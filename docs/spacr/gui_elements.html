<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>spacr.gui_elements API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../spacr.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;spacr</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#fig">fig</a>
            </li>
            <li>
                    <a class="function" href="#restart_gui_app">restart_gui_app</a>
            </li>
            <li>
                    <a class="function" href="#create_menu_bar">create_menu_bar</a>
            </li>
            <li>
                    <a class="function" href="#set_element_size">set_element_size</a>
            </li>
            <li>
                    <a class="function" href="#set_dark_style">set_dark_style</a>
            </li>
            <li>
                    <a class="class" href="#spacrFont">spacrFont</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrFont.__init__">spacrFont</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFont.font_name">font_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFont.font_style">font_style</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFont.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFont.font_path">font_path</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrFont.get_font_path">get_font_path</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrFont.load_font">load_font</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrFont.get_font">get_font</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrContainer">spacrContainer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrContainer.__init__">spacrContainer</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrContainer.orient">orient</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrContainer.bg">bg</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrContainer.sash_thickness">sash_thickness</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrContainer.panes">panes</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrContainer.sashes">sashes</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.create_sash">create_sash</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.reposition_panes">reposition_panes</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.on_configure">on_configure</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.on_enter_sash">on_enter_sash</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.on_leave_sash">on_leave_sash</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.start_resize">start_resize</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrContainer.perform_resize">perform_resize</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrEntry">spacrEntry</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrEntry.__init__">spacrEntry</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.outline">outline</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.font_family">font_family</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.canvas_height">canvas_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrEntry.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrEntry.draw_rounded_rectangle">draw_rounded_rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrEntry.on_focus_in">on_focus_in</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrEntry.on_focus_out">on_focus_out</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrCheck">spacrCheck</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrCheck.__init__">spacrCheck</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.variable">variable</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.canvas_width">canvas_width</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.canvas_height">canvas_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheck.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCheck.draw_rounded_square">draw_rounded_square</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCheck.update_check">update_check</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCheck.toggle_variable">toggle_variable</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrCombo">spacrCombo</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrCombo.__init__">spacrCombo</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.font_family">font_family</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.values">values</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.canvas_width">canvas_width</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.canvas_height">canvas_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.var">var</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.selected_value">selected_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCombo.dropdown_menu">dropdown_menu</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCombo.draw_rounded_rectangle">draw_rounded_rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCombo.on_click">on_click</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCombo.open_dropdown">open_dropdown</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCombo.close_dropdown">close_dropdown</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCombo.on_select">on_select</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrCombo.set">set</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrDropdownMenu">spacrDropdownMenu</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrDropdownMenu.__init__">spacrDropdownMenu</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.variable">variable</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.options">options</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.command">command</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.text">text</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.size">size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.button_width">button_width</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.canvas_width">canvas_width</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.canvas_height">canvas_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.button_bg">button_bg</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.button_text">button_text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrDropdownMenu.menu">menu</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.create_rounded_rectangle">create_rounded_rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.on_enter">on_enter</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.on_leave">on_leave</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.on_click">on_click</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.post_menu">post_menu</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.on_select">on_select</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrDropdownMenu.update_styles">update_styles</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrCheckbutton">spacrCheckbutton</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrCheckbutton.__init__">spacrCheckbutton</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheckbutton.text">text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheckbutton.variable">variable</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrCheckbutton.command">command</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrProgressBar">spacrProgressBar</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrProgressBar.__init__">spacrProgressBar</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.style">style</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.operation_type">operation_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrProgressBar.additional_info">additional_info</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrProgressBar.set_label_position">set_label_position</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrProgressBar.update_label">update_label</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrSlider">spacrSlider</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrSlider.__init__">spacrSlider</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.specified_length">specified_length</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.knob_radius">knob_radius</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.thickness">thickness</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.knob_position">knob_position</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.slider_line">slider_line</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.knob">knob</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.position">position</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.offset">offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.from_">from_</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.to">to</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.value">value</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.show_index">show_index</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.command">command</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSlider.length">length</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.resize_slider">resize_slider</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.value_to_position">value_to_position</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.position_to_value">position_to_value</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.draw_slider">draw_slider</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.move_knob">move_knob</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.activate_knob">activate_knob</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.release_knob">release_knob</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.set_to">set_to</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.get">get</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.jump_to_click">jump_to_click</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSlider.update_slider_from_entry">update_slider_from_entry</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#spacrScrollbarStyle">spacrScrollbarStyle</a>
            </li>
            <li>
                    <a class="class" href="#spacrFrame">spacrFrame</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrFrame.__init__">spacrFrame</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFrame.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFrame.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrFrame.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrFrame.rounded_rectangle">rounded_rectangle</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrLabel">spacrLabel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrLabel.__init__">spacrLabel</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.text">text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.align">align</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.style_out">style_out</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.font_style">font_style</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.font_family">font_family</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrLabel.style">style</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrLabel.set_text">set_text</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrButton">spacrButton</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrButton.__init__">spacrButton</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.text">text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.command">command</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.icon_name">icon_name</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.size">size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.show_text">show_text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.outline">outline</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.animation">animation</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrButton.is_zoomed_in">is_zoomed_in</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.load_icon">load_icon</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.get_icon_path">get_icon_path</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.on_enter">on_enter</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.on_leave">on_leave</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.on_click">on_click</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.create_rounded_rectangle">create_rounded_rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.update_description">update_description</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.clear_description">clear_description</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.animate_zoom">animate_zoom</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrButton.zoom_icon">zoom_icon</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrSwitch">spacrSwitch</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrSwitch.__init__">spacrSwitch</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.text">text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.variable">variable</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.command">command</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.canvas">canvas</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.switch_bg">switch_bg</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.switch">switch</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrSwitch.label">label</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.toggle">toggle</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.update_switch">update_switch</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.animate_switch">animate_switch</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.animate_movement">animate_movement</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.get">get</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrSwitch.create_rounded_rectangle">create_rounded_rectangle</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#spacrToolTip">spacrToolTip</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#spacrToolTip.__init__">spacrToolTip</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrToolTip.widget">widget</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrToolTip.text">text</a>
                        </li>
                        <li>
                                <a class="variable" href="#spacrToolTip.tooltip_window">tooltip_window</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrToolTip.show_tooltip">show_tooltip</a>
                        </li>
                        <li>
                                <a class="function" href="#spacrToolTip.hide_tooltip">hide_tooltip</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ModifyMaskApp">ModifyMaskApp</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ModifyMaskApp.__init__">ModifyMaskApp</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.root">root</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.folder_path">folder_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.scale_factor">scale_factor</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.image_filenames">image_filenames</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.masks_folder">masks_folder</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.current_image_index">current_image_index</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.canvas_width">canvas_width</a>
                        </li>
                        <li>
                                <a class="variable" href="#ModifyMaskApp.canvas_height">canvas_height</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.update_display">update_display</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.update_original_mask_from_zoom">update_original_mask_from_zoom</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.update_original_mask">update_original_mask</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.get_scaling_factors">get_scaling_factors</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.canvas_to_image">canvas_to_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.apply_zoom_on_enter">apply_zoom_on_enter</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.normalize_image">normalize_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.resize_arrays">resize_arrays</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.load_first_image">load_first_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.setup_canvas">setup_canvas</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.initialize_flags">initialize_flags</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.update_mouse_info">update_mouse_info</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.setup_navigation_toolbar">setup_navigation_toolbar</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.setup_mode_toolbar">setup_mode_toolbar</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.setup_function_toolbar">setup_function_toolbar</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.setup_zoom_toolbar">setup_zoom_toolbar</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.load_image_and_mask">load_image_and_mask</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.display_image">display_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.display_zoomed_image">display_zoomed_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.overlay_mask_on_image">overlay_mask_on_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.previous_image">previous_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.next_image">next_image</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.save_mask">save_mask</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.set_zoom_rectangle_start">set_zoom_rectangle_start</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.set_zoom_rectangle_end">set_zoom_rectangle_end</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.update_zoom_box">update_zoom_box</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.toggle_zoom_mode">toggle_zoom_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.toggle_brush_mode">toggle_brush_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.image_to_canvas">image_to_canvas</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.toggle_dividing_line_mode">toggle_dividing_line_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.start_dividing_line">start_dividing_line</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.finish_dividing_line">finish_dividing_line</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.update_dividing_line_preview">update_dividing_line_preview</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.apply_dividing_line">apply_dividing_line</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.toggle_draw_mode">toggle_draw_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.toggle_magic_wand_mode">toggle_magic_wand_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.toggle_erase_mode">toggle_erase_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.apply_brush_release">apply_brush_release</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.erase_brush_release">erase_brush_release</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.apply_brush">apply_brush</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.erase_brush">erase_brush</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.erase_object">erase_object</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.use_magic_wand">use_magic_wand</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.apply_magic_wand">apply_magic_wand</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.magic_wand_normal">magic_wand_normal</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.magic_wand_zoomed">magic_wand_zoomed</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.draw">draw</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.draw_on_zoomed_mask">draw_on_zoomed_mask</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.finish_drawing">finish_drawing</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.finish_drawing_if_active">finish_drawing_if_active</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.apply_normalization">apply_normalization</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.fill_objects">fill_objects</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.relabel_objects">relabel_objects</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.clear_objects">clear_objects</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.invert_mask">invert_mask</a>
                        </li>
                        <li>
                                <a class="function" href="#ModifyMaskApp.remove_small_objects">remove_small_objects</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AnnotateApp">AnnotateApp</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AnnotateApp.__init__">AnnotateApp</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.root">root</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.db_path">db_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.src">src</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.index">index</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.orig_annotation_columns">orig_annotation_columns</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.annotation_column">annotation_column</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.image_type">image_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.channels">channels</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.percentiles">percentiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.images">images</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.pending_updates">pending_updates</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.labels">labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.adjusted_to_original_paths">adjusted_to_original_paths</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.terminate">terminate</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.update_queue">update_queue</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.measurement">measurement</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.threshold">threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.normalize_channels">normalize_channels</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.font_loader">font_loader</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.font_size">font_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.bg_color">bg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.fg_color">fg_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.active_color">active_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.inactive_color">inactive_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.filtered_paths_annotations">filtered_paths_annotations</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.db_update_thread">db_update_thread</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.status_label">status_label</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.button_frame">button_frame</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.next_button">next_button</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.previous_button">previous_button</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.exit_button">exit_button</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.train_button">train_button</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.settings_button">settings_button</a>
                        </li>
                        <li>
                                <a class="variable" href="#AnnotateApp.grid_frame">grid_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.open_settings_window">open_settings_window</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.update_settings">update_settings</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.recreate_image_grid">recreate_image_grid</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.swich_back_annotation_column">swich_back_annotation_column</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.calculate_grid_dimensions">calculate_grid_dimensions</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.prefilter_paths_annotations">prefilter_paths_annotations</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.load_images">load_images</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.load_single_image">load_single_image</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.normalize_image">normalize_image</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.add_colored_border">add_colored_border</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.filter_channels">filter_channels</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.get_on_image_click">get_on_image_click</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.update_html">update_html</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.update_database_worker">update_database_worker</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.update_gui_text">update_gui_text</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.next_page">next_page</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.previous_page">previous_page</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.shutdown">shutdown</a>
                        </li>
                        <li>
                                <a class="function" href="#AnnotateApp.train_and_classify">train_and_classify</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#standardize_figure">standardize_figure</a>
            </li>
            <li>
                    <a class="function" href="#modify_figure_properties">modify_figure_properties</a>
            </li>
            <li>
                    <a class="function" href="#save_figure_as_format">save_figure_as_format</a>
            </li>
            <li>
                    <a class="function" href="#modify_figure">modify_figure</a>
            </li>
            <li>
                    <a class="function" href="#generate_dna_matrix">generate_dna_matrix</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../spacr.html">spacr</a><wbr>.gui_elements    </h1>

                
                        <input id="mod-gui_elements-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-gui_elements-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">sqlite3</span><span class="o">,</span> <span class="nn">webbrowser</span><span class="o">,</span> <span class="nn">pyautogui</span><span class="o">,</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">cv2</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">tkinter.font</span> <span class="k">as</span> <span class="nn">tkFont</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">font</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">Queue</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Label</span><span class="p">,</span> <span class="n">Frame</span><span class="p">,</span> <span class="n">Button</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageOps</span><span class="p">,</span> <span class="n">ImageTk</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span><span class="p">,</span> <span class="n">ImageEnhance</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">from</span> <span class="nn">skimage.exposure</span> <span class="kn">import</span> <span class="n">rescale_intensity</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">import</span> <span class="nn">imageio.v2</span> <span class="k">as</span> <span class="nn">imageio</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span> <span class="nn">skimage.draw</span> <span class="kn">import</span> <span class="n">polygon</span><span class="p">,</span> <span class="n">line</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">resize</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">binary_fill_holes</span><span class="p">,</span> <span class="n">label</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span><span class="p">,</span> <span class="n">scrolledtext</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="k">def</span> <span class="nf">restart_gui_app</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">    Restarts the GUI application by destroying the current instance</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">    and launching a fresh one.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>        <span class="c1"># Destroy the current root window</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>        <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>        
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>        <span class="c1"># Import and launch a new instance of the application</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>        <span class="kn">from</span> <span class="nn">spacr.gui</span> <span class="kn">import</span> <span class="n">gui_app</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>        <span class="n">new_root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>  <span class="c1"># Create a fresh Tkinter root instance</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>        <span class="n">gui_app</span><span class="p">()</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error restarting GUI application: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="k">def</span> <span class="nf">create_menu_bar</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="kn">from</span> <span class="nn">.gui</span> <span class="kn">import</span> <span class="n">initiate_root</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="n">gui_apps</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>        <span class="s2">&quot;Mask&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;mask&#39;</span><span class="p">),</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>        <span class="s2">&quot;Measure&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;measure&#39;</span><span class="p">),</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>        <span class="s2">&quot;Annotate&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span><span class="p">),</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>        <span class="s2">&quot;Make Masks&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;make_masks&#39;</span><span class="p">),</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>        <span class="s2">&quot;Classify&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;classify&#39;</span><span class="p">),</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>        <span class="s2">&quot;Umap&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;umap&#39;</span><span class="p">),</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>        <span class="s2">&quot;Train Cellpose&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;train_cellpose&#39;</span><span class="p">),</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>        <span class="s2">&quot;ML Analyze&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;ml_analyze&#39;</span><span class="p">),</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>        <span class="s2">&quot;Cellpose Masks&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;cellpose_masks&#39;</span><span class="p">),</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>        <span class="s2">&quot;Cellpose All&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;cellpose_all&#39;</span><span class="p">),</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>        <span class="s2">&quot;Map Barcodes&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;map_barcodes&#39;</span><span class="p">),</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>        <span class="s2">&quot;Regression&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">),</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>        <span class="s2">&quot;Activation&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;activation&#39;</span><span class="p">),</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>        <span class="s2">&quot;Recruitment&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;recruitment&#39;</span><span class="p">)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>    <span class="p">}</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>    <span class="c1"># Create the menu bar</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>    <span class="n">menu_bar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>    <span class="c1"># Create a &quot;SpaCr Applications&quot; menu</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>    <span class="n">app_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menu_bar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>    <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;SpaCr Applications&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">app_menu</span><span class="p">)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>    <span class="c1"># Add options to the &quot;SpaCr Applications&quot; menu</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>    <span class="k">for</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">app_func</span> <span class="ow">in</span> <span class="n">gui_apps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>        <span class="n">app_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>            <span class="n">label</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>            <span class="n">command</span><span class="o">=</span><span class="n">app_func</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>        <span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>    <span class="c1"># Add a separator and an exit option</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>    <span class="n">app_menu</span><span class="o">.</span><span class="n">add_separator</span><span class="p">()</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>    <span class="c1">#app_menu.add_command(label=&quot;Home&quot;,command=lambda: restart_gui_app(root))</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>    <span class="n">app_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Help&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;https://spacr.readthedocs.io/en/latest/?badge=latest&quot;</span><span class="p">))</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>    <span class="n">app_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>    <span class="c1"># Configure the menu for the root window</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="n">menu_bar</span><span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="k">def</span> <span class="nf">set_element_size</span><span class="p">():</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>    <span class="n">screen_width</span><span class="p">,</span> <span class="n">screen_height</span> <span class="o">=</span> <span class="n">pyautogui</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>    <span class="n">screen_area</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">*</span> <span class="n">screen_height</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>    
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>    <span class="c1"># Calculate sizes based on screen dimensions</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>    <span class="n">btn_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">screen_area</span> <span class="o">*</span> <span class="mf">0.002</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Button size as a fraction of screen area</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>    <span class="n">bar_size</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">20</span>  <span class="c1"># Bar size based on screen height</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>    <span class="n">settings_width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="mi">4</span>  <span class="c1"># Settings panel width as a fraction of screen width</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>    <span class="n">panel_width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">-</span> <span class="n">settings_width</span>  <span class="c1"># Panel width as a fraction of screen width</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>    <span class="n">panel_height</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">6</span>  <span class="c1"># Panel height as a fraction of screen height</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>    
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>    <span class="n">size_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>        <span class="s1">&#39;btn_size&#39;</span><span class="p">:</span> <span class="n">btn_size</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>        <span class="s1">&#39;bar_size&#39;</span><span class="p">:</span> <span class="n">bar_size</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>        <span class="s1">&#39;settings_width&#39;</span><span class="p">:</span> <span class="n">settings_width</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>        <span class="s1">&#39;panel_width&#39;</span><span class="p">:</span> <span class="n">panel_width</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>        <span class="s1">&#39;panel_height&#39;</span><span class="p">:</span> <span class="n">panel_height</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>    <span class="p">}</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>    <span class="k">return</span> <span class="n">size_dict</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="k">def</span> <span class="nf">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">parent_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;OpenSans&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="o">=</span><span class="s1">&#39;dark_gray&#39;</span><span class="p">):</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>    <span class="k">if</span> <span class="n">active_color</span> <span class="o">==</span> <span class="s1">&#39;teal&#39;</span><span class="p">:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>        <span class="n">active_color</span> <span class="o">=</span> <span class="s1">&#39;#008080&#39;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>    <span class="k">if</span> <span class="n">inactive_color</span> <span class="o">==</span> <span class="s1">&#39;dark_gray&#39;</span><span class="p">:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="n">inactive_color</span> <span class="o">=</span> <span class="s1">&#39;#2B2B2B&#39;</span> <span class="c1"># &#39;#333333&#39; #&#39;#050505&#39;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="k">if</span> <span class="n">bg_color</span> <span class="o">==</span> <span class="s1">&#39;black&#39;</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>        <span class="n">bg_color</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>    <span class="k">if</span> <span class="n">fg_color</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span><span class="p">:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="n">fg_color</span> <span class="o">=</span> <span class="s1">&#39;#ffffff&#39;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>    <span class="k">if</span> <span class="n">active_color</span> <span class="o">==</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>        <span class="n">active_color</span> <span class="o">=</span> <span class="s1">&#39;#007BFF&#39;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>    <span class="n">padding</span> <span class="o">=</span> <span class="s1">&#39;5 5 5 5&#39;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>    <span class="n">font_style</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>    <span class="k">if</span> <span class="n">font_family</span> <span class="o">==</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>        <span class="n">font_loader</span> <span class="o">=</span> <span class="n">spacrFont</span><span class="p">(</span><span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;OpenSans&#39;</span><span class="p">,</span> <span class="n">font_style</span><span class="o">=</span><span class="s1">&#39;Regular&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>        <span class="n">font_loader</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">theme_use</span><span class="p">(</span><span class="s1">&#39;clam&#39;</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>    
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TCombobox&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Spacr.TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Spacr.TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Custom.TLabel&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TButton&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TFrame&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TPanedwindow&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>    <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TLabel&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TLabel&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>    <span class="k">if</span> <span class="n">parent_frame</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="n">parent_frame</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="n">parent_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="n">parent_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>    <span class="k">if</span> <span class="n">containers</span><span class="p">:</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>        <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>                <span class="n">container_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>                <span class="n">container_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">container</span><span class="o">.</span><span class="n">winfo_class</span><span class="p">()</span><span class="si">}</span><span class="s1">.TFrame&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>                <span class="n">container</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">container</span><span class="o">.</span><span class="n">winfo_class</span><span class="p">()</span><span class="si">}</span><span class="s1">.TFrame&#39;</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>                <span class="n">container</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>    <span class="k">if</span> <span class="n">widgets</span><span class="p">:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="k">for</span> <span class="n">widget</span> <span class="ow">in</span> <span class="n">widgets</span><span class="p">:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">,</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">)):</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>                <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">)):</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>                <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">scrolledtext</span><span class="o">.</span><span class="n">ScrolledText</span><span class="p">):</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>                <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">insertbackground</span><span class="o">=</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>                <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>                <span class="n">menu</span> <span class="o">=</span> <span class="n">widget</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>                <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>                    <span class="n">menu</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>                    <span class="n">menu</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;font_loader&#39;</span><span class="p">:</span><span class="n">font_loader</span><span class="p">,</span> <span class="s1">&#39;font_family&#39;</span><span class="p">:</span> <span class="n">font_family</span><span class="p">,</span> <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">bg_color</span><span class="p">,</span> <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">fg_color</span><span class="p">,</span> <span class="s1">&#39;active_color&#39;</span><span class="p">:</span> <span class="n">active_color</span><span class="p">,</span> <span class="s1">&#39;inactive_color&#39;</span><span class="p">:</span> <span class="n">inactive_color</span><span class="p">}</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="k">class</span> <span class="nc">spacrFont</span><span class="p">:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        Initializes the FontLoader class.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        Parameters:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">        - font_name: str, the name of the font (e.g., &#39;OpenSans&#39;).</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="sd">        - font_style: str, the style of the font (e.g., &#39;Regular&#39;, &#39;Bold&#39;).</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="sd">        - font_size: int, the size of the font (default: 12).</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="n">font_name</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font_style</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">font_size</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="c1"># Determine the path based on the font name and style</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_font_path</span><span class="p">(</span><span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="c1"># Register the font with Tkinter</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_font</span><span class="p">()</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>    <span class="k">def</span> <span class="nf">get_font_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">):</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">        Returns the font path based on the font name and style.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        Parameters:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        - font_name: str, the name of the font.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        - font_style: str, the style of the font.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        Returns:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        - str, the path to the font file.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>        
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="k">if</span> <span class="n">font_name</span> <span class="o">==</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="k">if</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Regular&#39;</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Regular.ttf&#39;</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="k">elif</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Bold&#39;</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Bold.ttf&#39;</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>            <span class="k">elif</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Italic&#39;</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Italic.ttf&#39;</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>            <span class="c1"># Add more styles as needed</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>        <span class="c1"># Add more fonts as needed</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>        
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Font &#39;</span><span class="si">{</span><span class="n">font_name</span><span class="si">}</span><span class="s2">&#39; with style &#39;</span><span class="si">{</span><span class="n">font_style</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>    <span class="k">def</span> <span class="nf">load_font</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">        Loads the font into Tkinter.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="k">except</span> <span class="n">tk</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="c1"># Load the font manually if it&#39;s not already loaded</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tk_font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_path</span><span class="p">,</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>                <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>            <span class="p">)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>    <span class="k">def</span> <span class="nf">get_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        Returns the font in the specified size.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        Parameters:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        - size: int, the size of the font (optional).</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="sd">        Returns:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        - tkFont.Font object.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>        <span class="k">return</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="k">class</span> <span class="nc">spacrContainer</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">=</span> <span class="n">orient</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">bg</span> <span class="k">if</span> <span class="n">bg</span> <span class="k">else</span> <span class="s1">&#39;lightgrey&#39;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">panes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sashes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_configure</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">):</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding widget: </span><span class="si">{</span><span class="n">widget</span><span class="si">}</span><span class="s2"> with stretch: </span><span class="si">{</span><span class="n">stretch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="n">pane</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="n">pane</span><span class="o">.</span><span class="n">grid_propagate</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">pane</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>  <span class="c1"># Use grid for the widget within the pane</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">))</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">create_sash</span><span class="p">()</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>    <span class="k">def</span> <span class="nf">create_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span> <span class="n">cursor</span><span class="o">=</span><span class="s1">&#39;sb_v_double_arrow&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="s1">&#39;sb_h_double_arrow&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter_sash</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave_sash</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonPress-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_resize</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sash</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>    <span class="k">def</span> <span class="nf">reposition_panes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>            <span class="k">return</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="n">total_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="n">pane_size</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total size: </span><span class="si">{</span><span class="n">total_size</span><span class="si">}</span><span class="s2">, Pane size: </span><span class="si">{</span><span class="n">pane_size</span><span class="si">}</span><span class="s2">, Number of panes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">):</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>                <span class="n">pane</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>                <span class="n">pane</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sash</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sashes</span><span class="p">):</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>                <span class="n">sash</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>                <span class="n">sash</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>    <span class="k">def</span> <span class="nf">on_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring container: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>    <span class="k">def</span> <span class="nf">on_enter_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>    <span class="k">def</span> <span class="nf">on_leave_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>    <span class="k">def</span> <span class="nf">start_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_size</span> <span class="o">=</span> <span class="n">sash</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="n">sash</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_resize</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>    <span class="k">def</span> <span class="nf">perform_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="n">new_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_size</span> <span class="o">+</span> <span class="n">delta</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">):</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>                <span class="n">new_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>                <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">new_size</span><span class="p">:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>                    <span class="n">pane</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">new_row</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>                <span class="k">elif</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">new_size</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>                    <span class="n">previous_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">-</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">())</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">previous_row</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>                <span class="n">new_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>                <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">new_size</span><span class="p">:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>                    <span class="n">pane</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">new_col</span><span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>                <span class="k">elif</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">new_size</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>                    <span class="n">previous_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">-</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">())</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">previous_col</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="k">class</span> <span class="nc">spacrEntry</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="c1"># Set dark style</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="c1"># Set the background color of the frame</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="c1"># Create a canvas for the rounded rectangle background</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="mi">220</span>  <span class="c1"># Adjusted for padding</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="n">width</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1"># Adjusted for padding</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="c1"># Create the entry widget</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">textvariable</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">textvariable</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rely</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># Centered positioning</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="c1"># Bind events to change the background color on focus</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focus_in</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focus_out</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>        
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Increased radius for more rounded corners</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="mi">5</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>    
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>    <span class="k">def</span> <span class="nf">on_focus_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>    
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="k">def</span> <span class="nf">on_focus_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="k">class</span> <span class="nc">spacrCheck</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="c1"># Create a canvas for the rounded square background</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>        <span class="c1"># Draw the initial rounded square based on the variable&#39;s value</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>        <span class="c1"># Bind variable changes to update the checkbox</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_check</span><span class="p">)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="c1"># Bind click event to toggle the variable</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_variable</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Adjust the radius for more rounded corners</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>    <span class="k">def</span> <span class="nf">update_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>    <span class="k">def</span> <span class="nf">toggle_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="k">class</span> <span class="nc">spacrCombo</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="c1"># Set dark style</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="c1"># Create a canvas for the rounded rectangle background</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="n">width</span> <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">220</span>  <span class="c1"># Adjusted for padding</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1"># Adjusted for padding</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>        
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">textvariable</span> <span class="k">if</span> <span class="n">textvariable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>        
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>        <span class="c1"># Create the label to display the selected value</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rely</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>        
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="c1"># Bind events to open the dropdown menu</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>        
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Increased radius for more rounded corners</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="mi">5</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># Update label background to match rectangle color</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_dropdown</span><span class="p">()</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close_dropdown</span><span class="p">()</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>    <span class="k">def</span> <span class="nf">open_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">30</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>            <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_select</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">item</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">))</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">item</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">))</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>    <span class="k">def</span> <span class="nf">close_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>        <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close_dropdown</span><span class="p">()</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="k">class</span> <span class="nc">spacrDropdownMenu</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Settings&quot;</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>        <span class="c1"># Button size configuration</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>        <span class="c1"># Create the canvas and rounded button</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>        <span class="n">color_settings</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="c1"># Create the button with rounded edges</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        <span class="c1"># Create and place the label on the button</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="c1"># Bind events for button behavior</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="c1"># Create a popup menu with the desired background color</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="n">opt</span><span class="o">=</span><span class="n">option</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_select</span><span class="p">(</span><span class="n">opt</span><span class="p">))</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        <span class="p">]</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>    <span class="k">def</span> <span class="nf">on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>    <span class="k">def</span> <span class="nf">on_leave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">post_menu</span><span class="p">()</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>    <span class="k">def</span> <span class="nf">post_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>    <span class="k">def</span> <span class="nf">update_styles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">active_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">])</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>        <span class="k">if</span> <span class="n">active_categories</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>                <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entrycget</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                <span class="k">if</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">active_categories</span><span class="p">:</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="k">class</span> <span class="nc">spacrCheckbutton</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">):</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span> <span class="k">if</span> <span class="n">variable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Spacr.TCheckbutton&#39;</span><span class="p">)</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">])</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="k">class</span> <span class="nc">spacrProgressBar</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Progressbar</span><span class="p">):</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>        <span class="c1"># Get the style colors</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="c1"># Configure the style for the progress bar</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>        <span class="c1"># Remove any borders and ensure the active color fills the entire space</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>            <span class="s2">&quot;spacr.Horizontal.TProgressbar&quot;</span><span class="p">,</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>            <span class="n">troughcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="c1"># Set the trough to bg color</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>            <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>    <span class="c1"># Active part is the active color</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>            <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                   <span class="c1"># Remove border width</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>            <span class="n">pbarrelief</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>               <span class="c1"># Flat relief for the progress bar</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>            <span class="n">troughrelief</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>             <span class="c1"># Flat relief for the trough</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>            <span class="n">thickness</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>                    <span class="c1"># Set the thickness of the progress bar</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>            <span class="n">darkcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>     <span class="c1"># Ensure darkcolor matches the active color</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>            <span class="n">lightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>    <span class="c1"># Ensure lightcolor matches the active color</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>            <span class="n">bordercolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span>        <span class="c1"># Set the border color to the background color to hide it</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>        <span class="p">)</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;spacr.Horizontal.TProgressbar&quot;</span><span class="p">)</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="c1"># Set initial value to 0</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>        <span class="c1"># Track whether to show the progress label</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>        <span class="c1"># Create the progress label with text wrapping</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>                <span class="n">parent</span><span class="p">,</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Processing: 0/0&quot;</span><span class="p">,</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>                <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>                <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>                <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>                <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                <span class="n">wraplength</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>                <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>            <span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">grid_forget</span><span class="p">()</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>        <span class="c1"># Initialize attributes for time and operation</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>    <span class="k">def</span> <span class="nf">set_label_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="p">:</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="n">row_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rowID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>            <span class="n">col_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columnID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>            <span class="n">col_span</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columnspan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row_info</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col_info</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="n">col_span</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>    <span class="k">def</span> <span class="nf">update_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="p">:</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>            <span class="c1"># Start with the base progress information</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>            <span class="n">label_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Processing: </span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;maximum&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>            <span class="c1"># Include the operation type if it exists</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span><span class="p">:</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>                <span class="n">label_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>            <span class="c1"># Handle additional info without adding newlines</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;additional_info&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span><span class="p">:</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                <span class="c1"># Join all additional info items with a space and ensure they&#39;re on the same line</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>                <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>                <span class="n">formatted_additional_info</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>                <span class="c1"># Append the additional info to the label_text, ensuring it&#39;s all in one line</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>                <span class="n">label_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">formatted_additional_info</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>            <span class="c1"># Update the progress label</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="k">class</span> <span class="nc">spacrSlider</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">knob_radius</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="o">=</span> <span class="n">length</span>  <span class="c1"># Store the specified length, if any</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">=</span> <span class="n">knob_radius</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="n">knob_radius</span>  <span class="c1"># Start at the beginning of the slider</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slider_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># Store the position option</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Initialize offset</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">from_</span> <span class="o">=</span> <span class="n">from_</span>  <span class="c1"># Minimum value of the slider</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">=</span> <span class="n">to</span>  <span class="c1"># Maximum value of the slider</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">from_</span>  <span class="c1"># Initial value of the slider</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span> <span class="o">=</span> <span class="n">show_index</span>  <span class="c1"># Whether to show the index Entry widget</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>  <span class="c1"># Callback function to handle value changes</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>        <span class="c1"># Initialize the style and colors</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="c1"># Configure the frame&#39;s background color</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="c1"># Create a frame for the slider and entry if needed</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="c1"># Entry widget for showing and editing index, if enabled</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">insertbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>            <span class="c1"># Bind the entry to update the slider on change</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Return&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_slider_from_entry</span><span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="c1"># Create the slider canvas</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">knob_radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="c1"># Set initial length to specified length or default value</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="c1"># Calculate initial knob position based on the initial value</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="c1"># Bind resize event to dynamically adjust the slider length if no length is specified</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_slider</span><span class="p">)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="c1"># Draw the slider components</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="c1"># Bind mouse events to the knob and slider</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_knob</span><span class="p">)</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">activate_knob</span><span class="p">)</span>  <span class="c1"># Activate knob on click</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">release_knob</span><span class="p">)</span>  <span class="c1"># Trigger command on release</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>    <span class="k">def</span> <span class="nf">resize_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span>  <span class="c1"># 90% of the container width</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>        <span class="c1"># Calculate the horizontal offset based on the position</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># position is &quot;left&quot;</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="c1"># Update the knob position after resizing</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>    <span class="k">def</span> <span class="nf">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">:</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="n">relative_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="n">relative_value</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>    <span class="k">def</span> <span class="nf">position_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">:</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>        <span class="n">relative_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span> <span class="o">+</span> <span class="n">relative_position</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>    <span class="k">def</span> <span class="nf">draw_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slider_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> 
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>            <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>        <span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>        <span class="n">knob_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="k">if</span> <span class="n">inactive</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>            <span class="n">fill</span><span class="o">=</span><span class="n">knob_color</span><span class="p">,</span> 
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>            <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>        <span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>    <span class="k">def</span> <span class="nf">move_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="n">new_position</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="n">new_position</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position_to_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span><span class="p">)</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob</span><span class="p">,</span> 
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="p">)</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>    <span class="k">def</span> <span class="nf">activate_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">move_knob</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>    <span class="k">def</span> <span class="nf">release_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Call the command with the final value when the knob is released</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>    <span class="k">def</span> <span class="nf">set_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_to</span><span class="p">):</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the slider&#39;s value and update the knob position.&quot;&quot;&quot;</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">))</span>  <span class="c1"># Ensure the value is within bounds</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>    <span class="k">def</span> <span class="nf">jump_to_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">activate_knob</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>    <span class="k">def</span> <span class="nf">update_slider_from_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the slider&#39;s value from the entry.&quot;&quot;&quot;</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>            <span class="k">pass</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="k">def</span> <span class="nf">spacrScrollbarStyle</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">,</span> <span class="n">active_color</span><span class="p">):</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>    <span class="c1"># Check if custom elements already exist to avoid duplication</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="o">.</span><span class="n">element_names</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.trough&#39;</span><span class="p">):</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">element_create</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.trough&#39;</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;clam&#39;</span><span class="p">)</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="o">.</span><span class="n">element_names</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.thumb&#39;</span><span class="p">):</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">element_create</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.thumb&#39;</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;clam&#39;</span><span class="p">)</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">,</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>                 <span class="p">[(</span><span class="s1">&#39;Vertical.Scrollbar.trough&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;Vertical.Scrollbar.thumb&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;expand&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;sticky&#39;</span><span class="p">:</span> <span class="s1">&#39;nswe&#39;</span><span class="p">})],</span> <span class="s1">&#39;sticky&#39;</span><span class="p">:</span> <span class="s1">&#39;ns&#39;</span><span class="p">})])</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">,</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>                    <span class="n">background</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>                    <span class="n">troughcolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>                    <span class="n">bordercolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>                    <span class="n">lightcolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>                    <span class="n">darkcolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">,</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>              <span class="n">background</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="p">)],</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>              <span class="n">troughcolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">)],</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>              <span class="n">bordercolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">)],</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>              <span class="n">lightcolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="p">)],</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>              <span class="n">darkcolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="p">)])</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="k">class</span> <span class="nc">spacrFrame</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scrollbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">textbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;TFrame&#39;</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>            <span class="n">screen_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>        <span class="c1"># Create the canvas</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>        <span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rounded_rectangle</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">(),</span> <span class="n">radius</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">bg</span><span class="p">)</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>        <span class="c1"># Define scrollbar styles</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>  <span class="c1"># Foreground color for text</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="c1"># Set custom scrollbar style</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="n">spacrScrollbarStyle</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="c1"># Create scrollbar with custom style if scrollbar option is True</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>            <span class="n">scrollbar_widget</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">yview</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">)</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="k">if</span> <span class="n">textbox</span><span class="p">:</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;TFrame&#39;</span><span class="p">)</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>        
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>            <span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>            <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">scrollregion</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="p">)</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="n">canvas</span><span class="o">.</span><span class="n">create_window</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;nw&quot;</span><span class="p">)</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">scrollbar_widget</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>        
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        <span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>            <span class="n">scrollbar_widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">)</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="p">])</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">scrollbar_widget</span><span class="p">])</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>    <span class="k">def</span> <span class="nf">rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>        <span class="p">]</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>        <span class="k">return</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="k">class</span> <span class="nc">spacrLabel</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>        <span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;foreground&#39;</span><span class="p">,</span> <span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="s1">&#39;anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;justify&#39;</span><span class="p">,</span> <span class="s1">&#39;wraplength&#39;</span><span class="p">]}</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">valid_kwargs</span><span class="p">)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>        
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="n">align</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>            <span class="n">screen_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>            <span class="n">label_height</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">50</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>            <span class="n">label_width</span> <span class="o">=</span> <span class="n">label_height</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>            <span class="n">label_height</span> <span class="o">=</span> <span class="n">height</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>            <span class="n">label_width</span> <span class="o">=</span> <span class="n">label_height</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">label_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">label_height</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="n">tkFont</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>            <span class="n">anchor_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>            <span class="n">text_anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># default to right alignment</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>            <span class="n">anchor_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="n">text_anchor</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>            <span class="n">ttk_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>                <span class="n">ttk_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>                <span class="n">ttk_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">text_anchor</span><span class="p">)</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">label_width</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span> <span class="k">else</span> <span class="n">label_width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> 
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>                                                          <span class="n">label_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> 
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>                                                          <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor_value</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">label_width</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span> <span class="k">else</span> <span class="n">label_width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> 
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>                                                        <span class="n">label_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> 
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>                                                        <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor_value</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>        
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="k">class</span> <span class="nc">spacrButton</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">icon_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">show_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">animation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>        
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>  <span class="c1"># Capitalize only the first letter of the text</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_name</span> <span class="k">if</span> <span class="n">icon_name</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span> <span class="o">=</span> <span class="n">show_text</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">animation</span>  <span class="c1"># Add animation attribute</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># Make the button width equal to the size if show_text is False</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="c1"># Create the canvas first</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">color_settings</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="p">:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_icon</span><span class="p">()</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>  <span class="c1"># Align text to the left of the specified point</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Track zoom state for smooth transitions</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>    <span class="k">def</span> <span class="nf">load_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>        <span class="n">icon_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_name</span><span class="p">)</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>            <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">UnidentifiedImageError</span><span class="p">):</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>                <span class="n">icon_path</span> <span class="o">=</span> <span class="n">icon_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>                <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">UnidentifiedImageError</span><span class="p">):</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>                <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Icon not found: </span><span class="si">{</span><span class="n">icon_path</span><span class="si">}</span><span class="s1">. Using default icon instead.&#39;</span><span class="p">)</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>        <span class="n">initial_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.65</span><span class="p">)</span>  <span class="c1"># 65% of button size initially</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span> <span class="o">=</span> <span class="n">icon_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">initial_size</span><span class="p">,</span> <span class="n">initial_size</span><span class="p">),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span><span class="p">)</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span><span class="p">)</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span>  <span class="c1"># Keep a reference to avoid garbage collection</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>    <span class="k">def</span> <span class="nf">get_icon_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon_name</span><span class="p">):</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="n">icon_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="s1">&#39;icons&#39;</span><span class="p">)</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">icon_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">icon_name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>    <span class="k">def</span> <span class="nf">on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_description</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span><span class="p">:</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">animate_zoom</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>  <span class="c1"># Zoom in the icon to 85% of button size</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>    <span class="k">def</span> <span class="nf">on_leave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_description</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span><span class="p">:</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">animate_zoom</span><span class="p">(</span><span class="mf">0.65</span><span class="p">)</span>  <span class="c1"># Reset the icon size to 65% of button size</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="p">]</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>    
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>    <span class="k">def</span> <span class="nf">update_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;show_description&#39;</span><span class="p">):</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                <span class="n">parent</span><span class="o">.</span><span class="n">show_description</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">main_buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">additional_buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;No description available.&quot;</span><span class="p">)))</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>                <span class="k">return</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">master</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>    <span class="k">def</span> <span class="nf">clear_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;clear_description&#39;</span><span class="p">):</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>                <span class="n">parent</span><span class="o">.</span><span class="n">clear_description</span><span class="p">()</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>                <span class="k">return</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">master</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>    <span class="k">def</span> <span class="nf">animate_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_scale</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>        <span class="n">current_scale</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="k">else</span> <span class="mf">0.65</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>        <span class="n">step_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">target_scale</span> <span class="o">-</span> <span class="n">current_scale</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_animate_step</span><span class="p">(</span><span class="n">current_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>    <span class="k">def</span> <span class="nf">_animate_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>        <span class="k">if</span> <span class="n">steps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>            <span class="n">new_scale</span> <span class="o">=</span> <span class="n">current_scale</span> <span class="o">+</span> <span class="n">step_scale</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_icon</span><span class="p">(</span><span class="n">new_scale</span><span class="p">)</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_animate_step</span><span class="p">,</span> <span class="n">new_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>    <span class="k">def</span> <span class="nf">zoom_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>        <span class="c1"># Resize the original icon image</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="n">new_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">scale_factor</span><span class="p">)</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="n">resized_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">new_size</span><span class="p">,</span> <span class="n">new_size</span><span class="p">),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">resized_icon</span><span class="p">)</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="c1"># Update the icon on the canvas</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_icon</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span><span class="p">)</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a><span class="k">class</span> <span class="nc">spacrSwitch</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span> <span class="k">if</span> <span class="n">variable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">switch_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#fff&quot;</span><span class="p">)</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">switch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#800080&quot;</span><span class="p">)</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">spacrLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_switch</span><span class="p">()</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">])</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>    <span class="k">def</span> <span class="nf">toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animate_switch</span><span class="p">()</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="nf">update_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">)</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#800080&quot;</span><span class="p">)</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>    <span class="k">def</span> <span class="nf">animate_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>            <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>            <span class="n">final_color</span> <span class="o">=</span> <span class="s2">&quot;#008080&quot;</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>            <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">4</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>            <span class="n">final_color</span> <span class="o">=</span> <span class="s2">&quot;#800080&quot;</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animate_movement</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">final_color</span><span class="p">)</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>    <span class="k">def</span> <span class="nf">animate_movement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">final_color</span><span class="p">):</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">start_x</span> <span class="o">&lt;</span> <span class="n">end_x</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">final_color</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_switch</span><span class="p">()</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="k">class</span> <span class="nc">spacrToolTip</span><span class="p">:</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_tooltip</span><span class="p">)</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_tooltip</span><span class="p">)</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>    <span class="k">def</span> <span class="nf">show_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span> <span class="o">+</span> <span class="mi">20</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="o">+</span> <span class="mi">10</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">wm_geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>        <span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>        <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>    <span class="k">def</span> <span class="nf">hide_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">:</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="k">class</span> <span class="nc">ModifyMaskApp</span><span class="p">:</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span> <span class="o">=</span> <span class="n">folder_path</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;.tiff&#39;</span><span class="p">))])</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">masks_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_navigation_toolbar</span><span class="p">()</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_mode_toolbar</span><span class="p">()</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_function_toolbar</span><span class="p">()</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_zoom_toolbar</span><span class="p">()</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_canvas</span><span class="p">()</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_first_image</span><span class="p">()</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>    
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>    <span class="c1"># Helper functions#</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>    
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>    <span class="k">def</span> <span class="nf">update_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_zoomed_image</span><span class="p">()</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>    
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>    <span class="k">def</span> <span class="nf">update_original_mask_from_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>        <span class="n">zoomed_mask_resized</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_mask_resized</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>        
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>    <span class="k">def</span> <span class="nf">update_original_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>        <span class="n">actual_mask_region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="n">target_shape</span> <span class="o">=</span> <span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>        <span class="n">resized_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">target_shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>        <span class="k">if</span> <span class="n">resized_mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape mismatch: resized_mask </span><span class="si">{</span><span class="n">resized_mask</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, actual_mask_region </span><span class="si">{</span><span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">actual_mask_region</span><span class="p">,</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">],</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>    <span class="k">def</span> <span class="nf">get_scaling_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_width</span><span class="p">,</span> <span class="n">img_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">):</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="n">x_scale</span> <span class="o">=</span> <span class="n">img_width</span> <span class="o">/</span> <span class="n">canvas_width</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>        <span class="n">y_scale</span> <span class="o">=</span> <span class="n">img_height</span> <span class="o">/</span> <span class="n">canvas_height</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>        <span class="k">return</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>    
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>    <span class="k">def</span> <span class="nf">canvas_to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_canvas</span><span class="p">,</span> <span class="n">y_canvas</span><span class="p">):</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>        <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scaling_factors</span><span class="p">(</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>        <span class="p">)</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>        <span class="n">x_image</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_canvas</span> <span class="o">*</span> <span class="n">x_scale</span><span class="p">)</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>        <span class="n">y_image</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_canvas</span> <span class="o">*</span> <span class="n">y_scale</span><span class="p">)</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>        <span class="k">return</span> <span class="n">x_image</span><span class="p">,</span> <span class="n">y_image</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>    <span class="k">def</span> <span class="nf">apply_zoom_on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_end</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>        
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>    <span class="k">def</span> <span class="nf">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">):</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">)</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized</span> <span class="o">-</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">upper_bound</span> <span class="o">-</span> <span class="n">lower_bound</span><span class="p">)</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized</span> <span class="o">*</span> <span class="n">max_value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>        <span class="k">return</span> <span class="n">normalized</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>    
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>    <span class="k">def</span> <span class="nf">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>        <span class="n">original_dtype</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>        <span class="n">scaled_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">)</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>        <span class="n">scaled_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">)</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>        <span class="n">scaled_img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">scaled_height</span><span class="p">,</span> <span class="n">scaled_width</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>        <span class="n">scaled_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="n">scaled_height</span><span class="p">,</span> <span class="n">scaled_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>        <span class="n">stretched_img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">scaled_img</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>        <span class="n">stretched_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">scaled_mask</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>        <span class="k">return</span> <span class="n">stretched_img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">original_dtype</span><span class="p">),</span> <span class="n">stretched_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">original_dtype</span><span class="p">)</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>    
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>    <span class="c1">#Initiate canvas elements#</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>    
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>    <span class="k">def</span> <span class="nf">load_first_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>    <span class="k">def</span> <span class="nf">setup_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>    <span class="k">def</span> <span class="nf">initialize_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;99.9&quot;</span><span class="p">)</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="p">)</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>    <span class="k">def</span> <span class="nf">update_mouse_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>        <span class="n">intensity</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>        <span class="n">mask_value</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>        <span class="n">pixel_count</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>  
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">:</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>                <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>                <span class="n">mask_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>                <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>                <span class="n">mask_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>        <span class="k">if</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>            <span class="n">pixel_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">mask_value</span><span class="p">)</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Intensity: </span><span class="si">{</span><span class="n">intensity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mask: </span><span class="si">{</span><span class="n">mask_value</span><span class="si">}</span><span class="s2">, Area: </span><span class="si">{</span><span class="n">pixel_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mask: </span><span class="si">{</span><span class="n">mask_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>        <span class="k">if</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area: </span><span class="si">{</span><span class="n">pixel_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Area: N/A&quot;</span><span class="p">)</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>    
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>    <span class="k">def</span> <span class="nf">setup_navigation_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>        <span class="n">navigation_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>        <span class="n">navigation_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>        <span class="n">prev_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Previous&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_image</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>        <span class="n">prev_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>        <span class="n">next_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_image</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>        <span class="n">next_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>        <span class="n">save_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_mask</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>        <span class="n">save_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Image: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Mask: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Area: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>    <span class="k">def</span> <span class="nf">setup_mode_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_draw_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_magic_wand_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Tolerance:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Max Pixels:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;1000&quot;</span><span class="p">)</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_erase_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_brush_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">)</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush Size:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_dividing_line_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>    <span class="k">def</span> <span class="nf">setup_function_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Fill&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Relabel&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relabel_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Clear&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">invert_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Invert&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">invert_mask</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">invert_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>        <span class="n">remove_small_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove Small&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_small_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>        <span class="n">remove_small_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Min Area:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>  <span class="c1"># Default minimum area</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>    <span class="k">def</span> <span class="nf">setup_zoom_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_zoom_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply Normalization&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_normalization</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Lower Percentile:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>        
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Upper Percentile:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>    
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>    <span class="k">def</span> <span class="nf">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>        <span class="c1"># Load the image</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Image shape: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, dtype: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>        <span class="c1"># Handle multi-channel or transparency issues</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>            <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># If the image has an alpha channel (RGBA)</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>                <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Remove the alpha channel</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>            <span class="c1"># Convert RGB to grayscale using weighted average</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2989</span><span class="p">,</span> <span class="mf">0.5870</span><span class="p">,</span> <span class="mf">0.1140</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converted to grayscale: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>        <span class="c1"># Ensure the shape is (height, width) without extra channel</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">:</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>            <span class="c1"># Scale the image to fit the 16-bit range (065535)</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">/</span> <span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">65535</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>            <span class="c1"># eventually remove this images should not have to be 16 bit look into downstream function (non 16bit images are jsut black)</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>        <span class="c1"># Load the corresponding mask</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>        <span class="n">mask_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masks_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">mask_path</span><span class="p">):</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading mask: </span><span class="si">{</span><span class="n">mask_path</span><span class="si">}</span><span class="s1"> for image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">mask_path</span><span class="p">)</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>            <span class="c1"># Ensure mask is uint8</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>            <span class="c1"># Create a new mask with the same size as the image</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded new mask for image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>        <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>    
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>    <span class="c1"># Image Display functions#</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>    <span class="k">def</span> <span class="nf">display_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        <span class="n">lower_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>        <span class="n">upper_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">99.9</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>        <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_mask_on_image</span><span class="p">(</span><span class="n">normalized</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;nw&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span><span class="p">)</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>    <span class="k">def</span> <span class="nf">display_zoomed_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span><span class="p">:</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>            <span class="c1"># Convert canvas coordinates to image coordinates</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span><span class="p">)</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span><span class="p">)</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>            <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="n">x0</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="n">y0</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="n">x1</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>            <span class="c1"># Normalize the entire image</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>            <span class="n">lower_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>            <span class="n">upper_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">99.9</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>            <span class="n">normalized_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>            <span class="c1"># Extract the zoomed portion of the normalized image and mask</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="n">normalized_image</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>            <span class="n">original_mask_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>            <span class="n">zoom_mask_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a>            <span class="k">if</span> <span class="n">original_mask_area</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span> <span class="o">=</span> <span class="n">original_mask_area</span><span class="o">/</span><span class="n">zoom_mask_area</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>            <span class="c1"># Resize the zoomed image and mask to fit the canvas</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>            <span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>            <span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>            
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">canvas_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">canvas_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>                <span class="c1">#self.zoom_mask = resize(self.zoom_mask, (canvas_height, canvas_width), preserve_range=True).astype(np.uint8)</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>                <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_mask_on_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">)</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;nw&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span><span class="p">)</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>    <span class="k">def</span> <span class="nf">overlay_mask_on_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">image</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>        <span class="n">max_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">max_label</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>        <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># background color</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>        <span class="n">colored_mask</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>        <span class="n">image_8bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">/</span> <span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>        <span class="c1"># Blend the mask and the image with transparency</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>        <span class="n">combined_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> 
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>                                  <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image_8bit</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">colored_mask</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> 
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>                                  <span class="n">image_8bit</span><span class="p">)</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>        <span class="c1"># Convert the final image back to uint8</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>        <span class="n">combined_image</span> <span class="o">=</span> <span class="n">combined_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>        <span class="k">return</span> <span class="n">combined_image</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>    
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>    <span class="c1"># Navigation functions#</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>    
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>    <span class="k">def</span> <span class="nf">previous_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>            
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>    <span class="k">def</span> <span class="nf">next_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>            
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>            
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>    <span class="k">def</span> <span class="nf">save_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">):</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>            <span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">original_size</span><span class="p">:</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>                <span class="n">resized_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">original_size</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>                <span class="n">resized_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>            <span class="n">resized_mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">resized_mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>            <span class="n">save_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_folder</span><span class="p">):</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_folder</span><span class="p">)</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>            <span class="n">image_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>            <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_folder</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">)</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving mask to: </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Debug print</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>            <span class="n">imageio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>    <span class="c1"># Zoom Functions #</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>    <span class="k">def</span> <span class="nf">set_zoom_rectangle_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>    
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>    <span class="k">def</span> <span class="nf">set_zoom_rectangle_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_zoomed_image</span><span class="p">()</span>  
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>  
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>  
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>    <span class="k">def</span> <span class="nf">update_zoom_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>            <span class="c1"># Assuming event.x and event.y are already in image coordinates</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>    
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>    <span class="c1"># Mode activation#</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>    
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>    <span class="k">def</span> <span class="nf">toggle_zoom_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom ON&quot;</span><span class="p">)</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_start</span><span class="p">)</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_end</span><span class="p">)</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_zoom_box</span><span class="p">)</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom&quot;</span><span class="p">)</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>    <span class="k">def</span> <span class="nf">toggle_brush_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span><span class="p">:</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush ON&quot;</span><span class="p">)</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_brush</span><span class="p">)</span>  <span class="c1"># Left click and drag to apply brush</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_brush</span><span class="p">)</span>  <span class="c1"># Right click and drag to erase with brush</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_brush_release</span><span class="p">)</span>  <span class="c1"># Left button release</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_brush_release</span><span class="p">)</span>  <span class="c1"># Right button release</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>    <span class="k">def</span> <span class="nf">image_to_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_image</span><span class="p">,</span> <span class="n">y_image</span><span class="p">):</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>        <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scaling_factors</span><span class="p">(</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a>        <span class="p">)</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>        <span class="n">x_canvas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_image</span> <span class="o">/</span> <span class="n">x_scale</span><span class="p">)</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a>        <span class="n">y_canvas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_image</span> <span class="o">/</span> <span class="n">y_scale</span><span class="p">)</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a>        <span class="k">return</span> <span class="n">x_canvas</span><span class="p">,</span> <span class="n">y_canvas</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a>    <span class="k">def</span> <span class="nf">toggle_dividing_line_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line ON&quot;</span><span class="p">)</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_dividing_line</span><span class="p">)</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">finish_dividing_line</span><span class="p">)</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dividing_line_preview</span><span class="p">)</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dividing Line Mode: OFF&quot;</span><span class="p">)</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>    <span class="k">def</span> <span class="nf">start_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>    <span class="k">def</span> <span class="nf">finish_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">]</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_dividing_line</span><span class="p">()</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span><span class="p">)</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>    <span class="k">def</span> <span class="nf">update_dividing_line_preview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">:</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>            <span class="n">canvas_coords</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_to_canvas</span><span class="p">(</span><span class="o">*</span><span class="n">pt</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">]</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>            <span class="n">flat_canvas_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">canvas_coords</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">pt</span><span class="p">]</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span><span class="p">,</span> <span class="o">*</span><span class="n">flat_canvas_coords</span><span class="p">)</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>    <span class="k">def</span> <span class="nf">apply_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">:</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>            <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>                <span class="n">line_rr</span><span class="p">,</span> <span class="n">line_cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>                <span class="n">rr</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_rr</span><span class="p">)</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a>                <span class="n">cc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_cc</span><span class="p">)</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a>            <span class="n">mask_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a>                <span class="c1"># Update the zoomed mask</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>                <span class="c1"># Reflect changes to the original mask</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a>                <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>                <span class="n">zoomed_mask_resized_back</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_mask_resized_back</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>                <span class="c1"># Directly update the original mask</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>                <span class="n">mask_copy</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask_copy</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>            <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>    <span class="k">def</span> <span class="nf">toggle_draw_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span><span class="p">:</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw ON&quot;</span><span class="p">)</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">)</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">finish_drawing</span><span class="p">)</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>            
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>    <span class="k">def</span> <span class="nf">toggle_magic_wand_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span><span class="p">:</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand ON&quot;</span><span class="p">)</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_magic_wand</span><span class="p">)</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_magic_wand</span><span class="p">)</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>            
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>    <span class="k">def</span> <span class="nf">toggle_erase_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span><span class="p">:</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase ON&quot;</span><span class="p">)</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_object</span><span class="p">)</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>    
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>    <span class="c1"># Mode functions#</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a>    
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a>    <span class="k">def</span> <span class="nf">apply_brush_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;brush_path&#39;</span><span class="p">):</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a>            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">brush_size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span><span class="p">:</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a>                <span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a>                <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_x</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a>                <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_y</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a>                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_x</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>                <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_y</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask_from_zoom</span><span class="p">()</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>    <span class="k">def</span> <span class="nf">erase_brush_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;erase_path&#39;</span><span class="p">):</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">brush_size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span><span class="p">:</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>                <span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>                <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_x</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>                <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_y</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_x</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>                <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_y</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>                    
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask_from_zoom</span><span class="p">()</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>        
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>    <span class="k">def</span> <span class="nf">apply_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>        <span class="n">brush_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;brush_path&#39;</span><span class="p">):</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">:</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a>            <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">last_y</span><span class="p">,</span> <span class="n">last_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a>            <span class="k">for</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">brush_size</span><span class="p">))</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">brush_size</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a>    <span class="k">def</span> <span class="nf">erase_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a>        <span class="n">brush_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;erase_path&#39;</span><span class="p">):</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">:</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a>            <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">last_y</span><span class="p">,</span> <span class="n">last_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>            <span class="k">for</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">brush_size</span><span class="p">))</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">brush_size</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>    <span class="k">def</span> <span class="nf">erase_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>            <span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>            <span class="n">zoomed_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvas_x</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">))</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>            <span class="n">zoomed_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvas_y</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">))</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>            <span class="n">orig_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoomed_x</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">)</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>            <span class="n">orig_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoomed_y</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">)</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>            <span class="k">if</span> <span class="n">orig_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">orig_y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">orig_x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">orig_y</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Point is out of bounds in the original image.&quot;</span><span class="p">)</span>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>                <span class="k">return</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>            <span class="n">orig_x</span><span class="p">,</span> <span class="n">orig_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>        <span class="n">label_to_remove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">orig_y</span><span class="p">,</span> <span class="n">orig_x</span><span class="p">]</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a>        <span class="k">if</span> <span class="n">label_to_remove</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">label_to_remove</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>            
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a>    <span class="k">def</span> <span class="nf">use_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>        <span class="n">tolerance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>        <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>        <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;add&#39;</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;erase&#39;</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_zoomed</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_normal</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>    
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>    <span class="k">def</span> <span class="nf">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">):</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">seed_point</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a>        <span class="n">initial_value</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a>        <span class="n">visited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>        <span class="n">added_pixels</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>        <span class="k">while</span> <span class="n">queue</span> <span class="ow">and</span> <span class="n">added_pixels</span> <span class="o">&lt;</span> <span class="n">maximum</span><span class="p">:</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>            <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]:</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>                <span class="k">continue</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>            <span class="n">visited</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>            <span class="n">current_value</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">current_value</span> <span class="o">-</span> <span class="n">initial_value</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>                <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a>                    <span class="n">added_pixels</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a>                <span class="n">mask</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>                <span class="k">if</span> <span class="n">added_pixels</span> <span class="o">&gt;=</span> <span class="n">maximum</span><span class="p">:</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>                    <span class="k">break</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>                <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]:</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>                    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dy</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>                    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nx</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ny</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">]:</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a>                        <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>        <span class="k">return</span> <span class="n">mask</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>    <span class="k">def</span> <span class="nf">magic_wand_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid maximum value; using default of 1000&quot;</span><span class="p">)</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1000</span> 
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>        
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>    <span class="k">def</span> <span class="nf">magic_wand_zoomed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Zoomed image or mask not initialized&quot;</span><span class="p">)</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>            <span class="k">return</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="n">maximum</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid maximum value; using default of 1000&quot;</span><span class="p">)</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>            
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>        <span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span> <span class="o">=</span> <span class="n">seed_point</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>        <span class="k">if</span> <span class="n">canvas_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">canvas_y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">canvas_x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">canvas_y</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected point is out of bounds in the zoomed image.&quot;</span><span class="p">)</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>            <span class="k">return</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>        
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a>        <span class="n">zoomed_mask_resized_back</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;erase&#39;</span><span class="p">:</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zoomed_mask_resized_back</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">])</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zoomed_mask_resized_back</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zoomed_mask_resized_back</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">])</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>                
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span><span class="p">:</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">:</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>                <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>            
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>    <span class="k">def</span> <span class="nf">draw_on_zoomed_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_coordinates</span><span class="p">):</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>        <span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>        <span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>        <span class="n">zoomed_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>        <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">zoomed_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>        <span class="n">zoomed_mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>        <span class="k">return</span> <span class="n">zoomed_mask</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>            
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>    <span class="k">def</span> <span class="nf">finish_drawing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>                <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>                <span class="n">zoomed_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_on_zoomed_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask</span><span class="p">(</span><span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>                <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">],</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_line</span><span class="p">)</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>            
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a>    <span class="k">def</span> <span class="nf">finish_drawing_if_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">finish_drawing</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>    <span class="c1"># Single function butons#</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>            
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>    <span class="k">def</span> <span class="nf">apply_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>    <span class="k">def</span> <span class="nf">fill_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>        <span class="n">binary_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a>        <span class="n">filled_mask</span> <span class="o">=</span> <span class="n">binary_fill_holes</span><span class="p">(</span><span class="n">binary_mask</span><span class="p">)</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">filled_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">filled_mask</span><span class="p">)</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>    <span class="k">def</span> <span class="nf">relabel_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>        
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>    <span class="k">def</span> <span class="nf">clear_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>    <span class="k">def</span> <span class="nf">invert_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_objects</span><span class="p">()</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>        
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a>    <span class="k">def</span> <span class="nf">remove_small_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a>            <span class="n">min_area</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid minimum area value; using default of 100&quot;</span><span class="p">)</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>            <span class="n">min_area</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># Skip background</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">labeled_mask</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_area</span><span class="p">:</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">labeled_mask</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Remove small objects</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a><span class="k">class</span> <span class="nc">AnnotateApp</span><span class="p">:</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">db_path</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">image_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">annotation_column</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid image size&quot;</span><span class="p">)</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a>        
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_annotation_columns</span> <span class="o">=</span> <span class="n">annotation_column</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="n">annotation_column</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span> <span class="o">=</span> <span class="n">image_type</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">channels</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span> <span class="o">=</span> <span class="n">percentiles</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="n">measurement</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span> <span class="o">=</span> <span class="n">normalize_channels</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.normalize_channels&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a>        
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">])</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">update_database_worker</span><span class="p">)</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a>        <span class="c1"># Set the initial window size and make it fit the screen size</span>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a>        <span class="c1"># Create the status label</span>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a>        <span class="c1"># Place the buttons at the bottom right</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;se&quot;</span><span class="p">)</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_page</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_page</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a>        
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Train &amp; Classify (beta)&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_and_classify</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span><span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a>        
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;orig.&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">swich_back_annotation_column</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span><span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a>        
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_settings_window</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a>        <span class="c1"># Calculate grid rows and columns based on the root window size and image size</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_dimensions</span><span class="p">()</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a>        <span class="c1"># Create a frame to hold the image grid</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos">2303</span></a>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos">2304</span></a>        <span class="c1"># Make the grid frame resize with the window</span>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos">2305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos">2306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos">2307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos">2308</span></a>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos">2309</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">):</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos">2310</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos">2311</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos">2312</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos">2313</span></a>            
</span><span id="L-2314"><a href="#L-2314"><span class="linenos">2314</span></a>    <span class="k">def</span> <span class="nf">open_settings_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos">2315</span></a>        <span class="kn">from</span> <span class="nn">.gui_utils</span> <span class="kn">import</span> <span class="n">generate_annotate_fields</span><span class="p">,</span> <span class="n">convert_to_number</span>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos">2316</span></a>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos">2317</span></a>        <span class="c1"># Create settings window</span>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos">2318</span></a>        <span class="n">settings_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos">2319</span></a>        <span class="n">settings_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Modify Annotation Settings&quot;</span><span class="p">)</span>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos">2320</span></a>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos">2321</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos">2322</span></a>        <span class="n">settings_window</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos">2323</span></a>        
</span><span id="L-2324"><a href="#L-2324"><span class="linenos">2324</span></a>        <span class="n">settings_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">settings_window</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos">2325</span></a>        <span class="n">settings_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos">2326</span></a>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos">2327</span></a>        <span class="c1"># Generate fields with current settings pre-filled</span>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos">2328</span></a>        <span class="n">vars_dict</span> <span class="o">=</span> <span class="n">generate_annotate_fields</span><span class="p">(</span><span class="n">settings_frame</span><span class="p">)</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos">2329</span></a>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos">2330</span></a>        <span class="c1"># Pre-fill the current settings into vars_dict</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos">2331</span></a>        <span class="n">current_settings</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos">2332</span></a>            <span class="s1">&#39;image_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos">2333</span></a>            <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos">2334</span></a>            <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos">2335</span></a>            <span class="s1">&#39;annotation_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos">2336</span></a>            <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">),</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos">2337</span></a>            <span class="s1">&#39;percentiles&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span><span class="p">)),</span>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos">2338</span></a>            <span class="s1">&#39;measurement&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos">2339</span></a>            <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos">2340</span></a>            <span class="s1">&#39;normalize_channels&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos">2341</span></a>        <span class="p">}</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos">2342</span></a>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos">2343</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">vars_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos">2344</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">current_settings</span><span class="p">:</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos">2345</span></a>                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos">2346</span></a>                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">current_settings</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos">2347</span></a>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos">2348</span></a>        <span class="k">def</span> <span class="nf">apply_new_settings</span><span class="p">():</span>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos">2349</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">vars_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos">2350</span></a>            
</span><span id="L-2351"><a href="#L-2351"><span class="linenos">2351</span></a>            <span class="c1"># Process settings exactly as your original initiation function does</span>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos">2352</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos">2353</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos">2354</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">convert_to_number</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos">2355</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos">2356</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos">2357</span></a>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos">2358</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos">2359</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos">2360</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">])</span>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos">2361</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos">2362</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2363"><a href="#L-2363"><span class="linenos">2363</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2364"><a href="#L-2364"><span class="linenos">2364</span></a>
</span><span id="L-2365"><a href="#L-2365"><span class="linenos">2365</span></a>            <span class="c1"># Convert empty strings to None</span>
</span><span id="L-2366"><a href="#L-2366"><span class="linenos">2366</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-2367"><a href="#L-2367"><span class="linenos">2367</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2368"><a href="#L-2368"><span class="linenos">2368</span></a>                    <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
</span><span id="L-2369"><a href="#L-2369"><span class="linenos">2369</span></a>                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-2370"><a href="#L-2370"><span class="linenos">2370</span></a>                    <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2371"><a href="#L-2371"><span class="linenos">2371</span></a>
</span><span id="L-2372"><a href="#L-2372"><span class="linenos">2372</span></a>            <span class="c1"># Apply these settings dynamically using update_settings method</span>
</span><span id="L-2373"><a href="#L-2373"><span class="linenos">2373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
</span><span id="L-2374"><a href="#L-2374"><span class="linenos">2374</span></a>                <span class="s1">&#39;image_type&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;image_type&#39;</span><span class="p">),</span>
</span><span id="L-2375"><a href="#L-2375"><span class="linenos">2375</span></a>                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channels&#39;</span><span class="p">),</span>
</span><span id="L-2376"><a href="#L-2376"><span class="linenos">2376</span></a>                <span class="s1">&#39;image_size&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;img_size&#39;</span><span class="p">),</span>
</span><span id="L-2377"><a href="#L-2377"><span class="linenos">2377</span></a>                <span class="s1">&#39;annotation_column&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;annotation_column&#39;</span><span class="p">),</span>
</span><span id="L-2378"><a href="#L-2378"><span class="linenos">2378</span></a>                <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalize&#39;</span><span class="p">),</span>
</span><span id="L-2379"><a href="#L-2379"><span class="linenos">2379</span></a>                <span class="s1">&#39;percentiles&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;percentiles&#39;</span><span class="p">),</span>
</span><span id="L-2380"><a href="#L-2380"><span class="linenos">2380</span></a>                <span class="s1">&#39;measurement&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;measurement&#39;</span><span class="p">),</span>
</span><span id="L-2381"><a href="#L-2381"><span class="linenos">2381</span></a>                <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">),</span>
</span><span id="L-2382"><a href="#L-2382"><span class="linenos">2382</span></a>                <span class="s1">&#39;normalize_channels&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">)</span>
</span><span id="L-2383"><a href="#L-2383"><span class="linenos">2383</span></a>            <span class="p">})</span>
</span><span id="L-2384"><a href="#L-2384"><span class="linenos">2384</span></a>
</span><span id="L-2385"><a href="#L-2385"><span class="linenos">2385</span></a>            <span class="n">settings_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-2386"><a href="#L-2386"><span class="linenos">2386</span></a>
</span><span id="L-2387"><a href="#L-2387"><span class="linenos">2387</span></a>        <span class="n">apply_button</span> <span class="o">=</span> <span class="n">spacrButton</span><span class="p">(</span><span class="n">settings_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply Settings&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">apply_new_settings</span><span class="p">,</span><span class="n">show_text</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2388"><a href="#L-2388"><span class="linenos">2388</span></a>        <span class="n">apply_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-2389"><a href="#L-2389"><span class="linenos">2389</span></a>        
</span><span id="L-2390"><a href="#L-2390"><span class="linenos">2390</span></a>    <span class="k">def</span> <span class="nf">update_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2391"><a href="#L-2391"><span class="linenos">2391</span></a>        <span class="n">allowed_attributes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-2392"><a href="#L-2392"><span class="linenos">2392</span></a>            <span class="s1">&#39;image_type&#39;</span><span class="p">,</span> <span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="s1">&#39;image_size&#39;</span><span class="p">,</span> <span class="s1">&#39;annotation_column&#39;</span><span class="p">,</span>
</span><span id="L-2393"><a href="#L-2393"><span class="linenos">2393</span></a>            <span class="s1">&#39;normalize&#39;</span><span class="p">,</span> <span class="s1">&#39;percentiles&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;normalize_channels&#39;</span>
</span><span id="L-2394"><a href="#L-2394"><span class="linenos">2394</span></a>        <span class="p">}</span>
</span><span id="L-2395"><a href="#L-2395"><span class="linenos">2395</span></a>
</span><span id="L-2396"><a href="#L-2396"><span class="linenos">2396</span></a>        <span class="n">updated</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-2397"><a href="#L-2397"><span class="linenos">2397</span></a>
</span><span id="L-2398"><a href="#L-2398"><span class="linenos">2398</span></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-2399"><a href="#L-2399"><span class="linenos">2399</span></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">allowed_attributes</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2400"><a href="#L-2400"><span class="linenos">2400</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-2401"><a href="#L-2401"><span class="linenos">2401</span></a>                <span class="n">updated</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-2402"><a href="#L-2402"><span class="linenos">2402</span></a>
</span><span id="L-2403"><a href="#L-2403"><span class="linenos">2403</span></a>        <span class="k">if</span> <span class="s1">&#39;image_size&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-2404"><a href="#L-2404"><span class="linenos">2404</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2405"><a href="#L-2405"><span class="linenos">2405</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="L-2406"><a href="#L-2406"><span class="linenos">2406</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-2407"><a href="#L-2407"><span class="linenos">2407</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">)</span>
</span><span id="L-2408"><a href="#L-2408"><span class="linenos">2408</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2409"><a href="#L-2409"><span class="linenos">2409</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid image size&quot;</span><span class="p">)</span>
</span><span id="L-2410"><a href="#L-2410"><span class="linenos">2410</span></a>
</span><span id="L-2411"><a href="#L-2411"><span class="linenos">2411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_dimensions</span><span class="p">()</span>
</span><span id="L-2412"><a href="#L-2412"><span class="linenos">2412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recreate_image_grid</span><span class="p">()</span>
</span><span id="L-2413"><a href="#L-2413"><span class="linenos">2413</span></a>
</span><span id="L-2414"><a href="#L-2414"><span class="linenos">2414</span></a>        <span class="k">if</span> <span class="n">updated</span><span class="p">:</span>
</span><span id="L-2415"><a href="#L-2415"><span class="linenos">2415</span></a>            <span class="n">current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># Retain current index</span>
</span><span id="L-2416"><a href="#L-2416"><span class="linenos">2416</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="L-2417"><a href="#L-2417"><span class="linenos">2417</span></a>
</span><span id="L-2418"><a href="#L-2418"><span class="linenos">2418</span></a>            <span class="c1"># Ensure the retained index is still valid (not out of bounds)</span>
</span><span id="L-2419"><a href="#L-2419"><span class="linenos">2419</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-2420"><a href="#L-2420"><span class="linenos">2420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_index</span><span class="p">,</span> <span class="n">max_index</span> <span class="o">:=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="mi">0</span><span class="p">))))</span>
</span><span id="L-2421"><a href="#L-2421"><span class="linenos">2421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span><span id="L-2422"><a href="#L-2422"><span class="linenos">2422</span></a>
</span><span id="L-2423"><a href="#L-2423"><span class="linenos">2423</span></a>    <span class="k">def</span> <span class="nf">recreate_image_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2424"><a href="#L-2424"><span class="linenos">2424</span></a>        <span class="c1"># Remove current labels</span>
</span><span id="L-2425"><a href="#L-2425"><span class="linenos">2425</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
</span><span id="L-2426"><a href="#L-2426"><span class="linenos">2426</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-2427"><a href="#L-2427"><span class="linenos">2427</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-2428"><a href="#L-2428"><span class="linenos">2428</span></a>
</span><span id="L-2429"><a href="#L-2429"><span class="linenos">2429</span></a>        <span class="c1"># Recreate the labels grid with updated dimensions</span>
</span><span id="L-2430"><a href="#L-2430"><span class="linenos">2430</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="L-2431"><a href="#L-2431"><span class="linenos">2431</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="L-2432"><a href="#L-2432"><span class="linenos">2432</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="L-2433"><a href="#L-2433"><span class="linenos">2433</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-2434"><a href="#L-2434"><span class="linenos">2434</span></a>
</span><span id="L-2435"><a href="#L-2435"><span class="linenos">2435</span></a>        <span class="c1"># Reconfigure grid weights</span>
</span><span id="L-2436"><a href="#L-2436"><span class="linenos">2436</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">):</span>
</span><span id="L-2437"><a href="#L-2437"><span class="linenos">2437</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2438"><a href="#L-2438"><span class="linenos">2438</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="L-2439"><a href="#L-2439"><span class="linenos">2439</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2440"><a href="#L-2440"><span class="linenos">2440</span></a>
</span><span id="L-2441"><a href="#L-2441"><span class="linenos">2441</span></a>            
</span><span id="L-2442"><a href="#L-2442"><span class="linenos">2442</span></a>    <span class="k">def</span> <span class="nf">swich_back_annotation_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2443"><a href="#L-2443"><span class="linenos">2443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_annotation_columns</span>
</span><span id="L-2444"><a href="#L-2444"><span class="linenos">2444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="L-2445"><a href="#L-2445"><span class="linenos">2445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="L-2446"><a href="#L-2446"><span class="linenos">2446</span></a>            
</span><span id="L-2447"><a href="#L-2447"><span class="linenos">2447</span></a>    <span class="k">def</span> <span class="nf">calculate_grid_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2448"><a href="#L-2448"><span class="linenos">2448</span></a>        <span class="n">window_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="L-2449"><a href="#L-2449"><span class="linenos">2449</span></a>        <span class="n">window_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="L-2450"><a href="#L-2450"><span class="linenos">2450</span></a>
</span><span id="L-2451"><a href="#L-2451"><span class="linenos">2451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span> <span class="o">=</span> <span class="n">window_width</span> <span class="o">//</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="L-2452"><a href="#L-2452"><span class="linenos">2452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">window_height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="L-2453"><a href="#L-2453"><span class="linenos">2453</span></a>
</span><span id="L-2454"><a href="#L-2454"><span class="linenos">2454</span></a>        <span class="c1"># Update to make sure grid_rows and grid_cols are at least 1</span>
</span><span id="L-2455"><a href="#L-2455"><span class="linenos">2455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">)</span>
</span><span id="L-2456"><a href="#L-2456"><span class="linenos">2456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">)</span>
</span><span id="L-2457"><a href="#L-2457"><span class="linenos">2457</span></a>
</span><span id="L-2458"><a href="#L-2458"><span class="linenos">2458</span></a>    <span class="k">def</span> <span class="nf">prefilter_paths_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2459"><a href="#L-2459"><span class="linenos">2459</span></a>        <span class="kn">from</span> <span class="nn">.io</span> <span class="kn">import</span> <span class="n">_read_and_join_tables</span><span class="p">,</span> <span class="n">_read_db</span>
</span><span id="L-2460"><a href="#L-2460"><span class="linenos">2460</span></a>        <span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">is_list_of_lists</span>
</span><span id="L-2461"><a href="#L-2461"><span class="linenos">2461</span></a>
</span><span id="L-2462"><a href="#L-2462"><span class="linenos">2462</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2463"><a href="#L-2463"><span class="linenos">2463</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">_read_and_join_tables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="L-2464"><a href="#L-2464"><span class="linenos">2464</span></a>            <span class="n">png_list_df</span> <span class="o">=</span> <span class="n">_read_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png_list&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2465"><a href="#L-2465"><span class="linenos">2465</span></a>            <span class="n">png_list_df</span> <span class="o">=</span> <span class="n">png_list_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;prcfo&#39;</span><span class="p">)</span>
</span><span id="L-2466"><a href="#L-2466"><span class="linenos">2466</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">png_list_df</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2467"><a href="#L-2467"><span class="linenos">2467</span></a>            <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2468"><a href="#L-2468"><span class="linenos">2468</span></a>            <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2469"><a href="#L-2469"><span class="linenos">2469</span></a>
</span><span id="L-2470"><a href="#L-2470"><span class="linenos">2470</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-2471"><a href="#L-2471"><span class="linenos">2471</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2472"><a href="#L-2472"><span class="linenos">2472</span></a>                    <span class="n">mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2473"><a href="#L-2473"><span class="linenos">2473</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-2474"><a href="#L-2474"><span class="linenos">2474</span></a>                    <span class="n">mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span>
</span><span id="L-2475"><a href="#L-2475"><span class="linenos">2475</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mes</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="L-2476"><a href="#L-2476"><span class="linenos">2476</span></a>
</span><span id="L-2477"><a href="#L-2477"><span class="linenos">2477</span></a>            <span class="k">if</span> <span class="n">is_list_of_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="L-2478"><a href="#L-2478"><span class="linenos">2478</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_list_of_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
</span><span id="L-2479"><a href="#L-2479"><span class="linenos">2479</span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
</span><span id="L-2480"><a href="#L-2480"><span class="linenos">2480</span></a>                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="L-2481"><a href="#L-2481"><span class="linenos">2481</span></a>                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span>
</span><span id="L-2482"><a href="#L-2482"><span class="linenos">2482</span></a>                        <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2483"><a href="#L-2483"><span class="linenos">2483</span></a>                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
</span><span id="L-2484"><a href="#L-2484"><span class="linenos">2484</span></a>                        <span class="n">th_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2485"><a href="#L-2485"><span class="linenos">2485</span></a>                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="L-2486"><a href="#L-2486"><span class="linenos">2486</span></a>                            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2487"><a href="#L-2487"><span class="linenos">2487</span></a>                                <span class="n">th_idx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-2488"><a href="#L-2488"><span class="linenos">2488</span></a>                                <span class="n">thd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="L-2489"><a href="#L-2489"><span class="linenos">2489</span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thd</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2490"><a href="#L-2490"><span class="linenos">2490</span></a>                                    <span class="n">thd</span> <span class="o">=</span> <span class="n">thd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2491"><a href="#L-2491"><span class="linenos">2491</span></a>                                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-2492"><a href="#L-2492"><span class="linenos">2492</span></a>                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2493"><a href="#L-2493"><span class="linenos">2493</span></a>                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2494"><a href="#L-2494"><span class="linenos">2494</span></a>                                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thd</span><span class="p">]</span>
</span><span id="L-2495"><a href="#L-2495"><span class="linenos">2495</span></a>                        <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2496"><a href="#L-2496"><span class="linenos">2496</span></a>            
</span><span id="L-2497"><a href="#L-2497"><span class="linenos">2497</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2498"><a href="#L-2498"><span class="linenos">2498</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-2499"><a href="#L-2499"><span class="linenos">2499</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2500"><a href="#L-2500"><span class="linenos">2500</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2501"><a href="#L-2501"><span class="linenos">2501</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="L-2502"><a href="#L-2502"><span class="linenos">2502</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2503"><a href="#L-2503"><span class="linenos">2503</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="s1">&#39;threshold_measurement&#39;</span>
</span><span id="L-2504"><a href="#L-2504"><span class="linenos">2504</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2505"><a href="#L-2505"><span class="linenos">2505</span></a>            
</span><span id="L-2506"><a href="#L-2506"><span class="linenos">2506</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2507"><a href="#L-2507"><span class="linenos">2507</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2508"><a href="#L-2508"><span class="linenos">2508</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2509"><a href="#L-2509"><span class="linenos">2509</span></a>                <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2510"><a href="#L-2510"><span class="linenos">2510</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-2511"><a href="#L-2511"><span class="linenos">2511</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q1&#39;</span><span class="p">:</span>
</span><span id="L-2512"><a href="#L-2512"><span class="linenos">2512</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="L-2513"><a href="#L-2513"><span class="linenos">2513</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q2&#39;</span><span class="p">:</span>
</span><span id="L-2514"><a href="#L-2514"><span class="linenos">2514</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="L-2515"><a href="#L-2515"><span class="linenos">2515</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q3&#39;</span><span class="p">:</span>
</span><span id="L-2516"><a href="#L-2516"><span class="linenos">2516</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="L-2517"><a href="#L-2517"><span class="linenos">2517</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q4&#39;</span><span class="p">:</span>
</span><span id="L-2518"><a href="#L-2518"><span class="linenos">2518</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-2519"><a href="#L-2519"><span class="linenos">2519</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q5&#39;</span><span class="p">:</span>
</span><span id="L-2520"><a href="#L-2520"><span class="linenos">2520</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-2521"><a href="#L-2521"><span class="linenos">2521</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q6&#39;</span><span class="p">:</span>
</span><span id="L-2522"><a href="#L-2522"><span class="linenos">2522</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-2523"><a href="#L-2523"><span class="linenos">2523</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q7&#39;</span><span class="p">:</span>
</span><span id="L-2524"><a href="#L-2524"><span class="linenos">2524</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="L-2525"><a href="#L-2525"><span class="linenos">2525</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q8&#39;</span><span class="p">:</span>
</span><span id="L-2526"><a href="#L-2526"><span class="linenos">2526</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-2527"><a href="#L-2527"><span class="linenos">2527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q9&#39;</span><span class="p">:</span>
</span><span id="L-2528"><a href="#L-2528"><span class="linenos">2528</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
</span><span id="L-2529"><a href="#L-2529"><span class="linenos">2529</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;threshold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2530"><a href="#L-2530"><span class="linenos">2530</span></a>
</span><span id="L-2531"><a href="#L-2531"><span class="linenos">2531</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="L-2532"><a href="#L-2532"><span class="linenos">2532</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2533"><a href="#L-2533"><span class="linenos">2533</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2534"><a href="#L-2534"><span class="linenos">2534</span></a>
</span><span id="L-2535"><a href="#L-2535"><span class="linenos">2535</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">])</span>
</span><span id="L-2536"><a href="#L-2536"><span class="linenos">2536</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="L-2537"><a href="#L-2537"><span class="linenos">2537</span></a>                <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2538"><a href="#L-2538"><span class="linenos">2538</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-2539"><a href="#L-2539"><span class="linenos">2539</span></a>                    <span class="k">for</span> <span class="n">tpe</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="L-2540"><a href="#L-2540"><span class="linenos">2540</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">tpe</span><span class="p">)]</span>
</span><span id="L-2541"><a href="#L-2541"><span class="linenos">2541</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2542"><a href="#L-2542"><span class="linenos">2542</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">)]</span>
</span><span id="L-2543"><a href="#L-2543"><span class="linenos">2543</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-2544"><a href="#L-2544"><span class="linenos">2544</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;image_type: Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2545"><a href="#L-2545"><span class="linenos">2545</span></a>
</span><span id="L-2546"><a href="#L-2546"><span class="linenos">2546</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;png_path&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-2547"><a href="#L-2547"><span class="linenos">2547</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2548"><a href="#L-2548"><span class="linenos">2548</span></a>            <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="L-2549"><a href="#L-2549"><span class="linenos">2549</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="L-2550"><a href="#L-2550"><span class="linenos">2550</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="L-2551"><a href="#L-2551"><span class="linenos">2551</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list WHERE png_path LIKE ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,))</span>
</span><span id="L-2552"><a href="#L-2552"><span class="linenos">2552</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2553"><a href="#L-2553"><span class="linenos">2553</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list&quot;</span><span class="p">)</span>
</span><span id="L-2554"><a href="#L-2554"><span class="linenos">2554</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="L-2555"><a href="#L-2555"><span class="linenos">2555</span></a>            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2556"><a href="#L-2556"><span class="linenos">2556</span></a>
</span><span id="L-2557"><a href="#L-2557"><span class="linenos">2557</span></a>    <span class="k">def</span> <span class="nf">load_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2558"><a href="#L-2558"><span class="linenos">2558</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
</span><span id="L-2559"><a href="#L-2559"><span class="linenos">2559</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-2560"><a href="#L-2560"><span class="linenos">2560</span></a>
</span><span id="L-2561"><a href="#L-2561"><span class="linenos">2561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2562"><a href="#L-2562"><span class="linenos">2562</span></a>        <span class="n">paths_annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">]</span>
</span><span id="L-2563"><a href="#L-2563"><span class="linenos">2563</span></a>
</span><span id="L-2564"><a href="#L-2564"><span class="linenos">2564</span></a>        <span class="n">adjusted_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2565"><a href="#L-2565"><span class="linenos">2565</span></a>        <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">paths_annotations</span><span class="p">:</span>
</span><span id="L-2566"><a href="#L-2566"><span class="linenos">2566</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">):</span>
</span><span id="L-2567"><a href="#L-2567"><span class="linenos">2567</span></a>                <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/data/&#39;</span><span class="p">)</span>
</span><span id="L-2568"><a href="#L-2568"><span class="linenos">2568</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-2569"><a href="#L-2569"><span class="linenos">2569</span></a>                    <span class="n">new_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2570"><a href="#L-2570"><span class="linenos">2570</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span><span class="p">[</span><span class="n">new_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="L-2571"><a href="#L-2571"><span class="linenos">2571</span></a>                    <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">new_path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="L-2572"><a href="#L-2572"><span class="linenos">2572</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2573"><a href="#L-2573"><span class="linenos">2573</span></a>                    <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="L-2574"><a href="#L-2574"><span class="linenos">2574</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2575"><a href="#L-2575"><span class="linenos">2575</span></a>                <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="L-2576"><a href="#L-2576"><span class="linenos">2576</span></a>
</span><span id="L-2577"><a href="#L-2577"><span class="linenos">2577</span></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="L-2578"><a href="#L-2578"><span class="linenos">2578</span></a>            <span class="n">loaded_images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_single_image</span><span class="p">,</span> <span class="n">adjusted_paths</span><span class="p">))</span>
</span><span id="L-2579"><a href="#L-2579"><span class="linenos">2579</span></a>
</span><span id="L-2580"><a href="#L-2580"><span class="linenos">2580</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">annotation</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loaded_images</span><span class="p">):</span>
</span><span id="L-2581"><a href="#L-2581"><span class="linenos">2581</span></a>            <span class="k">if</span> <span class="n">annotation</span><span class="p">:</span>
</span><span id="L-2582"><a href="#L-2582"><span class="linenos">2582</span></a>                <span class="n">border_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="n">annotation</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
</span><span id="L-2583"><a href="#L-2583"><span class="linenos">2583</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_colored_border</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">border_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="L-2584"><a href="#L-2584"><span class="linenos">2584</span></a>
</span><span id="L-2585"><a href="#L-2585"><span class="linenos">2585</span></a>            <span class="n">photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-2586"><a href="#L-2586"><span class="linenos">2586</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-2587"><a href="#L-2587"><span class="linenos">2587</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">photo</span>
</span><span id="L-2588"><a href="#L-2588"><span class="linenos">2588</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">photo</span><span class="p">)</span>
</span><span id="L-2589"><a href="#L-2589"><span class="linenos">2589</span></a>
</span><span id="L-2590"><a href="#L-2590"><span class="linenos">2590</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">adjusted_paths</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2591"><a href="#L-2591"><span class="linenos">2591</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Button-1&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_on_image_click</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span>
</span><span id="L-2592"><a href="#L-2592"><span class="linenos">2592</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Button-3&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_on_image_click</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span>
</span><span id="L-2593"><a href="#L-2593"><span class="linenos">2593</span></a>
</span><span id="L-2594"><a href="#L-2594"><span class="linenos">2594</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="L-2595"><a href="#L-2595"><span class="linenos">2595</span></a>
</span><span id="L-2596"><a href="#L-2596"><span class="linenos">2596</span></a>    <span class="k">def</span> <span class="nf">load_single_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_annotation_tuple</span><span class="p">):</span>
</span><span id="L-2597"><a href="#L-2597"><span class="linenos">2597</span></a>        <span class="n">path</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="n">path_annotation_tuple</span>
</span><span id="L-2598"><a href="#L-2598"><span class="linenos">2598</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-2599"><a href="#L-2599"><span class="linenos">2599</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span>
</span><span id="L-2600"><a href="#L-2600"><span class="linenos">2600</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
</span><span id="L-2601"><a href="#L-2601"><span class="linenos">2601</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_channels</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-2602"><a href="#L-2602"><span class="linenos">2602</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">)</span>
</span><span id="L-2603"><a href="#L-2603"><span class="linenos">2603</span></a>        <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">annotation</span>
</span><span id="L-2604"><a href="#L-2604"><span class="linenos">2604</span></a>    
</span><span id="L-2605"><a href="#L-2605"><span class="linenos">2605</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-2606"><a href="#L-2606"><span class="linenos">2606</span></a>    <span class="k">def</span> <span class="nf">normalize_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span> <span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-2607"><a href="#L-2607"><span class="linenos">2607</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2608"><a href="#L-2608"><span class="linenos">2608</span></a><span class="sd">        Normalize an image based on specific channels (R, G, B).</span>
</span><span id="L-2609"><a href="#L-2609"><span class="linenos">2609</span></a>
</span><span id="L-2610"><a href="#L-2610"><span class="linenos">2610</span></a><span class="sd">        Args:</span>
</span><span id="L-2611"><a href="#L-2611"><span class="linenos">2611</span></a><span class="sd">            img (PIL.Image or np.array): Input image.</span>
</span><span id="L-2612"><a href="#L-2612"><span class="linenos">2612</span></a><span class="sd">            normalize (bool): Whether to normalize the image or not.</span>
</span><span id="L-2613"><a href="#L-2613"><span class="linenos">2613</span></a><span class="sd">            percentiles (tuple): Percentiles to use for intensity rescaling.</span>
</span><span id="L-2614"><a href="#L-2614"><span class="linenos">2614</span></a><span class="sd">            normalize_channels (list): List of channels to normalize. E.g., [&#39;r&#39;, &#39;g&#39;, &#39;b&#39;], [&#39;r&#39;], [&#39;g&#39;], etc.</span>
</span><span id="L-2615"><a href="#L-2615"><span class="linenos">2615</span></a>
</span><span id="L-2616"><a href="#L-2616"><span class="linenos">2616</span></a><span class="sd">        Returns:</span>
</span><span id="L-2617"><a href="#L-2617"><span class="linenos">2617</span></a><span class="sd">            PIL.Image: Normalized image.</span>
</span><span id="L-2618"><a href="#L-2618"><span class="linenos">2618</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2619"><a href="#L-2619"><span class="linenos">2619</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-2620"><a href="#L-2620"><span class="linenos">2620</span></a>
</span><span id="L-2621"><a href="#L-2621"><span class="linenos">2621</span></a>        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
</span><span id="L-2622"><a href="#L-2622"><span class="linenos">2622</span></a>            <span class="k">if</span> <span class="n">img_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Grayscale image</span>
</span><span id="L-2623"><a href="#L-2623"><span class="linenos">2623</span></a>                <span class="n">p2</span><span class="p">,</span> <span class="n">p98</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">)</span>
</span><span id="L-2624"><a href="#L-2624"><span class="linenos">2624</span></a>                <span class="n">img_array</span> <span class="o">=</span> <span class="n">rescale_intensity</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">in_range</span><span class="o">=</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p98</span><span class="p">),</span> <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="L-2625"><a href="#L-2625"><span class="linenos">2625</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Color image or multi-channel image</span>
</span><span id="L-2626"><a href="#L-2626"><span class="linenos">2626</span></a>                <span class="c1"># Create a map for the color channels</span>
</span><span id="L-2627"><a href="#L-2627"><span class="linenos">2627</span></a>                <span class="n">channel_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span><span id="L-2628"><a href="#L-2628"><span class="linenos">2628</span></a>                
</span><span id="L-2629"><a href="#L-2629"><span class="linenos">2629</span></a>                <span class="c1"># If normalize_channels is not specified, normalize all channels</span>
</span><span id="L-2630"><a href="#L-2630"><span class="linenos">2630</span></a>                <span class="k">if</span> <span class="n">normalize_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2631"><a href="#L-2631"><span class="linenos">2631</span></a>                    <span class="n">normalize_channels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
</span><span id="L-2632"><a href="#L-2632"><span class="linenos">2632</span></a>                
</span><span id="L-2633"><a href="#L-2633"><span class="linenos">2633</span></a>                <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">normalize_channels</span><span class="p">:</span>
</span><span id="L-2634"><a href="#L-2634"><span class="linenos">2634</span></a>                    <span class="k">if</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channel_map</span><span class="p">:</span>
</span><span id="L-2635"><a href="#L-2635"><span class="linenos">2635</span></a>                        <span class="n">channel_idx</span> <span class="o">=</span> <span class="n">channel_map</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
</span><span id="L-2636"><a href="#L-2636"><span class="linenos">2636</span></a>                        <span class="n">p2</span><span class="p">,</span> <span class="n">p98</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">],</span> <span class="n">percentiles</span><span class="p">)</span>
</span><span id="L-2637"><a href="#L-2637"><span class="linenos">2637</span></a>                        <span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rescale_intensity</span><span class="p">(</span><span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">],</span> <span class="n">in_range</span><span class="o">=</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p98</span><span class="p">),</span> <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="L-2638"><a href="#L-2638"><span class="linenos">2638</span></a>
</span><span id="L-2639"><a href="#L-2639"><span class="linenos">2639</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
</span><span id="L-2640"><a href="#L-2640"><span class="linenos">2640</span></a>
</span><span id="L-2641"><a href="#L-2641"><span class="linenos">2641</span></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img_array</span><span class="p">)</span>
</span><span id="L-2642"><a href="#L-2642"><span class="linenos">2642</span></a>
</span><span id="L-2643"><a href="#L-2643"><span class="linenos">2643</span></a>    
</span><span id="L-2644"><a href="#L-2644"><span class="linenos">2644</span></a>    <span class="k">def</span> <span class="nf">add_colored_border</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">border_color</span><span class="p">):</span>
</span><span id="L-2645"><a href="#L-2645"><span class="linenos">2645</span></a>        <span class="n">top_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="L-2646"><a href="#L-2646"><span class="linenos">2646</span></a>        <span class="n">bottom_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="L-2647"><a href="#L-2647"><span class="linenos">2647</span></a>        <span class="n">left_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="L-2648"><a href="#L-2648"><span class="linenos">2648</span></a>        <span class="n">right_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="L-2649"><a href="#L-2649"><span class="linenos">2649</span></a>
</span><span id="L-2650"><a href="#L-2650"><span class="linenos">2650</span></a>        <span class="n">bordered_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2651"><a href="#L-2651"><span class="linenos">2651</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">top_border</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-2652"><a href="#L-2652"><span class="linenos">2652</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">bottom_border</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="L-2653"><a href="#L-2653"><span class="linenos">2653</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">left_border</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="L-2654"><a href="#L-2654"><span class="linenos">2654</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">right_border</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="L-2655"><a href="#L-2655"><span class="linenos">2655</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="L-2656"><a href="#L-2656"><span class="linenos">2656</span></a>
</span><span id="L-2657"><a href="#L-2657"><span class="linenos">2657</span></a>        <span class="k">return</span> <span class="n">bordered_img</span>
</span><span id="L-2658"><a href="#L-2658"><span class="linenos">2658</span></a>    
</span><span id="L-2659"><a href="#L-2659"><span class="linenos">2659</span></a>    <span class="k">def</span> <span class="nf">filter_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
</span><span id="L-2660"><a href="#L-2660"><span class="linenos">2660</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-2661"><a href="#L-2661"><span class="linenos">2661</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="L-2662"><a href="#L-2662"><span class="linenos">2662</span></a>            <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="L-2663"><a href="#L-2663"><span class="linenos">2663</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-2664"><a href="#L-2664"><span class="linenos">2664</span></a>            <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="L-2665"><a href="#L-2665"><span class="linenos">2665</span></a>                <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-2666"><a href="#L-2666"><span class="linenos">2666</span></a>            <span class="k">if</span> <span class="s1">&#39;b&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="L-2667"><a href="#L-2667"><span class="linenos">2667</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-2668"><a href="#L-2668"><span class="linenos">2668</span></a>
</span><span id="L-2669"><a href="#L-2669"><span class="linenos">2669</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-2670"><a href="#L-2670"><span class="linenos">2670</span></a>                <span class="n">channel_img</span> <span class="o">=</span> <span class="n">r</span> <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="p">(</span><span class="n">g</span> <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="n">b</span><span class="p">)</span>
</span><span id="L-2671"><a href="#L-2671"><span class="linenos">2671</span></a>                <span class="k">return</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">grayscale</span><span class="p">(</span><span class="n">channel_img</span><span class="p">)</span>
</span><span id="L-2672"><a href="#L-2672"><span class="linenos">2672</span></a>
</span><span id="L-2673"><a href="#L-2673"><span class="linenos">2673</span></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-2674"><a href="#L-2674"><span class="linenos">2674</span></a>
</span><span id="L-2675"><a href="#L-2675"><span class="linenos">2675</span></a>    <span class="k">def</span> <span class="nf">get_on_image_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
</span><span id="L-2676"><a href="#L-2676"><span class="linenos">2676</span></a>        <span class="k">def</span> <span class="nf">on_image_click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="L-2677"><a href="#L-2677"><span class="linenos">2677</span></a>            <span class="n">new_annotation</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-2678"><a href="#L-2678"><span class="linenos">2678</span></a>            
</span><span id="L-2679"><a href="#L-2679"><span class="linenos">2679</span></a>            <span class="n">original_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="L-2680"><a href="#L-2680"><span class="linenos">2680</span></a>            
</span><span id="L-2681"><a href="#L-2681"><span class="linenos">2681</span></a>            <span class="k">if</span> <span class="n">original_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_annotation</span><span class="p">:</span>
</span><span id="L-2682"><a href="#L-2682"><span class="linenos">2682</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2683"><a href="#L-2683"><span class="linenos">2683</span></a>                <span class="n">new_annotation</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2684"><a href="#L-2684"><span class="linenos">2684</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2685"><a href="#L-2685"><span class="linenos">2685</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_annotation</span>
</span><span id="L-2686"><a href="#L-2686"><span class="linenos">2686</span></a>            
</span><span id="L-2687"><a href="#L-2687"><span class="linenos">2687</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> annotated: </span><span class="si">{</span><span class="n">new_annotation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2688"><a href="#L-2688"><span class="linenos">2688</span></a>            
</span><span id="L-2689"><a href="#L-2689"><span class="linenos">2689</span></a>            <span class="n">img_</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
</span><span id="L-2690"><a href="#L-2690"><span class="linenos">2690</span></a>            <span class="n">border_fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="n">new_annotation</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">new_annotation</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-2691"><a href="#L-2691"><span class="linenos">2691</span></a>            <span class="n">img_</span> <span class="o">=</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">img_</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">border_fill</span><span class="p">)</span> <span class="k">if</span> <span class="n">border_fill</span> <span class="k">else</span> <span class="n">img_</span>
</span><span id="L-2692"><a href="#L-2692"><span class="linenos">2692</span></a>
</span><span id="L-2693"><a href="#L-2693"><span class="linenos">2693</span></a>            <span class="n">photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img_</span><span class="p">)</span>
</span><span id="L-2694"><a href="#L-2694"><span class="linenos">2694</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">photo</span>
</span><span id="L-2695"><a href="#L-2695"><span class="linenos">2695</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">photo</span><span class="p">)</span>
</span><span id="L-2696"><a href="#L-2696"><span class="linenos">2696</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="L-2697"><a href="#L-2697"><span class="linenos">2697</span></a>
</span><span id="L-2698"><a href="#L-2698"><span class="linenos">2698</span></a>        <span class="k">return</span> <span class="n">on_image_click</span>
</span><span id="L-2699"><a href="#L-2699"><span class="linenos">2699</span></a>
</span><span id="L-2700"><a href="#L-2700"><span class="linenos">2700</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-2701"><a href="#L-2701"><span class="linenos">2701</span></a>    <span class="k">def</span> <span class="nf">update_html</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span><span id="L-2702"><a href="#L-2702"><span class="linenos">2702</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-2703"><a href="#L-2703"><span class="linenos">2703</span></a><span class="s2">        &lt;script&gt;</span>
</span><span id="L-2704"><a href="#L-2704"><span class="linenos">2704</span></a><span class="s2">        document.getElementById(&#39;unique_id&#39;).innerHTML = &#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;;</span>
</span><span id="L-2705"><a href="#L-2705"><span class="linenos">2705</span></a><span class="s2">        &lt;/script&gt;</span>
</span><span id="L-2706"><a href="#L-2706"><span class="linenos">2706</span></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">))</span>
</span><span id="L-2707"><a href="#L-2707"><span class="linenos">2707</span></a>
</span><span id="L-2708"><a href="#L-2708"><span class="linenos">2708</span></a>    <span class="k">def</span> <span class="nf">update_database_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2709"><a href="#L-2709"><span class="linenos">2709</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="L-2710"><a href="#L-2710"><span class="linenos">2710</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="L-2711"><a href="#L-2711"><span class="linenos">2711</span></a>
</span><span id="L-2712"><a href="#L-2712"><span class="linenos">2712</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;div id=&#39;unique_id&#39;&gt;Initial Text&lt;/div&gt;&quot;</span><span class="p">))</span>
</span><span id="L-2713"><a href="#L-2713"><span class="linenos">2713</span></a>
</span><span id="L-2714"><a href="#L-2714"><span class="linenos">2714</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-2715"><a href="#L-2715"><span class="linenos">2715</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">:</span>
</span><span id="L-2716"><a href="#L-2716"><span class="linenos">2716</span></a>                <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2717"><a href="#L-2717"><span class="linenos">2717</span></a>                <span class="k">break</span>
</span><span id="L-2718"><a href="#L-2718"><span class="linenos">2718</span></a>
</span><span id="L-2719"><a href="#L-2719"><span class="linenos">2719</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="L-2720"><a href="#L-2720"><span class="linenos">2720</span></a>                <span class="n">AnnotateApp</span><span class="o">.</span><span class="n">update_html</span><span class="p">(</span><span class="s2">&quot;Do not exit, Updating database...&quot;</span><span class="p">)</span>
</span><span id="L-2721"><a href="#L-2721"><span class="linenos">2721</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Do not exit, Updating database...&#39;</span><span class="p">)</span>
</span><span id="L-2722"><a href="#L-2722"><span class="linenos">2722</span></a>
</span><span id="L-2723"><a href="#L-2723"><span class="linenos">2723</span></a>                <span class="n">pending_updates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-2724"><a href="#L-2724"><span class="linenos">2724</span></a>                <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">new_annotation</span> <span class="ow">in</span> <span class="n">pending_updates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-2725"><a href="#L-2725"><span class="linenos">2725</span></a>                    <span class="k">if</span> <span class="n">new_annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2726"><a href="#L-2726"><span class="linenos">2726</span></a>                        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UPDATE png_list SET </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s1"> = NULL WHERE png_path = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">path</span><span class="p">,))</span>
</span><span id="L-2727"><a href="#L-2727"><span class="linenos">2727</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-2728"><a href="#L-2728"><span class="linenos">2728</span></a>                        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UPDATE png_list SET </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s1"> = ? WHERE png_path = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">new_annotation</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="L-2729"><a href="#L-2729"><span class="linenos">2729</span></a>                <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-2730"><a href="#L-2730"><span class="linenos">2730</span></a>
</span><span id="L-2731"><a href="#L-2731"><span class="linenos">2731</span></a>                <span class="n">AnnotateApp</span><span class="o">.</span><span class="n">update_html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-2732"><a href="#L-2732"><span class="linenos">2732</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-2733"><a href="#L-2733"><span class="linenos">2733</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="L-2734"><a href="#L-2734"><span class="linenos">2734</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="L-2735"><a href="#L-2735"><span class="linenos">2735</span></a>
</span><span id="L-2736"><a href="#L-2736"><span class="linenos">2736</span></a>    <span class="k">def</span> <span class="nf">update_gui_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="L-2737"><a href="#L-2737"><span class="linenos">2737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-2738"><a href="#L-2738"><span class="linenos">2738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="L-2739"><a href="#L-2739"><span class="linenos">2739</span></a>
</span><span id="L-2740"><a href="#L-2740"><span class="linenos">2740</span></a>    <span class="k">def</span> <span class="nf">next_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2741"><a href="#L-2741"><span class="linenos">2741</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="L-2742"><a href="#L-2742"><span class="linenos">2742</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="L-2743"><a href="#L-2743"><span class="linenos">2743</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-2744"><a href="#L-2744"><span class="linenos">2744</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span>
</span><span id="L-2745"><a href="#L-2745"><span class="linenos">2745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>  <span class="c1"># Re-fetch annotations from the database</span>
</span><span id="L-2746"><a href="#L-2746"><span class="linenos">2746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span><span id="L-2747"><a href="#L-2747"><span class="linenos">2747</span></a>
</span><span id="L-2748"><a href="#L-2748"><span class="linenos">2748</span></a>    <span class="k">def</span> <span class="nf">previous_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2749"><a href="#L-2749"><span class="linenos">2749</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="L-2750"><a href="#L-2750"><span class="linenos">2750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="L-2751"><a href="#L-2751"><span class="linenos">2751</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-2752"><a href="#L-2752"><span class="linenos">2752</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span>
</span><span id="L-2753"><a href="#L-2753"><span class="linenos">2753</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2754"><a href="#L-2754"><span class="linenos">2754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2755"><a href="#L-2755"><span class="linenos">2755</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>  <span class="c1"># Re-fetch annotations from the database</span>
</span><span id="L-2756"><a href="#L-2756"><span class="linenos">2756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span><span id="L-2757"><a href="#L-2757"><span class="linenos">2757</span></a>
</span><span id="L-2758"><a href="#L-2758"><span class="linenos">2758</span></a>    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2759"><a href="#L-2759"><span class="linenos">2759</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-2760"><a href="#L-2760"><span class="linenos">2760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="L-2761"><a href="#L-2761"><span class="linenos">2761</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="L-2762"><a href="#L-2762"><span class="linenos">2762</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-2763"><a href="#L-2763"><span class="linenos">2763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="L-2764"><a href="#L-2764"><span class="linenos">2764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span><span id="L-2765"><a href="#L-2765"><span class="linenos">2765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="L-2766"><a href="#L-2766"><span class="linenos">2766</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Quit application&#39;</span><span class="p">)</span>
</span><span id="L-2767"><a href="#L-2767"><span class="linenos">2767</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2768"><a href="#L-2768"><span class="linenos">2768</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting for pending updates to finish before quitting&#39;</span><span class="p">)</span>
</span><span id="L-2769"><a href="#L-2769"><span class="linenos">2769</span></a>            
</span><span id="L-2770"><a href="#L-2770"><span class="linenos">2770</span></a>    <span class="k">def</span> <span class="nf">train_and_classify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2771"><a href="#L-2771"><span class="linenos">2771</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2772"><a href="#L-2772"><span class="linenos">2772</span></a><span class="sd">        1) Merge data from the relevant DB tables (including png_list).</span>
</span><span id="L-2773"><a href="#L-2773"><span class="linenos">2773</span></a><span class="sd">        2) Collect manual annotations from png_list.&lt;annotation_column&gt; =&gt; &#39;manual_annotation&#39;.</span>
</span><span id="L-2774"><a href="#L-2774"><span class="linenos">2774</span></a><span class="sd">           - 1 =&gt; class=1, 2 =&gt; class=0 (for training).</span>
</span><span id="L-2775"><a href="#L-2775"><span class="linenos">2775</span></a><span class="sd">        3) If only one class is present, randomly sample unannotated images as the other class.</span>
</span><span id="L-2776"><a href="#L-2776"><span class="linenos">2776</span></a><span class="sd">        4) Train an XGBoost model.</span>
</span><span id="L-2777"><a href="#L-2777"><span class="linenos">2777</span></a><span class="sd">        5) Classify *all* rows -&gt; fill XGboost_score (prob of class=1) &amp; XGboost_annotation (1 or 2 if high confidence).</span>
</span><span id="L-2778"><a href="#L-2778"><span class="linenos">2778</span></a><span class="sd">        6) Write those columns back to sqlite, so every row in png_list has a score (and possibly an annotation).</span>
</span><span id="L-2779"><a href="#L-2779"><span class="linenos">2779</span></a><span class="sd">        7) Refresh the UI (prefilter_paths_annotations + load_images).</span>
</span><span id="L-2780"><a href="#L-2780"><span class="linenos">2780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2781"><a href="#L-2781"><span class="linenos">2781</span></a>
</span><span id="L-2782"><a href="#L-2782"><span class="linenos">2782</span></a>        <span class="c1"># Optionally, update your GUI status label</span>
</span><span id="L-2783"><a href="#L-2783"><span class="linenos">2783</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Merging data...&quot;</span><span class="p">)</span>
</span><span id="L-2784"><a href="#L-2784"><span class="linenos">2784</span></a>
</span><span id="L-2785"><a href="#L-2785"><span class="linenos">2785</span></a>        <span class="kn">from</span> <span class="nn">spacr.io</span> <span class="kn">import</span> <span class="n">_read_and_merge_data</span>  <span class="c1"># Adapt to your actual import</span>
</span><span id="L-2786"><a href="#L-2786"><span class="linenos">2786</span></a>
</span><span id="L-2787"><a href="#L-2787"><span class="linenos">2787</span></a>        <span class="c1"># (1) Merge data</span>
</span><span id="L-2788"><a href="#L-2788"><span class="linenos">2788</span></a>        <span class="n">merged_df</span><span class="p">,</span> <span class="n">obj_df_ls</span> <span class="o">=</span> <span class="n">_read_and_merge_data</span><span class="p">(</span>
</span><span id="L-2789"><a href="#L-2789"><span class="linenos">2789</span></a>            <span class="n">locs</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">],</span>
</span><span id="L-2790"><a href="#L-2790"><span class="linenos">2790</span></a>            <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;cytoplasm&#39;</span><span class="p">,</span> <span class="s1">&#39;nucleus&#39;</span><span class="p">,</span> <span class="s1">&#39;pathogen&#39;</span><span class="p">,</span> <span class="s1">&#39;png_list&#39;</span><span class="p">],</span>
</span><span id="L-2791"><a href="#L-2791"><span class="linenos">2791</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-2792"><a href="#L-2792"><span class="linenos">2792</span></a>        <span class="p">)</span>
</span><span id="L-2793"><a href="#L-2793"><span class="linenos">2793</span></a>
</span><span id="L-2794"><a href="#L-2794"><span class="linenos">2794</span></a>        <span class="c1"># (2) Load manual annotations from the DB</span>
</span><span id="L-2795"><a href="#L-2795"><span class="linenos">2795</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="L-2796"><a href="#L-2796"><span class="linenos">2796</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="L-2797"><a href="#L-2797"><span class="linenos">2797</span></a>        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list WHERE </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> IS NOT NULL&quot;</span><span class="p">)</span>
</span><span id="L-2798"><a href="#L-2798"><span class="linenos">2798</span></a>        <span class="n">annotated_rows</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  <span class="c1"># e.g. [(png_path, 1 or 2), ...]</span>
</span><span id="L-2799"><a href="#L-2799"><span class="linenos">2799</span></a>        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2800"><a href="#L-2800"><span class="linenos">2800</span></a>
</span><span id="L-2801"><a href="#L-2801"><span class="linenos">2801</span></a>        <span class="c1"># dict {png_path -&gt; 1 or 2}</span>
</span><span id="L-2802"><a href="#L-2802"><span class="linenos">2802</span></a>        <span class="n">annot_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">annotated_rows</span><span class="p">)</span>
</span><span id="L-2803"><a href="#L-2803"><span class="linenos">2803</span></a>
</span><span id="L-2804"><a href="#L-2804"><span class="linenos">2804</span></a>        <span class="c1"># Add &#39;manual_annotation&#39; to merged_df</span>
</span><span id="L-2805"><a href="#L-2805"><span class="linenos">2805</span></a>        <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">annot_dict</span><span class="p">)</span>
</span><span id="L-2806"><a href="#L-2806"><span class="linenos">2806</span></a>
</span><span id="L-2807"><a href="#L-2807"><span class="linenos">2807</span></a>        <span class="c1"># Subset with manual labels</span>
</span><span id="L-2808"><a href="#L-2808"><span class="linenos">2808</span></a>        <span class="n">annotated_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2809"><a href="#L-2809"><span class="linenos">2809</span></a>        <span class="c1"># Convert &quot;2&quot; =&gt; &quot;0&quot; for binary classification</span>
</span><span id="L-2810"><a href="#L-2810"><span class="linenos">2810</span></a>        <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-2811"><a href="#L-2811"><span class="linenos">2811</span></a>
</span><span id="L-2812"><a href="#L-2812"><span class="linenos">2812</span></a>        <span class="c1"># (3) Handle single-class scenario</span>
</span><span id="L-2813"><a href="#L-2813"><span class="linenos">2813</span></a>        <span class="n">class_counts</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span><span id="L-2814"><a href="#L-2814"><span class="linenos">2814</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-2815"><a href="#L-2815"><span class="linenos">2815</span></a>            <span class="n">single_class</span> <span class="o">=</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 0 or 1</span>
</span><span id="L-2816"><a href="#L-2816"><span class="linenos">2816</span></a>            <span class="n">needed</span> <span class="o">=</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2817"><a href="#L-2817"><span class="linenos">2817</span></a>            <span class="n">other_class</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">single_class</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-2818"><a href="#L-2818"><span class="linenos">2818</span></a>
</span><span id="L-2819"><a href="#L-2819"><span class="linenos">2819</span></a>            <span class="n">unannotated_df_all</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2820"><a href="#L-2820"><span class="linenos">2820</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unannotated_df_all</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2821"><a href="#L-2821"><span class="linenos">2821</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No unannotated rows to sample for the other class. Cannot proceed.&quot;</span><span class="p">)</span>
</span><span id="L-2822"><a href="#L-2822"><span class="linenos">2822</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Not enough data to train (no second class).&quot;</span><span class="p">)</span>
</span><span id="L-2823"><a href="#L-2823"><span class="linenos">2823</span></a>                <span class="k">return</span>
</span><span id="L-2824"><a href="#L-2824"><span class="linenos">2824</span></a>
</span><span id="L-2825"><a href="#L-2825"><span class="linenos">2825</span></a>            <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">needed</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unannotated_df_all</span><span class="p">))</span>
</span><span id="L-2826"><a href="#L-2826"><span class="linenos">2826</span></a>            <span class="n">artificially_labeled</span> <span class="o">=</span> <span class="n">unannotated_df_all</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2827"><a href="#L-2827"><span class="linenos">2827</span></a>            <span class="n">artificially_labeled</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_class</span>
</span><span id="L-2828"><a href="#L-2828"><span class="linenos">2828</span></a>
</span><span id="L-2829"><a href="#L-2829"><span class="linenos">2829</span></a>            <span class="n">annotated_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">annotated_df</span><span class="p">,</span> <span class="n">artificially_labeled</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2830"><a href="#L-2830"><span class="linenos">2830</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only one class was present =&gt; randomly labeled </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2"> unannotated rows as </span><span class="si">{</span><span class="n">other_class</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-2831"><a href="#L-2831"><span class="linenos">2831</span></a>
</span><span id="L-2832"><a href="#L-2832"><span class="linenos">2832</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotated_df</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-2833"><a href="#L-2833"><span class="linenos">2833</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not enough annotated data to train (need at least 2).&quot;</span><span class="p">)</span>
</span><span id="L-2834"><a href="#L-2834"><span class="linenos">2834</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Not enough data to train.&quot;</span><span class="p">)</span>
</span><span id="L-2835"><a href="#L-2835"><span class="linenos">2835</span></a>            <span class="k">return</span>
</span><span id="L-2836"><a href="#L-2836"><span class="linenos">2836</span></a>
</span><span id="L-2837"><a href="#L-2837"><span class="linenos">2837</span></a>        <span class="c1"># (4) Train XGBoost</span>
</span><span id="L-2838"><a href="#L-2838"><span class="linenos">2838</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Training XGBoost model...&quot;</span><span class="p">)</span>
</span><span id="L-2839"><a href="#L-2839"><span class="linenos">2839</span></a>
</span><span id="L-2840"><a href="#L-2840"><span class="linenos">2840</span></a>        <span class="c1"># Identify numeric columns</span>
</span><span id="L-2841"><a href="#L-2841"><span class="linenos">2841</span></a>        <span class="n">ignore_cols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;png_path&#39;</span><span class="p">,</span> <span class="s1">&#39;manual_annotation&#39;</span><span class="p">}</span>
</span><span id="L-2842"><a href="#L-2842"><span class="linenos">2842</span></a>        <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-2843"><a href="#L-2843"><span class="linenos">2843</span></a>            <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">annotated_df</span><span class="o">.</span><span class="n">columns</span>
</span><span id="L-2844"><a href="#L-2844"><span class="linenos">2844</span></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore_cols</span>
</span><span id="L-2845"><a href="#L-2845"><span class="linenos">2845</span></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">annotated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span> <span class="ow">or</span> <span class="n">annotated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="L-2846"><a href="#L-2846"><span class="linenos">2846</span></a>        <span class="p">]</span>
</span><span id="L-2847"><a href="#L-2847"><span class="linenos">2847</span></a>
</span><span id="L-2848"><a href="#L-2848"><span class="linenos">2848</span></a>        <span class="n">X_data</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-2849"><a href="#L-2849"><span class="linenos">2849</span></a>        <span class="n">y_data</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-2850"><a href="#L-2850"><span class="linenos">2850</span></a>
</span><span id="L-2851"><a href="#L-2851"><span class="linenos">2851</span></a>        <span class="c1"># standard train/test</span>
</span><span id="L-2852"><a href="#L-2852"><span class="linenos">2852</span></a>        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="L-2853"><a href="#L-2853"><span class="linenos">2853</span></a>            <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
</span><span id="L-2854"><a href="#L-2854"><span class="linenos">2854</span></a>        <span class="p">)</span>
</span><span id="L-2855"><a href="#L-2855"><span class="linenos">2855</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">)</span>
</span><span id="L-2856"><a href="#L-2856"><span class="linenos">2856</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="L-2857"><a href="#L-2857"><span class="linenos">2857</span></a>
</span><span id="L-2858"><a href="#L-2858"><span class="linenos">2858</span></a>        <span class="c1"># Evaluate</span>
</span><span id="L-2859"><a href="#L-2859"><span class="linenos">2859</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="L-2860"><a href="#L-2860"><span class="linenos">2860</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Classification Report ===&quot;</span><span class="p">)</span>
</span><span id="L-2861"><a href="#L-2861"><span class="linenos">2861</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
</span><span id="L-2862"><a href="#L-2862"><span class="linenos">2862</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Confusion Matrix ===&quot;</span><span class="p">)</span>
</span><span id="L-2863"><a href="#L-2863"><span class="linenos">2863</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
</span><span id="L-2864"><a href="#L-2864"><span class="linenos">2864</span></a>
</span><span id="L-2865"><a href="#L-2865"><span class="linenos">2865</span></a>        <span class="c1"># (5) Classify ALL rows</span>
</span><span id="L-2866"><a href="#L-2866"><span class="linenos">2866</span></a>        <span class="n">all_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2867"><a href="#L-2867"><span class="linenos">2867</span></a>        <span class="n">X_all</span> <span class="o">=</span> <span class="n">all_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-2868"><a href="#L-2868"><span class="linenos">2868</span></a>        <span class="n">probs_all</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_all</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-2869"><a href="#L-2869"><span class="linenos">2869</span></a>        <span class="c1"># Probability =&gt; XGboost_score</span>
</span><span id="L-2870"><a href="#L-2870"><span class="linenos">2870</span></a>        <span class="n">all_df</span><span class="p">[</span><span class="s1">&#39;XGboost_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs_all</span>
</span><span id="L-2871"><a href="#L-2871"><span class="linenos">2871</span></a>
</span><span id="L-2872"><a href="#L-2872"><span class="linenos">2872</span></a>        <span class="c1"># Decide XGboost_annotation</span>
</span><span id="L-2873"><a href="#L-2873"><span class="linenos">2873</span></a>        <span class="k">def</span> <span class="nf">get_annotation_from_prob</span><span class="p">(</span><span class="n">prob</span><span class="p">):</span>
</span><span id="L-2874"><a href="#L-2874"><span class="linenos">2874</span></a>            <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
</span><span id="L-2875"><a href="#L-2875"><span class="linenos">2875</span></a>                <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># class=1</span>
</span><span id="L-2876"><a href="#L-2876"><span class="linenos">2876</span></a>            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
</span><span id="L-2877"><a href="#L-2877"><span class="linenos">2877</span></a>                <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># class=0</span>
</span><span id="L-2878"><a href="#L-2878"><span class="linenos">2878</span></a>            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># uncertain</span>
</span><span id="L-2879"><a href="#L-2879"><span class="linenos">2879</span></a>
</span><span id="L-2880"><a href="#L-2880"><span class="linenos">2880</span></a>        <span class="n">xgb_anno_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_annotation_from_prob</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probs_all</span><span class="p">]</span>
</span><span id="L-2881"><a href="#L-2881"><span class="linenos">2881</span></a>        <span class="c1"># Convert 0 =&gt; 2 if your DB uses &quot;2&quot; for the negative class</span>
</span><span id="L-2882"><a href="#L-2882"><span class="linenos">2882</span></a>        <span class="n">xgb_anno_col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xgb_anno_col</span><span class="p">]</span>
</span><span id="L-2883"><a href="#L-2883"><span class="linenos">2883</span></a>
</span><span id="L-2884"><a href="#L-2884"><span class="linenos">2884</span></a>        <span class="n">all_df</span><span class="p">[</span><span class="s1">&#39;XGboost_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xgb_anno_col</span>
</span><span id="L-2885"><a href="#L-2885"><span class="linenos">2885</span></a>
</span><span id="L-2886"><a href="#L-2886"><span class="linenos">2886</span></a>        <span class="c1"># (6) Write results back to png_list</span>
</span><span id="L-2887"><a href="#L-2887"><span class="linenos">2887</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Updating the database with XGBoost predictions...&quot;</span><span class="p">)</span>
</span><span id="L-2888"><a href="#L-2888"><span class="linenos">2888</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="L-2889"><a href="#L-2889"><span class="linenos">2889</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="L-2890"><a href="#L-2890"><span class="linenos">2890</span></a>        <span class="c1"># Ensure columns exist</span>
</span><span id="L-2891"><a href="#L-2891"><span class="linenos">2891</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2892"><a href="#L-2892"><span class="linenos">2892</span></a>            <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE png_list ADD COLUMN XGboost_annotation INTEGER&quot;</span><span class="p">)</span>
</span><span id="L-2893"><a href="#L-2893"><span class="linenos">2893</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
</span><span id="L-2894"><a href="#L-2894"><span class="linenos">2894</span></a>            <span class="k">pass</span>
</span><span id="L-2895"><a href="#L-2895"><span class="linenos">2895</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2896"><a href="#L-2896"><span class="linenos">2896</span></a>            <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE png_list ADD COLUMN XGboost_score FLOAT&quot;</span><span class="p">)</span>
</span><span id="L-2897"><a href="#L-2897"><span class="linenos">2897</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
</span><span id="L-2898"><a href="#L-2898"><span class="linenos">2898</span></a>            <span class="k">pass</span>
</span><span id="L-2899"><a href="#L-2899"><span class="linenos">2899</span></a>
</span><span id="L-2900"><a href="#L-2900"><span class="linenos">2900</span></a>        <span class="c1"># Update each row</span>
</span><span id="L-2901"><a href="#L-2901"><span class="linenos">2901</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">all_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-2902"><a href="#L-2902"><span class="linenos">2902</span></a>            <span class="n">score_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;XGboost_score&#39;</span><span class="p">])</span>
</span><span id="L-2903"><a href="#L-2903"><span class="linenos">2903</span></a>            <span class="n">anno_val</span>  <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;XGboost_annotation&#39;</span><span class="p">]</span>
</span><span id="L-2904"><a href="#L-2904"><span class="linenos">2904</span></a>            <span class="n">the_path</span>  <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span>
</span><span id="L-2905"><a href="#L-2905"><span class="linenos">2905</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">the_path</span><span class="p">):</span>
</span><span id="L-2906"><a href="#L-2906"><span class="linenos">2906</span></a>                <span class="k">continue</span>  <span class="c1"># skip if no path</span>
</span><span id="L-2907"><a href="#L-2907"><span class="linenos">2907</span></a>
</span><span id="L-2908"><a href="#L-2908"><span class="linenos">2908</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">anno_val</span><span class="p">):</span>
</span><span id="L-2909"><a href="#L-2909"><span class="linenos">2909</span></a>                <span class="c1"># We set annotation=NULL but do set the score</span>
</span><span id="L-2910"><a href="#L-2910"><span class="linenos">2910</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-2911"><a href="#L-2911"><span class="linenos">2911</span></a><span class="s2">                    UPDATE png_list</span>
</span><span id="L-2912"><a href="#L-2912"><span class="linenos">2912</span></a><span class="s2">                       SET XGboost_annotation = NULL,</span>
</span><span id="L-2913"><a href="#L-2913"><span class="linenos">2913</span></a><span class="s2">                           XGboost_score       = ?</span>
</span><span id="L-2914"><a href="#L-2914"><span class="linenos">2914</span></a><span class="s2">                     WHERE png_path = ?</span>
</span><span id="L-2915"><a href="#L-2915"><span class="linenos">2915</span></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">score_val</span><span class="p">,</span> <span class="n">the_path</span><span class="p">))</span>
</span><span id="L-2916"><a href="#L-2916"><span class="linenos">2916</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2917"><a href="#L-2917"><span class="linenos">2917</span></a>                <span class="c1"># numeric annotation + numeric score</span>
</span><span id="L-2918"><a href="#L-2918"><span class="linenos">2918</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-2919"><a href="#L-2919"><span class="linenos">2919</span></a><span class="s2">                    UPDATE png_list</span>
</span><span id="L-2920"><a href="#L-2920"><span class="linenos">2920</span></a><span class="s2">                       SET XGboost_annotation = ?,</span>
</span><span id="L-2921"><a href="#L-2921"><span class="linenos">2921</span></a><span class="s2">                           XGboost_score       = ?</span>
</span><span id="L-2922"><a href="#L-2922"><span class="linenos">2922</span></a><span class="s2">                     WHERE png_path = ?</span>
</span><span id="L-2923"><a href="#L-2923"><span class="linenos">2923</span></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">anno_val</span><span class="p">),</span> <span class="n">score_val</span><span class="p">,</span> <span class="n">the_path</span><span class="p">))</span>
</span><span id="L-2924"><a href="#L-2924"><span class="linenos">2924</span></a>                
</span><span id="L-2925"><a href="#L-2925"><span class="linenos">2925</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="s1">&#39;XGboost_annotation&#39;</span>
</span><span id="L-2926"><a href="#L-2926"><span class="linenos">2926</span></a>
</span><span id="L-2927"><a href="#L-2927"><span class="linenos">2927</span></a><span class="k">def</span> <span class="nf">standardize_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="L-2928"><a href="#L-2928"><span class="linenos">2928</span></a>    <span class="kn">from</span> <span class="nn">.gui_elements</span> <span class="kn">import</span> <span class="n">set_dark_style</span>
</span><span id="L-2929"><a href="#L-2929"><span class="linenos">2929</span></a>    <span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
</span><span id="L-2930"><a href="#L-2930"><span class="linenos">2930</span></a>
</span><span id="L-2931"><a href="#L-2931"><span class="linenos">2931</span></a>    <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="L-2932"><a href="#L-2932"><span class="linenos">2932</span></a>    <span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="L-2933"><a href="#L-2933"><span class="linenos">2933</span></a>    <span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="L-2934"><a href="#L-2934"><span class="linenos">2934</span></a>    <span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="L-2935"><a href="#L-2935"><span class="linenos">2935</span></a>    <span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="L-2936"><a href="#L-2936"><span class="linenos">2936</span></a>
</span><span id="L-2937"><a href="#L-2937"><span class="linenos">2937</span></a>    <span class="c1"># Get the custom font path from the font loader</span>
</span><span id="L-2938"><a href="#L-2938"><span class="linenos">2938</span></a>    <span class="n">font_path</span> <span class="o">=</span> <span class="n">font_loader</span><span class="o">.</span><span class="n">font_path</span>
</span><span id="L-2939"><a href="#L-2939"><span class="linenos">2939</span></a>    <span class="n">font_prop</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">font_path</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-2940"><a href="#L-2940"><span class="linenos">2940</span></a>
</span><span id="L-2941"><a href="#L-2941"><span class="linenos">2941</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2942"><a href="#L-2942"><span class="linenos">2942</span></a><span class="sd">    Standardizes the appearance of the figure:</span>
</span><span id="L-2943"><a href="#L-2943"><span class="linenos">2943</span></a><span class="sd">    - Font size: from style</span>
</span><span id="L-2944"><a href="#L-2944"><span class="linenos">2944</span></a><span class="sd">    - Font color: from style</span>
</span><span id="L-2945"><a href="#L-2945"><span class="linenos">2945</span></a><span class="sd">    - Font family: custom OpenSans from font_loader</span>
</span><span id="L-2946"><a href="#L-2946"><span class="linenos">2946</span></a><span class="sd">    - Removes top and right spines</span>
</span><span id="L-2947"><a href="#L-2947"><span class="linenos">2947</span></a><span class="sd">    - Figure and subplot background: from style</span>
</span><span id="L-2948"><a href="#L-2948"><span class="linenos">2948</span></a><span class="sd">    - Line width: 1</span>
</span><span id="L-2949"><a href="#L-2949"><span class="linenos">2949</span></a><span class="sd">    - Line color: from style</span>
</span><span id="L-2950"><a href="#L-2950"><span class="linenos">2950</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2951"><a href="#L-2951"><span class="linenos">2951</span></a>    
</span><span id="L-2952"><a href="#L-2952"><span class="linenos">2952</span></a>
</span><span id="L-2953"><a href="#L-2953"><span class="linenos">2953</span></a>    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="L-2954"><a href="#L-2954"><span class="linenos">2954</span></a>        <span class="c1"># Set font properties for title and labels</span>
</span><span id="L-2955"><a href="#L-2955"><span class="linenos">2955</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-2956"><a href="#L-2956"><span class="linenos">2956</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2957"><a href="#L-2957"><span class="linenos">2957</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="L-2958"><a href="#L-2958"><span class="linenos">2958</span></a>
</span><span id="L-2959"><a href="#L-2959"><span class="linenos">2959</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-2960"><a href="#L-2960"><span class="linenos">2960</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2961"><a href="#L-2961"><span class="linenos">2961</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="L-2962"><a href="#L-2962"><span class="linenos">2962</span></a>
</span><span id="L-2963"><a href="#L-2963"><span class="linenos">2963</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-2964"><a href="#L-2964"><span class="linenos">2964</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2965"><a href="#L-2965"><span class="linenos">2965</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="L-2966"><a href="#L-2966"><span class="linenos">2966</span></a>
</span><span id="L-2967"><a href="#L-2967"><span class="linenos">2967</span></a>        <span class="c1"># Set font properties for tick labels</span>
</span><span id="L-2968"><a href="#L-2968"><span class="linenos">2968</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
</span><span id="L-2969"><a href="#L-2969"><span class="linenos">2969</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-2970"><a href="#L-2970"><span class="linenos">2970</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2971"><a href="#L-2971"><span class="linenos">2971</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="L-2972"><a href="#L-2972"><span class="linenos">2972</span></a>
</span><span id="L-2973"><a href="#L-2973"><span class="linenos">2973</span></a>        <span class="c1"># Remove top and right spines</span>
</span><span id="L-2974"><a href="#L-2974"><span class="linenos">2974</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2975"><a href="#L-2975"><span class="linenos">2975</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2976"><a href="#L-2976"><span class="linenos">2976</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2977"><a href="#L-2977"><span class="linenos">2977</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2978"><a href="#L-2978"><span class="linenos">2978</span></a>
</span><span id="L-2979"><a href="#L-2979"><span class="linenos">2979</span></a>        <span class="c1"># Set spine line width and color</span>
</span><span id="L-2980"><a href="#L-2980"><span class="linenos">2980</span></a>        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-2981"><a href="#L-2981"><span class="linenos">2981</span></a>            <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2982"><a href="#L-2982"><span class="linenos">2982</span></a>            <span class="n">spine</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2983"><a href="#L-2983"><span class="linenos">2983</span></a>
</span><span id="L-2984"><a href="#L-2984"><span class="linenos">2984</span></a>        <span class="c1"># Set line width and color</span>
</span><span id="L-2985"><a href="#L-2985"><span class="linenos">2985</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">():</span>
</span><span id="L-2986"><a href="#L-2986"><span class="linenos">2986</span></a>            <span class="n">line</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2987"><a href="#L-2987"><span class="linenos">2987</span></a>            <span class="n">line</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="L-2988"><a href="#L-2988"><span class="linenos">2988</span></a>
</span><span id="L-2989"><a href="#L-2989"><span class="linenos">2989</span></a>        <span class="c1"># Set subplot background color</span>
</span><span id="L-2990"><a href="#L-2990"><span class="linenos">2990</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-2991"><a href="#L-2991"><span class="linenos">2991</span></a>
</span><span id="L-2992"><a href="#L-2992"><span class="linenos">2992</span></a>        <span class="c1"># Adjust the grid if needed</span>
</span><span id="L-2993"><a href="#L-2993"><span class="linenos">2993</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-2994"><a href="#L-2994"><span class="linenos">2994</span></a>
</span><span id="L-2995"><a href="#L-2995"><span class="linenos">2995</span></a>    <span class="c1"># Set figure background color</span>
</span><span id="L-2996"><a href="#L-2996"><span class="linenos">2996</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-2997"><a href="#L-2997"><span class="linenos">2997</span></a>
</span><span id="L-2998"><a href="#L-2998"><span class="linenos">2998</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span><span id="L-2999"><a href="#L-2999"><span class="linenos">2999</span></a>
</span><span id="L-3000"><a href="#L-3000"><span class="linenos">3000</span></a>    <span class="k">return</span> <span class="n">fig</span>
</span><span id="L-3001"><a href="#L-3001"><span class="linenos">3001</span></a>
</span><span id="L-3002"><a href="#L-3002"><span class="linenos">3002</span></a><span class="k">def</span> <span class="nf">modify_figure_properties</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">scale_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label_rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-3003"><a href="#L-3003"><span class="linenos">3003</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3004"><a href="#L-3004"><span class="linenos">3004</span></a><span class="sd">    Modifies the properties of the figure, including scaling, line widths, font sizes, axis limits, x-axis label rotation, background color, text color, line color, and other common options.</span>
</span><span id="L-3005"><a href="#L-3005"><span class="linenos">3005</span></a>
</span><span id="L-3006"><a href="#L-3006"><span class="linenos">3006</span></a><span class="sd">    Parameters:</span>
</span><span id="L-3007"><a href="#L-3007"><span class="linenos">3007</span></a><span class="sd">    - fig: The Matplotlib figure object to modify.</span>
</span><span id="L-3008"><a href="#L-3008"><span class="linenos">3008</span></a><span class="sd">    - scale_x: Scaling factor for the width of subplots (optional).</span>
</span><span id="L-3009"><a href="#L-3009"><span class="linenos">3009</span></a><span class="sd">    - scale_y: Scaling factor for the height of subplots (optional).</span>
</span><span id="L-3010"><a href="#L-3010"><span class="linenos">3010</span></a><span class="sd">    - line_width: Desired line width for all lines (optional).</span>
</span><span id="L-3011"><a href="#L-3011"><span class="linenos">3011</span></a><span class="sd">    - font_size: Desired font size for all text (optional).</span>
</span><span id="L-3012"><a href="#L-3012"><span class="linenos">3012</span></a><span class="sd">    - x_lim: Tuple specifying the x-axis limits (min, max) (optional).</span>
</span><span id="L-3013"><a href="#L-3013"><span class="linenos">3013</span></a><span class="sd">    - y_lim: Tuple specifying the y-axis limits (min, max) (optional).</span>
</span><span id="L-3014"><a href="#L-3014"><span class="linenos">3014</span></a><span class="sd">    - grid: Boolean to add grid lines to the plot (optional).</span>
</span><span id="L-3015"><a href="#L-3015"><span class="linenos">3015</span></a><span class="sd">    - legend: Boolean to show/hide the legend (optional).</span>
</span><span id="L-3016"><a href="#L-3016"><span class="linenos">3016</span></a><span class="sd">    - title: String to set as the title of the plot (optional).</span>
</span><span id="L-3017"><a href="#L-3017"><span class="linenos">3017</span></a><span class="sd">    - x_label_rotation: Angle to rotate the x-axis labels (optional).</span>
</span><span id="L-3018"><a href="#L-3018"><span class="linenos">3018</span></a><span class="sd">    - remove_axes: Boolean to remove or show the axes labels (optional).</span>
</span><span id="L-3019"><a href="#L-3019"><span class="linenos">3019</span></a><span class="sd">    - bg_color: Color for the figure and subplot background (optional).</span>
</span><span id="L-3020"><a href="#L-3020"><span class="linenos">3020</span></a><span class="sd">    - text_color: Color for all text in the figure (optional).</span>
</span><span id="L-3021"><a href="#L-3021"><span class="linenos">3021</span></a><span class="sd">    - line_color: Color for all lines in the figure (optional).</span>
</span><span id="L-3022"><a href="#L-3022"><span class="linenos">3022</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3023"><a href="#L-3023"><span class="linenos">3023</span></a>    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3024"><a href="#L-3024"><span class="linenos">3024</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: The figure provided is None.&quot;</span><span class="p">)</span>
</span><span id="L-3025"><a href="#L-3025"><span class="linenos">3025</span></a>        <span class="k">return</span>
</span><span id="L-3026"><a href="#L-3026"><span class="linenos">3026</span></a>
</span><span id="L-3027"><a href="#L-3027"><span class="linenos">3027</span></a>    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="L-3028"><a href="#L-3028"><span class="linenos">3028</span></a>        <span class="c1"># Rescale subplots if scaling factors are provided</span>
</span><span id="L-3029"><a href="#L-3029"><span class="linenos">3029</span></a>        <span class="k">if</span> <span class="n">scale_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scale_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3030"><a href="#L-3030"><span class="linenos">3030</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
</span><span id="L-3031"><a href="#L-3031"><span class="linenos">3031</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="n">scale_x</span> <span class="k">if</span> <span class="n">scale_x</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3032"><a href="#L-3032"><span class="linenos">3032</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="p">(</span><span class="n">scale_y</span> <span class="k">if</span> <span class="n">scale_y</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3033"><a href="#L-3033"><span class="linenos">3033</span></a>            <span class="n">new_bbox</span> <span class="o">=</span> <span class="p">[</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">]</span>
</span><span id="L-3034"><a href="#L-3034"><span class="linenos">3034</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">new_bbox</span><span class="p">)</span>
</span><span id="L-3035"><a href="#L-3035"><span class="linenos">3035</span></a>
</span><span id="L-3036"><a href="#L-3036"><span class="linenos">3036</span></a>        <span class="c1"># Set axis limits if provided</span>
</span><span id="L-3037"><a href="#L-3037"><span class="linenos">3037</span></a>        <span class="k">if</span> <span class="n">x_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3038"><a href="#L-3038"><span class="linenos">3038</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lim</span><span class="p">)</span>
</span><span id="L-3039"><a href="#L-3039"><span class="linenos">3039</span></a>        <span class="k">if</span> <span class="n">y_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3040"><a href="#L-3040"><span class="linenos">3040</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
</span><span id="L-3041"><a href="#L-3041"><span class="linenos">3041</span></a>
</span><span id="L-3042"><a href="#L-3042"><span class="linenos">3042</span></a>        <span class="c1"># Set grid visibility only</span>
</span><span id="L-3043"><a href="#L-3043"><span class="linenos">3043</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</span><span id="L-3044"><a href="#L-3044"><span class="linenos">3044</span></a>
</span><span id="L-3045"><a href="#L-3045"><span class="linenos">3045</span></a>        <span class="c1"># Adjust line width and color if specified</span>
</span><span id="L-3046"><a href="#L-3046"><span class="linenos">3046</span></a>        <span class="k">if</span> <span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3047"><a href="#L-3047"><span class="linenos">3047</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">():</span>
</span><span id="L-3048"><a href="#L-3048"><span class="linenos">3048</span></a>                <span class="k">if</span> <span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3049"><a href="#L-3049"><span class="linenos">3049</span></a>                    <span class="n">line</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">line_width</span><span class="p">)</span>
</span><span id="L-3050"><a href="#L-3050"><span class="linenos">3050</span></a>                <span class="k">if</span> <span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3051"><a href="#L-3051"><span class="linenos">3051</span></a>                    <span class="n">line</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">line_color</span><span class="p">)</span>
</span><span id="L-3052"><a href="#L-3052"><span class="linenos">3052</span></a>            <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>  <span class="c1"># Modify width and color of spines (e.g., scale bars)</span>
</span><span id="L-3053"><a href="#L-3053"><span class="linenos">3053</span></a>                <span class="k">if</span> <span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3054"><a href="#L-3054"><span class="linenos">3054</span></a>                    <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">line_width</span><span class="p">)</span>
</span><span id="L-3055"><a href="#L-3055"><span class="linenos">3055</span></a>                <span class="k">if</span> <span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3056"><a href="#L-3056"><span class="linenos">3056</span></a>                    <span class="n">spine</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">line_color</span><span class="p">)</span>
</span><span id="L-3057"><a href="#L-3057"><span class="linenos">3057</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">text_color</span> <span class="k">if</span> <span class="n">text_color</span> <span class="k">else</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="L-3058"><a href="#L-3058"><span class="linenos">3058</span></a>
</span><span id="L-3059"><a href="#L-3059"><span class="linenos">3059</span></a>        <span class="c1"># Adjust font size if specified</span>
</span><span id="L-3060"><a href="#L-3060"><span class="linenos">3060</span></a>        <span class="k">if</span> <span class="n">font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3061"><a href="#L-3061"><span class="linenos">3061</span></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
</span><span id="L-3062"><a href="#L-3062"><span class="linenos">3062</span></a>                <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-3063"><a href="#L-3063"><span class="linenos">3063</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-3064"><a href="#L-3064"><span class="linenos">3064</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-3065"><a href="#L-3065"><span class="linenos">3065</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-3066"><a href="#L-3066"><span class="linenos">3066</span></a>            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
</span><span id="L-3067"><a href="#L-3067"><span class="linenos">3067</span></a>                <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">get_texts</span><span class="p">():</span>
</span><span id="L-3068"><a href="#L-3068"><span class="linenos">3068</span></a>                    <span class="n">text</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="L-3069"><a href="#L-3069"><span class="linenos">3069</span></a>
</span><span id="L-3070"><a href="#L-3070"><span class="linenos">3070</span></a>        <span class="c1"># Rotate x-axis labels if rotation is specified</span>
</span><span id="L-3071"><a href="#L-3071"><span class="linenos">3071</span></a>        <span class="k">if</span> <span class="n">x_label_rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3072"><a href="#L-3072"><span class="linenos">3072</span></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
</span><span id="L-3073"><a href="#L-3073"><span class="linenos">3073</span></a>                <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">x_label_rotation</span><span class="p">)</span>
</span><span id="L-3074"><a href="#L-3074"><span class="linenos">3074</span></a>                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x_label_rotation</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="L-3075"><a href="#L-3075"><span class="linenos">3075</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">set_ha</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="L-3076"><a href="#L-3076"><span class="linenos">3076</span></a>
</span><span id="L-3077"><a href="#L-3077"><span class="linenos">3077</span></a>        <span class="c1"># Toggle axes labels visibility without affecting the grid or spines</span>
</span><span id="L-3078"><a href="#L-3078"><span class="linenos">3078</span></a>        <span class="k">if</span> <span class="n">remove_axes</span><span class="p">:</span>
</span><span id="L-3079"><a href="#L-3079"><span class="linenos">3079</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3080"><a href="#L-3080"><span class="linenos">3080</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3081"><a href="#L-3081"><span class="linenos">3081</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-3082"><a href="#L-3082"><span class="linenos">3082</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3083"><a href="#L-3083"><span class="linenos">3083</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3084"><a href="#L-3084"><span class="linenos">3084</span></a>
</span><span id="L-3085"><a href="#L-3085"><span class="linenos">3085</span></a>        <span class="c1"># Set text color if specified</span>
</span><span id="L-3086"><a href="#L-3086"><span class="linenos">3086</span></a>        <span class="k">if</span> <span class="n">text_color</span><span class="p">:</span>
</span><span id="L-3087"><a href="#L-3087"><span class="linenos">3087</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="L-3088"><a href="#L-3088"><span class="linenos">3088</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="L-3089"><a href="#L-3089"><span class="linenos">3089</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="L-3090"><a href="#L-3090"><span class="linenos">3090</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="L-3091"><a href="#L-3091"><span class="linenos">3091</span></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
</span><span id="L-3092"><a href="#L-3092"><span class="linenos">3092</span></a>                <span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="L-3093"><a href="#L-3093"><span class="linenos">3093</span></a>
</span><span id="L-3094"><a href="#L-3094"><span class="linenos">3094</span></a>        <span class="c1"># Set background color for subplots if specified</span>
</span><span id="L-3095"><a href="#L-3095"><span class="linenos">3095</span></a>        <span class="k">if</span> <span class="n">bg_color</span><span class="p">:</span>
</span><span id="L-3096"><a href="#L-3096"><span class="linenos">3096</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-3097"><a href="#L-3097"><span class="linenos">3097</span></a>
</span><span id="L-3098"><a href="#L-3098"><span class="linenos">3098</span></a>    <span class="c1"># Set figure background color if specified</span>
</span><span id="L-3099"><a href="#L-3099"><span class="linenos">3099</span></a>    <span class="k">if</span> <span class="n">bg_color</span><span class="p">:</span>
</span><span id="L-3100"><a href="#L-3100"><span class="linenos">3100</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="L-3101"><a href="#L-3101"><span class="linenos">3101</span></a>
</span><span id="L-3102"><a href="#L-3102"><span class="linenos">3102</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span><span id="L-3103"><a href="#L-3103"><span class="linenos">3103</span></a>
</span><span id="L-3104"><a href="#L-3104"><span class="linenos">3104</span></a><span class="k">def</span> <span class="nf">save_figure_as_format</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">file_format</span><span class="p">):</span>
</span><span id="L-3105"><a href="#L-3105"><span class="linenos">3105</span></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="n">defaultextension</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*&quot;</span><span class="p">)])</span>
</span><span id="L-3106"><a href="#L-3106"><span class="linenos">3106</span></a>    <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="L-3107"><a href="#L-3107"><span class="linenos">3107</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-3108"><a href="#L-3108"><span class="linenos">3108</span></a>            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">file_format</span><span class="p">)</span>
</span><span id="L-3109"><a href="#L-3109"><span class="linenos">3109</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure saved as </span><span class="si">{</span><span class="n">file_format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-3110"><a href="#L-3110"><span class="linenos">3110</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-3111"><a href="#L-3111"><span class="linenos">3111</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error saving figure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-3112"><a href="#L-3112"><span class="linenos">3112</span></a>
</span><span id="L-3113"><a href="#L-3113"><span class="linenos">3113</span></a><span class="k">def</span> <span class="nf">modify_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="L-3114"><a href="#L-3114"><span class="linenos">3114</span></a>    <span class="kn">from</span> <span class="nn">.gui_core</span> <span class="kn">import</span> <span class="n">display_figure</span>
</span><span id="L-3115"><a href="#L-3115"><span class="linenos">3115</span></a>    <span class="k">def</span> <span class="nf">apply_modifications</span><span class="p">():</span>
</span><span id="L-3116"><a href="#L-3116"><span class="linenos">3116</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-3117"><a href="#L-3117"><span class="linenos">3117</span></a>            <span class="c1"># Only apply changes if the fields are filled</span>
</span><span id="L-3118"><a href="#L-3118"><span class="linenos">3118</span></a>            <span class="n">scale_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_x_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">scale_x_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3119"><a href="#L-3119"><span class="linenos">3119</span></a>            <span class="n">scale_y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_y_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">scale_y_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3120"><a href="#L-3120"><span class="linenos">3120</span></a>            <span class="n">line_width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_width_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">line_width_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3121"><a href="#L-3121"><span class="linenos">3121</span></a>            <span class="n">font_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">font_size_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">font_size_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3122"><a href="#L-3122"><span class="linenos">3122</span></a>            <span class="n">x_lim</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">x_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3123"><a href="#L-3123"><span class="linenos">3123</span></a>            <span class="n">y_lim</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">y_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">y_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3124"><a href="#L-3124"><span class="linenos">3124</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="n">title_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">title_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3125"><a href="#L-3125"><span class="linenos">3125</span></a>            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">bg_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">bg_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3126"><a href="#L-3126"><span class="linenos">3126</span></a>            <span class="n">text_color</span> <span class="o">=</span> <span class="n">text_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">text_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3127"><a href="#L-3127"><span class="linenos">3127</span></a>            <span class="n">line_color</span> <span class="o">=</span> <span class="n">line_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">line_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3128"><a href="#L-3128"><span class="linenos">3128</span></a>            <span class="n">x_label_rotation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_label_rotation_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">x_label_rotation_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3129"><a href="#L-3129"><span class="linenos">3129</span></a>
</span><span id="L-3130"><a href="#L-3130"><span class="linenos">3130</span></a>            <span class="n">modify_figure_properties</span><span class="p">(</span>
</span><span id="L-3131"><a href="#L-3131"><span class="linenos">3131</span></a>                <span class="n">fig</span><span class="p">,</span>
</span><span id="L-3132"><a href="#L-3132"><span class="linenos">3132</span></a>                <span class="n">scale_x</span><span class="o">=</span><span class="n">scale_x</span><span class="p">,</span>
</span><span id="L-3133"><a href="#L-3133"><span class="linenos">3133</span></a>                <span class="n">scale_y</span><span class="o">=</span><span class="n">scale_y</span><span class="p">,</span>
</span><span id="L-3134"><a href="#L-3134"><span class="linenos">3134</span></a>                <span class="n">line_width</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span>
</span><span id="L-3135"><a href="#L-3135"><span class="linenos">3135</span></a>                <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
</span><span id="L-3136"><a href="#L-3136"><span class="linenos">3136</span></a>                <span class="n">x_lim</span><span class="o">=</span><span class="n">x_lim</span><span class="p">,</span>
</span><span id="L-3137"><a href="#L-3137"><span class="linenos">3137</span></a>                <span class="n">y_lim</span><span class="o">=</span><span class="n">y_lim</span><span class="p">,</span>
</span><span id="L-3138"><a href="#L-3138"><span class="linenos">3138</span></a>                <span class="n">grid</span><span class="o">=</span><span class="n">grid_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
</span><span id="L-3139"><a href="#L-3139"><span class="linenos">3139</span></a>                <span class="n">legend</span><span class="o">=</span><span class="n">legend_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
</span><span id="L-3140"><a href="#L-3140"><span class="linenos">3140</span></a>                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-3141"><a href="#L-3141"><span class="linenos">3141</span></a>                <span class="n">x_label_rotation</span><span class="o">=</span><span class="n">x_label_rotation</span><span class="p">,</span>
</span><span id="L-3142"><a href="#L-3142"><span class="linenos">3142</span></a>                <span class="n">remove_axes</span><span class="o">=</span><span class="n">remove_axes_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
</span><span id="L-3143"><a href="#L-3143"><span class="linenos">3143</span></a>                <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span>
</span><span id="L-3144"><a href="#L-3144"><span class="linenos">3144</span></a>                <span class="n">text_color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
</span><span id="L-3145"><a href="#L-3145"><span class="linenos">3145</span></a>                <span class="n">line_color</span><span class="o">=</span><span class="n">line_color</span>
</span><span id="L-3146"><a href="#L-3146"><span class="linenos">3146</span></a>            <span class="p">)</span>
</span><span id="L-3147"><a href="#L-3147"><span class="linenos">3147</span></a>            <span class="n">display_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-3148"><a href="#L-3148"><span class="linenos">3148</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-3149"><a href="#L-3149"><span class="linenos">3149</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input; please enter numeric values.&quot;</span><span class="p">)</span>
</span><span id="L-3150"><a href="#L-3150"><span class="linenos">3150</span></a>
</span><span id="L-3151"><a href="#L-3151"><span class="linenos">3151</span></a>    <span class="k">def</span> <span class="nf">toggle_spleens</span><span class="p">():</span>
</span><span id="L-3152"><a href="#L-3152"><span class="linenos">3152</span></a>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="L-3153"><a href="#L-3153"><span class="linenos">3153</span></a>            <span class="k">if</span> <span class="n">spleens_var</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-3154"><a href="#L-3154"><span class="linenos">3154</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3155"><a href="#L-3155"><span class="linenos">3155</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3156"><a href="#L-3156"><span class="linenos">3156</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3157"><a href="#L-3157"><span class="linenos">3157</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3158"><a href="#L-3158"><span class="linenos">3158</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-3159"><a href="#L-3159"><span class="linenos">3159</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-3160"><a href="#L-3160"><span class="linenos">3160</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-3161"><a href="#L-3161"><span class="linenos">3161</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3162"><a href="#L-3162"><span class="linenos">3162</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3163"><a href="#L-3163"><span class="linenos">3163</span></a>            <span class="n">display_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-3164"><a href="#L-3164"><span class="linenos">3164</span></a>
</span><span id="L-3165"><a href="#L-3165"><span class="linenos">3165</span></a>    <span class="c1"># Create a new window for user input</span>
</span><span id="L-3166"><a href="#L-3166"><span class="linenos">3166</span></a>    <span class="n">modify_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">()</span>
</span><span id="L-3167"><a href="#L-3167"><span class="linenos">3167</span></a>    <span class="n">modify_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Modify Figure Properties&quot;</span><span class="p">)</span>
</span><span id="L-3168"><a href="#L-3168"><span class="linenos">3168</span></a>
</span><span id="L-3169"><a href="#L-3169"><span class="linenos">3169</span></a>    <span class="c1"># Apply dark style to the popup window</span>
</span><span id="L-3170"><a href="#L-3170"><span class="linenos">3170</span></a>    <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="L-3171"><a href="#L-3171"><span class="linenos">3171</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TCheckbutton&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">selectcolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</span><span id="L-3172"><a href="#L-3172"><span class="linenos">3172</span></a>
</span><span id="L-3173"><a href="#L-3173"><span class="linenos">3173</span></a>    <span class="n">modify_window</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">)</span>
</span><span id="L-3174"><a href="#L-3174"><span class="linenos">3174</span></a>
</span><span id="L-3175"><a href="#L-3175"><span class="linenos">3175</span></a>    <span class="c1"># Create and style the input fields</span>
</span><span id="L-3176"><a href="#L-3176"><span class="linenos">3176</span></a>    <span class="n">scale_x_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3177"><a href="#L-3177"><span class="linenos">3177</span></a>    <span class="n">scale_y_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3178"><a href="#L-3178"><span class="linenos">3178</span></a>    <span class="n">line_width_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3179"><a href="#L-3179"><span class="linenos">3179</span></a>    <span class="n">font_size_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3180"><a href="#L-3180"><span class="linenos">3180</span></a>    <span class="n">x_lim_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3181"><a href="#L-3181"><span class="linenos">3181</span></a>    <span class="n">y_lim_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3182"><a href="#L-3182"><span class="linenos">3182</span></a>    <span class="n">title_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3183"><a href="#L-3183"><span class="linenos">3183</span></a>    <span class="n">bg_color_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3184"><a href="#L-3184"><span class="linenos">3184</span></a>    <span class="n">text_color_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3185"><a href="#L-3185"><span class="linenos">3185</span></a>    <span class="n">line_color_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3186"><a href="#L-3186"><span class="linenos">3186</span></a>    <span class="n">x_label_rotation_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="L-3187"><a href="#L-3187"><span class="linenos">3187</span></a>    <span class="n">remove_axes_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="L-3188"><a href="#L-3188"><span class="linenos">3188</span></a>    <span class="n">grid_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="L-3189"><a href="#L-3189"><span class="linenos">3189</span></a>    <span class="n">legend_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="L-3190"><a href="#L-3190"><span class="linenos">3190</span></a>    <span class="n">spleens_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="L-3191"><a href="#L-3191"><span class="linenos">3191</span></a>
</span><span id="L-3192"><a href="#L-3192"><span class="linenos">3192</span></a>    <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-3193"><a href="#L-3193"><span class="linenos">3193</span></a>        <span class="p">(</span><span class="s2">&quot;Rescale X:&quot;</span><span class="p">,</span> <span class="n">scale_x_var</span><span class="p">),</span>
</span><span id="L-3194"><a href="#L-3194"><span class="linenos">3194</span></a>        <span class="p">(</span><span class="s2">&quot;Rescale Y:&quot;</span><span class="p">,</span> <span class="n">scale_y_var</span><span class="p">),</span>
</span><span id="L-3195"><a href="#L-3195"><span class="linenos">3195</span></a>        <span class="p">(</span><span class="s2">&quot;Line Width:&quot;</span><span class="p">,</span> <span class="n">line_width_var</span><span class="p">),</span>
</span><span id="L-3196"><a href="#L-3196"><span class="linenos">3196</span></a>        <span class="p">(</span><span class="s2">&quot;Font Size:&quot;</span><span class="p">,</span> <span class="n">font_size_var</span><span class="p">),</span>
</span><span id="L-3197"><a href="#L-3197"><span class="linenos">3197</span></a>        <span class="p">(</span><span class="s2">&quot;X Axis Limits (tuple):&quot;</span><span class="p">,</span> <span class="n">x_lim_var</span><span class="p">),</span>
</span><span id="L-3198"><a href="#L-3198"><span class="linenos">3198</span></a>        <span class="p">(</span><span class="s2">&quot;Y Axis Limits (tuple):&quot;</span><span class="p">,</span> <span class="n">y_lim_var</span><span class="p">),</span>
</span><span id="L-3199"><a href="#L-3199"><span class="linenos">3199</span></a>        <span class="p">(</span><span class="s2">&quot;Title:&quot;</span><span class="p">,</span> <span class="n">title_var</span><span class="p">),</span>
</span><span id="L-3200"><a href="#L-3200"><span class="linenos">3200</span></a>        <span class="p">(</span><span class="s2">&quot;X Label Rotation (degrees):&quot;</span><span class="p">,</span> <span class="n">x_label_rotation_var</span><span class="p">),</span>
</span><span id="L-3201"><a href="#L-3201"><span class="linenos">3201</span></a>        <span class="p">(</span><span class="s2">&quot;Background Color:&quot;</span><span class="p">,</span> <span class="n">bg_color_var</span><span class="p">),</span>
</span><span id="L-3202"><a href="#L-3202"><span class="linenos">3202</span></a>        <span class="p">(</span><span class="s2">&quot;Text Color:&quot;</span><span class="p">,</span> <span class="n">text_color_var</span><span class="p">),</span>
</span><span id="L-3203"><a href="#L-3203"><span class="linenos">3203</span></a>        <span class="p">(</span><span class="s2">&quot;Line Color:&quot;</span><span class="p">,</span> <span class="n">line_color_var</span><span class="p">)</span>
</span><span id="L-3204"><a href="#L-3204"><span class="linenos">3204</span></a>    <span class="p">]</span>
</span><span id="L-3205"><a href="#L-3205"><span class="linenos">3205</span></a>
</span><span id="L-3206"><a href="#L-3206"><span class="linenos">3206</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label_text</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
</span><span id="L-3207"><a href="#L-3207"><span class="linenos">3207</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-3208"><a href="#L-3208"><span class="linenos">3208</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-3209"><a href="#L-3209"><span class="linenos">3209</span></a>
</span><span id="L-3210"><a href="#L-3210"><span class="linenos">3210</span></a>    <span class="n">checkboxes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-3211"><a href="#L-3211"><span class="linenos">3211</span></a>        <span class="p">(</span><span class="s2">&quot;Grid&quot;</span><span class="p">,</span> <span class="n">grid_var</span><span class="p">),</span>
</span><span id="L-3212"><a href="#L-3212"><span class="linenos">3212</span></a>        <span class="p">(</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="n">legend_var</span><span class="p">),</span>
</span><span id="L-3213"><a href="#L-3213"><span class="linenos">3213</span></a>        <span class="p">(</span><span class="s2">&quot;Spleens&quot;</span><span class="p">,</span> <span class="n">spleens_var</span><span class="p">),</span>
</span><span id="L-3214"><a href="#L-3214"><span class="linenos">3214</span></a>        <span class="p">(</span><span class="s2">&quot;Remove Axes&quot;</span><span class="p">,</span> <span class="n">remove_axes_var</span><span class="p">)</span>
</span><span id="L-3215"><a href="#L-3215"><span class="linenos">3215</span></a>    <span class="p">]</span>
</span><span id="L-3216"><a href="#L-3216"><span class="linenos">3216</span></a>
</span><span id="L-3217"><a href="#L-3217"><span class="linenos">3217</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label_text</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">checkboxes</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)):</span>
</span><span id="L-3218"><a href="#L-3218"><span class="linenos">3218</span></a>        <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;TCheckbutton&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-3219"><a href="#L-3219"><span class="linenos">3219</span></a>
</span><span id="L-3220"><a href="#L-3220"><span class="linenos">3220</span></a>    <span class="n">spleens_var</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">toggle_spleens</span><span class="p">())</span>
</span><span id="L-3221"><a href="#L-3221"><span class="linenos">3221</span></a>
</span><span id="L-3222"><a href="#L-3222"><span class="linenos">3222</span></a>    <span class="c1"># Apply button</span>
</span><span id="L-3223"><a href="#L-3223"><span class="linenos">3223</span></a>    <span class="n">apply_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">apply_modifications</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="L-3224"><a href="#L-3224"><span class="linenos">3224</span></a>    <span class="n">apply_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkboxes</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-3225"><a href="#L-3225"><span class="linenos">3225</span></a>
</span><span id="L-3226"><a href="#L-3226"><span class="linenos">3226</span></a><span class="k">def</span> <span class="nf">generate_dna_matrix</span><span class="p">(</span><span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;dna_matrix.gif&#39;</span><span class="p">,</span> <span class="n">canvas_width</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">canvas_height</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">base_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">transition_frames</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">enhance</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">lowercase_prob</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
</span><span id="L-3227"><a href="#L-3227"><span class="linenos">3227</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3228"><a href="#L-3228"><span class="linenos">3228</span></a><span class="sd">    Generate a DNA matrix animation and save it as GIF, MP4, or AVI using OpenCV for videos.</span>
</span><span id="L-3229"><a href="#L-3229"><span class="linenos">3229</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3230"><a href="#L-3230"><span class="linenos">3230</span></a>
</span><span id="L-3231"><a href="#L-3231"><span class="linenos">3231</span></a>    <span class="k">def</span> <span class="nf">save_output</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="n">output_format</span><span class="p">):</span>
</span><span id="L-3232"><a href="#L-3232"><span class="linenos">3232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the animation based on output format.&quot;&quot;&quot;</span>
</span><span id="L-3233"><a href="#L-3233"><span class="linenos">3233</span></a>        <span class="k">if</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="s1">&#39;.avi&#39;</span><span class="p">]:</span>
</span><span id="L-3234"><a href="#L-3234"><span class="linenos">3234</span></a>            <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">frames</span><span class="p">]</span>
</span><span id="L-3235"><a href="#L-3235"><span class="linenos">3235</span></a>            <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="s1">&#39;mp4v&#39;</span> <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;.mp4&#39;</span> <span class="k">else</span> <span class="s1">&#39;XVID&#39;</span><span class="p">))</span>
</span><span id="L-3236"><a href="#L-3236"><span class="linenos">3236</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">))</span>
</span><span id="L-3237"><a href="#L-3237"><span class="linenos">3237</span></a>            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
</span><span id="L-3238"><a href="#L-3238"><span class="linenos">3238</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">))</span>
</span><span id="L-3239"><a href="#L-3239"><span class="linenos">3239</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-3240"><a href="#L-3240"><span class="linenos">3240</span></a>        <span class="k">elif</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;.gif&#39;</span><span class="p">:</span>
</span><span id="L-3241"><a href="#L-3241"><span class="linenos">3241</span></a>            <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">duration</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="n">fps</span><span class="p">),</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-3242"><a href="#L-3242"><span class="linenos">3242</span></a>
</span><span id="L-3243"><a href="#L-3243"><span class="linenos">3243</span></a>    <span class="k">def</span> <span class="nf">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-3244"><a href="#L-3244"><span class="linenos">3244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws a DNA base at the specified position.&quot;&quot;&quot;</span>
</span><span id="L-3245"><a href="#L-3245"><span class="linenos">3245</span></a>        <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">col_idx</span> <span class="o">*</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">base_position</span> <span class="o">*</span> <span class="n">base_size</span><span class="p">),</span> <span class="n">base</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="o">*</span><span class="n">fill_color</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="L-3246"><a href="#L-3246"><span class="linenos">3246</span></a>
</span><span id="L-3247"><a href="#L-3247"><span class="linenos">3247</span></a>    <span class="c1"># Setup variables</span>
</span><span id="L-3248"><a href="#L-3248"><span class="linenos">3248</span></a>    <span class="n">num_frames</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">*</span> <span class="n">fps</span>
</span><span id="L-3249"><a href="#L-3249"><span class="linenos">3249</span></a>    <span class="n">num_columns</span> <span class="o">=</span> <span class="n">canvas_width</span> <span class="o">//</span> <span class="n">base_size</span>
</span><span id="L-3250"><a href="#L-3250"><span class="linenos">3250</span></a>    <span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
</span><span id="L-3251"><a href="#L-3251"><span class="linenos">3251</span></a>    <span class="n">active_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">155</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">155</span><span class="p">)</span>
</span><span id="L-3252"><a href="#L-3252"><span class="linenos">3252</span></a>    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="L-3253"><a href="#L-3253"><span class="linenos">3253</span></a>    <span class="n">base_colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">}</span>
</span><span id="L-3254"><a href="#L-3254"><span class="linenos">3254</span></a>
</span><span id="L-3255"><a href="#L-3255"><span class="linenos">3255</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">output_format</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</span><span id="L-3256"><a href="#L-3256"><span class="linenos">3256</span></a>    
</span><span id="L-3257"><a href="#L-3257"><span class="linenos">3257</span></a>    <span class="c1"># Initialize font</span>
</span><span id="L-3258"><a href="#L-3258"><span class="linenos">3258</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-3259"><a href="#L-3259"><span class="linenos">3259</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">font_type</span><span class="p">,</span> <span class="n">base_size</span><span class="p">)</span>
</span><span id="L-3260"><a href="#L-3260"><span class="linenos">3260</span></a>    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
</span><span id="L-3261"><a href="#L-3261"><span class="linenos">3261</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">load_default</span><span class="p">()</span>
</span><span id="L-3262"><a href="#L-3262"><span class="linenos">3262</span></a>
</span><span id="L-3263"><a href="#L-3263"><span class="linenos">3263</span></a>    <span class="c1"># DNA string and positions</span>
</span><span id="L-3264"><a href="#L-3264"><span class="linenos">3264</span></a>    <span class="n">string_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)]</span>
</span><span id="L-3265"><a href="#L-3265"><span class="linenos">3265</span></a>    <span class="n">visible_bases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_columns</span>
</span><span id="L-3266"><a href="#L-3266"><span class="linenos">3266</span></a>    <span class="n">base_positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="n">canvas_height</span> <span class="o">//</span> <span class="n">base_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)]</span>
</span><span id="L-3267"><a href="#L-3267"><span class="linenos">3267</span></a>    <span class="n">column_strings</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)]</span>
</span><span id="L-3268"><a href="#L-3268"><span class="linenos">3268</span></a>    <span class="n">random_white_sequences</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_columns</span>
</span><span id="L-3269"><a href="#L-3269"><span class="linenos">3269</span></a>
</span><span id="L-3270"><a href="#L-3270"><span class="linenos">3270</span></a>    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-3271"><a href="#L-3271"><span class="linenos">3271</span></a>    <span class="n">end_frame_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_frames</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-3272"><a href="#L-3272"><span class="linenos">3272</span></a>
</span><span id="L-3273"><a href="#L-3273"><span class="linenos">3273</span></a>    <span class="k">for</span> <span class="n">frame_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_frames</span><span class="p">):</span>
</span><span id="L-3274"><a href="#L-3274"><span class="linenos">3274</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="L-3275"><a href="#L-3275"><span class="linenos">3275</span></a>        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-3276"><a href="#L-3276"><span class="linenos">3276</span></a>
</span><span id="L-3277"><a href="#L-3277"><span class="linenos">3277</span></a>        <span class="k">for</span> <span class="n">col_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">):</span>
</span><span id="L-3278"><a href="#L-3278"><span class="linenos">3278</span></a>            <span class="k">if</span> <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">canvas_height</span> <span class="o">//</span> <span class="n">base_size</span> <span class="ow">and</span> <span class="n">frame_idx</span> <span class="o">&lt;</span> <span class="n">end_frame_start</span><span class="p">:</span>
</span><span id="L-3279"><a href="#L-3279"><span class="linenos">3279</span></a>                <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="L-3280"><a href="#L-3280"><span class="linenos">3280</span></a>                <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span>
</span><span id="L-3281"><a href="#L-3281"><span class="linenos">3281</span></a>                <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-3282"><a href="#L-3282"><span class="linenos">3282</span></a>                <span class="c1"># Randomly choose whether to make each base lowercase</span>
</span><span id="L-3283"><a href="#L-3283"><span class="linenos">3283</span></a>                <span class="n">column_strings</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-3284"><a href="#L-3284"><span class="linenos">3284</span></a>                    <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="n">base</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">base</span><span class="p">])</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">lowercase_prob</span> <span class="k">else</span> <span class="n">base</span>
</span><span id="L-3285"><a href="#L-3285"><span class="linenos">3285</span></a>                    <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bases</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">])]</span>
</span><span id="L-3286"><a href="#L-3286"><span class="linenos">3286</span></a>                <span class="p">]</span>
</span><span id="L-3287"><a href="#L-3287"><span class="linenos">3287</span></a>                <span class="k">if</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-3288"><a href="#L-3288"><span class="linenos">3288</span></a>                    <span class="n">random_start</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="L-3289"><a href="#L-3289"><span class="linenos">3289</span></a>                    <span class="n">random_white_sequences</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">random_start</span><span class="p">,</span> <span class="n">random_start</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="L-3290"><a href="#L-3290"><span class="linenos">3290</span></a>
</span><span id="L-3291"><a href="#L-3291"><span class="linenos">3291</span></a>            <span class="n">last_10_percent_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">))</span>
</span><span id="L-3292"><a href="#L-3292"><span class="linenos">3292</span></a>            
</span><span id="L-3293"><a href="#L-3293"><span class="linenos">3293</span></a>            <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">],</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">])):</span>
</span><span id="L-3294"><a href="#L-3294"><span class="linenos">3294</span></a>                <span class="n">base_position</span> <span class="o">=</span> <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">row_idx</span>
</span><span id="L-3295"><a href="#L-3295"><span class="linenos">3295</span></a>                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">base_position</span> <span class="o">*</span> <span class="n">base_size</span> <span class="o">&lt;</span> <span class="n">canvas_height</span><span class="p">:</span>
</span><span id="L-3296"><a href="#L-3296"><span class="linenos">3296</span></a>                    <span class="n">base</span> <span class="o">=</span> <span class="n">column_strings</span><span class="p">[</span><span class="n">col_idx</span><span class="p">][</span><span class="n">row_idx</span><span class="p">]</span>
</span><span id="L-3297"><a href="#L-3297"><span class="linenos">3297</span></a>                    <span class="k">if</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-3298"><a href="#L-3298"><span class="linenos">3298</span></a>                        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-3299"><a href="#L-3299"><span class="linenos">3299</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-3300"><a href="#L-3300"><span class="linenos">3300</span></a>                        <span class="k">elif</span> <span class="n">row_idx</span> <span class="o">&gt;=</span> <span class="n">last_10_percent_start</span><span class="p">:</span>
</span><span id="L-3301"><a href="#L-3301"><span class="linenos">3301</span></a>                            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(((</span><span class="n">row_idx</span> <span class="o">-</span> <span class="n">last_10_percent_start</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">last_10_percent_start</span><span class="p">))</span> <span class="o">*</span> <span class="mi">127</span><span class="p">)</span>
</span><span id="L-3302"><a href="#L-3302"><span class="linenos">3302</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">base_colors</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
</span><span id="L-3303"><a href="#L-3303"><span class="linenos">3303</span></a>                        <span class="k">elif</span> <span class="n">random_white_sequences</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="n">random_white_sequences</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]:</span>
</span><span id="L-3304"><a href="#L-3304"><span class="linenos">3304</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="L-3305"><a href="#L-3305"><span class="linenos">3305</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-3306"><a href="#L-3306"><span class="linenos">3306</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">base_colors</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
</span><span id="L-3307"><a href="#L-3307"><span class="linenos">3307</span></a>
</span><span id="L-3308"><a href="#L-3308"><span class="linenos">3308</span></a>            <span class="k">if</span> <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]:</span>
</span><span id="L-3309"><a href="#L-3309"><span class="linenos">3309</span></a>                <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-3310"><a href="#L-3310"><span class="linenos">3310</span></a>            <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="L-3311"><a href="#L-3311"><span class="linenos">3311</span></a>
</span><span id="L-3312"><a href="#L-3312"><span class="linenos">3312</span></a>        <span class="c1"># Convert the image to numpy array to check unique pixel values</span>
</span><span id="L-3313"><a href="#L-3313"><span class="linenos">3313</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-3314"><a href="#L-3314"><span class="linenos">3314</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">img_array</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Only append frames with more than two unique pixel values (avoid black frames)</span>
</span><span id="L-3315"><a href="#L-3315"><span class="linenos">3315</span></a>            <span class="c1"># Enhance contrast and saturation</span>
</span><span id="L-3316"><a href="#L-3316"><span class="linenos">3316</span></a>            <span class="k">if</span> <span class="n">enhance</span><span class="p">:</span>
</span><span id="L-3317"><a href="#L-3317"><span class="linenos">3317</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Brightness</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>   <span class="c1"># Slightly increase brightness</span>
</span><span id="L-3318"><a href="#L-3318"><span class="linenos">3318</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Sharpness</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>    <span class="c1"># Sharpen the image</span>
</span><span id="L-3319"><a href="#L-3319"><span class="linenos">3319</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Contrast</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>     <span class="c1"># Enhance contrast</span>
</span><span id="L-3320"><a href="#L-3320"><span class="linenos">3320</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>        <span class="c1"># Boost color saturation </span>
</span><span id="L-3321"><a href="#L-3321"><span class="linenos">3321</span></a>
</span><span id="L-3322"><a href="#L-3322"><span class="linenos">3322</span></a>            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-3323"><a href="#L-3323"><span class="linenos">3323</span></a>
</span><span id="L-3324"><a href="#L-3324"><span class="linenos">3324</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">transition_frames</span><span class="p">):</span>
</span><span id="L-3325"><a href="#L-3325"><span class="linenos">3325</span></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">transition_frames</span><span class="p">)</span>
</span><span id="L-3326"><a href="#L-3326"><span class="linenos">3326</span></a>        <span class="n">transition_frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="p">)</span>
</span><span id="L-3327"><a href="#L-3327"><span class="linenos">3327</span></a>        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition_frame</span><span class="p">)</span>
</span><span id="L-3328"><a href="#L-3328"><span class="linenos">3328</span></a>
</span><span id="L-3329"><a href="#L-3329"><span class="linenos">3329</span></a>    <span class="n">save_output</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="fig">
                    <div class="attr variable">
            <span class="name">fig</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#fig"></a>
    
    

                </section>
                <section id="restart_gui_app">
                            <input id="restart_gui_app-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">restart_gui_app</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">root</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="restart_gui_app-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#restart_gui_app"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="restart_gui_app-28"><a href="#restart_gui_app-28"><span class="linenos">28</span></a><span class="k">def</span> <span class="nf">restart_gui_app</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span><span id="restart_gui_app-29"><a href="#restart_gui_app-29"><span class="linenos">29</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="restart_gui_app-30"><a href="#restart_gui_app-30"><span class="linenos">30</span></a><span class="sd">    Restarts the GUI application by destroying the current instance</span>
</span><span id="restart_gui_app-31"><a href="#restart_gui_app-31"><span class="linenos">31</span></a><span class="sd">    and launching a fresh one.</span>
</span><span id="restart_gui_app-32"><a href="#restart_gui_app-32"><span class="linenos">32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="restart_gui_app-33"><a href="#restart_gui_app-33"><span class="linenos">33</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="restart_gui_app-34"><a href="#restart_gui_app-34"><span class="linenos">34</span></a>        <span class="c1"># Destroy the current root window</span>
</span><span id="restart_gui_app-35"><a href="#restart_gui_app-35"><span class="linenos">35</span></a>        <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="restart_gui_app-36"><a href="#restart_gui_app-36"><span class="linenos">36</span></a>        
</span><span id="restart_gui_app-37"><a href="#restart_gui_app-37"><span class="linenos">37</span></a>        <span class="c1"># Import and launch a new instance of the application</span>
</span><span id="restart_gui_app-38"><a href="#restart_gui_app-38"><span class="linenos">38</span></a>        <span class="kn">from</span> <span class="nn">spacr.gui</span> <span class="kn">import</span> <span class="n">gui_app</span>
</span><span id="restart_gui_app-39"><a href="#restart_gui_app-39"><span class="linenos">39</span></a>        <span class="n">new_root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>  <span class="c1"># Create a fresh Tkinter root instance</span>
</span><span id="restart_gui_app-40"><a href="#restart_gui_app-40"><span class="linenos">40</span></a>        <span class="n">gui_app</span><span class="p">()</span>
</span><span id="restart_gui_app-41"><a href="#restart_gui_app-41"><span class="linenos">41</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="restart_gui_app-42"><a href="#restart_gui_app-42"><span class="linenos">42</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error restarting GUI application: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Restarts the GUI application by destroying the current instance
and launching a fresh one.</p>
</div>


                </section>
                <section id="create_menu_bar">
                            <input id="create_menu_bar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_menu_bar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">root</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_menu_bar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_menu_bar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_menu_bar-44"><a href="#create_menu_bar-44"><span class="linenos">44</span></a><span class="k">def</span> <span class="nf">create_menu_bar</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span><span id="create_menu_bar-45"><a href="#create_menu_bar-45"><span class="linenos">45</span></a>    <span class="kn">from</span> <span class="nn">.gui</span> <span class="kn">import</span> <span class="n">initiate_root</span>
</span><span id="create_menu_bar-46"><a href="#create_menu_bar-46"><span class="linenos">46</span></a>    <span class="n">gui_apps</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="create_menu_bar-47"><a href="#create_menu_bar-47"><span class="linenos">47</span></a>        <span class="s2">&quot;Mask&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;mask&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-48"><a href="#create_menu_bar-48"><span class="linenos">48</span></a>        <span class="s2">&quot;Measure&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;measure&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-49"><a href="#create_menu_bar-49"><span class="linenos">49</span></a>        <span class="s2">&quot;Annotate&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-50"><a href="#create_menu_bar-50"><span class="linenos">50</span></a>        <span class="s2">&quot;Make Masks&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;make_masks&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-51"><a href="#create_menu_bar-51"><span class="linenos">51</span></a>        <span class="s2">&quot;Classify&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;classify&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-52"><a href="#create_menu_bar-52"><span class="linenos">52</span></a>        <span class="s2">&quot;Umap&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;umap&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-53"><a href="#create_menu_bar-53"><span class="linenos">53</span></a>        <span class="s2">&quot;Train Cellpose&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;train_cellpose&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-54"><a href="#create_menu_bar-54"><span class="linenos">54</span></a>        <span class="s2">&quot;ML Analyze&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;ml_analyze&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-55"><a href="#create_menu_bar-55"><span class="linenos">55</span></a>        <span class="s2">&quot;Cellpose Masks&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;cellpose_masks&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-56"><a href="#create_menu_bar-56"><span class="linenos">56</span></a>        <span class="s2">&quot;Cellpose All&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;cellpose_all&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-57"><a href="#create_menu_bar-57"><span class="linenos">57</span></a>        <span class="s2">&quot;Map Barcodes&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;map_barcodes&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-58"><a href="#create_menu_bar-58"><span class="linenos">58</span></a>        <span class="s2">&quot;Regression&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-59"><a href="#create_menu_bar-59"><span class="linenos">59</span></a>        <span class="s2">&quot;Activation&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;activation&#39;</span><span class="p">),</span>
</span><span id="create_menu_bar-60"><a href="#create_menu_bar-60"><span class="linenos">60</span></a>        <span class="s2">&quot;Recruitment&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">initiate_root</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">settings_type</span><span class="o">=</span><span class="s1">&#39;recruitment&#39;</span><span class="p">)</span>
</span><span id="create_menu_bar-61"><a href="#create_menu_bar-61"><span class="linenos">61</span></a>    <span class="p">}</span>
</span><span id="create_menu_bar-62"><a href="#create_menu_bar-62"><span class="linenos">62</span></a>
</span><span id="create_menu_bar-63"><a href="#create_menu_bar-63"><span class="linenos">63</span></a>    <span class="c1"># Create the menu bar</span>
</span><span id="create_menu_bar-64"><a href="#create_menu_bar-64"><span class="linenos">64</span></a>    <span class="n">menu_bar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="create_menu_bar-65"><a href="#create_menu_bar-65"><span class="linenos">65</span></a>
</span><span id="create_menu_bar-66"><a href="#create_menu_bar-66"><span class="linenos">66</span></a>    <span class="c1"># Create a &quot;SpaCr Applications&quot; menu</span>
</span><span id="create_menu_bar-67"><a href="#create_menu_bar-67"><span class="linenos">67</span></a>    <span class="n">app_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menu_bar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="create_menu_bar-68"><a href="#create_menu_bar-68"><span class="linenos">68</span></a>    <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;SpaCr Applications&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">app_menu</span><span class="p">)</span>
</span><span id="create_menu_bar-69"><a href="#create_menu_bar-69"><span class="linenos">69</span></a>
</span><span id="create_menu_bar-70"><a href="#create_menu_bar-70"><span class="linenos">70</span></a>    <span class="c1"># Add options to the &quot;SpaCr Applications&quot; menu</span>
</span><span id="create_menu_bar-71"><a href="#create_menu_bar-71"><span class="linenos">71</span></a>    <span class="k">for</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">app_func</span> <span class="ow">in</span> <span class="n">gui_apps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="create_menu_bar-72"><a href="#create_menu_bar-72"><span class="linenos">72</span></a>        <span class="n">app_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span>
</span><span id="create_menu_bar-73"><a href="#create_menu_bar-73"><span class="linenos">73</span></a>            <span class="n">label</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
</span><span id="create_menu_bar-74"><a href="#create_menu_bar-74"><span class="linenos">74</span></a>            <span class="n">command</span><span class="o">=</span><span class="n">app_func</span>
</span><span id="create_menu_bar-75"><a href="#create_menu_bar-75"><span class="linenos">75</span></a>        <span class="p">)</span>
</span><span id="create_menu_bar-76"><a href="#create_menu_bar-76"><span class="linenos">76</span></a>
</span><span id="create_menu_bar-77"><a href="#create_menu_bar-77"><span class="linenos">77</span></a>    <span class="c1"># Add a separator and an exit option</span>
</span><span id="create_menu_bar-78"><a href="#create_menu_bar-78"><span class="linenos">78</span></a>    <span class="n">app_menu</span><span class="o">.</span><span class="n">add_separator</span><span class="p">()</span>
</span><span id="create_menu_bar-79"><a href="#create_menu_bar-79"><span class="linenos">79</span></a>    <span class="c1">#app_menu.add_command(label=&quot;Home&quot;,command=lambda: restart_gui_app(root))</span>
</span><span id="create_menu_bar-80"><a href="#create_menu_bar-80"><span class="linenos">80</span></a>    <span class="n">app_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Help&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;https://spacr.readthedocs.io/en/latest/?badge=latest&quot;</span><span class="p">))</span>
</span><span id="create_menu_bar-81"><a href="#create_menu_bar-81"><span class="linenos">81</span></a>    <span class="n">app_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
</span><span id="create_menu_bar-82"><a href="#create_menu_bar-82"><span class="linenos">82</span></a>
</span><span id="create_menu_bar-83"><a href="#create_menu_bar-83"><span class="linenos">83</span></a>    <span class="c1"># Configure the menu for the root window</span>
</span><span id="create_menu_bar-84"><a href="#create_menu_bar-84"><span class="linenos">84</span></a>    <span class="n">root</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="n">menu_bar</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="set_element_size">
                            <input id="set_element_size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_element_size</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="set_element_size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_element_size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_element_size-86"><a href="#set_element_size-86"><span class="linenos"> 86</span></a><span class="k">def</span> <span class="nf">set_element_size</span><span class="p">():</span>
</span><span id="set_element_size-87"><a href="#set_element_size-87"><span class="linenos"> 87</span></a>
</span><span id="set_element_size-88"><a href="#set_element_size-88"><span class="linenos"> 88</span></a>    <span class="n">screen_width</span><span class="p">,</span> <span class="n">screen_height</span> <span class="o">=</span> <span class="n">pyautogui</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</span><span id="set_element_size-89"><a href="#set_element_size-89"><span class="linenos"> 89</span></a>    <span class="n">screen_area</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">*</span> <span class="n">screen_height</span>
</span><span id="set_element_size-90"><a href="#set_element_size-90"><span class="linenos"> 90</span></a>    
</span><span id="set_element_size-91"><a href="#set_element_size-91"><span class="linenos"> 91</span></a>    <span class="c1"># Calculate sizes based on screen dimensions</span>
</span><span id="set_element_size-92"><a href="#set_element_size-92"><span class="linenos"> 92</span></a>    <span class="n">btn_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">screen_area</span> <span class="o">*</span> <span class="mf">0.002</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Button size as a fraction of screen area</span>
</span><span id="set_element_size-93"><a href="#set_element_size-93"><span class="linenos"> 93</span></a>    <span class="n">bar_size</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">20</span>  <span class="c1"># Bar size based on screen height</span>
</span><span id="set_element_size-94"><a href="#set_element_size-94"><span class="linenos"> 94</span></a>    <span class="n">settings_width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="mi">4</span>  <span class="c1"># Settings panel width as a fraction of screen width</span>
</span><span id="set_element_size-95"><a href="#set_element_size-95"><span class="linenos"> 95</span></a>    <span class="n">panel_width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">-</span> <span class="n">settings_width</span>  <span class="c1"># Panel width as a fraction of screen width</span>
</span><span id="set_element_size-96"><a href="#set_element_size-96"><span class="linenos"> 96</span></a>    <span class="n">panel_height</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">6</span>  <span class="c1"># Panel height as a fraction of screen height</span>
</span><span id="set_element_size-97"><a href="#set_element_size-97"><span class="linenos"> 97</span></a>    
</span><span id="set_element_size-98"><a href="#set_element_size-98"><span class="linenos"> 98</span></a>    <span class="n">size_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="set_element_size-99"><a href="#set_element_size-99"><span class="linenos"> 99</span></a>        <span class="s1">&#39;btn_size&#39;</span><span class="p">:</span> <span class="n">btn_size</span><span class="p">,</span>
</span><span id="set_element_size-100"><a href="#set_element_size-100"><span class="linenos">100</span></a>        <span class="s1">&#39;bar_size&#39;</span><span class="p">:</span> <span class="n">bar_size</span><span class="p">,</span>
</span><span id="set_element_size-101"><a href="#set_element_size-101"><span class="linenos">101</span></a>        <span class="s1">&#39;settings_width&#39;</span><span class="p">:</span> <span class="n">settings_width</span><span class="p">,</span>
</span><span id="set_element_size-102"><a href="#set_element_size-102"><span class="linenos">102</span></a>        <span class="s1">&#39;panel_width&#39;</span><span class="p">:</span> <span class="n">panel_width</span><span class="p">,</span>
</span><span id="set_element_size-103"><a href="#set_element_size-103"><span class="linenos">103</span></a>        <span class="s1">&#39;panel_height&#39;</span><span class="p">:</span> <span class="n">panel_height</span>
</span><span id="set_element_size-104"><a href="#set_element_size-104"><span class="linenos">104</span></a>    <span class="p">}</span>
</span><span id="set_element_size-105"><a href="#set_element_size-105"><span class="linenos">105</span></a>    <span class="k">return</span> <span class="n">size_dict</span>
</span></pre></div>


    

                </section>
                <section id="set_dark_style">
                            <input id="set_dark_style-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_dark_style</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">style</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">containers</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">widgets</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">font_family</span><span class="o">=</span><span class="s1">&#39;OpenSans&#39;</span>,</span><span class="param">	<span class="n">font_size</span><span class="o">=</span><span class="mi">12</span>,</span><span class="param">	<span class="n">bg_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">fg_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>,</span><span class="param">	<span class="n">active_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>,</span><span class="param">	<span class="n">inactive_color</span><span class="o">=</span><span class="s1">&#39;dark_gray&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="set_dark_style-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_dark_style"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_dark_style-107"><a href="#set_dark_style-107"><span class="linenos">107</span></a><span class="k">def</span> <span class="nf">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">parent_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;OpenSans&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="o">=</span><span class="s1">&#39;dark_gray&#39;</span><span class="p">):</span>
</span><span id="set_dark_style-108"><a href="#set_dark_style-108"><span class="linenos">108</span></a>
</span><span id="set_dark_style-109"><a href="#set_dark_style-109"><span class="linenos">109</span></a>    <span class="k">if</span> <span class="n">active_color</span> <span class="o">==</span> <span class="s1">&#39;teal&#39;</span><span class="p">:</span>
</span><span id="set_dark_style-110"><a href="#set_dark_style-110"><span class="linenos">110</span></a>        <span class="n">active_color</span> <span class="o">=</span> <span class="s1">&#39;#008080&#39;</span>
</span><span id="set_dark_style-111"><a href="#set_dark_style-111"><span class="linenos">111</span></a>    <span class="k">if</span> <span class="n">inactive_color</span> <span class="o">==</span> <span class="s1">&#39;dark_gray&#39;</span><span class="p">:</span>
</span><span id="set_dark_style-112"><a href="#set_dark_style-112"><span class="linenos">112</span></a>        <span class="n">inactive_color</span> <span class="o">=</span> <span class="s1">&#39;#2B2B2B&#39;</span> <span class="c1"># &#39;#333333&#39; #&#39;#050505&#39;</span>
</span><span id="set_dark_style-113"><a href="#set_dark_style-113"><span class="linenos">113</span></a>    <span class="k">if</span> <span class="n">bg_color</span> <span class="o">==</span> <span class="s1">&#39;black&#39;</span><span class="p">:</span>
</span><span id="set_dark_style-114"><a href="#set_dark_style-114"><span class="linenos">114</span></a>        <span class="n">bg_color</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
</span><span id="set_dark_style-115"><a href="#set_dark_style-115"><span class="linenos">115</span></a>    <span class="k">if</span> <span class="n">fg_color</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span><span class="p">:</span>
</span><span id="set_dark_style-116"><a href="#set_dark_style-116"><span class="linenos">116</span></a>        <span class="n">fg_color</span> <span class="o">=</span> <span class="s1">&#39;#ffffff&#39;</span>
</span><span id="set_dark_style-117"><a href="#set_dark_style-117"><span class="linenos">117</span></a>    <span class="k">if</span> <span class="n">active_color</span> <span class="o">==</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span>
</span><span id="set_dark_style-118"><a href="#set_dark_style-118"><span class="linenos">118</span></a>        <span class="n">active_color</span> <span class="o">=</span> <span class="s1">&#39;#007BFF&#39;</span>
</span><span id="set_dark_style-119"><a href="#set_dark_style-119"><span class="linenos">119</span></a>
</span><span id="set_dark_style-120"><a href="#set_dark_style-120"><span class="linenos">120</span></a>    <span class="n">padding</span> <span class="o">=</span> <span class="s1">&#39;5 5 5 5&#39;</span>
</span><span id="set_dark_style-121"><a href="#set_dark_style-121"><span class="linenos">121</span></a>    <span class="n">font_style</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="set_dark_style-122"><a href="#set_dark_style-122"><span class="linenos">122</span></a>
</span><span id="set_dark_style-123"><a href="#set_dark_style-123"><span class="linenos">123</span></a>    <span class="k">if</span> <span class="n">font_family</span> <span class="o">==</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="set_dark_style-124"><a href="#set_dark_style-124"><span class="linenos">124</span></a>        <span class="n">font_loader</span> <span class="o">=</span> <span class="n">spacrFont</span><span class="p">(</span><span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;OpenSans&#39;</span><span class="p">,</span> <span class="n">font_style</span><span class="o">=</span><span class="s1">&#39;Regular&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="set_dark_style-125"><a href="#set_dark_style-125"><span class="linenos">125</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="set_dark_style-126"><a href="#set_dark_style-126"><span class="linenos">126</span></a>        <span class="n">font_loader</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="set_dark_style-127"><a href="#set_dark_style-127"><span class="linenos">127</span></a>        
</span><span id="set_dark_style-128"><a href="#set_dark_style-128"><span class="linenos">128</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">theme_use</span><span class="p">(</span><span class="s1">&#39;clam&#39;</span><span class="p">)</span>
</span><span id="set_dark_style-129"><a href="#set_dark_style-129"><span class="linenos">129</span></a>    
</span><span id="set_dark_style-130"><a href="#set_dark_style-130"><span class="linenos">130</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-131"><a href="#set_dark_style-131"><span class="linenos">131</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TCombobox&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-132"><a href="#set_dark_style-132"><span class="linenos">132</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Spacr.TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-133"><a href="#set_dark_style-133"><span class="linenos">133</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-134"><a href="#set_dark_style-134"><span class="linenos">134</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Spacr.TEntry&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-135"><a href="#set_dark_style-135"><span class="linenos">135</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Custom.TLabel&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-136"><a href="#set_dark_style-136"><span class="linenos">136</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TButton&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span><span id="set_dark_style-137"><a href="#set_dark_style-137"><span class="linenos">137</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TFrame&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="set_dark_style-138"><a href="#set_dark_style-138"><span class="linenos">138</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TPanedwindow&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="set_dark_style-139"><a href="#set_dark_style-139"><span class="linenos">139</span></a>    <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="set_dark_style-140"><a href="#set_dark_style-140"><span class="linenos">140</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TLabel&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-141"><a href="#set_dark_style-141"><span class="linenos">141</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="set_dark_style-142"><a href="#set_dark_style-142"><span class="linenos">142</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;TLabel&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-143"><a href="#set_dark_style-143"><span class="linenos">143</span></a>
</span><span id="set_dark_style-144"><a href="#set_dark_style-144"><span class="linenos">144</span></a>    <span class="k">if</span> <span class="n">parent_frame</span><span class="p">:</span>
</span><span id="set_dark_style-145"><a href="#set_dark_style-145"><span class="linenos">145</span></a>        <span class="n">parent_frame</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="set_dark_style-146"><a href="#set_dark_style-146"><span class="linenos">146</span></a>        <span class="n">parent_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="set_dark_style-147"><a href="#set_dark_style-147"><span class="linenos">147</span></a>        <span class="n">parent_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="set_dark_style-148"><a href="#set_dark_style-148"><span class="linenos">148</span></a>
</span><span id="set_dark_style-149"><a href="#set_dark_style-149"><span class="linenos">149</span></a>    <span class="k">if</span> <span class="n">containers</span><span class="p">:</span>
</span><span id="set_dark_style-150"><a href="#set_dark_style-150"><span class="linenos">150</span></a>        <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">:</span>
</span><span id="set_dark_style-151"><a href="#set_dark_style-151"><span class="linenos">151</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="set_dark_style-152"><a href="#set_dark_style-152"><span class="linenos">152</span></a>                <span class="n">container_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="set_dark_style-153"><a href="#set_dark_style-153"><span class="linenos">153</span></a>                <span class="n">container_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">container</span><span class="o">.</span><span class="n">winfo_class</span><span class="p">()</span><span class="si">}</span><span class="s1">.TFrame&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="set_dark_style-154"><a href="#set_dark_style-154"><span class="linenos">154</span></a>                <span class="n">container</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">container</span><span class="o">.</span><span class="n">winfo_class</span><span class="p">()</span><span class="si">}</span><span class="s1">.TFrame&#39;</span><span class="p">)</span>
</span><span id="set_dark_style-155"><a href="#set_dark_style-155"><span class="linenos">155</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="set_dark_style-156"><a href="#set_dark_style-156"><span class="linenos">156</span></a>                <span class="n">container</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="set_dark_style-157"><a href="#set_dark_style-157"><span class="linenos">157</span></a>
</span><span id="set_dark_style-158"><a href="#set_dark_style-158"><span class="linenos">158</span></a>    <span class="k">if</span> <span class="n">widgets</span><span class="p">:</span>
</span><span id="set_dark_style-159"><a href="#set_dark_style-159"><span class="linenos">159</span></a>        <span class="k">for</span> <span class="n">widget</span> <span class="ow">in</span> <span class="n">widgets</span><span class="p">:</span>
</span><span id="set_dark_style-160"><a href="#set_dark_style-160"><span class="linenos">160</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">,</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">)):</span>
</span><span id="set_dark_style-161"><a href="#set_dark_style-161"><span class="linenos">161</span></a>                <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="set_dark_style-162"><a href="#set_dark_style-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">)):</span>
</span><span id="set_dark_style-163"><a href="#set_dark_style-163"><span class="linenos">163</span></a>                <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="set_dark_style-164"><a href="#set_dark_style-164"><span class="linenos">164</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-165"><a href="#set_dark_style-165"><span class="linenos">165</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="set_dark_style-166"><a href="#set_dark_style-166"><span class="linenos">166</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-167"><a href="#set_dark_style-167"><span class="linenos">167</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">scrolledtext</span><span class="o">.</span><span class="n">ScrolledText</span><span class="p">):</span>
</span><span id="set_dark_style-168"><a href="#set_dark_style-168"><span class="linenos">168</span></a>                <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">insertbackground</span><span class="o">=</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="set_dark_style-169"><a href="#set_dark_style-169"><span class="linenos">169</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">):</span>
</span><span id="set_dark_style-170"><a href="#set_dark_style-170"><span class="linenos">170</span></a>                <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="set_dark_style-171"><a href="#set_dark_style-171"><span class="linenos">171</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-172"><a href="#set_dark_style-172"><span class="linenos">172</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="set_dark_style-173"><a href="#set_dark_style-173"><span class="linenos">173</span></a>                    <span class="n">widget</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-174"><a href="#set_dark_style-174"><span class="linenos">174</span></a>                <span class="n">menu</span> <span class="o">=</span> <span class="n">widget</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span>
</span><span id="set_dark_style-175"><a href="#set_dark_style-175"><span class="linenos">175</span></a>                <span class="k">if</span> <span class="n">font_loader</span><span class="p">:</span>
</span><span id="set_dark_style-176"><a href="#set_dark_style-176"><span class="linenos">176</span></a>                    <span class="n">menu</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-177"><a href="#set_dark_style-177"><span class="linenos">177</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="set_dark_style-178"><a href="#set_dark_style-178"><span class="linenos">178</span></a>                    <span class="n">menu</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">font_family</span><span class="p">,</span> <span class="n">font_size</span><span class="p">))</span>
</span><span id="set_dark_style-179"><a href="#set_dark_style-179"><span class="linenos">179</span></a>
</span><span id="set_dark_style-180"><a href="#set_dark_style-180"><span class="linenos">180</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;font_loader&#39;</span><span class="p">:</span><span class="n">font_loader</span><span class="p">,</span> <span class="s1">&#39;font_family&#39;</span><span class="p">:</span> <span class="n">font_family</span><span class="p">,</span> <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">bg_color</span><span class="p">,</span> <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">fg_color</span><span class="p">,</span> <span class="s1">&#39;active_color&#39;</span><span class="p">:</span> <span class="n">active_color</span><span class="p">,</span> <span class="s1">&#39;inactive_color&#39;</span><span class="p">:</span> <span class="n">inactive_color</span><span class="p">}</span>
</span></pre></div>


    

                </section>
                <section id="spacrFont">
                            <input id="spacrFont-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrFont</span>:

                <label class="view-source-button" for="spacrFont-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFont"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFont-182"><a href="#spacrFont-182"><span class="linenos">182</span></a><span class="k">class</span> <span class="nc">spacrFont</span><span class="p">:</span>
</span><span id="spacrFont-183"><a href="#spacrFont-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
</span><span id="spacrFont-184"><a href="#spacrFont-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont-185"><a href="#spacrFont-185"><span class="linenos">185</span></a><span class="sd">        Initializes the FontLoader class.</span>
</span><span id="spacrFont-186"><a href="#spacrFont-186"><span class="linenos">186</span></a>
</span><span id="spacrFont-187"><a href="#spacrFont-187"><span class="linenos">187</span></a><span class="sd">        Parameters:</span>
</span><span id="spacrFont-188"><a href="#spacrFont-188"><span class="linenos">188</span></a><span class="sd">        - font_name: str, the name of the font (e.g., &#39;OpenSans&#39;).</span>
</span><span id="spacrFont-189"><a href="#spacrFont-189"><span class="linenos">189</span></a><span class="sd">        - font_style: str, the style of the font (e.g., &#39;Regular&#39;, &#39;Bold&#39;).</span>
</span><span id="spacrFont-190"><a href="#spacrFont-190"><span class="linenos">190</span></a><span class="sd">        - font_size: int, the size of the font (default: 12).</span>
</span><span id="spacrFont-191"><a href="#spacrFont-191"><span class="linenos">191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont-192"><a href="#spacrFont-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="n">font_name</span>
</span><span id="spacrFont-193"><a href="#spacrFont-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font_style</span>
</span><span id="spacrFont-194"><a href="#spacrFont-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">font_size</span>
</span><span id="spacrFont-195"><a href="#spacrFont-195"><span class="linenos">195</span></a>
</span><span id="spacrFont-196"><a href="#spacrFont-196"><span class="linenos">196</span></a>        <span class="c1"># Determine the path based on the font name and style</span>
</span><span id="spacrFont-197"><a href="#spacrFont-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_font_path</span><span class="p">(</span><span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">)</span>
</span><span id="spacrFont-198"><a href="#spacrFont-198"><span class="linenos">198</span></a>
</span><span id="spacrFont-199"><a href="#spacrFont-199"><span class="linenos">199</span></a>        <span class="c1"># Register the font with Tkinter</span>
</span><span id="spacrFont-200"><a href="#spacrFont-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_font</span><span class="p">()</span>
</span><span id="spacrFont-201"><a href="#spacrFont-201"><span class="linenos">201</span></a>
</span><span id="spacrFont-202"><a href="#spacrFont-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">get_font_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">):</span>
</span><span id="spacrFont-203"><a href="#spacrFont-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont-204"><a href="#spacrFont-204"><span class="linenos">204</span></a><span class="sd">        Returns the font path based on the font name and style.</span>
</span><span id="spacrFont-205"><a href="#spacrFont-205"><span class="linenos">205</span></a>
</span><span id="spacrFont-206"><a href="#spacrFont-206"><span class="linenos">206</span></a><span class="sd">        Parameters:</span>
</span><span id="spacrFont-207"><a href="#spacrFont-207"><span class="linenos">207</span></a><span class="sd">        - font_name: str, the name of the font.</span>
</span><span id="spacrFont-208"><a href="#spacrFont-208"><span class="linenos">208</span></a><span class="sd">        - font_style: str, the style of the font.</span>
</span><span id="spacrFont-209"><a href="#spacrFont-209"><span class="linenos">209</span></a>
</span><span id="spacrFont-210"><a href="#spacrFont-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="spacrFont-211"><a href="#spacrFont-211"><span class="linenos">211</span></a><span class="sd">        - str, the path to the font file.</span>
</span><span id="spacrFont-212"><a href="#spacrFont-212"><span class="linenos">212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont-213"><a href="#spacrFont-213"><span class="linenos">213</span></a>        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</span><span id="spacrFont-214"><a href="#spacrFont-214"><span class="linenos">214</span></a>        
</span><span id="spacrFont-215"><a href="#spacrFont-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="n">font_name</span> <span class="o">==</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="spacrFont-216"><a href="#spacrFont-216"><span class="linenos">216</span></a>            <span class="k">if</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Regular&#39;</span><span class="p">:</span>
</span><span id="spacrFont-217"><a href="#spacrFont-217"><span class="linenos">217</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Regular.ttf&#39;</span><span class="p">)</span>
</span><span id="spacrFont-218"><a href="#spacrFont-218"><span class="linenos">218</span></a>            <span class="k">elif</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Bold&#39;</span><span class="p">:</span>
</span><span id="spacrFont-219"><a href="#spacrFont-219"><span class="linenos">219</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Bold.ttf&#39;</span><span class="p">)</span>
</span><span id="spacrFont-220"><a href="#spacrFont-220"><span class="linenos">220</span></a>            <span class="k">elif</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Italic&#39;</span><span class="p">:</span>
</span><span id="spacrFont-221"><a href="#spacrFont-221"><span class="linenos">221</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Italic.ttf&#39;</span><span class="p">)</span>
</span><span id="spacrFont-222"><a href="#spacrFont-222"><span class="linenos">222</span></a>            <span class="c1"># Add more styles as needed</span>
</span><span id="spacrFont-223"><a href="#spacrFont-223"><span class="linenos">223</span></a>        <span class="c1"># Add more fonts as needed</span>
</span><span id="spacrFont-224"><a href="#spacrFont-224"><span class="linenos">224</span></a>        
</span><span id="spacrFont-225"><a href="#spacrFont-225"><span class="linenos">225</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Font &#39;</span><span class="si">{</span><span class="n">font_name</span><span class="si">}</span><span class="s2">&#39; with style &#39;</span><span class="si">{</span><span class="n">font_style</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
</span><span id="spacrFont-226"><a href="#spacrFont-226"><span class="linenos">226</span></a>
</span><span id="spacrFont-227"><a href="#spacrFont-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="nf">load_font</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrFont-228"><a href="#spacrFont-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont-229"><a href="#spacrFont-229"><span class="linenos">229</span></a><span class="sd">        Loads the font into Tkinter.</span>
</span><span id="spacrFont-230"><a href="#spacrFont-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont-231"><a href="#spacrFont-231"><span class="linenos">231</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="spacrFont-232"><a href="#spacrFont-232"><span class="linenos">232</span></a>            <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrFont-233"><a href="#spacrFont-233"><span class="linenos">233</span></a>        <span class="k">except</span> <span class="n">tk</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
</span><span id="spacrFont-234"><a href="#spacrFont-234"><span class="linenos">234</span></a>            <span class="c1"># Load the font manually if it&#39;s not already loaded</span>
</span><span id="spacrFont-235"><a href="#spacrFont-235"><span class="linenos">235</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tk_font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span>
</span><span id="spacrFont-236"><a href="#spacrFont-236"><span class="linenos">236</span></a>                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span>
</span><span id="spacrFont-237"><a href="#spacrFont-237"><span class="linenos">237</span></a>                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_path</span><span class="p">,</span>
</span><span id="spacrFont-238"><a href="#spacrFont-238"><span class="linenos">238</span></a>                <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
</span><span id="spacrFont-239"><a href="#spacrFont-239"><span class="linenos">239</span></a>            <span class="p">)</span>
</span><span id="spacrFont-240"><a href="#spacrFont-240"><span class="linenos">240</span></a>
</span><span id="spacrFont-241"><a href="#spacrFont-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">get_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrFont-242"><a href="#spacrFont-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont-243"><a href="#spacrFont-243"><span class="linenos">243</span></a><span class="sd">        Returns the font in the specified size.</span>
</span><span id="spacrFont-244"><a href="#spacrFont-244"><span class="linenos">244</span></a>
</span><span id="spacrFont-245"><a href="#spacrFont-245"><span class="linenos">245</span></a><span class="sd">        Parameters:</span>
</span><span id="spacrFont-246"><a href="#spacrFont-246"><span class="linenos">246</span></a><span class="sd">        - size: int, the size of the font (optional).</span>
</span><span id="spacrFont-247"><a href="#spacrFont-247"><span class="linenos">247</span></a>
</span><span id="spacrFont-248"><a href="#spacrFont-248"><span class="linenos">248</span></a><span class="sd">        Returns:</span>
</span><span id="spacrFont-249"><a href="#spacrFont-249"><span class="linenos">249</span></a><span class="sd">        - tkFont.Font object.</span>
</span><span id="spacrFont-250"><a href="#spacrFont-250"><span class="linenos">250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont-251"><a href="#spacrFont-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrFont-252"><a href="#spacrFont-252"><span class="linenos">252</span></a>            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
</span><span id="spacrFont-253"><a href="#spacrFont-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span></pre></div>


    

                            <div id="spacrFont.__init__" class="classattr">
                                        <input id="spacrFont.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrFont</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">font_name</span>, </span><span class="param"><span class="n">font_style</span>, </span><span class="param"><span class="n">font_size</span><span class="o">=</span><span class="mi">12</span></span>)</span>

                <label class="view-source-button" for="spacrFont.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFont.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFont.__init__-183"><a href="#spacrFont.__init__-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
</span><span id="spacrFont.__init__-184"><a href="#spacrFont.__init__-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont.__init__-185"><a href="#spacrFont.__init__-185"><span class="linenos">185</span></a><span class="sd">        Initializes the FontLoader class.</span>
</span><span id="spacrFont.__init__-186"><a href="#spacrFont.__init__-186"><span class="linenos">186</span></a>
</span><span id="spacrFont.__init__-187"><a href="#spacrFont.__init__-187"><span class="linenos">187</span></a><span class="sd">        Parameters:</span>
</span><span id="spacrFont.__init__-188"><a href="#spacrFont.__init__-188"><span class="linenos">188</span></a><span class="sd">        - font_name: str, the name of the font (e.g., &#39;OpenSans&#39;).</span>
</span><span id="spacrFont.__init__-189"><a href="#spacrFont.__init__-189"><span class="linenos">189</span></a><span class="sd">        - font_style: str, the style of the font (e.g., &#39;Regular&#39;, &#39;Bold&#39;).</span>
</span><span id="spacrFont.__init__-190"><a href="#spacrFont.__init__-190"><span class="linenos">190</span></a><span class="sd">        - font_size: int, the size of the font (default: 12).</span>
</span><span id="spacrFont.__init__-191"><a href="#spacrFont.__init__-191"><span class="linenos">191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont.__init__-192"><a href="#spacrFont.__init__-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="n">font_name</span>
</span><span id="spacrFont.__init__-193"><a href="#spacrFont.__init__-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font_style</span>
</span><span id="spacrFont.__init__-194"><a href="#spacrFont.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">font_size</span>
</span><span id="spacrFont.__init__-195"><a href="#spacrFont.__init__-195"><span class="linenos">195</span></a>
</span><span id="spacrFont.__init__-196"><a href="#spacrFont.__init__-196"><span class="linenos">196</span></a>        <span class="c1"># Determine the path based on the font name and style</span>
</span><span id="spacrFont.__init__-197"><a href="#spacrFont.__init__-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_font_path</span><span class="p">(</span><span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">)</span>
</span><span id="spacrFont.__init__-198"><a href="#spacrFont.__init__-198"><span class="linenos">198</span></a>
</span><span id="spacrFont.__init__-199"><a href="#spacrFont.__init__-199"><span class="linenos">199</span></a>        <span class="c1"># Register the font with Tkinter</span>
</span><span id="spacrFont.__init__-200"><a href="#spacrFont.__init__-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_font</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the FontLoader class.</p>

<p>Parameters:</p>

<ul>
<li>font_name: str, the name of the font (e.g., 'OpenSans').</li>
<li>font_style: str, the style of the font (e.g., 'Regular', 'Bold').</li>
<li>font_size: int, the size of the font (default: 12).</li>
</ul>
</div>


                            </div>
                            <div id="spacrFont.font_name" class="classattr">
                                <div class="attr variable">
            <span class="name">font_name</span>

        
    </div>
    <a class="headerlink" href="#spacrFont.font_name"></a>
    
    

                            </div>
                            <div id="spacrFont.font_style" class="classattr">
                                <div class="attr variable">
            <span class="name">font_style</span>

        
    </div>
    <a class="headerlink" href="#spacrFont.font_style"></a>
    
    

                            </div>
                            <div id="spacrFont.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrFont.font_size"></a>
    
    

                            </div>
                            <div id="spacrFont.font_path" class="classattr">
                                <div class="attr variable">
            <span class="name">font_path</span>

        
    </div>
    <a class="headerlink" href="#spacrFont.font_path"></a>
    
    

                            </div>
                            <div id="spacrFont.get_font_path" class="classattr">
                                        <input id="spacrFont.get_font_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_font_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">font_name</span>, </span><span class="param"><span class="n">font_style</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrFont.get_font_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFont.get_font_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFont.get_font_path-202"><a href="#spacrFont.get_font_path-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">get_font_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_name</span><span class="p">,</span> <span class="n">font_style</span><span class="p">):</span>
</span><span id="spacrFont.get_font_path-203"><a href="#spacrFont.get_font_path-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont.get_font_path-204"><a href="#spacrFont.get_font_path-204"><span class="linenos">204</span></a><span class="sd">        Returns the font path based on the font name and style.</span>
</span><span id="spacrFont.get_font_path-205"><a href="#spacrFont.get_font_path-205"><span class="linenos">205</span></a>
</span><span id="spacrFont.get_font_path-206"><a href="#spacrFont.get_font_path-206"><span class="linenos">206</span></a><span class="sd">        Parameters:</span>
</span><span id="spacrFont.get_font_path-207"><a href="#spacrFont.get_font_path-207"><span class="linenos">207</span></a><span class="sd">        - font_name: str, the name of the font.</span>
</span><span id="spacrFont.get_font_path-208"><a href="#spacrFont.get_font_path-208"><span class="linenos">208</span></a><span class="sd">        - font_style: str, the style of the font.</span>
</span><span id="spacrFont.get_font_path-209"><a href="#spacrFont.get_font_path-209"><span class="linenos">209</span></a>
</span><span id="spacrFont.get_font_path-210"><a href="#spacrFont.get_font_path-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="spacrFont.get_font_path-211"><a href="#spacrFont.get_font_path-211"><span class="linenos">211</span></a><span class="sd">        - str, the path to the font file.</span>
</span><span id="spacrFont.get_font_path-212"><a href="#spacrFont.get_font_path-212"><span class="linenos">212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont.get_font_path-213"><a href="#spacrFont.get_font_path-213"><span class="linenos">213</span></a>        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</span><span id="spacrFont.get_font_path-214"><a href="#spacrFont.get_font_path-214"><span class="linenos">214</span></a>        
</span><span id="spacrFont.get_font_path-215"><a href="#spacrFont.get_font_path-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="n">font_name</span> <span class="o">==</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="spacrFont.get_font_path-216"><a href="#spacrFont.get_font_path-216"><span class="linenos">216</span></a>            <span class="k">if</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Regular&#39;</span><span class="p">:</span>
</span><span id="spacrFont.get_font_path-217"><a href="#spacrFont.get_font_path-217"><span class="linenos">217</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Regular.ttf&#39;</span><span class="p">)</span>
</span><span id="spacrFont.get_font_path-218"><a href="#spacrFont.get_font_path-218"><span class="linenos">218</span></a>            <span class="k">elif</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Bold&#39;</span><span class="p">:</span>
</span><span id="spacrFont.get_font_path-219"><a href="#spacrFont.get_font_path-219"><span class="linenos">219</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Bold.ttf&#39;</span><span class="p">)</span>
</span><span id="spacrFont.get_font_path-220"><a href="#spacrFont.get_font_path-220"><span class="linenos">220</span></a>            <span class="k">elif</span> <span class="n">font_style</span> <span class="o">==</span> <span class="s1">&#39;Italic&#39;</span><span class="p">:</span>
</span><span id="spacrFont.get_font_path-221"><a href="#spacrFont.get_font_path-221"><span class="linenos">221</span></a>                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;resources/font/open_sans/static/OpenSans-Italic.ttf&#39;</span><span class="p">)</span>
</span><span id="spacrFont.get_font_path-222"><a href="#spacrFont.get_font_path-222"><span class="linenos">222</span></a>            <span class="c1"># Add more styles as needed</span>
</span><span id="spacrFont.get_font_path-223"><a href="#spacrFont.get_font_path-223"><span class="linenos">223</span></a>        <span class="c1"># Add more fonts as needed</span>
</span><span id="spacrFont.get_font_path-224"><a href="#spacrFont.get_font_path-224"><span class="linenos">224</span></a>        
</span><span id="spacrFont.get_font_path-225"><a href="#spacrFont.get_font_path-225"><span class="linenos">225</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Font &#39;</span><span class="si">{</span><span class="n">font_name</span><span class="si">}</span><span class="s2">&#39; with style &#39;</span><span class="si">{</span><span class="n">font_style</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the font path based on the font name and style.</p>

<p>Parameters:</p>

<ul>
<li>font_name: str, the name of the font.</li>
<li>font_style: str, the style of the font.</li>
</ul>

<p>Returns:</p>

<ul>
<li>str, the path to the font file.</li>
</ul>
</div>


                            </div>
                            <div id="spacrFont.load_font" class="classattr">
                                        <input id="spacrFont.load_font-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_font</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrFont.load_font-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFont.load_font"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFont.load_font-227"><a href="#spacrFont.load_font-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="nf">load_font</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrFont.load_font-228"><a href="#spacrFont.load_font-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont.load_font-229"><a href="#spacrFont.load_font-229"><span class="linenos">229</span></a><span class="sd">        Loads the font into Tkinter.</span>
</span><span id="spacrFont.load_font-230"><a href="#spacrFont.load_font-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont.load_font-231"><a href="#spacrFont.load_font-231"><span class="linenos">231</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="spacrFont.load_font-232"><a href="#spacrFont.load_font-232"><span class="linenos">232</span></a>            <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrFont.load_font-233"><a href="#spacrFont.load_font-233"><span class="linenos">233</span></a>        <span class="k">except</span> <span class="n">tk</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
</span><span id="spacrFont.load_font-234"><a href="#spacrFont.load_font-234"><span class="linenos">234</span></a>            <span class="c1"># Load the font manually if it&#39;s not already loaded</span>
</span><span id="spacrFont.load_font-235"><a href="#spacrFont.load_font-235"><span class="linenos">235</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tk_font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span>
</span><span id="spacrFont.load_font-236"><a href="#spacrFont.load_font-236"><span class="linenos">236</span></a>                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span>
</span><span id="spacrFont.load_font-237"><a href="#spacrFont.load_font-237"><span class="linenos">237</span></a>                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_path</span><span class="p">,</span>
</span><span id="spacrFont.load_font-238"><a href="#spacrFont.load_font-238"><span class="linenos">238</span></a>                <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
</span><span id="spacrFont.load_font-239"><a href="#spacrFont.load_font-239"><span class="linenos">239</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Loads the font into Tkinter.</p>
</div>


                            </div>
                            <div id="spacrFont.get_font" class="classattr">
                                        <input id="spacrFont.get_font-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_font</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">size</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrFont.get_font-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFont.get_font"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFont.get_font-241"><a href="#spacrFont.get_font-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">get_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrFont.get_font-242"><a href="#spacrFont.get_font-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="spacrFont.get_font-243"><a href="#spacrFont.get_font-243"><span class="linenos">243</span></a><span class="sd">        Returns the font in the specified size.</span>
</span><span id="spacrFont.get_font-244"><a href="#spacrFont.get_font-244"><span class="linenos">244</span></a>
</span><span id="spacrFont.get_font-245"><a href="#spacrFont.get_font-245"><span class="linenos">245</span></a><span class="sd">        Parameters:</span>
</span><span id="spacrFont.get_font-246"><a href="#spacrFont.get_font-246"><span class="linenos">246</span></a><span class="sd">        - size: int, the size of the font (optional).</span>
</span><span id="spacrFont.get_font-247"><a href="#spacrFont.get_font-247"><span class="linenos">247</span></a>
</span><span id="spacrFont.get_font-248"><a href="#spacrFont.get_font-248"><span class="linenos">248</span></a><span class="sd">        Returns:</span>
</span><span id="spacrFont.get_font-249"><a href="#spacrFont.get_font-249"><span class="linenos">249</span></a><span class="sd">        - tkFont.Font object.</span>
</span><span id="spacrFont.get_font-250"><a href="#spacrFont.get_font-250"><span class="linenos">250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="spacrFont.get_font-251"><a href="#spacrFont.get_font-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrFont.get_font-252"><a href="#spacrFont.get_font-252"><span class="linenos">252</span></a>            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
</span><span id="spacrFont.get_font-253"><a href="#spacrFont.get_font-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the font in the specified size.</p>

<p>Parameters:</p>

<ul>
<li>size: int, the size of the font (optional).</li>
</ul>

<p>Returns:</p>

<ul>
<li>tkFont.Font object.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="spacrContainer">
                            <input id="spacrContainer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrContainer</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrContainer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer-255"><a href="#spacrContainer-255"><span class="linenos">255</span></a><span class="k">class</span> <span class="nc">spacrContainer</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrContainer-256"><a href="#spacrContainer-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrContainer-257"><a href="#spacrContainer-257"><span class="linenos">257</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrContainer-258"><a href="#spacrContainer-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">=</span> <span class="n">orient</span>
</span><span id="spacrContainer-259"><a href="#spacrContainer-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">bg</span> <span class="k">if</span> <span class="n">bg</span> <span class="k">else</span> <span class="s1">&#39;lightgrey&#39;</span>
</span><span id="spacrContainer-260"><a href="#spacrContainer-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="spacrContainer-261"><a href="#spacrContainer-261"><span class="linenos">261</span></a>
</span><span id="spacrContainer-262"><a href="#spacrContainer-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">panes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="spacrContainer-263"><a href="#spacrContainer-263"><span class="linenos">263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sashes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="spacrContainer-264"><a href="#spacrContainer-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_configure</span><span class="p">)</span>
</span><span id="spacrContainer-265"><a href="#spacrContainer-265"><span class="linenos">265</span></a>
</span><span id="spacrContainer-266"><a href="#spacrContainer-266"><span class="linenos">266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrContainer-267"><a href="#spacrContainer-267"><span class="linenos">267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrContainer-268"><a href="#spacrContainer-268"><span class="linenos">268</span></a>
</span><span id="spacrContainer-269"><a href="#spacrContainer-269"><span class="linenos">269</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">):</span>
</span><span id="spacrContainer-270"><a href="#spacrContainer-270"><span class="linenos">270</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding widget: </span><span class="si">{</span><span class="n">widget</span><span class="si">}</span><span class="s2"> with stretch: </span><span class="si">{</span><span class="n">stretch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrContainer-271"><a href="#spacrContainer-271"><span class="linenos">271</span></a>        <span class="n">pane</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">)</span>
</span><span id="spacrContainer-272"><a href="#spacrContainer-272"><span class="linenos">272</span></a>        <span class="n">pane</span><span class="o">.</span><span class="n">grid_propagate</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrContainer-273"><a href="#spacrContainer-273"><span class="linenos">273</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">pane</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>  <span class="c1"># Use grid for the widget within the pane</span>
</span><span id="spacrContainer-274"><a href="#spacrContainer-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">))</span>
</span><span id="spacrContainer-275"><a href="#spacrContainer-275"><span class="linenos">275</span></a>
</span><span id="spacrContainer-276"><a href="#spacrContainer-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="spacrContainer-277"><a href="#spacrContainer-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">create_sash</span><span class="p">()</span>
</span><span id="spacrContainer-278"><a href="#spacrContainer-278"><span class="linenos">278</span></a>
</span><span id="spacrContainer-279"><a href="#spacrContainer-279"><span class="linenos">279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span><span id="spacrContainer-280"><a href="#spacrContainer-280"><span class="linenos">280</span></a>
</span><span id="spacrContainer-281"><a href="#spacrContainer-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">create_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrContainer-282"><a href="#spacrContainer-282"><span class="linenos">282</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span> <span class="n">cursor</span><span class="o">=</span><span class="s1">&#39;sb_v_double_arrow&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="s1">&#39;sb_h_double_arrow&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer-283"><a href="#spacrContainer-283"><span class="linenos">283</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter_sash</span><span class="p">)</span>
</span><span id="spacrContainer-284"><a href="#spacrContainer-284"><span class="linenos">284</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave_sash</span><span class="p">)</span>
</span><span id="spacrContainer-285"><a href="#spacrContainer-285"><span class="linenos">285</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonPress-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_resize</span><span class="p">)</span>
</span><span id="spacrContainer-286"><a href="#spacrContainer-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sash</span><span class="p">)</span>
</span><span id="spacrContainer-287"><a href="#spacrContainer-287"><span class="linenos">287</span></a>
</span><span id="spacrContainer-288"><a href="#spacrContainer-288"><span class="linenos">288</span></a>    <span class="k">def</span> <span class="nf">reposition_panes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrContainer-289"><a href="#spacrContainer-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">:</span>
</span><span id="spacrContainer-290"><a href="#spacrContainer-290"><span class="linenos">290</span></a>            <span class="k">return</span>
</span><span id="spacrContainer-291"><a href="#spacrContainer-291"><span class="linenos">291</span></a>
</span><span id="spacrContainer-292"><a href="#spacrContainer-292"><span class="linenos">292</span></a>        <span class="n">total_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="spacrContainer-293"><a href="#spacrContainer-293"><span class="linenos">293</span></a>        <span class="n">pane_size</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span>
</span><span id="spacrContainer-294"><a href="#spacrContainer-294"><span class="linenos">294</span></a>
</span><span id="spacrContainer-295"><a href="#spacrContainer-295"><span class="linenos">295</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total size: </span><span class="si">{</span><span class="n">total_size</span><span class="si">}</span><span class="s2">, Pane size: </span><span class="si">{</span><span class="n">pane_size</span><span class="si">}</span><span class="s2">, Number of panes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrContainer-296"><a href="#spacrContainer-296"><span class="linenos">296</span></a>
</span><span id="spacrContainer-297"><a href="#spacrContainer-297"><span class="linenos">297</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">):</span>
</span><span id="spacrContainer-298"><a href="#spacrContainer-298"><span class="linenos">298</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="spacrContainer-299"><a href="#spacrContainer-299"><span class="linenos">299</span></a>                <span class="n">pane</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="spacrContainer-300"><a href="#spacrContainer-300"><span class="linenos">300</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrContainer-301"><a href="#spacrContainer-301"><span class="linenos">301</span></a>                <span class="n">pane</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="spacrContainer-302"><a href="#spacrContainer-302"><span class="linenos">302</span></a>
</span><span id="spacrContainer-303"><a href="#spacrContainer-303"><span class="linenos">303</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sash</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sashes</span><span class="p">):</span>
</span><span id="spacrContainer-304"><a href="#spacrContainer-304"><span class="linenos">304</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="spacrContainer-305"><a href="#spacrContainer-305"><span class="linenos">305</span></a>                <span class="n">sash</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="spacrContainer-306"><a href="#spacrContainer-306"><span class="linenos">306</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrContainer-307"><a href="#spacrContainer-307"><span class="linenos">307</span></a>                <span class="n">sash</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">)</span>
</span><span id="spacrContainer-308"><a href="#spacrContainer-308"><span class="linenos">308</span></a>
</span><span id="spacrContainer-309"><a href="#spacrContainer-309"><span class="linenos">309</span></a>    <span class="k">def</span> <span class="nf">on_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer-310"><a href="#spacrContainer-310"><span class="linenos">310</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring container: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrContainer-311"><a href="#spacrContainer-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span><span id="spacrContainer-312"><a href="#spacrContainer-312"><span class="linenos">312</span></a>
</span><span id="spacrContainer-313"><a href="#spacrContainer-313"><span class="linenos">313</span></a>    <span class="k">def</span> <span class="nf">on_enter_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer-314"><a href="#spacrContainer-314"><span class="linenos">314</span></a>        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="spacrContainer-315"><a href="#spacrContainer-315"><span class="linenos">315</span></a>
</span><span id="spacrContainer-316"><a href="#spacrContainer-316"><span class="linenos">316</span></a>    <span class="k">def</span> <span class="nf">on_leave_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer-317"><a href="#spacrContainer-317"><span class="linenos">317</span></a>        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">)</span>
</span><span id="spacrContainer-318"><a href="#spacrContainer-318"><span class="linenos">318</span></a>
</span><span id="spacrContainer-319"><a href="#spacrContainer-319"><span class="linenos">319</span></a>    <span class="k">def</span> <span class="nf">start_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer-320"><a href="#spacrContainer-320"><span class="linenos">320</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span>
</span><span id="spacrContainer-321"><a href="#spacrContainer-321"><span class="linenos">321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span>
</span><span id="spacrContainer-322"><a href="#spacrContainer-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_size</span> <span class="o">=</span> <span class="n">sash</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="n">sash</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span>
</span><span id="spacrContainer-323"><a href="#spacrContainer-323"><span class="linenos">323</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_resize</span><span class="p">)</span>
</span><span id="spacrContainer-324"><a href="#spacrContainer-324"><span class="linenos">324</span></a>
</span><span id="spacrContainer-325"><a href="#spacrContainer-325"><span class="linenos">325</span></a>    <span class="k">def</span> <span class="nf">perform_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer-326"><a href="#spacrContainer-326"><span class="linenos">326</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span>
</span><span id="spacrContainer-327"><a href="#spacrContainer-327"><span class="linenos">327</span></a>        <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span><span class="p">)</span>
</span><span id="spacrContainer-328"><a href="#spacrContainer-328"><span class="linenos">328</span></a>        <span class="n">new_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_size</span> <span class="o">+</span> <span class="n">delta</span>
</span><span id="spacrContainer-329"><a href="#spacrContainer-329"><span class="linenos">329</span></a>
</span><span id="spacrContainer-330"><a href="#spacrContainer-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">):</span>
</span><span id="spacrContainer-331"><a href="#spacrContainer-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="spacrContainer-332"><a href="#spacrContainer-332"><span class="linenos">332</span></a>                <span class="n">new_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer-333"><a href="#spacrContainer-333"><span class="linenos">333</span></a>                <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">new_size</span><span class="p">:</span>
</span><span id="spacrContainer-334"><a href="#spacrContainer-334"><span class="linenos">334</span></a>                    <span class="n">pane</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">new_row</span><span class="p">)</span>
</span><span id="spacrContainer-335"><a href="#spacrContainer-335"><span class="linenos">335</span></a>                <span class="k">elif</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">new_size</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="spacrContainer-336"><a href="#spacrContainer-336"><span class="linenos">336</span></a>                    <span class="n">previous_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">-</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">())</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer-337"><a href="#spacrContainer-337"><span class="linenos">337</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">previous_row</span><span class="p">)</span>
</span><span id="spacrContainer-338"><a href="#spacrContainer-338"><span class="linenos">338</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrContainer-339"><a href="#spacrContainer-339"><span class="linenos">339</span></a>                <span class="n">new_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer-340"><a href="#spacrContainer-340"><span class="linenos">340</span></a>                <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">new_size</span><span class="p">:</span>
</span><span id="spacrContainer-341"><a href="#spacrContainer-341"><span class="linenos">341</span></a>                    <span class="n">pane</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">new_col</span><span class="p">)</span>
</span><span id="spacrContainer-342"><a href="#spacrContainer-342"><span class="linenos">342</span></a>                <span class="k">elif</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">new_size</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="spacrContainer-343"><a href="#spacrContainer-343"><span class="linenos">343</span></a>                    <span class="n">previous_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">-</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">())</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer-344"><a href="#spacrContainer-344"><span class="linenos">344</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">previous_col</span><span class="p">)</span>
</span><span id="spacrContainer-345"><a href="#spacrContainer-345"><span class="linenos">345</span></a>
</span><span id="spacrContainer-346"><a href="#spacrContainer-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrContainer.__init__" class="classattr">
                                        <input id="spacrContainer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrContainer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span>, </span><span class="param"><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span>, </span><span class="param"><span class="n">bg</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrContainer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.__init__-256"><a href="#spacrContainer.__init__-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrContainer.__init__-257"><a href="#spacrContainer.__init__-257"><span class="linenos">257</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrContainer.__init__-258"><a href="#spacrContainer.__init__-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">=</span> <span class="n">orient</span>
</span><span id="spacrContainer.__init__-259"><a href="#spacrContainer.__init__-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">bg</span> <span class="k">if</span> <span class="n">bg</span> <span class="k">else</span> <span class="s1">&#39;lightgrey&#39;</span>
</span><span id="spacrContainer.__init__-260"><a href="#spacrContainer.__init__-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="spacrContainer.__init__-261"><a href="#spacrContainer.__init__-261"><span class="linenos">261</span></a>
</span><span id="spacrContainer.__init__-262"><a href="#spacrContainer.__init__-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">panes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="spacrContainer.__init__-263"><a href="#spacrContainer.__init__-263"><span class="linenos">263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sashes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="spacrContainer.__init__-264"><a href="#spacrContainer.__init__-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_configure</span><span class="p">)</span>
</span><span id="spacrContainer.__init__-265"><a href="#spacrContainer.__init__-265"><span class="linenos">265</span></a>
</span><span id="spacrContainer.__init__-266"><a href="#spacrContainer.__init__-266"><span class="linenos">266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrContainer.__init__-267"><a href="#spacrContainer.__init__-267"><span class="linenos">267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrContainer.orient" class="classattr">
                                <div class="attr variable">
            <span class="name">orient</span>

        
    </div>
    <a class="headerlink" href="#spacrContainer.orient"></a>
    
    

                            </div>
                            <div id="spacrContainer.bg" class="classattr">
                                <div class="attr variable">
            <span class="name">bg</span>

        
    </div>
    <a class="headerlink" href="#spacrContainer.bg"></a>
    
    

                            </div>
                            <div id="spacrContainer.sash_thickness" class="classattr">
                                <div class="attr variable">
            <span class="name">sash_thickness</span>

        
    </div>
    <a class="headerlink" href="#spacrContainer.sash_thickness"></a>
    
    

                            </div>
                            <div id="spacrContainer.panes" class="classattr">
                                <div class="attr variable">
            <span class="name">panes</span>

        
    </div>
    <a class="headerlink" href="#spacrContainer.panes"></a>
    
    

                            </div>
                            <div id="spacrContainer.sashes" class="classattr">
                                <div class="attr variable">
            <span class="name">sashes</span>

        
    </div>
    <a class="headerlink" href="#spacrContainer.sashes"></a>
    
    

                            </div>
                            <div id="spacrContainer.add" class="classattr">
                                        <input id="spacrContainer.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">widget</span>, </span><span class="param"><span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;always&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.add-269"><a href="#spacrContainer.add-269"><span class="linenos">269</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">):</span>
</span><span id="spacrContainer.add-270"><a href="#spacrContainer.add-270"><span class="linenos">270</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding widget: </span><span class="si">{</span><span class="n">widget</span><span class="si">}</span><span class="s2"> with stretch: </span><span class="si">{</span><span class="n">stretch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrContainer.add-271"><a href="#spacrContainer.add-271"><span class="linenos">271</span></a>        <span class="n">pane</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">)</span>
</span><span id="spacrContainer.add-272"><a href="#spacrContainer.add-272"><span class="linenos">272</span></a>        <span class="n">pane</span><span class="o">.</span><span class="n">grid_propagate</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrContainer.add-273"><a href="#spacrContainer.add-273"><span class="linenos">273</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">pane</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>  <span class="c1"># Use grid for the widget within the pane</span>
</span><span id="spacrContainer.add-274"><a href="#spacrContainer.add-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">))</span>
</span><span id="spacrContainer.add-275"><a href="#spacrContainer.add-275"><span class="linenos">275</span></a>
</span><span id="spacrContainer.add-276"><a href="#spacrContainer.add-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="spacrContainer.add-277"><a href="#spacrContainer.add-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">create_sash</span><span class="p">()</span>
</span><span id="spacrContainer.add-278"><a href="#spacrContainer.add-278"><span class="linenos">278</span></a>
</span><span id="spacrContainer.add-279"><a href="#spacrContainer.add-279"><span class="linenos">279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.create_sash" class="classattr">
                                        <input id="spacrContainer.create_sash-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sash</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.create_sash-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.create_sash"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.create_sash-281"><a href="#spacrContainer.create_sash-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">create_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrContainer.create_sash-282"><a href="#spacrContainer.create_sash-282"><span class="linenos">282</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span> <span class="n">cursor</span><span class="o">=</span><span class="s1">&#39;sb_v_double_arrow&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="s1">&#39;sb_h_double_arrow&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer.create_sash-283"><a href="#spacrContainer.create_sash-283"><span class="linenos">283</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter_sash</span><span class="p">)</span>
</span><span id="spacrContainer.create_sash-284"><a href="#spacrContainer.create_sash-284"><span class="linenos">284</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave_sash</span><span class="p">)</span>
</span><span id="spacrContainer.create_sash-285"><a href="#spacrContainer.create_sash-285"><span class="linenos">285</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonPress-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_resize</span><span class="p">)</span>
</span><span id="spacrContainer.create_sash-286"><a href="#spacrContainer.create_sash-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sash</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.reposition_panes" class="classattr">
                                        <input id="spacrContainer.reposition_panes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reposition_panes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.reposition_panes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.reposition_panes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.reposition_panes-288"><a href="#spacrContainer.reposition_panes-288"><span class="linenos">288</span></a>    <span class="k">def</span> <span class="nf">reposition_panes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrContainer.reposition_panes-289"><a href="#spacrContainer.reposition_panes-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">:</span>
</span><span id="spacrContainer.reposition_panes-290"><a href="#spacrContainer.reposition_panes-290"><span class="linenos">290</span></a>            <span class="k">return</span>
</span><span id="spacrContainer.reposition_panes-291"><a href="#spacrContainer.reposition_panes-291"><span class="linenos">291</span></a>
</span><span id="spacrContainer.reposition_panes-292"><a href="#spacrContainer.reposition_panes-292"><span class="linenos">292</span></a>        <span class="n">total_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="spacrContainer.reposition_panes-293"><a href="#spacrContainer.reposition_panes-293"><span class="linenos">293</span></a>        <span class="n">pane_size</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span>
</span><span id="spacrContainer.reposition_panes-294"><a href="#spacrContainer.reposition_panes-294"><span class="linenos">294</span></a>
</span><span id="spacrContainer.reposition_panes-295"><a href="#spacrContainer.reposition_panes-295"><span class="linenos">295</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total size: </span><span class="si">{</span><span class="n">total_size</span><span class="si">}</span><span class="s2">, Pane size: </span><span class="si">{</span><span class="n">pane_size</span><span class="si">}</span><span class="s2">, Number of panes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrContainer.reposition_panes-296"><a href="#spacrContainer.reposition_panes-296"><span class="linenos">296</span></a>
</span><span id="spacrContainer.reposition_panes-297"><a href="#spacrContainer.reposition_panes-297"><span class="linenos">297</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">):</span>
</span><span id="spacrContainer.reposition_panes-298"><a href="#spacrContainer.reposition_panes-298"><span class="linenos">298</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="spacrContainer.reposition_panes-299"><a href="#spacrContainer.reposition_panes-299"><span class="linenos">299</span></a>                <span class="n">pane</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="spacrContainer.reposition_panes-300"><a href="#spacrContainer.reposition_panes-300"><span class="linenos">300</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrContainer.reposition_panes-301"><a href="#spacrContainer.reposition_panes-301"><span class="linenos">301</span></a>                <span class="n">pane</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="spacrContainer.reposition_panes-302"><a href="#spacrContainer.reposition_panes-302"><span class="linenos">302</span></a>
</span><span id="spacrContainer.reposition_panes-303"><a href="#spacrContainer.reposition_panes-303"><span class="linenos">303</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sash</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sashes</span><span class="p">):</span>
</span><span id="spacrContainer.reposition_panes-304"><a href="#spacrContainer.reposition_panes-304"><span class="linenos">304</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="spacrContainer.reposition_panes-305"><a href="#spacrContainer.reposition_panes-305"><span class="linenos">305</span></a>                <span class="n">sash</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="spacrContainer.reposition_panes-306"><a href="#spacrContainer.reposition_panes-306"><span class="linenos">306</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrContainer.reposition_panes-307"><a href="#spacrContainer.reposition_panes-307"><span class="linenos">307</span></a>                <span class="n">sash</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.on_configure" class="classattr">
                                        <input id="spacrContainer.on_configure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_configure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.on_configure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.on_configure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.on_configure-309"><a href="#spacrContainer.on_configure-309"><span class="linenos">309</span></a>    <span class="k">def</span> <span class="nf">on_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer.on_configure-310"><a href="#spacrContainer.on_configure-310"><span class="linenos">310</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring container: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrContainer.on_configure-311"><a href="#spacrContainer.on_configure-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.on_enter_sash" class="classattr">
                                        <input id="spacrContainer.on_enter_sash-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_enter_sash</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.on_enter_sash-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.on_enter_sash"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.on_enter_sash-313"><a href="#spacrContainer.on_enter_sash-313"><span class="linenos">313</span></a>    <span class="k">def</span> <span class="nf">on_enter_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer.on_enter_sash-314"><a href="#spacrContainer.on_enter_sash-314"><span class="linenos">314</span></a>        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.on_leave_sash" class="classattr">
                                        <input id="spacrContainer.on_leave_sash-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_leave_sash</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.on_leave_sash-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.on_leave_sash"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.on_leave_sash-316"><a href="#spacrContainer.on_leave_sash-316"><span class="linenos">316</span></a>    <span class="k">def</span> <span class="nf">on_leave_sash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer.on_leave_sash-317"><a href="#spacrContainer.on_leave_sash-317"><span class="linenos">317</span></a>        <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.start_resize" class="classattr">
                                        <input id="spacrContainer.start_resize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">start_resize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.start_resize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.start_resize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.start_resize-319"><a href="#spacrContainer.start_resize-319"><span class="linenos">319</span></a>    <span class="k">def</span> <span class="nf">start_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer.start_resize-320"><a href="#spacrContainer.start_resize-320"><span class="linenos">320</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span>
</span><span id="spacrContainer.start_resize-321"><a href="#spacrContainer.start_resize-321"><span class="linenos">321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span>
</span><span id="spacrContainer.start_resize-322"><a href="#spacrContainer.start_resize-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_size</span> <span class="o">=</span> <span class="n">sash</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="n">sash</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span>
</span><span id="spacrContainer.start_resize-323"><a href="#spacrContainer.start_resize-323"><span class="linenos">323</span></a>        <span class="n">sash</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_resize</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrContainer.perform_resize" class="classattr">
                                        <input id="spacrContainer.perform_resize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">perform_resize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrContainer.perform_resize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrContainer.perform_resize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrContainer.perform_resize-325"><a href="#spacrContainer.perform_resize-325"><span class="linenos">325</span></a>    <span class="k">def</span> <span class="nf">perform_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrContainer.perform_resize-326"><a href="#spacrContainer.perform_resize-326"><span class="linenos">326</span></a>        <span class="n">sash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span>
</span><span id="spacrContainer.perform_resize-327"><a href="#spacrContainer.perform_resize-327"><span class="linenos">327</span></a>        <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span> <span class="k">else</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-328"><a href="#spacrContainer.perform_resize-328"><span class="linenos">328</span></a>        <span class="n">new_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_size</span> <span class="o">+</span> <span class="n">delta</span>
</span><span id="spacrContainer.perform_resize-329"><a href="#spacrContainer.perform_resize-329"><span class="linenos">329</span></a>
</span><span id="spacrContainer.perform_resize-330"><a href="#spacrContainer.perform_resize-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pane</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">):</span>
</span><span id="spacrContainer.perform_resize-331"><a href="#spacrContainer.perform_resize-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orient</span> <span class="o">==</span> <span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">:</span>
</span><span id="spacrContainer.perform_resize-332"><a href="#spacrContainer.perform_resize-332"><span class="linenos">332</span></a>                <span class="n">new_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-333"><a href="#spacrContainer.perform_resize-333"><span class="linenos">333</span></a>                <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">new_size</span><span class="p">:</span>
</span><span id="spacrContainer.perform_resize-334"><a href="#spacrContainer.perform_resize-334"><span class="linenos">334</span></a>                    <span class="n">pane</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">new_row</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-335"><a href="#spacrContainer.perform_resize-335"><span class="linenos">335</span></a>                <span class="k">elif</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">new_size</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="spacrContainer.perform_resize-336"><a href="#spacrContainer.perform_resize-336"><span class="linenos">336</span></a>                    <span class="n">previous_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">-</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">())</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-337"><a href="#spacrContainer.perform_resize-337"><span class="linenos">337</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">previous_row</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-338"><a href="#spacrContainer.perform_resize-338"><span class="linenos">338</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrContainer.perform_resize-339"><a href="#spacrContainer.perform_resize-339"><span class="linenos">339</span></a>                <span class="n">new_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-340"><a href="#spacrContainer.perform_resize-340"><span class="linenos">340</span></a>                <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">new_size</span><span class="p">:</span>
</span><span id="spacrContainer.perform_resize-341"><a href="#spacrContainer.perform_resize-341"><span class="linenos">341</span></a>                    <span class="n">pane</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">new_col</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-342"><a href="#spacrContainer.perform_resize-342"><span class="linenos">342</span></a>                <span class="k">elif</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_x</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">new_size</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="spacrContainer.perform_resize-343"><a href="#spacrContainer.perform_resize-343"><span class="linenos">343</span></a>                    <span class="n">previous_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">-</span> <span class="n">pane</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">())</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">sash_thickness</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-344"><a href="#spacrContainer.perform_resize-344"><span class="linenos">344</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">panes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">previous_col</span><span class="p">)</span>
</span><span id="spacrContainer.perform_resize-345"><a href="#spacrContainer.perform_resize-345"><span class="linenos">345</span></a>
</span><span id="spacrContainer.perform_resize-346"><a href="#spacrContainer.perform_resize-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reposition_panes</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrEntry">
                            <input id="spacrEntry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrEntry</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrEntry-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrEntry"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrEntry-348"><a href="#spacrEntry-348"><span class="linenos">348</span></a><span class="k">class</span> <span class="nc">spacrEntry</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrEntry-349"><a href="#spacrEntry-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrEntry-350"><a href="#spacrEntry-350"><span class="linenos">350</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrEntry-351"><a href="#spacrEntry-351"><span class="linenos">351</span></a>        
</span><span id="spacrEntry-352"><a href="#spacrEntry-352"><span class="linenos">352</span></a>        <span class="c1"># Set dark style</span>
</span><span id="spacrEntry-353"><a href="#spacrEntry-353"><span class="linenos">353</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrEntry-354"><a href="#spacrEntry-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrEntry-355"><a href="#spacrEntry-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrEntry-356"><a href="#spacrEntry-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrEntry-357"><a href="#spacrEntry-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>
</span><span id="spacrEntry-358"><a href="#spacrEntry-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrEntry-359"><a href="#spacrEntry-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrEntry-360"><a href="#spacrEntry-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrEntry-361"><a href="#spacrEntry-361"><span class="linenos">361</span></a>        
</span><span id="spacrEntry-362"><a href="#spacrEntry-362"><span class="linenos">362</span></a>        <span class="c1"># Set the background color of the frame</span>
</span><span id="spacrEntry-363"><a href="#spacrEntry-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrEntry-364"><a href="#spacrEntry-364"><span class="linenos">364</span></a>
</span><span id="spacrEntry-365"><a href="#spacrEntry-365"><span class="linenos">365</span></a>        <span class="c1"># Create a canvas for the rounded rectangle background</span>
</span><span id="spacrEntry-366"><a href="#spacrEntry-366"><span class="linenos">366</span></a>        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrEntry-367"><a href="#spacrEntry-367"><span class="linenos">367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="mi">220</span>  <span class="c1"># Adjusted for padding</span>
</span><span id="spacrEntry-368"><a href="#spacrEntry-368"><span class="linenos">368</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrEntry-369"><a href="#spacrEntry-369"><span class="linenos">369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="n">width</span>
</span><span id="spacrEntry-370"><a href="#spacrEntry-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1"># Adjusted for padding</span>
</span><span id="spacrEntry-371"><a href="#spacrEntry-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrEntry-372"><a href="#spacrEntry-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="spacrEntry-373"><a href="#spacrEntry-373"><span class="linenos">373</span></a>        
</span><span id="spacrEntry-374"><a href="#spacrEntry-374"><span class="linenos">374</span></a>        <span class="c1"># Create the entry widget</span>
</span><span id="spacrEntry-375"><a href="#spacrEntry-375"><span class="linenos">375</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrEntry-376"><a href="#spacrEntry-376"><span class="linenos">376</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">textvariable</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry-377"><a href="#spacrEntry-377"><span class="linenos">377</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrEntry-378"><a href="#spacrEntry-378"><span class="linenos">378</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">textvariable</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry-379"><a href="#spacrEntry-379"><span class="linenos">379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rely</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># Centered positioning</span>
</span><span id="spacrEntry-380"><a href="#spacrEntry-380"><span class="linenos">380</span></a>        
</span><span id="spacrEntry-381"><a href="#spacrEntry-381"><span class="linenos">381</span></a>        <span class="c1"># Bind events to change the background color on focus</span>
</span><span id="spacrEntry-382"><a href="#spacrEntry-382"><span class="linenos">382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focus_in</span><span class="p">)</span>
</span><span id="spacrEntry-383"><a href="#spacrEntry-383"><span class="linenos">383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focus_out</span><span class="p">)</span>
</span><span id="spacrEntry-384"><a href="#spacrEntry-384"><span class="linenos">384</span></a>        
</span><span id="spacrEntry-385"><a href="#spacrEntry-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry-386"><a href="#spacrEntry-386"><span class="linenos">386</span></a>
</span><span id="spacrEntry-387"><a href="#spacrEntry-387"><span class="linenos">387</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="spacrEntry-388"><a href="#spacrEntry-388"><span class="linenos">388</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Increased radius for more rounded corners</span>
</span><span id="spacrEntry-389"><a href="#spacrEntry-389"><span class="linenos">389</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</span><span id="spacrEntry-390"><a href="#spacrEntry-390"><span class="linenos">390</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="mi">5</span>
</span><span id="spacrEntry-391"><a href="#spacrEntry-391"><span class="linenos">391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrEntry-392"><a href="#spacrEntry-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry-393"><a href="#spacrEntry-393"><span class="linenos">393</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry-394"><a href="#spacrEntry-394"><span class="linenos">394</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry-395"><a href="#spacrEntry-395"><span class="linenos">395</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry-396"><a href="#spacrEntry-396"><span class="linenos">396</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry-397"><a href="#spacrEntry-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry-398"><a href="#spacrEntry-398"><span class="linenos">398</span></a>    
</span><span id="spacrEntry-399"><a href="#spacrEntry-399"><span class="linenos">399</span></a>    <span class="k">def</span> <span class="nf">on_focus_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrEntry-400"><a href="#spacrEntry-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrEntry-401"><a href="#spacrEntry-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrEntry-402"><a href="#spacrEntry-402"><span class="linenos">402</span></a>    
</span><span id="spacrEntry-403"><a href="#spacrEntry-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">on_focus_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrEntry-404"><a href="#spacrEntry-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry-405"><a href="#spacrEntry-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrEntry.__init__" class="classattr">
                                        <input id="spacrEntry.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrEntry</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">parent</span>,</span><span class="param">	<span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">outline</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">width</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrEntry.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrEntry.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrEntry.__init__-349"><a href="#spacrEntry.__init__-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrEntry.__init__-350"><a href="#spacrEntry.__init__-350"><span class="linenos">350</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrEntry.__init__-351"><a href="#spacrEntry.__init__-351"><span class="linenos">351</span></a>        
</span><span id="spacrEntry.__init__-352"><a href="#spacrEntry.__init__-352"><span class="linenos">352</span></a>        <span class="c1"># Set dark style</span>
</span><span id="spacrEntry.__init__-353"><a href="#spacrEntry.__init__-353"><span class="linenos">353</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrEntry.__init__-354"><a href="#spacrEntry.__init__-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrEntry.__init__-355"><a href="#spacrEntry.__init__-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrEntry.__init__-356"><a href="#spacrEntry.__init__-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrEntry.__init__-357"><a href="#spacrEntry.__init__-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>
</span><span id="spacrEntry.__init__-358"><a href="#spacrEntry.__init__-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrEntry.__init__-359"><a href="#spacrEntry.__init__-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrEntry.__init__-360"><a href="#spacrEntry.__init__-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrEntry.__init__-361"><a href="#spacrEntry.__init__-361"><span class="linenos">361</span></a>        
</span><span id="spacrEntry.__init__-362"><a href="#spacrEntry.__init__-362"><span class="linenos">362</span></a>        <span class="c1"># Set the background color of the frame</span>
</span><span id="spacrEntry.__init__-363"><a href="#spacrEntry.__init__-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrEntry.__init__-364"><a href="#spacrEntry.__init__-364"><span class="linenos">364</span></a>
</span><span id="spacrEntry.__init__-365"><a href="#spacrEntry.__init__-365"><span class="linenos">365</span></a>        <span class="c1"># Create a canvas for the rounded rectangle background</span>
</span><span id="spacrEntry.__init__-366"><a href="#spacrEntry.__init__-366"><span class="linenos">366</span></a>        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrEntry.__init__-367"><a href="#spacrEntry.__init__-367"><span class="linenos">367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="mi">220</span>  <span class="c1"># Adjusted for padding</span>
</span><span id="spacrEntry.__init__-368"><a href="#spacrEntry.__init__-368"><span class="linenos">368</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrEntry.__init__-369"><a href="#spacrEntry.__init__-369"><span class="linenos">369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="n">width</span>
</span><span id="spacrEntry.__init__-370"><a href="#spacrEntry.__init__-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1"># Adjusted for padding</span>
</span><span id="spacrEntry.__init__-371"><a href="#spacrEntry.__init__-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrEntry.__init__-372"><a href="#spacrEntry.__init__-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="spacrEntry.__init__-373"><a href="#spacrEntry.__init__-373"><span class="linenos">373</span></a>        
</span><span id="spacrEntry.__init__-374"><a href="#spacrEntry.__init__-374"><span class="linenos">374</span></a>        <span class="c1"># Create the entry widget</span>
</span><span id="spacrEntry.__init__-375"><a href="#spacrEntry.__init__-375"><span class="linenos">375</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrEntry.__init__-376"><a href="#spacrEntry.__init__-376"><span class="linenos">376</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">textvariable</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry.__init__-377"><a href="#spacrEntry.__init__-377"><span class="linenos">377</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrEntry.__init__-378"><a href="#spacrEntry.__init__-378"><span class="linenos">378</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">textvariable</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry.__init__-379"><a href="#spacrEntry.__init__-379"><span class="linenos">379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rely</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># Centered positioning</span>
</span><span id="spacrEntry.__init__-380"><a href="#spacrEntry.__init__-380"><span class="linenos">380</span></a>        
</span><span id="spacrEntry.__init__-381"><a href="#spacrEntry.__init__-381"><span class="linenos">381</span></a>        <span class="c1"># Bind events to change the background color on focus</span>
</span><span id="spacrEntry.__init__-382"><a href="#spacrEntry.__init__-382"><span class="linenos">382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focus_in</span><span class="p">)</span>
</span><span id="spacrEntry.__init__-383"><a href="#spacrEntry.__init__-383"><span class="linenos">383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focus_out</span><span class="p">)</span>
</span><span id="spacrEntry.__init__-384"><a href="#spacrEntry.__init__-384"><span class="linenos">384</span></a>        
</span><span id="spacrEntry.__init__-385"><a href="#spacrEntry.__init__-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrEntry.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.bg_color"></a>
    
    

                            </div>
                            <div id="spacrEntry.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.active_color"></a>
    
    

                            </div>
                            <div id="spacrEntry.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.fg_color"></a>
    
    

                            </div>
                            <div id="spacrEntry.outline" class="classattr">
                                <div class="attr variable">
            <span class="name">outline</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.outline"></a>
    
    

                            </div>
                            <div id="spacrEntry.font_family" class="classattr">
                                <div class="attr variable">
            <span class="name">font_family</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.font_family"></a>
    
    

                            </div>
                            <div id="spacrEntry.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.font_size"></a>
    
    

                            </div>
                            <div id="spacrEntry.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.font_loader"></a>
    
    

                            </div>
                            <div id="spacrEntry.canvas_height" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_height</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.canvas_height"></a>
    
    

                            </div>
                            <div id="spacrEntry.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrEntry.canvas"></a>
    
    

                            </div>
                            <div id="spacrEntry.draw_rounded_rectangle" class="classattr">
                                        <input id="spacrEntry.draw_rounded_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_rounded_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrEntry.draw_rounded_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrEntry.draw_rounded_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrEntry.draw_rounded_rectangle-387"><a href="#spacrEntry.draw_rounded_rectangle-387"><span class="linenos">387</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="spacrEntry.draw_rounded_rectangle-388"><a href="#spacrEntry.draw_rounded_rectangle-388"><span class="linenos">388</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Increased radius for more rounded corners</span>
</span><span id="spacrEntry.draw_rounded_rectangle-389"><a href="#spacrEntry.draw_rounded_rectangle-389"><span class="linenos">389</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</span><span id="spacrEntry.draw_rounded_rectangle-390"><a href="#spacrEntry.draw_rounded_rectangle-390"><span class="linenos">390</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="mi">5</span>
</span><span id="spacrEntry.draw_rounded_rectangle-391"><a href="#spacrEntry.draw_rounded_rectangle-391"><span class="linenos">391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrEntry.draw_rounded_rectangle-392"><a href="#spacrEntry.draw_rounded_rectangle-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry.draw_rounded_rectangle-393"><a href="#spacrEntry.draw_rounded_rectangle-393"><span class="linenos">393</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry.draw_rounded_rectangle-394"><a href="#spacrEntry.draw_rounded_rectangle-394"><span class="linenos">394</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry.draw_rounded_rectangle-395"><a href="#spacrEntry.draw_rounded_rectangle-395"><span class="linenos">395</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry.draw_rounded_rectangle-396"><a href="#spacrEntry.draw_rounded_rectangle-396"><span class="linenos">396</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrEntry.draw_rounded_rectangle-397"><a href="#spacrEntry.draw_rounded_rectangle-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrEntry.on_focus_in" class="classattr">
                                        <input id="spacrEntry.on_focus_in-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_focus_in</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrEntry.on_focus_in-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrEntry.on_focus_in"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrEntry.on_focus_in-399"><a href="#spacrEntry.on_focus_in-399"><span class="linenos">399</span></a>    <span class="k">def</span> <span class="nf">on_focus_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrEntry.on_focus_in-400"><a href="#spacrEntry.on_focus_in-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrEntry.on_focus_in-401"><a href="#spacrEntry.on_focus_in-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrEntry.on_focus_out" class="classattr">
                                        <input id="spacrEntry.on_focus_out-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_focus_out</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrEntry.on_focus_out-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrEntry.on_focus_out"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrEntry.on_focus_out-403"><a href="#spacrEntry.on_focus_out-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">on_focus_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrEntry.on_focus_out-404"><a href="#spacrEntry.on_focus_out-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrEntry.on_focus_out-405"><a href="#spacrEntry.on_focus_out-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrCheck">
                            <input id="spacrCheck-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrCheck</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrCheck-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheck"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheck-407"><a href="#spacrCheck-407"><span class="linenos">407</span></a><span class="k">class</span> <span class="nc">spacrCheck</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrCheck-408"><a href="#spacrCheck-408"><span class="linenos">408</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrCheck-409"><a href="#spacrCheck-409"><span class="linenos">409</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrCheck-410"><a href="#spacrCheck-410"><span class="linenos">410</span></a>        
</span><span id="spacrCheck-411"><a href="#spacrCheck-411"><span class="linenos">411</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrCheck-412"><a href="#spacrCheck-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck-413"><a href="#spacrCheck-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck-414"><a href="#spacrCheck-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck-415"><a href="#spacrCheck-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck-416"><a href="#spacrCheck-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
</span><span id="spacrCheck-417"><a href="#spacrCheck-417"><span class="linenos">417</span></a>
</span><span id="spacrCheck-418"><a href="#spacrCheck-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrCheck-419"><a href="#spacrCheck-419"><span class="linenos">419</span></a>
</span><span id="spacrCheck-420"><a href="#spacrCheck-420"><span class="linenos">420</span></a>        <span class="c1"># Create a canvas for the rounded square background</span>
</span><span id="spacrCheck-421"><a href="#spacrCheck-421"><span class="linenos">421</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="spacrCheck-422"><a href="#spacrCheck-422"><span class="linenos">422</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="spacrCheck-423"><a href="#spacrCheck-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrCheck-424"><a href="#spacrCheck-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="spacrCheck-425"><a href="#spacrCheck-425"><span class="linenos">425</span></a>
</span><span id="spacrCheck-426"><a href="#spacrCheck-426"><span class="linenos">426</span></a>        <span class="c1"># Draw the initial rounded square based on the variable&#39;s value</span>
</span><span id="spacrCheck-427"><a href="#spacrCheck-427"><span class="linenos">427</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCheck-428"><a href="#spacrCheck-428"><span class="linenos">428</span></a>
</span><span id="spacrCheck-429"><a href="#spacrCheck-429"><span class="linenos">429</span></a>        <span class="c1"># Bind variable changes to update the checkbox</span>
</span><span id="spacrCheck-430"><a href="#spacrCheck-430"><span class="linenos">430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_check</span><span class="p">)</span>
</span><span id="spacrCheck-431"><a href="#spacrCheck-431"><span class="linenos">431</span></a>
</span><span id="spacrCheck-432"><a href="#spacrCheck-432"><span class="linenos">432</span></a>        <span class="c1"># Bind click event to toggle the variable</span>
</span><span id="spacrCheck-433"><a href="#spacrCheck-433"><span class="linenos">433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_variable</span><span class="p">)</span>
</span><span id="spacrCheck-434"><a href="#spacrCheck-434"><span class="linenos">434</span></a>
</span><span id="spacrCheck-435"><a href="#spacrCheck-435"><span class="linenos">435</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="spacrCheck-436"><a href="#spacrCheck-436"><span class="linenos">436</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Adjust the radius for more rounded corners</span>
</span><span id="spacrCheck-437"><a href="#spacrCheck-437"><span class="linenos">437</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
</span><span id="spacrCheck-438"><a href="#spacrCheck-438"><span class="linenos">438</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span>
</span><span id="spacrCheck-439"><a href="#spacrCheck-439"><span class="linenos">439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrCheck-440"><a href="#spacrCheck-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-441"><a href="#spacrCheck-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-442"><a href="#spacrCheck-442"><span class="linenos">442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-443"><a href="#spacrCheck-443"><span class="linenos">443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-444"><a href="#spacrCheck-444"><span class="linenos">444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCheck-445"><a href="#spacrCheck-445"><span class="linenos">445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCheck-446"><a href="#spacrCheck-446"><span class="linenos">446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-447"><a href="#spacrCheck-447"><span class="linenos">447</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-448"><a href="#spacrCheck-448"><span class="linenos">448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-449"><a href="#spacrCheck-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck-450"><a href="#spacrCheck-450"><span class="linenos">450</span></a>
</span><span id="spacrCheck-451"><a href="#spacrCheck-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">update_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="spacrCheck-452"><a href="#spacrCheck-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCheck-453"><a href="#spacrCheck-453"><span class="linenos">453</span></a>
</span><span id="spacrCheck-454"><a href="#spacrCheck-454"><span class="linenos">454</span></a>    <span class="k">def</span> <span class="nf">toggle_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrCheck-455"><a href="#spacrCheck-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrCheck.__init__" class="classattr">
                                        <input id="spacrCheck.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrCheck</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span>, </span><span class="param"><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span>, </span><span class="param"><span class="n">variable</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrCheck.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheck.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheck.__init__-408"><a href="#spacrCheck.__init__-408"><span class="linenos">408</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrCheck.__init__-409"><a href="#spacrCheck.__init__-409"><span class="linenos">409</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrCheck.__init__-410"><a href="#spacrCheck.__init__-410"><span class="linenos">410</span></a>        
</span><span id="spacrCheck.__init__-411"><a href="#spacrCheck.__init__-411"><span class="linenos">411</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrCheck.__init__-412"><a href="#spacrCheck.__init__-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck.__init__-413"><a href="#spacrCheck.__init__-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck.__init__-414"><a href="#spacrCheck.__init__-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck.__init__-415"><a href="#spacrCheck.__init__-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrCheck.__init__-416"><a href="#spacrCheck.__init__-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
</span><span id="spacrCheck.__init__-417"><a href="#spacrCheck.__init__-417"><span class="linenos">417</span></a>
</span><span id="spacrCheck.__init__-418"><a href="#spacrCheck.__init__-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrCheck.__init__-419"><a href="#spacrCheck.__init__-419"><span class="linenos">419</span></a>
</span><span id="spacrCheck.__init__-420"><a href="#spacrCheck.__init__-420"><span class="linenos">420</span></a>        <span class="c1"># Create a canvas for the rounded square background</span>
</span><span id="spacrCheck.__init__-421"><a href="#spacrCheck.__init__-421"><span class="linenos">421</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="spacrCheck.__init__-422"><a href="#spacrCheck.__init__-422"><span class="linenos">422</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="spacrCheck.__init__-423"><a href="#spacrCheck.__init__-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrCheck.__init__-424"><a href="#spacrCheck.__init__-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="spacrCheck.__init__-425"><a href="#spacrCheck.__init__-425"><span class="linenos">425</span></a>
</span><span id="spacrCheck.__init__-426"><a href="#spacrCheck.__init__-426"><span class="linenos">426</span></a>        <span class="c1"># Draw the initial rounded square based on the variable&#39;s value</span>
</span><span id="spacrCheck.__init__-427"><a href="#spacrCheck.__init__-427"><span class="linenos">427</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCheck.__init__-428"><a href="#spacrCheck.__init__-428"><span class="linenos">428</span></a>
</span><span id="spacrCheck.__init__-429"><a href="#spacrCheck.__init__-429"><span class="linenos">429</span></a>        <span class="c1"># Bind variable changes to update the checkbox</span>
</span><span id="spacrCheck.__init__-430"><a href="#spacrCheck.__init__-430"><span class="linenos">430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_check</span><span class="p">)</span>
</span><span id="spacrCheck.__init__-431"><a href="#spacrCheck.__init__-431"><span class="linenos">431</span></a>
</span><span id="spacrCheck.__init__-432"><a href="#spacrCheck.__init__-432"><span class="linenos">432</span></a>        <span class="c1"># Bind click event to toggle the variable</span>
</span><span id="spacrCheck.__init__-433"><a href="#spacrCheck.__init__-433"><span class="linenos">433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_variable</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrCheck.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.bg_color"></a>
    
    

                            </div>
                            <div id="spacrCheck.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.active_color"></a>
    
    

                            </div>
                            <div id="spacrCheck.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.fg_color"></a>
    
    

                            </div>
                            <div id="spacrCheck.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrCheck.variable" class="classattr">
                                <div class="attr variable">
            <span class="name">variable</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.variable"></a>
    
    

                            </div>
                            <div id="spacrCheck.canvas_width" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_width</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.canvas_width"></a>
    
    

                            </div>
                            <div id="spacrCheck.canvas_height" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_height</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.canvas_height"></a>
    
    

                            </div>
                            <div id="spacrCheck.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrCheck.canvas"></a>
    
    

                            </div>
                            <div id="spacrCheck.draw_rounded_square" class="classattr">
                                        <input id="spacrCheck.draw_rounded_square-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_rounded_square</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCheck.draw_rounded_square-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheck.draw_rounded_square"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheck.draw_rounded_square-435"><a href="#spacrCheck.draw_rounded_square-435"><span class="linenos">435</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="spacrCheck.draw_rounded_square-436"><a href="#spacrCheck.draw_rounded_square-436"><span class="linenos">436</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Adjust the radius for more rounded corners</span>
</span><span id="spacrCheck.draw_rounded_square-437"><a href="#spacrCheck.draw_rounded_square-437"><span class="linenos">437</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
</span><span id="spacrCheck.draw_rounded_square-438"><a href="#spacrCheck.draw_rounded_square-438"><span class="linenos">438</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span>
</span><span id="spacrCheck.draw_rounded_square-439"><a href="#spacrCheck.draw_rounded_square-439"><span class="linenos">439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-440"><a href="#spacrCheck.draw_rounded_square-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-441"><a href="#spacrCheck.draw_rounded_square-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-442"><a href="#spacrCheck.draw_rounded_square-442"><span class="linenos">442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-443"><a href="#spacrCheck.draw_rounded_square-443"><span class="linenos">443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-444"><a href="#spacrCheck.draw_rounded_square-444"><span class="linenos">444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-445"><a href="#spacrCheck.draw_rounded_square-445"><span class="linenos">445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-446"><a href="#spacrCheck.draw_rounded_square-446"><span class="linenos">446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-447"><a href="#spacrCheck.draw_rounded_square-447"><span class="linenos">447</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-448"><a href="#spacrCheck.draw_rounded_square-448"><span class="linenos">448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrCheck.draw_rounded_square-449"><a href="#spacrCheck.draw_rounded_square-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCheck.update_check" class="classattr">
                                        <input id="spacrCheck.update_check-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_check</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCheck.update_check-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheck.update_check"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheck.update_check-451"><a href="#spacrCheck.update_check-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">update_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="spacrCheck.update_check-452"><a href="#spacrCheck.update_check-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCheck.toggle_variable" class="classattr">
                                        <input id="spacrCheck.toggle_variable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_variable</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCheck.toggle_variable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheck.toggle_variable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheck.toggle_variable-454"><a href="#spacrCheck.toggle_variable-454"><span class="linenos">454</span></a>    <span class="k">def</span> <span class="nf">toggle_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrCheck.toggle_variable-455"><a href="#spacrCheck.toggle_variable-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrCombo">
                            <input id="spacrCombo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrCombo</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrCombo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo-457"><a href="#spacrCombo-457"><span class="linenos">457</span></a><span class="k">class</span> <span class="nc">spacrCombo</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrCombo-458"><a href="#spacrCombo-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrCombo-459"><a href="#spacrCombo-459"><span class="linenos">459</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrCombo-460"><a href="#spacrCombo-460"><span class="linenos">460</span></a>        
</span><span id="spacrCombo-461"><a href="#spacrCombo-461"><span class="linenos">461</span></a>        <span class="c1"># Set dark style</span>
</span><span id="spacrCombo-462"><a href="#spacrCombo-462"><span class="linenos">462</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrCombo-463"><a href="#spacrCombo-463"><span class="linenos">463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-464"><a href="#spacrCombo-464"><span class="linenos">464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-465"><a href="#spacrCombo-465"><span class="linenos">465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-466"><a href="#spacrCombo-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-467"><a href="#spacrCombo-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-468"><a href="#spacrCombo-468"><span class="linenos">468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-469"><a href="#spacrCombo-469"><span class="linenos">469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrCombo-470"><a href="#spacrCombo-470"><span class="linenos">470</span></a>
</span><span id="spacrCombo-471"><a href="#spacrCombo-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="spacrCombo-472"><a href="#spacrCombo-472"><span class="linenos">472</span></a>
</span><span id="spacrCombo-473"><a href="#spacrCombo-473"><span class="linenos">473</span></a>        <span class="c1"># Create a canvas for the rounded rectangle background</span>
</span><span id="spacrCombo-474"><a href="#spacrCombo-474"><span class="linenos">474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="n">width</span> <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">220</span>  <span class="c1"># Adjusted for padding</span>
</span><span id="spacrCombo-475"><a href="#spacrCombo-475"><span class="linenos">475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1"># Adjusted for padding</span>
</span><span id="spacrCombo-476"><a href="#spacrCombo-476"><span class="linenos">476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrCombo-477"><a href="#spacrCombo-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="spacrCombo-478"><a href="#spacrCombo-478"><span class="linenos">478</span></a>        
</span><span id="spacrCombo-479"><a href="#spacrCombo-479"><span class="linenos">479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">textvariable</span> <span class="k">if</span> <span class="n">textvariable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="spacrCombo-480"><a href="#spacrCombo-480"><span class="linenos">480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="spacrCombo-481"><a href="#spacrCombo-481"><span class="linenos">481</span></a>        
</span><span id="spacrCombo-482"><a href="#spacrCombo-482"><span class="linenos">482</span></a>        <span class="c1"># Create the label to display the selected value</span>
</span><span id="spacrCombo-483"><a href="#spacrCombo-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrCombo-484"><a href="#spacrCombo-484"><span class="linenos">484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="spacrCombo-485"><a href="#spacrCombo-485"><span class="linenos">485</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrCombo-486"><a href="#spacrCombo-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="spacrCombo-487"><a href="#spacrCombo-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rely</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
</span><span id="spacrCombo-488"><a href="#spacrCombo-488"><span class="linenos">488</span></a>        
</span><span id="spacrCombo-489"><a href="#spacrCombo-489"><span class="linenos">489</span></a>        <span class="c1"># Bind events to open the dropdown menu</span>
</span><span id="spacrCombo-490"><a href="#spacrCombo-490"><span class="linenos">490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrCombo-491"><a href="#spacrCombo-491"><span class="linenos">491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrCombo-492"><a href="#spacrCombo-492"><span class="linenos">492</span></a>        
</span><span id="spacrCombo-493"><a href="#spacrCombo-493"><span class="linenos">493</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCombo-494"><a href="#spacrCombo-494"><span class="linenos">494</span></a>
</span><span id="spacrCombo-495"><a href="#spacrCombo-495"><span class="linenos">495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrCombo-496"><a href="#spacrCombo-496"><span class="linenos">496</span></a>
</span><span id="spacrCombo-497"><a href="#spacrCombo-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="spacrCombo-498"><a href="#spacrCombo-498"><span class="linenos">498</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Increased radius for more rounded corners</span>
</span><span id="spacrCombo-499"><a href="#spacrCombo-499"><span class="linenos">499</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</span><span id="spacrCombo-500"><a href="#spacrCombo-500"><span class="linenos">500</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="mi">5</span>
</span><span id="spacrCombo-501"><a href="#spacrCombo-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrCombo-502"><a href="#spacrCombo-502"><span class="linenos">502</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo-503"><a href="#spacrCombo-503"><span class="linenos">503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo-504"><a href="#spacrCombo-504"><span class="linenos">504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo-505"><a href="#spacrCombo-505"><span class="linenos">505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo-506"><a href="#spacrCombo-506"><span class="linenos">506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo-507"><a href="#spacrCombo-507"><span class="linenos">507</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo-508"><a href="#spacrCombo-508"><span class="linenos">508</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># Update label background to match rectangle color</span>
</span><span id="spacrCombo-509"><a href="#spacrCombo-509"><span class="linenos">509</span></a>
</span><span id="spacrCombo-510"><a href="#spacrCombo-510"><span class="linenos">510</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrCombo-511"><a href="#spacrCombo-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrCombo-512"><a href="#spacrCombo-512"><span class="linenos">512</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_dropdown</span><span class="p">()</span>
</span><span id="spacrCombo-513"><a href="#spacrCombo-513"><span class="linenos">513</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrCombo-514"><a href="#spacrCombo-514"><span class="linenos">514</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close_dropdown</span><span class="p">()</span>
</span><span id="spacrCombo-515"><a href="#spacrCombo-515"><span class="linenos">515</span></a>
</span><span id="spacrCombo-516"><a href="#spacrCombo-516"><span class="linenos">516</span></a>    <span class="k">def</span> <span class="nf">open_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrCombo-517"><a href="#spacrCombo-517"><span class="linenos">517</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrCombo-518"><a href="#spacrCombo-518"><span class="linenos">518</span></a>        
</span><span id="spacrCombo-519"><a href="#spacrCombo-519"><span class="linenos">519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="spacrCombo-520"><a href="#spacrCombo-520"><span class="linenos">520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrCombo-521"><a href="#spacrCombo-521"><span class="linenos">521</span></a>        
</span><span id="spacrCombo-522"><a href="#spacrCombo-522"><span class="linenos">522</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="spacrCombo-523"><a href="#spacrCombo-523"><span class="linenos">523</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">30</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrCombo-524"><a href="#spacrCombo-524"><span class="linenos">524</span></a>        
</span><span id="spacrCombo-525"><a href="#spacrCombo-525"><span class="linenos">525</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="spacrCombo-526"><a href="#spacrCombo-526"><span class="linenos">526</span></a>            <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="spacrCombo-527"><a href="#spacrCombo-527"><span class="linenos">527</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrCombo-528"><a href="#spacrCombo-528"><span class="linenos">528</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="spacrCombo-529"><a href="#spacrCombo-529"><span class="linenos">529</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrCombo-530"><a href="#spacrCombo-530"><span class="linenos">530</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="spacrCombo-531"><a href="#spacrCombo-531"><span class="linenos">531</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span><span id="spacrCombo-532"><a href="#spacrCombo-532"><span class="linenos">532</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_select</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</span><span id="spacrCombo-533"><a href="#spacrCombo-533"><span class="linenos">533</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">item</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">))</span>
</span><span id="spacrCombo-534"><a href="#spacrCombo-534"><span class="linenos">534</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">item</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">))</span>
</span><span id="spacrCombo-535"><a href="#spacrCombo-535"><span class="linenos">535</span></a>
</span><span id="spacrCombo-536"><a href="#spacrCombo-536"><span class="linenos">536</span></a>    <span class="k">def</span> <span class="nf">close_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrCombo-537"><a href="#spacrCombo-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCombo-538"><a href="#spacrCombo-538"><span class="linenos">538</span></a>        
</span><span id="spacrCombo-539"><a href="#spacrCombo-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">:</span>
</span><span id="spacrCombo-540"><a href="#spacrCombo-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="spacrCombo-541"><a href="#spacrCombo-541"><span class="linenos">541</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrCombo-542"><a href="#spacrCombo-542"><span class="linenos">542</span></a>
</span><span id="spacrCombo-543"><a href="#spacrCombo-543"><span class="linenos">543</span></a>    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrCombo-544"><a href="#spacrCombo-544"><span class="linenos">544</span></a>        <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="spacrCombo-545"><a href="#spacrCombo-545"><span class="linenos">545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrCombo-546"><a href="#spacrCombo-546"><span class="linenos">546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">)</span>
</span><span id="spacrCombo-547"><a href="#spacrCombo-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="spacrCombo-548"><a href="#spacrCombo-548"><span class="linenos">548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close_dropdown</span><span class="p">()</span>
</span><span id="spacrCombo-549"><a href="#spacrCombo-549"><span class="linenos">549</span></a>
</span><span id="spacrCombo-550"><a href="#spacrCombo-550"><span class="linenos">550</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrCombo-551"><a href="#spacrCombo-551"><span class="linenos">551</span></a>        <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="spacrCombo-552"><a href="#spacrCombo-552"><span class="linenos">552</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrCombo-553"><a href="#spacrCombo-553"><span class="linenos">553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">)</span>
</span><span id="spacrCombo-554"><a href="#spacrCombo-554"><span class="linenos">554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrCombo.__init__" class="classattr">
                                        <input id="spacrCombo.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrCombo</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span>, </span><span class="param"><span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">values</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">width</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrCombo.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.__init__-458"><a href="#spacrCombo.__init__-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrCombo.__init__-459"><a href="#spacrCombo.__init__-459"><span class="linenos">459</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrCombo.__init__-460"><a href="#spacrCombo.__init__-460"><span class="linenos">460</span></a>        
</span><span id="spacrCombo.__init__-461"><a href="#spacrCombo.__init__-461"><span class="linenos">461</span></a>        <span class="c1"># Set dark style</span>
</span><span id="spacrCombo.__init__-462"><a href="#spacrCombo.__init__-462"><span class="linenos">462</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrCombo.__init__-463"><a href="#spacrCombo.__init__-463"><span class="linenos">463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-464"><a href="#spacrCombo.__init__-464"><span class="linenos">464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-465"><a href="#spacrCombo.__init__-465"><span class="linenos">465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-466"><a href="#spacrCombo.__init__-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-467"><a href="#spacrCombo.__init__-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-468"><a href="#spacrCombo.__init__-468"><span class="linenos">468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-469"><a href="#spacrCombo.__init__-469"><span class="linenos">469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrCombo.__init__-470"><a href="#spacrCombo.__init__-470"><span class="linenos">470</span></a>
</span><span id="spacrCombo.__init__-471"><a href="#spacrCombo.__init__-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="spacrCombo.__init__-472"><a href="#spacrCombo.__init__-472"><span class="linenos">472</span></a>
</span><span id="spacrCombo.__init__-473"><a href="#spacrCombo.__init__-473"><span class="linenos">473</span></a>        <span class="c1"># Create a canvas for the rounded rectangle background</span>
</span><span id="spacrCombo.__init__-474"><a href="#spacrCombo.__init__-474"><span class="linenos">474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="n">width</span> <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">220</span>  <span class="c1"># Adjusted for padding</span>
</span><span id="spacrCombo.__init__-475"><a href="#spacrCombo.__init__-475"><span class="linenos">475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1"># Adjusted for padding</span>
</span><span id="spacrCombo.__init__-476"><a href="#spacrCombo.__init__-476"><span class="linenos">476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrCombo.__init__-477"><a href="#spacrCombo.__init__-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="spacrCombo.__init__-478"><a href="#spacrCombo.__init__-478"><span class="linenos">478</span></a>        
</span><span id="spacrCombo.__init__-479"><a href="#spacrCombo.__init__-479"><span class="linenos">479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">textvariable</span> <span class="k">if</span> <span class="n">textvariable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="spacrCombo.__init__-480"><a href="#spacrCombo.__init__-480"><span class="linenos">480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="spacrCombo.__init__-481"><a href="#spacrCombo.__init__-481"><span class="linenos">481</span></a>        
</span><span id="spacrCombo.__init__-482"><a href="#spacrCombo.__init__-482"><span class="linenos">482</span></a>        <span class="c1"># Create the label to display the selected value</span>
</span><span id="spacrCombo.__init__-483"><a href="#spacrCombo.__init__-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrCombo.__init__-484"><a href="#spacrCombo.__init__-484"><span class="linenos">484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="spacrCombo.__init__-485"><a href="#spacrCombo.__init__-485"><span class="linenos">485</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrCombo.__init__-486"><a href="#spacrCombo.__init__-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
</span><span id="spacrCombo.__init__-487"><a href="#spacrCombo.__init__-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rely</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
</span><span id="spacrCombo.__init__-488"><a href="#spacrCombo.__init__-488"><span class="linenos">488</span></a>        
</span><span id="spacrCombo.__init__-489"><a href="#spacrCombo.__init__-489"><span class="linenos">489</span></a>        <span class="c1"># Bind events to open the dropdown menu</span>
</span><span id="spacrCombo.__init__-490"><a href="#spacrCombo.__init__-490"><span class="linenos">490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrCombo.__init__-491"><a href="#spacrCombo.__init__-491"><span class="linenos">491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrCombo.__init__-492"><a href="#spacrCombo.__init__-492"><span class="linenos">492</span></a>        
</span><span id="spacrCombo.__init__-493"><a href="#spacrCombo.__init__-493"><span class="linenos">493</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCombo.__init__-494"><a href="#spacrCombo.__init__-494"><span class="linenos">494</span></a>
</span><span id="spacrCombo.__init__-495"><a href="#spacrCombo.__init__-495"><span class="linenos">495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrCombo.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.bg_color"></a>
    
    

                            </div>
                            <div id="spacrCombo.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.active_color"></a>
    
    

                            </div>
                            <div id="spacrCombo.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.fg_color"></a>
    
    

                            </div>
                            <div id="spacrCombo.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrCombo.font_family" class="classattr">
                                <div class="attr variable">
            <span class="name">font_family</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.font_family"></a>
    
    

                            </div>
                            <div id="spacrCombo.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.font_size"></a>
    
    

                            </div>
                            <div id="spacrCombo.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.font_loader"></a>
    
    

                            </div>
                            <div id="spacrCombo.values" class="classattr">
                                <div class="attr variable">
            <span class="name">values</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.values"></a>
    
    

                            </div>
                            <div id="spacrCombo.canvas_width" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_width</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.canvas_width"></a>
    
    

                            </div>
                            <div id="spacrCombo.canvas_height" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_height</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.canvas_height"></a>
    
    

                            </div>
                            <div id="spacrCombo.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.canvas"></a>
    
    

                            </div>
                            <div id="spacrCombo.var" class="classattr">
                                <div class="attr variable">
            <span class="name">var</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.var"></a>
    
    

                            </div>
                            <div id="spacrCombo.selected_value" class="classattr">
                                <div class="attr variable">
            <span class="name">selected_value</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.selected_value"></a>
    
    

                            </div>
                            <div id="spacrCombo.dropdown_menu" class="classattr">
                                <div class="attr variable">
            <span class="name">dropdown_menu</span>

        
    </div>
    <a class="headerlink" href="#spacrCombo.dropdown_menu"></a>
    
    

                            </div>
                            <div id="spacrCombo.draw_rounded_rectangle" class="classattr">
                                        <input id="spacrCombo.draw_rounded_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_rounded_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCombo.draw_rounded_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.draw_rounded_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.draw_rounded_rectangle-497"><a href="#spacrCombo.draw_rounded_rectangle-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="nf">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="spacrCombo.draw_rounded_rectangle-498"><a href="#spacrCombo.draw_rounded_rectangle-498"><span class="linenos">498</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Increased radius for more rounded corners</span>
</span><span id="spacrCombo.draw_rounded_rectangle-499"><a href="#spacrCombo.draw_rounded_rectangle-499"><span class="linenos">499</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</span><span id="spacrCombo.draw_rounded_rectangle-500"><a href="#spacrCombo.draw_rounded_rectangle-500"><span class="linenos">500</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="mi">5</span>
</span><span id="spacrCombo.draw_rounded_rectangle-501"><a href="#spacrCombo.draw_rounded_rectangle-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-502"><a href="#spacrCombo.draw_rounded_rectangle-502"><span class="linenos">502</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-503"><a href="#spacrCombo.draw_rounded_rectangle-503"><span class="linenos">503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-504"><a href="#spacrCombo.draw_rounded_rectangle-504"><span class="linenos">504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-505"><a href="#spacrCombo.draw_rounded_rectangle-505"><span class="linenos">505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-506"><a href="#spacrCombo.draw_rounded_rectangle-506"><span class="linenos">506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-507"><a href="#spacrCombo.draw_rounded_rectangle-507"><span class="linenos">507</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="spacrCombo.draw_rounded_rectangle-508"><a href="#spacrCombo.draw_rounded_rectangle-508"><span class="linenos">508</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># Update label background to match rectangle color</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCombo.on_click" class="classattr">
                                        <input id="spacrCombo.on_click-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_click</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCombo.on_click-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.on_click"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.on_click-510"><a href="#spacrCombo.on_click-510"><span class="linenos">510</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrCombo.on_click-511"><a href="#spacrCombo.on_click-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrCombo.on_click-512"><a href="#spacrCombo.on_click-512"><span class="linenos">512</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_dropdown</span><span class="p">()</span>
</span><span id="spacrCombo.on_click-513"><a href="#spacrCombo.on_click-513"><span class="linenos">513</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrCombo.on_click-514"><a href="#spacrCombo.on_click-514"><span class="linenos">514</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close_dropdown</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCombo.open_dropdown" class="classattr">
                                        <input id="spacrCombo.open_dropdown-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_dropdown</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCombo.open_dropdown-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.open_dropdown"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.open_dropdown-516"><a href="#spacrCombo.open_dropdown-516"><span class="linenos">516</span></a>    <span class="k">def</span> <span class="nf">open_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrCombo.open_dropdown-517"><a href="#spacrCombo.open_dropdown-517"><span class="linenos">517</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-518"><a href="#spacrCombo.open_dropdown-518"><span class="linenos">518</span></a>        
</span><span id="spacrCombo.open_dropdown-519"><a href="#spacrCombo.open_dropdown-519"><span class="linenos">519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-520"><a href="#spacrCombo.open_dropdown-520"><span class="linenos">520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-521"><a href="#spacrCombo.open_dropdown-521"><span class="linenos">521</span></a>        
</span><span id="spacrCombo.open_dropdown-522"><a href="#spacrCombo.open_dropdown-522"><span class="linenos">522</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="spacrCombo.open_dropdown-523"><a href="#spacrCombo.open_dropdown-523"><span class="linenos">523</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">30</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-524"><a href="#spacrCombo.open_dropdown-524"><span class="linenos">524</span></a>        
</span><span id="spacrCombo.open_dropdown-525"><a href="#spacrCombo.open_dropdown-525"><span class="linenos">525</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="spacrCombo.open_dropdown-526"><a href="#spacrCombo.open_dropdown-526"><span class="linenos">526</span></a>            <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="spacrCombo.open_dropdown-527"><a href="#spacrCombo.open_dropdown-527"><span class="linenos">527</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrCombo.open_dropdown-528"><a href="#spacrCombo.open_dropdown-528"><span class="linenos">528</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-529"><a href="#spacrCombo.open_dropdown-529"><span class="linenos">529</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrCombo.open_dropdown-530"><a href="#spacrCombo.open_dropdown-530"><span class="linenos">530</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-531"><a href="#spacrCombo.open_dropdown-531"><span class="linenos">531</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span><span id="spacrCombo.open_dropdown-532"><a href="#spacrCombo.open_dropdown-532"><span class="linenos">532</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_select</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</span><span id="spacrCombo.open_dropdown-533"><a href="#spacrCombo.open_dropdown-533"><span class="linenos">533</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">item</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">))</span>
</span><span id="spacrCombo.open_dropdown-534"><a href="#spacrCombo.open_dropdown-534"><span class="linenos">534</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">item</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCombo.close_dropdown" class="classattr">
                                        <input id="spacrCombo.close_dropdown-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close_dropdown</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCombo.close_dropdown-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.close_dropdown"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.close_dropdown-536"><a href="#spacrCombo.close_dropdown-536"><span class="linenos">536</span></a>    <span class="k">def</span> <span class="nf">close_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrCombo.close_dropdown-537"><a href="#spacrCombo.close_dropdown-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrCombo.close_dropdown-538"><a href="#spacrCombo.close_dropdown-538"><span class="linenos">538</span></a>        
</span><span id="spacrCombo.close_dropdown-539"><a href="#spacrCombo.close_dropdown-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="p">:</span>
</span><span id="spacrCombo.close_dropdown-540"><a href="#spacrCombo.close_dropdown-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="spacrCombo.close_dropdown-541"><a href="#spacrCombo.close_dropdown-541"><span class="linenos">541</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown_menu</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCombo.on_select" class="classattr">
                                        <input id="spacrCombo.on_select-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_select</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">value</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCombo.on_select-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.on_select"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.on_select-543"><a href="#spacrCombo.on_select-543"><span class="linenos">543</span></a>    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrCombo.on_select-544"><a href="#spacrCombo.on_select-544"><span class="linenos">544</span></a>        <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="spacrCombo.on_select-545"><a href="#spacrCombo.on_select-545"><span class="linenos">545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrCombo.on_select-546"><a href="#spacrCombo.on_select-546"><span class="linenos">546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">)</span>
</span><span id="spacrCombo.on_select-547"><a href="#spacrCombo.on_select-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="spacrCombo.on_select-548"><a href="#spacrCombo.on_select-548"><span class="linenos">548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close_dropdown</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrCombo.set" class="classattr">
                                        <input id="spacrCombo.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">value</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrCombo.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCombo.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCombo.set-550"><a href="#spacrCombo.set-550"><span class="linenos">550</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrCombo.set-551"><a href="#spacrCombo.set-551"><span class="linenos">551</span></a>        <span class="n">display_text</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
</span><span id="spacrCombo.set-552"><a href="#spacrCombo.set-552"><span class="linenos">552</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrCombo.set-553"><a href="#spacrCombo.set-553"><span class="linenos">553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">display_text</span><span class="p">)</span>
</span><span id="spacrCombo.set-554"><a href="#spacrCombo.set-554"><span class="linenos">554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrDropdownMenu">
                            <input id="spacrDropdownMenu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrDropdownMenu</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrDropdownMenu-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu-556"><a href="#spacrDropdownMenu-556"><span class="linenos">556</span></a><span class="k">class</span> <span class="nc">spacrDropdownMenu</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-557"><a href="#spacrDropdownMenu-557"><span class="linenos">557</span></a>
</span><span id="spacrDropdownMenu-558"><a href="#spacrDropdownMenu-558"><span class="linenos">558</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-559"><a href="#spacrDropdownMenu-559"><span class="linenos">559</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-560"><a href="#spacrDropdownMenu-560"><span class="linenos">560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
</span><span id="spacrDropdownMenu-561"><a href="#spacrDropdownMenu-561"><span class="linenos">561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
</span><span id="spacrDropdownMenu-562"><a href="#spacrDropdownMenu-562"><span class="linenos">562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrDropdownMenu-563"><a href="#spacrDropdownMenu-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Settings&quot;</span>
</span><span id="spacrDropdownMenu-564"><a href="#spacrDropdownMenu-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</span><span id="spacrDropdownMenu-565"><a href="#spacrDropdownMenu-565"><span class="linenos">565</span></a>
</span><span id="spacrDropdownMenu-566"><a href="#spacrDropdownMenu-566"><span class="linenos">566</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="spacrDropdownMenu-567"><a href="#spacrDropdownMenu-567"><span class="linenos">567</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrDropdownMenu-568"><a href="#spacrDropdownMenu-568"><span class="linenos">568</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu-569"><a href="#spacrDropdownMenu-569"><span class="linenos">569</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu-570"><a href="#spacrDropdownMenu-570"><span class="linenos">570</span></a>
</span><span id="spacrDropdownMenu-571"><a href="#spacrDropdownMenu-571"><span class="linenos">571</span></a>        <span class="c1"># Button size configuration</span>
</span><span id="spacrDropdownMenu-572"><a href="#spacrDropdownMenu-572"><span class="linenos">572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-573"><a href="#spacrDropdownMenu-573"><span class="linenos">573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="spacrDropdownMenu-574"><a href="#spacrDropdownMenu-574"><span class="linenos">574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="spacrDropdownMenu-575"><a href="#spacrDropdownMenu-575"><span class="linenos">575</span></a>
</span><span id="spacrDropdownMenu-576"><a href="#spacrDropdownMenu-576"><span class="linenos">576</span></a>        <span class="c1"># Create the canvas and rounded button</span>
</span><span id="spacrDropdownMenu-577"><a href="#spacrDropdownMenu-577"><span class="linenos">577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrDropdownMenu-578"><a href="#spacrDropdownMenu-578"><span class="linenos">578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-579"><a href="#spacrDropdownMenu-579"><span class="linenos">579</span></a>
</span><span id="spacrDropdownMenu-580"><a href="#spacrDropdownMenu-580"><span class="linenos">580</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="spacrDropdownMenu-581"><a href="#spacrDropdownMenu-581"><span class="linenos">581</span></a>        <span class="n">color_settings</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="spacrDropdownMenu-582"><a href="#spacrDropdownMenu-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu-583"><a href="#spacrDropdownMenu-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu-584"><a href="#spacrDropdownMenu-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu-585"><a href="#spacrDropdownMenu-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu-586"><a href="#spacrDropdownMenu-586"><span class="linenos">586</span></a>
</span><span id="spacrDropdownMenu-587"><a href="#spacrDropdownMenu-587"><span class="linenos">587</span></a>        <span class="c1"># Create the button with rounded edges</span>
</span><span id="spacrDropdownMenu-588"><a href="#spacrDropdownMenu-588"><span class="linenos">588</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-589"><a href="#spacrDropdownMenu-589"><span class="linenos">589</span></a>
</span><span id="spacrDropdownMenu-590"><a href="#spacrDropdownMenu-590"><span class="linenos">590</span></a>        <span class="c1"># Create and place the label on the button</span>
</span><span id="spacrDropdownMenu-591"><a href="#spacrDropdownMenu-591"><span class="linenos">591</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-592"><a href="#spacrDropdownMenu-592"><span class="linenos">592</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-593"><a href="#spacrDropdownMenu-593"><span class="linenos">593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-594"><a href="#spacrDropdownMenu-594"><span class="linenos">594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-595"><a href="#spacrDropdownMenu-595"><span class="linenos">595</span></a>
</span><span id="spacrDropdownMenu-596"><a href="#spacrDropdownMenu-596"><span class="linenos">596</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-597"><a href="#spacrDropdownMenu-597"><span class="linenos">597</span></a>
</span><span id="spacrDropdownMenu-598"><a href="#spacrDropdownMenu-598"><span class="linenos">598</span></a>        <span class="c1"># Bind events for button behavior</span>
</span><span id="spacrDropdownMenu-599"><a href="#spacrDropdownMenu-599"><span class="linenos">599</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-600"><a href="#spacrDropdownMenu-600"><span class="linenos">600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-601"><a href="#spacrDropdownMenu-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-602"><a href="#spacrDropdownMenu-602"><span class="linenos">602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-603"><a href="#spacrDropdownMenu-603"><span class="linenos">603</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-604"><a href="#spacrDropdownMenu-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-605"><a href="#spacrDropdownMenu-605"><span class="linenos">605</span></a>
</span><span id="spacrDropdownMenu-606"><a href="#spacrDropdownMenu-606"><span class="linenos">606</span></a>        <span class="c1"># Create a popup menu with the desired background color</span>
</span><span id="spacrDropdownMenu-607"><a href="#spacrDropdownMenu-607"><span class="linenos">607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-608"><a href="#spacrDropdownMenu-608"><span class="linenos">608</span></a>        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-609"><a href="#spacrDropdownMenu-609"><span class="linenos">609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="n">opt</span><span class="o">=</span><span class="n">option</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_select</span><span class="p">(</span><span class="n">opt</span><span class="p">))</span>
</span><span id="spacrDropdownMenu-610"><a href="#spacrDropdownMenu-610"><span class="linenos">610</span></a>
</span><span id="spacrDropdownMenu-611"><a href="#spacrDropdownMenu-611"><span class="linenos">611</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-612"><a href="#spacrDropdownMenu-612"><span class="linenos">612</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="spacrDropdownMenu-613"><a href="#spacrDropdownMenu-613"><span class="linenos">613</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-614"><a href="#spacrDropdownMenu-614"><span class="linenos">614</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-615"><a href="#spacrDropdownMenu-615"><span class="linenos">615</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-616"><a href="#spacrDropdownMenu-616"><span class="linenos">616</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-617"><a href="#spacrDropdownMenu-617"><span class="linenos">617</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-618"><a href="#spacrDropdownMenu-618"><span class="linenos">618</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-619"><a href="#spacrDropdownMenu-619"><span class="linenos">619</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-620"><a href="#spacrDropdownMenu-620"><span class="linenos">620</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-621"><a href="#spacrDropdownMenu-621"><span class="linenos">621</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-622"><a href="#spacrDropdownMenu-622"><span class="linenos">622</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-623"><a href="#spacrDropdownMenu-623"><span class="linenos">623</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-624"><a href="#spacrDropdownMenu-624"><span class="linenos">624</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-625"><a href="#spacrDropdownMenu-625"><span class="linenos">625</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-626"><a href="#spacrDropdownMenu-626"><span class="linenos">626</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-627"><a href="#spacrDropdownMenu-627"><span class="linenos">627</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-628"><a href="#spacrDropdownMenu-628"><span class="linenos">628</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu-629"><a href="#spacrDropdownMenu-629"><span class="linenos">629</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="spacrDropdownMenu-630"><a href="#spacrDropdownMenu-630"><span class="linenos">630</span></a>        <span class="p">]</span>
</span><span id="spacrDropdownMenu-631"><a href="#spacrDropdownMenu-631"><span class="linenos">631</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-632"><a href="#spacrDropdownMenu-632"><span class="linenos">632</span></a>
</span><span id="spacrDropdownMenu-633"><a href="#spacrDropdownMenu-633"><span class="linenos">633</span></a>    <span class="k">def</span> <span class="nf">on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-634"><a href="#spacrDropdownMenu-634"><span class="linenos">634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-635"><a href="#spacrDropdownMenu-635"><span class="linenos">635</span></a>
</span><span id="spacrDropdownMenu-636"><a href="#spacrDropdownMenu-636"><span class="linenos">636</span></a>    <span class="k">def</span> <span class="nf">on_leave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-637"><a href="#spacrDropdownMenu-637"><span class="linenos">637</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-638"><a href="#spacrDropdownMenu-638"><span class="linenos">638</span></a>
</span><span id="spacrDropdownMenu-639"><a href="#spacrDropdownMenu-639"><span class="linenos">639</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-640"><a href="#spacrDropdownMenu-640"><span class="linenos">640</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">post_menu</span><span class="p">()</span>
</span><span id="spacrDropdownMenu-641"><a href="#spacrDropdownMenu-641"><span class="linenos">641</span></a>
</span><span id="spacrDropdownMenu-642"><a href="#spacrDropdownMenu-642"><span class="linenos">642</span></a>    <span class="k">def</span> <span class="nf">post_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-643"><a href="#spacrDropdownMenu-643"><span class="linenos">643</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="spacrDropdownMenu-644"><a href="#spacrDropdownMenu-644"><span class="linenos">644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-645"><a href="#spacrDropdownMenu-645"><span class="linenos">645</span></a>
</span><span id="spacrDropdownMenu-646"><a href="#spacrDropdownMenu-646"><span class="linenos">646</span></a>    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-647"><a href="#spacrDropdownMenu-647"><span class="linenos">647</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-648"><a href="#spacrDropdownMenu-648"><span class="linenos">648</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-649"><a href="#spacrDropdownMenu-649"><span class="linenos">649</span></a>
</span><span id="spacrDropdownMenu-650"><a href="#spacrDropdownMenu-650"><span class="linenos">650</span></a>    <span class="k">def</span> <span class="nf">update_styles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">active_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-651"><a href="#spacrDropdownMenu-651"><span class="linenos">651</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">])</span>
</span><span id="spacrDropdownMenu-652"><a href="#spacrDropdownMenu-652"><span class="linenos">652</span></a>
</span><span id="spacrDropdownMenu-653"><a href="#spacrDropdownMenu-653"><span class="linenos">653</span></a>        <span class="k">if</span> <span class="n">active_categories</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-654"><a href="#spacrDropdownMenu-654"><span class="linenos">654</span></a>            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="spacrDropdownMenu-655"><a href="#spacrDropdownMenu-655"><span class="linenos">655</span></a>                <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entrycget</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">)</span>
</span><span id="spacrDropdownMenu-656"><a href="#spacrDropdownMenu-656"><span class="linenos">656</span></a>                <span class="k">if</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">active_categories</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-657"><a href="#spacrDropdownMenu-657"><span class="linenos">657</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrDropdownMenu-658"><a href="#spacrDropdownMenu-658"><span class="linenos">658</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="spacrDropdownMenu-659"><a href="#spacrDropdownMenu-659"><span class="linenos">659</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrDropdownMenu.__init__" class="classattr">
                                        <input id="spacrDropdownMenu.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrDropdownMenu</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">parent</span>,</span><span class="param">	<span class="n">variable</span>,</span><span class="param">	<span class="n">options</span>,</span><span class="param">	<span class="n">command</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">font</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">size</span><span class="o">=</span><span class="mi">50</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrDropdownMenu.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.__init__-558"><a href="#spacrDropdownMenu.__init__-558"><span class="linenos">558</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.__init__-559"><a href="#spacrDropdownMenu.__init__-559"><span class="linenos">559</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-560"><a href="#spacrDropdownMenu.__init__-560"><span class="linenos">560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
</span><span id="spacrDropdownMenu.__init__-561"><a href="#spacrDropdownMenu.__init__-561"><span class="linenos">561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
</span><span id="spacrDropdownMenu.__init__-562"><a href="#spacrDropdownMenu.__init__-562"><span class="linenos">562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrDropdownMenu.__init__-563"><a href="#spacrDropdownMenu.__init__-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Settings&quot;</span>
</span><span id="spacrDropdownMenu.__init__-564"><a href="#spacrDropdownMenu.__init__-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</span><span id="spacrDropdownMenu.__init__-565"><a href="#spacrDropdownMenu.__init__-565"><span class="linenos">565</span></a>
</span><span id="spacrDropdownMenu.__init__-566"><a href="#spacrDropdownMenu.__init__-566"><span class="linenos">566</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="spacrDropdownMenu.__init__-567"><a href="#spacrDropdownMenu.__init__-567"><span class="linenos">567</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrDropdownMenu.__init__-568"><a href="#spacrDropdownMenu.__init__-568"><span class="linenos">568</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu.__init__-569"><a href="#spacrDropdownMenu.__init__-569"><span class="linenos">569</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu.__init__-570"><a href="#spacrDropdownMenu.__init__-570"><span class="linenos">570</span></a>
</span><span id="spacrDropdownMenu.__init__-571"><a href="#spacrDropdownMenu.__init__-571"><span class="linenos">571</span></a>        <span class="c1"># Button size configuration</span>
</span><span id="spacrDropdownMenu.__init__-572"><a href="#spacrDropdownMenu.__init__-572"><span class="linenos">572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-573"><a href="#spacrDropdownMenu.__init__-573"><span class="linenos">573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="spacrDropdownMenu.__init__-574"><a href="#spacrDropdownMenu.__init__-574"><span class="linenos">574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="spacrDropdownMenu.__init__-575"><a href="#spacrDropdownMenu.__init__-575"><span class="linenos">575</span></a>
</span><span id="spacrDropdownMenu.__init__-576"><a href="#spacrDropdownMenu.__init__-576"><span class="linenos">576</span></a>        <span class="c1"># Create the canvas and rounded button</span>
</span><span id="spacrDropdownMenu.__init__-577"><a href="#spacrDropdownMenu.__init__-577"><span class="linenos">577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrDropdownMenu.__init__-578"><a href="#spacrDropdownMenu.__init__-578"><span class="linenos">578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-579"><a href="#spacrDropdownMenu.__init__-579"><span class="linenos">579</span></a>
</span><span id="spacrDropdownMenu.__init__-580"><a href="#spacrDropdownMenu.__init__-580"><span class="linenos">580</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="spacrDropdownMenu.__init__-581"><a href="#spacrDropdownMenu.__init__-581"><span class="linenos">581</span></a>        <span class="n">color_settings</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="spacrDropdownMenu.__init__-582"><a href="#spacrDropdownMenu.__init__-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu.__init__-583"><a href="#spacrDropdownMenu.__init__-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu.__init__-584"><a href="#spacrDropdownMenu.__init__-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu.__init__-585"><a href="#spacrDropdownMenu.__init__-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrDropdownMenu.__init__-586"><a href="#spacrDropdownMenu.__init__-586"><span class="linenos">586</span></a>
</span><span id="spacrDropdownMenu.__init__-587"><a href="#spacrDropdownMenu.__init__-587"><span class="linenos">587</span></a>        <span class="c1"># Create the button with rounded edges</span>
</span><span id="spacrDropdownMenu.__init__-588"><a href="#spacrDropdownMenu.__init__-588"><span class="linenos">588</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-589"><a href="#spacrDropdownMenu.__init__-589"><span class="linenos">589</span></a>
</span><span id="spacrDropdownMenu.__init__-590"><a href="#spacrDropdownMenu.__init__-590"><span class="linenos">590</span></a>        <span class="c1"># Create and place the label on the button</span>
</span><span id="spacrDropdownMenu.__init__-591"><a href="#spacrDropdownMenu.__init__-591"><span class="linenos">591</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.__init__-592"><a href="#spacrDropdownMenu.__init__-592"><span class="linenos">592</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-593"><a href="#spacrDropdownMenu.__init__-593"><span class="linenos">593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.__init__-594"><a href="#spacrDropdownMenu.__init__-594"><span class="linenos">594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-595"><a href="#spacrDropdownMenu.__init__-595"><span class="linenos">595</span></a>
</span><span id="spacrDropdownMenu.__init__-596"><a href="#spacrDropdownMenu.__init__-596"><span class="linenos">596</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-597"><a href="#spacrDropdownMenu.__init__-597"><span class="linenos">597</span></a>
</span><span id="spacrDropdownMenu.__init__-598"><a href="#spacrDropdownMenu.__init__-598"><span class="linenos">598</span></a>        <span class="c1"># Bind events for button behavior</span>
</span><span id="spacrDropdownMenu.__init__-599"><a href="#spacrDropdownMenu.__init__-599"><span class="linenos">599</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-600"><a href="#spacrDropdownMenu.__init__-600"><span class="linenos">600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-601"><a href="#spacrDropdownMenu.__init__-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-602"><a href="#spacrDropdownMenu.__init__-602"><span class="linenos">602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-603"><a href="#spacrDropdownMenu.__init__-603"><span class="linenos">603</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-604"><a href="#spacrDropdownMenu.__init__-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-605"><a href="#spacrDropdownMenu.__init__-605"><span class="linenos">605</span></a>
</span><span id="spacrDropdownMenu.__init__-606"><a href="#spacrDropdownMenu.__init__-606"><span class="linenos">606</span></a>        <span class="c1"># Create a popup menu with the desired background color</span>
</span><span id="spacrDropdownMenu.__init__-607"><a href="#spacrDropdownMenu.__init__-607"><span class="linenos">607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.__init__-608"><a href="#spacrDropdownMenu.__init__-608"><span class="linenos">608</span></a>        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.__init__-609"><a href="#spacrDropdownMenu.__init__-609"><span class="linenos">609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="n">opt</span><span class="o">=</span><span class="n">option</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_select</span><span class="p">(</span><span class="n">opt</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrDropdownMenu.variable" class="classattr">
                                <div class="attr variable">
            <span class="name">variable</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.variable"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.options" class="classattr">
                                <div class="attr variable">
            <span class="name">options</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.options"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.command" class="classattr">
                                <div class="attr variable">
            <span class="name">command</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.command"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.text" class="classattr">
                                <div class="attr variable">
            <span class="name">text</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.text"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.size" class="classattr">
                                        <input id="spacrDropdownMenu.size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">size</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.size-1818"><a href="#spacrDropdownMenu.size-1818"><span class="linenos">1818</span></a>    <span class="k">def</span> <span class="nf">grid_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.size-1819"><a href="#spacrDropdownMenu.size-1819"><span class="linenos">1819</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tuple of the number of column and rows in the grid.&quot;&quot;&quot;</span>
</span><span id="spacrDropdownMenu.size-1820"><a href="#spacrDropdownMenu.size-1820"><span class="linenos">1820</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getints</span><span class="p">(</span>
</span><span id="spacrDropdownMenu.size-1821"><a href="#spacrDropdownMenu.size-1821"><span class="linenos">1821</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Return a tuple of the number of column and rows in the grid.</p>
</div>


                            </div>
                            <div id="spacrDropdownMenu.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.font_size"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.font_loader"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.button_width" class="classattr">
                                <div class="attr variable">
            <span class="name">button_width</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.button_width"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.canvas_width" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_width</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.canvas_width"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.canvas_height" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_height</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.canvas_height"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.canvas"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.active_color"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.fg_color"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.bg_color"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.button_bg" class="classattr">
                                <div class="attr variable">
            <span class="name">button_bg</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.button_bg"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.button_text" class="classattr">
                                <div class="attr variable">
            <span class="name">button_text</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.button_text"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.menu" class="classattr">
                                <div class="attr variable">
            <span class="name">menu</span>

        
    </div>
    <a class="headerlink" href="#spacrDropdownMenu.menu"></a>
    
    

                            </div>
                            <div id="spacrDropdownMenu.create_rounded_rectangle" class="classattr">
                                        <input id="spacrDropdownMenu.create_rounded_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_rounded_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">radius</span><span class="o">=</span><span class="mi">20</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.create_rounded_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.create_rounded_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.create_rounded_rectangle-611"><a href="#spacrDropdownMenu.create_rounded_rectangle-611"><span class="linenos">611</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-612"><a href="#spacrDropdownMenu.create_rounded_rectangle-612"><span class="linenos">612</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-613"><a href="#spacrDropdownMenu.create_rounded_rectangle-613"><span class="linenos">613</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-614"><a href="#spacrDropdownMenu.create_rounded_rectangle-614"><span class="linenos">614</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-615"><a href="#spacrDropdownMenu.create_rounded_rectangle-615"><span class="linenos">615</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-616"><a href="#spacrDropdownMenu.create_rounded_rectangle-616"><span class="linenos">616</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-617"><a href="#spacrDropdownMenu.create_rounded_rectangle-617"><span class="linenos">617</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-618"><a href="#spacrDropdownMenu.create_rounded_rectangle-618"><span class="linenos">618</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-619"><a href="#spacrDropdownMenu.create_rounded_rectangle-619"><span class="linenos">619</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-620"><a href="#spacrDropdownMenu.create_rounded_rectangle-620"><span class="linenos">620</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-621"><a href="#spacrDropdownMenu.create_rounded_rectangle-621"><span class="linenos">621</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-622"><a href="#spacrDropdownMenu.create_rounded_rectangle-622"><span class="linenos">622</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-623"><a href="#spacrDropdownMenu.create_rounded_rectangle-623"><span class="linenos">623</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-624"><a href="#spacrDropdownMenu.create_rounded_rectangle-624"><span class="linenos">624</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-625"><a href="#spacrDropdownMenu.create_rounded_rectangle-625"><span class="linenos">625</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-626"><a href="#spacrDropdownMenu.create_rounded_rectangle-626"><span class="linenos">626</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-627"><a href="#spacrDropdownMenu.create_rounded_rectangle-627"><span class="linenos">627</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-628"><a href="#spacrDropdownMenu.create_rounded_rectangle-628"><span class="linenos">628</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-629"><a href="#spacrDropdownMenu.create_rounded_rectangle-629"><span class="linenos">629</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-630"><a href="#spacrDropdownMenu.create_rounded_rectangle-630"><span class="linenos">630</span></a>        <span class="p">]</span>
</span><span id="spacrDropdownMenu.create_rounded_rectangle-631"><a href="#spacrDropdownMenu.create_rounded_rectangle-631"><span class="linenos">631</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrDropdownMenu.on_enter" class="classattr">
                                        <input id="spacrDropdownMenu.on_enter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_enter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.on_enter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.on_enter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.on_enter-633"><a href="#spacrDropdownMenu.on_enter-633"><span class="linenos">633</span></a>    <span class="k">def</span> <span class="nf">on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.on_enter-634"><a href="#spacrDropdownMenu.on_enter-634"><span class="linenos">634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrDropdownMenu.on_leave" class="classattr">
                                        <input id="spacrDropdownMenu.on_leave-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_leave</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.on_leave-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.on_leave"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.on_leave-636"><a href="#spacrDropdownMenu.on_leave-636"><span class="linenos">636</span></a>    <span class="k">def</span> <span class="nf">on_leave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.on_leave-637"><a href="#spacrDropdownMenu.on_leave-637"><span class="linenos">637</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrDropdownMenu.on_click" class="classattr">
                                        <input id="spacrDropdownMenu.on_click-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_click</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.on_click-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.on_click"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.on_click-639"><a href="#spacrDropdownMenu.on_click-639"><span class="linenos">639</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.on_click-640"><a href="#spacrDropdownMenu.on_click-640"><span class="linenos">640</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">post_menu</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrDropdownMenu.post_menu" class="classattr">
                                        <input id="spacrDropdownMenu.post_menu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">post_menu</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.post_menu-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.post_menu"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.post_menu-642"><a href="#spacrDropdownMenu.post_menu-642"><span class="linenos">642</span></a>    <span class="k">def</span> <span class="nf">post_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.post_menu-643"><a href="#spacrDropdownMenu.post_menu-643"><span class="linenos">643</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="spacrDropdownMenu.post_menu-644"><a href="#spacrDropdownMenu.post_menu-644"><span class="linenos">644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrDropdownMenu.on_select" class="classattr">
                                        <input id="spacrDropdownMenu.on_select-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_select</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">option</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.on_select-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.on_select"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.on_select-646"><a href="#spacrDropdownMenu.on_select-646"><span class="linenos">646</span></a>    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.on_select-647"><a href="#spacrDropdownMenu.on_select-647"><span class="linenos">647</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.on_select-648"><a href="#spacrDropdownMenu.on_select-648"><span class="linenos">648</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrDropdownMenu.update_styles" class="classattr">
                                        <input id="spacrDropdownMenu.update_styles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_styles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">active_categories</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrDropdownMenu.update_styles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrDropdownMenu.update_styles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrDropdownMenu.update_styles-650"><a href="#spacrDropdownMenu.update_styles-650"><span class="linenos">650</span></a>    <span class="k">def</span> <span class="nf">update_styles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">active_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.update_styles-651"><a href="#spacrDropdownMenu.update_styles-651"><span class="linenos">651</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">])</span>
</span><span id="spacrDropdownMenu.update_styles-652"><a href="#spacrDropdownMenu.update_styles-652"><span class="linenos">652</span></a>
</span><span id="spacrDropdownMenu.update_styles-653"><a href="#spacrDropdownMenu.update_styles-653"><span class="linenos">653</span></a>        <span class="k">if</span> <span class="n">active_categories</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.update_styles-654"><a href="#spacrDropdownMenu.update_styles-654"><span class="linenos">654</span></a>            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="spacrDropdownMenu.update_styles-655"><a href="#spacrDropdownMenu.update_styles-655"><span class="linenos">655</span></a>                <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entrycget</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">)</span>
</span><span id="spacrDropdownMenu.update_styles-656"><a href="#spacrDropdownMenu.update_styles-656"><span class="linenos">656</span></a>                <span class="k">if</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">active_categories</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.update_styles-657"><a href="#spacrDropdownMenu.update_styles-657"><span class="linenos">657</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrDropdownMenu.update_styles-658"><a href="#spacrDropdownMenu.update_styles-658"><span class="linenos">658</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="spacrDropdownMenu.update_styles-659"><a href="#spacrDropdownMenu.update_styles-659"><span class="linenos">659</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrCheckbutton">
                            <input id="spacrCheckbutton-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrCheckbutton</span><wbr>(<span class="base">tkinter.ttk.Checkbutton</span>):

                <label class="view-source-button" for="spacrCheckbutton-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheckbutton"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheckbutton-661"><a href="#spacrCheckbutton-661"><span class="linenos">661</span></a><span class="k">class</span> <span class="nc">spacrCheckbutton</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">):</span>
</span><span id="spacrCheckbutton-662"><a href="#spacrCheckbutton-662"><span class="linenos">662</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrCheckbutton-663"><a href="#spacrCheckbutton-663"><span class="linenos">663</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrCheckbutton-664"><a href="#spacrCheckbutton-664"><span class="linenos">664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrCheckbutton-665"><a href="#spacrCheckbutton-665"><span class="linenos">665</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span> <span class="k">if</span> <span class="n">variable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="spacrCheckbutton-666"><a href="#spacrCheckbutton-666"><span class="linenos">666</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrCheckbutton-667"><a href="#spacrCheckbutton-667"><span class="linenos">667</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Spacr.TCheckbutton&#39;</span><span class="p">)</span>
</span><span id="spacrCheckbutton-668"><a href="#spacrCheckbutton-668"><span class="linenos">668</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrCheckbutton-669"><a href="#spacrCheckbutton-669"><span class="linenos">669</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Ttk Checkbutton widget which is either in on- or off-state.</p>
</div>


                            <div id="spacrCheckbutton.__init__" class="classattr">
                                        <input id="spacrCheckbutton.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrCheckbutton</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span>, </span><span class="param"><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span>, </span><span class="param"><span class="n">variable</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">command</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrCheckbutton.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrCheckbutton.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrCheckbutton.__init__-662"><a href="#spacrCheckbutton.__init__-662"><span class="linenos">662</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrCheckbutton.__init__-663"><a href="#spacrCheckbutton.__init__-663"><span class="linenos">663</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrCheckbutton.__init__-664"><a href="#spacrCheckbutton.__init__-664"><span class="linenos">664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrCheckbutton.__init__-665"><a href="#spacrCheckbutton.__init__-665"><span class="linenos">665</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span> <span class="k">if</span> <span class="n">variable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="spacrCheckbutton.__init__-666"><a href="#spacrCheckbutton.__init__-666"><span class="linenos">666</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrCheckbutton.__init__-667"><a href="#spacrCheckbutton.__init__-667"><span class="linenos">667</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Spacr.TCheckbutton&#39;</span><span class="p">)</span>
</span><span id="spacrCheckbutton.__init__-668"><a href="#spacrCheckbutton.__init__-668"><span class="linenos">668</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrCheckbutton.__init__-669"><a href="#spacrCheckbutton.__init__-669"><span class="linenos">669</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Construct a Ttk Checkbutton widget with the parent master.</p>

<p>STANDARD OPTIONS</p>

<pre><code>class, compound, cursor, image, state, style, takefocus,
text, textvariable, underline, width
</code></pre>

<p>WIDGET-SPECIFIC OPTIONS</p>

<pre><code>command, offvalue, onvalue, variable
</code></pre>
</div>


                            </div>
                            <div id="spacrCheckbutton.text" class="classattr">
                                <div class="attr variable">
            <span class="name">text</span>

        
    </div>
    <a class="headerlink" href="#spacrCheckbutton.text"></a>
    
    

                            </div>
                            <div id="spacrCheckbutton.variable" class="classattr">
                                <div class="attr variable">
            <span class="name">variable</span>

        
    </div>
    <a class="headerlink" href="#spacrCheckbutton.variable"></a>
    
    

                            </div>
                            <div id="spacrCheckbutton.command" class="classattr">
                                <div class="attr variable">
            <span class="name">command</span>

        
    </div>
    <a class="headerlink" href="#spacrCheckbutton.command"></a>
    
    

                            </div>
                </section>
                <section id="spacrProgressBar">
                            <input id="spacrProgressBar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrProgressBar</span><wbr>(<span class="base">tkinter.ttk.Progressbar</span>):

                <label class="view-source-button" for="spacrProgressBar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrProgressBar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrProgressBar-671"><a href="#spacrProgressBar-671"><span class="linenos">671</span></a><span class="k">class</span> <span class="nc">spacrProgressBar</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Progressbar</span><span class="p">):</span>
</span><span id="spacrProgressBar-672"><a href="#spacrProgressBar-672"><span class="linenos">672</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrProgressBar-673"><a href="#spacrProgressBar-673"><span class="linenos">673</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrProgressBar-674"><a href="#spacrProgressBar-674"><span class="linenos">674</span></a>
</span><span id="spacrProgressBar-675"><a href="#spacrProgressBar-675"><span class="linenos">675</span></a>        <span class="c1"># Get the style colors</span>
</span><span id="spacrProgressBar-676"><a href="#spacrProgressBar-676"><span class="linenos">676</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrProgressBar-677"><a href="#spacrProgressBar-677"><span class="linenos">677</span></a>
</span><span id="spacrProgressBar-678"><a href="#spacrProgressBar-678"><span class="linenos">678</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar-679"><a href="#spacrProgressBar-679"><span class="linenos">679</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar-680"><a href="#spacrProgressBar-680"><span class="linenos">680</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar-681"><a href="#spacrProgressBar-681"><span class="linenos">681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar-682"><a href="#spacrProgressBar-682"><span class="linenos">682</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar-683"><a href="#spacrProgressBar-683"><span class="linenos">683</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar-684"><a href="#spacrProgressBar-684"><span class="linenos">684</span></a>
</span><span id="spacrProgressBar-685"><a href="#spacrProgressBar-685"><span class="linenos">685</span></a>        <span class="c1"># Configure the style for the progress bar</span>
</span><span id="spacrProgressBar-686"><a href="#spacrProgressBar-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrProgressBar-687"><a href="#spacrProgressBar-687"><span class="linenos">687</span></a>        
</span><span id="spacrProgressBar-688"><a href="#spacrProgressBar-688"><span class="linenos">688</span></a>        <span class="c1"># Remove any borders and ensure the active color fills the entire space</span>
</span><span id="spacrProgressBar-689"><a href="#spacrProgressBar-689"><span class="linenos">689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
</span><span id="spacrProgressBar-690"><a href="#spacrProgressBar-690"><span class="linenos">690</span></a>            <span class="s2">&quot;spacr.Horizontal.TProgressbar&quot;</span><span class="p">,</span>
</span><span id="spacrProgressBar-691"><a href="#spacrProgressBar-691"><span class="linenos">691</span></a>            <span class="n">troughcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="c1"># Set the trough to bg color</span>
</span><span id="spacrProgressBar-692"><a href="#spacrProgressBar-692"><span class="linenos">692</span></a>            <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>    <span class="c1"># Active part is the active color</span>
</span><span id="spacrProgressBar-693"><a href="#spacrProgressBar-693"><span class="linenos">693</span></a>            <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                   <span class="c1"># Remove border width</span>
</span><span id="spacrProgressBar-694"><a href="#spacrProgressBar-694"><span class="linenos">694</span></a>            <span class="n">pbarrelief</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>               <span class="c1"># Flat relief for the progress bar</span>
</span><span id="spacrProgressBar-695"><a href="#spacrProgressBar-695"><span class="linenos">695</span></a>            <span class="n">troughrelief</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>             <span class="c1"># Flat relief for the trough</span>
</span><span id="spacrProgressBar-696"><a href="#spacrProgressBar-696"><span class="linenos">696</span></a>            <span class="n">thickness</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>                    <span class="c1"># Set the thickness of the progress bar</span>
</span><span id="spacrProgressBar-697"><a href="#spacrProgressBar-697"><span class="linenos">697</span></a>            <span class="n">darkcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>     <span class="c1"># Ensure darkcolor matches the active color</span>
</span><span id="spacrProgressBar-698"><a href="#spacrProgressBar-698"><span class="linenos">698</span></a>            <span class="n">lightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>    <span class="c1"># Ensure lightcolor matches the active color</span>
</span><span id="spacrProgressBar-699"><a href="#spacrProgressBar-699"><span class="linenos">699</span></a>            <span class="n">bordercolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span>        <span class="c1"># Set the border color to the background color to hide it</span>
</span><span id="spacrProgressBar-700"><a href="#spacrProgressBar-700"><span class="linenos">700</span></a>        <span class="p">)</span>
</span><span id="spacrProgressBar-701"><a href="#spacrProgressBar-701"><span class="linenos">701</span></a>
</span><span id="spacrProgressBar-702"><a href="#spacrProgressBar-702"><span class="linenos">702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;spacr.Horizontal.TProgressbar&quot;</span><span class="p">)</span>
</span><span id="spacrProgressBar-703"><a href="#spacrProgressBar-703"><span class="linenos">703</span></a>
</span><span id="spacrProgressBar-704"><a href="#spacrProgressBar-704"><span class="linenos">704</span></a>        <span class="c1"># Set initial value to 0</span>
</span><span id="spacrProgressBar-705"><a href="#spacrProgressBar-705"><span class="linenos">705</span></a>        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="spacrProgressBar-706"><a href="#spacrProgressBar-706"><span class="linenos">706</span></a>
</span><span id="spacrProgressBar-707"><a href="#spacrProgressBar-707"><span class="linenos">707</span></a>        <span class="c1"># Track whether to show the progress label</span>
</span><span id="spacrProgressBar-708"><a href="#spacrProgressBar-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="spacrProgressBar-709"><a href="#spacrProgressBar-709"><span class="linenos">709</span></a>
</span><span id="spacrProgressBar-710"><a href="#spacrProgressBar-710"><span class="linenos">710</span></a>        <span class="c1"># Create the progress label with text wrapping</span>
</span><span id="spacrProgressBar-711"><a href="#spacrProgressBar-711"><span class="linenos">711</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
</span><span id="spacrProgressBar-712"><a href="#spacrProgressBar-712"><span class="linenos">712</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
</span><span id="spacrProgressBar-713"><a href="#spacrProgressBar-713"><span class="linenos">713</span></a>                <span class="n">parent</span><span class="p">,</span>
</span><span id="spacrProgressBar-714"><a href="#spacrProgressBar-714"><span class="linenos">714</span></a>                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Processing: 0/0&quot;</span><span class="p">,</span>
</span><span id="spacrProgressBar-715"><a href="#spacrProgressBar-715"><span class="linenos">715</span></a>                <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
</span><span id="spacrProgressBar-716"><a href="#spacrProgressBar-716"><span class="linenos">716</span></a>                <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
</span><span id="spacrProgressBar-717"><a href="#spacrProgressBar-717"><span class="linenos">717</span></a>                <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="spacrProgressBar-718"><a href="#spacrProgressBar-718"><span class="linenos">718</span></a>                <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span>
</span><span id="spacrProgressBar-719"><a href="#spacrProgressBar-719"><span class="linenos">719</span></a>                <span class="n">wraplength</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="spacrProgressBar-720"><a href="#spacrProgressBar-720"><span class="linenos">720</span></a>                <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrProgressBar-721"><a href="#spacrProgressBar-721"><span class="linenos">721</span></a>            <span class="p">)</span>
</span><span id="spacrProgressBar-722"><a href="#spacrProgressBar-722"><span class="linenos">722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">grid_forget</span><span class="p">()</span>
</span><span id="spacrProgressBar-723"><a href="#spacrProgressBar-723"><span class="linenos">723</span></a>
</span><span id="spacrProgressBar-724"><a href="#spacrProgressBar-724"><span class="linenos">724</span></a>        <span class="c1"># Initialize attributes for time and operation</span>
</span><span id="spacrProgressBar-725"><a href="#spacrProgressBar-725"><span class="linenos">725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrProgressBar-726"><a href="#spacrProgressBar-726"><span class="linenos">726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrProgressBar-727"><a href="#spacrProgressBar-727"><span class="linenos">727</span></a>
</span><span id="spacrProgressBar-728"><a href="#spacrProgressBar-728"><span class="linenos">728</span></a>    <span class="k">def</span> <span class="nf">set_label_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrProgressBar-729"><a href="#spacrProgressBar-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="p">:</span>
</span><span id="spacrProgressBar-730"><a href="#spacrProgressBar-730"><span class="linenos">730</span></a>            <span class="n">row_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rowID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="spacrProgressBar-731"><a href="#spacrProgressBar-731"><span class="linenos">731</span></a>            <span class="n">col_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columnID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="spacrProgressBar-732"><a href="#spacrProgressBar-732"><span class="linenos">732</span></a>            <span class="n">col_span</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columnspan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="spacrProgressBar-733"><a href="#spacrProgressBar-733"><span class="linenos">733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row_info</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col_info</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="n">col_span</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span><span id="spacrProgressBar-734"><a href="#spacrProgressBar-734"><span class="linenos">734</span></a>
</span><span id="spacrProgressBar-735"><a href="#spacrProgressBar-735"><span class="linenos">735</span></a>    <span class="k">def</span> <span class="nf">update_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrProgressBar-736"><a href="#spacrProgressBar-736"><span class="linenos">736</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="p">:</span>
</span><span id="spacrProgressBar-737"><a href="#spacrProgressBar-737"><span class="linenos">737</span></a>            <span class="c1"># Start with the base progress information</span>
</span><span id="spacrProgressBar-738"><a href="#spacrProgressBar-738"><span class="linenos">738</span></a>            <span class="n">label_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Processing: </span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;maximum&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="spacrProgressBar-739"><a href="#spacrProgressBar-739"><span class="linenos">739</span></a>            
</span><span id="spacrProgressBar-740"><a href="#spacrProgressBar-740"><span class="linenos">740</span></a>            <span class="c1"># Include the operation type if it exists</span>
</span><span id="spacrProgressBar-741"><a href="#spacrProgressBar-741"><span class="linenos">741</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span><span class="p">:</span>
</span><span id="spacrProgressBar-742"><a href="#spacrProgressBar-742"><span class="linenos">742</span></a>                <span class="n">label_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="spacrProgressBar-743"><a href="#spacrProgressBar-743"><span class="linenos">743</span></a>            
</span><span id="spacrProgressBar-744"><a href="#spacrProgressBar-744"><span class="linenos">744</span></a>            <span class="c1"># Handle additional info without adding newlines</span>
</span><span id="spacrProgressBar-745"><a href="#spacrProgressBar-745"><span class="linenos">745</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;additional_info&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span><span class="p">:</span>
</span><span id="spacrProgressBar-746"><a href="#spacrProgressBar-746"><span class="linenos">746</span></a>                <span class="c1"># Join all additional info items with a space and ensure they&#39;re on the same line</span>
</span><span id="spacrProgressBar-747"><a href="#spacrProgressBar-747"><span class="linenos">747</span></a>                <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
</span><span id="spacrProgressBar-748"><a href="#spacrProgressBar-748"><span class="linenos">748</span></a>                <span class="n">formatted_additional_info</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span><span id="spacrProgressBar-749"><a href="#spacrProgressBar-749"><span class="linenos">749</span></a>
</span><span id="spacrProgressBar-750"><a href="#spacrProgressBar-750"><span class="linenos">750</span></a>                <span class="c1"># Append the additional info to the label_text, ensuring it&#39;s all in one line</span>
</span><span id="spacrProgressBar-751"><a href="#spacrProgressBar-751"><span class="linenos">751</span></a>                <span class="n">label_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">formatted_additional_info</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="spacrProgressBar-752"><a href="#spacrProgressBar-752"><span class="linenos">752</span></a>
</span><span id="spacrProgressBar-753"><a href="#spacrProgressBar-753"><span class="linenos">753</span></a>            <span class="c1"># Update the progress label</span>
</span><span id="spacrProgressBar-754"><a href="#spacrProgressBar-754"><span class="linenos">754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ttk Progressbar widget shows the status of a long-running
operation. They can operate in two modes: determinate mode shows the
amount completed relative to the total amount of work to be done, and
indeterminate mode provides an animated display to let the user know
that something is happening.</p>
</div>


                            <div id="spacrProgressBar.__init__" class="classattr">
                                        <input id="spacrProgressBar.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrProgressBar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span>, </span><span class="param"><span class="n">label</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrProgressBar.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrProgressBar.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrProgressBar.__init__-672"><a href="#spacrProgressBar.__init__-672"><span class="linenos">672</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrProgressBar.__init__-673"><a href="#spacrProgressBar.__init__-673"><span class="linenos">673</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrProgressBar.__init__-674"><a href="#spacrProgressBar.__init__-674"><span class="linenos">674</span></a>
</span><span id="spacrProgressBar.__init__-675"><a href="#spacrProgressBar.__init__-675"><span class="linenos">675</span></a>        <span class="c1"># Get the style colors</span>
</span><span id="spacrProgressBar.__init__-676"><a href="#spacrProgressBar.__init__-676"><span class="linenos">676</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrProgressBar.__init__-677"><a href="#spacrProgressBar.__init__-677"><span class="linenos">677</span></a>
</span><span id="spacrProgressBar.__init__-678"><a href="#spacrProgressBar.__init__-678"><span class="linenos">678</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar.__init__-679"><a href="#spacrProgressBar.__init__-679"><span class="linenos">679</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar.__init__-680"><a href="#spacrProgressBar.__init__-680"><span class="linenos">680</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar.__init__-681"><a href="#spacrProgressBar.__init__-681"><span class="linenos">681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar.__init__-682"><a href="#spacrProgressBar.__init__-682"><span class="linenos">682</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar.__init__-683"><a href="#spacrProgressBar.__init__-683"><span class="linenos">683</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrProgressBar.__init__-684"><a href="#spacrProgressBar.__init__-684"><span class="linenos">684</span></a>
</span><span id="spacrProgressBar.__init__-685"><a href="#spacrProgressBar.__init__-685"><span class="linenos">685</span></a>        <span class="c1"># Configure the style for the progress bar</span>
</span><span id="spacrProgressBar.__init__-686"><a href="#spacrProgressBar.__init__-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrProgressBar.__init__-687"><a href="#spacrProgressBar.__init__-687"><span class="linenos">687</span></a>        
</span><span id="spacrProgressBar.__init__-688"><a href="#spacrProgressBar.__init__-688"><span class="linenos">688</span></a>        <span class="c1"># Remove any borders and ensure the active color fills the entire space</span>
</span><span id="spacrProgressBar.__init__-689"><a href="#spacrProgressBar.__init__-689"><span class="linenos">689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
</span><span id="spacrProgressBar.__init__-690"><a href="#spacrProgressBar.__init__-690"><span class="linenos">690</span></a>            <span class="s2">&quot;spacr.Horizontal.TProgressbar&quot;</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-691"><a href="#spacrProgressBar.__init__-691"><span class="linenos">691</span></a>            <span class="n">troughcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="c1"># Set the trough to bg color</span>
</span><span id="spacrProgressBar.__init__-692"><a href="#spacrProgressBar.__init__-692"><span class="linenos">692</span></a>            <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>    <span class="c1"># Active part is the active color</span>
</span><span id="spacrProgressBar.__init__-693"><a href="#spacrProgressBar.__init__-693"><span class="linenos">693</span></a>            <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                   <span class="c1"># Remove border width</span>
</span><span id="spacrProgressBar.__init__-694"><a href="#spacrProgressBar.__init__-694"><span class="linenos">694</span></a>            <span class="n">pbarrelief</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>               <span class="c1"># Flat relief for the progress bar</span>
</span><span id="spacrProgressBar.__init__-695"><a href="#spacrProgressBar.__init__-695"><span class="linenos">695</span></a>            <span class="n">troughrelief</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>             <span class="c1"># Flat relief for the trough</span>
</span><span id="spacrProgressBar.__init__-696"><a href="#spacrProgressBar.__init__-696"><span class="linenos">696</span></a>            <span class="n">thickness</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>                    <span class="c1"># Set the thickness of the progress bar</span>
</span><span id="spacrProgressBar.__init__-697"><a href="#spacrProgressBar.__init__-697"><span class="linenos">697</span></a>            <span class="n">darkcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>     <span class="c1"># Ensure darkcolor matches the active color</span>
</span><span id="spacrProgressBar.__init__-698"><a href="#spacrProgressBar.__init__-698"><span class="linenos">698</span></a>            <span class="n">lightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">,</span>    <span class="c1"># Ensure lightcolor matches the active color</span>
</span><span id="spacrProgressBar.__init__-699"><a href="#spacrProgressBar.__init__-699"><span class="linenos">699</span></a>            <span class="n">bordercolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span>        <span class="c1"># Set the border color to the background color to hide it</span>
</span><span id="spacrProgressBar.__init__-700"><a href="#spacrProgressBar.__init__-700"><span class="linenos">700</span></a>        <span class="p">)</span>
</span><span id="spacrProgressBar.__init__-701"><a href="#spacrProgressBar.__init__-701"><span class="linenos">701</span></a>
</span><span id="spacrProgressBar.__init__-702"><a href="#spacrProgressBar.__init__-702"><span class="linenos">702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;spacr.Horizontal.TProgressbar&quot;</span><span class="p">)</span>
</span><span id="spacrProgressBar.__init__-703"><a href="#spacrProgressBar.__init__-703"><span class="linenos">703</span></a>
</span><span id="spacrProgressBar.__init__-704"><a href="#spacrProgressBar.__init__-704"><span class="linenos">704</span></a>        <span class="c1"># Set initial value to 0</span>
</span><span id="spacrProgressBar.__init__-705"><a href="#spacrProgressBar.__init__-705"><span class="linenos">705</span></a>        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="spacrProgressBar.__init__-706"><a href="#spacrProgressBar.__init__-706"><span class="linenos">706</span></a>
</span><span id="spacrProgressBar.__init__-707"><a href="#spacrProgressBar.__init__-707"><span class="linenos">707</span></a>        <span class="c1"># Track whether to show the progress label</span>
</span><span id="spacrProgressBar.__init__-708"><a href="#spacrProgressBar.__init__-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="spacrProgressBar.__init__-709"><a href="#spacrProgressBar.__init__-709"><span class="linenos">709</span></a>
</span><span id="spacrProgressBar.__init__-710"><a href="#spacrProgressBar.__init__-710"><span class="linenos">710</span></a>        <span class="c1"># Create the progress label with text wrapping</span>
</span><span id="spacrProgressBar.__init__-711"><a href="#spacrProgressBar.__init__-711"><span class="linenos">711</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
</span><span id="spacrProgressBar.__init__-712"><a href="#spacrProgressBar.__init__-712"><span class="linenos">712</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
</span><span id="spacrProgressBar.__init__-713"><a href="#spacrProgressBar.__init__-713"><span class="linenos">713</span></a>                <span class="n">parent</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-714"><a href="#spacrProgressBar.__init__-714"><span class="linenos">714</span></a>                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Processing: 0/0&quot;</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-715"><a href="#spacrProgressBar.__init__-715"><span class="linenos">715</span></a>                <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-716"><a href="#spacrProgressBar.__init__-716"><span class="linenos">716</span></a>                <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-717"><a href="#spacrProgressBar.__init__-717"><span class="linenos">717</span></a>                <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-718"><a href="#spacrProgressBar.__init__-718"><span class="linenos">718</span></a>                <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-719"><a href="#spacrProgressBar.__init__-719"><span class="linenos">719</span></a>                <span class="n">wraplength</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="spacrProgressBar.__init__-720"><a href="#spacrProgressBar.__init__-720"><span class="linenos">720</span></a>                <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrProgressBar.__init__-721"><a href="#spacrProgressBar.__init__-721"><span class="linenos">721</span></a>            <span class="p">)</span>
</span><span id="spacrProgressBar.__init__-722"><a href="#spacrProgressBar.__init__-722"><span class="linenos">722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">grid_forget</span><span class="p">()</span>
</span><span id="spacrProgressBar.__init__-723"><a href="#spacrProgressBar.__init__-723"><span class="linenos">723</span></a>
</span><span id="spacrProgressBar.__init__-724"><a href="#spacrProgressBar.__init__-724"><span class="linenos">724</span></a>        <span class="c1"># Initialize attributes for time and operation</span>
</span><span id="spacrProgressBar.__init__-725"><a href="#spacrProgressBar.__init__-725"><span class="linenos">725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrProgressBar.__init__-726"><a href="#spacrProgressBar.__init__-726"><span class="linenos">726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Construct a Ttk Progressbar with parent master.</p>

<p>STANDARD OPTIONS</p>

<pre><code>class, cursor, style, takefocus
</code></pre>

<p>WIDGET-SPECIFIC OPTIONS</p>

<pre><code>orient, length, mode, maximum, value, variable, phase
</code></pre>
</div>


                            </div>
                            <div id="spacrProgressBar.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.fg_color"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.bg_color"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.active_color"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.font_size"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.font_loader"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.style" class="classattr">
                                <div class="attr variable">
            <span class="name">style</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.style"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.label"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.operation_type" class="classattr">
                                <div class="attr variable">
            <span class="name">operation_type</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.operation_type"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.additional_info" class="classattr">
                                <div class="attr variable">
            <span class="name">additional_info</span>

        
    </div>
    <a class="headerlink" href="#spacrProgressBar.additional_info"></a>
    
    

                            </div>
                            <div id="spacrProgressBar.set_label_position" class="classattr">
                                        <input id="spacrProgressBar.set_label_position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_label_position</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrProgressBar.set_label_position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrProgressBar.set_label_position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrProgressBar.set_label_position-728"><a href="#spacrProgressBar.set_label_position-728"><span class="linenos">728</span></a>    <span class="k">def</span> <span class="nf">set_label_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrProgressBar.set_label_position-729"><a href="#spacrProgressBar.set_label_position-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="p">:</span>
</span><span id="spacrProgressBar.set_label_position-730"><a href="#spacrProgressBar.set_label_position-730"><span class="linenos">730</span></a>            <span class="n">row_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rowID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="spacrProgressBar.set_label_position-731"><a href="#spacrProgressBar.set_label_position-731"><span class="linenos">731</span></a>            <span class="n">col_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columnID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="spacrProgressBar.set_label_position-732"><a href="#spacrProgressBar.set_label_position-732"><span class="linenos">732</span></a>            <span class="n">col_span</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columnspan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="spacrProgressBar.set_label_position-733"><a href="#spacrProgressBar.set_label_position-733"><span class="linenos">733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row_info</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col_info</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="n">col_span</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrProgressBar.update_label" class="classattr">
                                        <input id="spacrProgressBar.update_label-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_label</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrProgressBar.update_label-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrProgressBar.update_label"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrProgressBar.update_label-735"><a href="#spacrProgressBar.update_label-735"><span class="linenos">735</span></a>    <span class="k">def</span> <span class="nf">update_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrProgressBar.update_label-736"><a href="#spacrProgressBar.update_label-736"><span class="linenos">736</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="p">:</span>
</span><span id="spacrProgressBar.update_label-737"><a href="#spacrProgressBar.update_label-737"><span class="linenos">737</span></a>            <span class="c1"># Start with the base progress information</span>
</span><span id="spacrProgressBar.update_label-738"><a href="#spacrProgressBar.update_label-738"><span class="linenos">738</span></a>            <span class="n">label_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Processing: </span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;maximum&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="spacrProgressBar.update_label-739"><a href="#spacrProgressBar.update_label-739"><span class="linenos">739</span></a>            
</span><span id="spacrProgressBar.update_label-740"><a href="#spacrProgressBar.update_label-740"><span class="linenos">740</span></a>            <span class="c1"># Include the operation type if it exists</span>
</span><span id="spacrProgressBar.update_label-741"><a href="#spacrProgressBar.update_label-741"><span class="linenos">741</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span><span class="p">:</span>
</span><span id="spacrProgressBar.update_label-742"><a href="#spacrProgressBar.update_label-742"><span class="linenos">742</span></a>                <span class="n">label_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="spacrProgressBar.update_label-743"><a href="#spacrProgressBar.update_label-743"><span class="linenos">743</span></a>            
</span><span id="spacrProgressBar.update_label-744"><a href="#spacrProgressBar.update_label-744"><span class="linenos">744</span></a>            <span class="c1"># Handle additional info without adding newlines</span>
</span><span id="spacrProgressBar.update_label-745"><a href="#spacrProgressBar.update_label-745"><span class="linenos">745</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;additional_info&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span><span class="p">:</span>
</span><span id="spacrProgressBar.update_label-746"><a href="#spacrProgressBar.update_label-746"><span class="linenos">746</span></a>                <span class="c1"># Join all additional info items with a space and ensure they&#39;re on the same line</span>
</span><span id="spacrProgressBar.update_label-747"><a href="#spacrProgressBar.update_label-747"><span class="linenos">747</span></a>                <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
</span><span id="spacrProgressBar.update_label-748"><a href="#spacrProgressBar.update_label-748"><span class="linenos">748</span></a>                <span class="n">formatted_additional_info</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span><span id="spacrProgressBar.update_label-749"><a href="#spacrProgressBar.update_label-749"><span class="linenos">749</span></a>
</span><span id="spacrProgressBar.update_label-750"><a href="#spacrProgressBar.update_label-750"><span class="linenos">750</span></a>                <span class="c1"># Append the additional info to the label_text, ensuring it&#39;s all in one line</span>
</span><span id="spacrProgressBar.update_label-751"><a href="#spacrProgressBar.update_label-751"><span class="linenos">751</span></a>                <span class="n">label_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">formatted_additional_info</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="spacrProgressBar.update_label-752"><a href="#spacrProgressBar.update_label-752"><span class="linenos">752</span></a>
</span><span id="spacrProgressBar.update_label-753"><a href="#spacrProgressBar.update_label-753"><span class="linenos">753</span></a>            <span class="c1"># Update the progress label</span>
</span><span id="spacrProgressBar.update_label-754"><a href="#spacrProgressBar.update_label-754"><span class="linenos">754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">progress_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrSlider">
                            <input id="spacrSlider-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrSlider</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrSlider-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider-756"><a href="#spacrSlider-756"><span class="linenos">756</span></a><span class="k">class</span> <span class="nc">spacrSlider</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrSlider-757"><a href="#spacrSlider-757"><span class="linenos">757</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">knob_radius</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrSlider-758"><a href="#spacrSlider-758"><span class="linenos">758</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrSlider-759"><a href="#spacrSlider-759"><span class="linenos">759</span></a>
</span><span id="spacrSlider-760"><a href="#spacrSlider-760"><span class="linenos">760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="o">=</span> <span class="n">length</span>  <span class="c1"># Store the specified length, if any</span>
</span><span id="spacrSlider-761"><a href="#spacrSlider-761"><span class="linenos">761</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">=</span> <span class="n">knob_radius</span>
</span><span id="spacrSlider-762"><a href="#spacrSlider-762"><span class="linenos">762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
</span><span id="spacrSlider-763"><a href="#spacrSlider-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="n">knob_radius</span>  <span class="c1"># Start at the beginning of the slider</span>
</span><span id="spacrSlider-764"><a href="#spacrSlider-764"><span class="linenos">764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slider_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrSlider-765"><a href="#spacrSlider-765"><span class="linenos">765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrSlider-766"><a href="#spacrSlider-766"><span class="linenos">766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># Store the position option</span>
</span><span id="spacrSlider-767"><a href="#spacrSlider-767"><span class="linenos">767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Initialize offset</span>
</span><span id="spacrSlider-768"><a href="#spacrSlider-768"><span class="linenos">768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">from_</span> <span class="o">=</span> <span class="n">from_</span>  <span class="c1"># Minimum value of the slider</span>
</span><span id="spacrSlider-769"><a href="#spacrSlider-769"><span class="linenos">769</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">=</span> <span class="n">to</span>  <span class="c1"># Maximum value of the slider</span>
</span><span id="spacrSlider-770"><a href="#spacrSlider-770"><span class="linenos">770</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">from_</span>  <span class="c1"># Initial value of the slider</span>
</span><span id="spacrSlider-771"><a href="#spacrSlider-771"><span class="linenos">771</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span> <span class="o">=</span> <span class="n">show_index</span>  <span class="c1"># Whether to show the index Entry widget</span>
</span><span id="spacrSlider-772"><a href="#spacrSlider-772"><span class="linenos">772</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>  <span class="c1"># Callback function to handle value changes</span>
</span><span id="spacrSlider-773"><a href="#spacrSlider-773"><span class="linenos">773</span></a>
</span><span id="spacrSlider-774"><a href="#spacrSlider-774"><span class="linenos">774</span></a>        <span class="c1"># Initialize the style and colors</span>
</span><span id="spacrSlider-775"><a href="#spacrSlider-775"><span class="linenos">775</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrSlider-776"><a href="#spacrSlider-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider-777"><a href="#spacrSlider-777"><span class="linenos">777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider-778"><a href="#spacrSlider-778"><span class="linenos">778</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider-779"><a href="#spacrSlider-779"><span class="linenos">779</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider-780"><a href="#spacrSlider-780"><span class="linenos">780</span></a>
</span><span id="spacrSlider-781"><a href="#spacrSlider-781"><span class="linenos">781</span></a>        <span class="c1"># Configure the frame&#39;s background color</span>
</span><span id="spacrSlider-782"><a href="#spacrSlider-782"><span class="linenos">782</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrSlider-783"><a href="#spacrSlider-783"><span class="linenos">783</span></a>
</span><span id="spacrSlider-784"><a href="#spacrSlider-784"><span class="linenos">784</span></a>        <span class="c1"># Create a frame for the slider and entry if needed</span>
</span><span id="spacrSlider-785"><a href="#spacrSlider-785"><span class="linenos">785</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrSlider-786"><a href="#spacrSlider-786"><span class="linenos">786</span></a>
</span><span id="spacrSlider-787"><a href="#spacrSlider-787"><span class="linenos">787</span></a>        <span class="c1"># Entry widget for showing and editing index, if enabled</span>
</span><span id="spacrSlider-788"><a href="#spacrSlider-788"><span class="linenos">788</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="spacrSlider-789"><a href="#spacrSlider-789"><span class="linenos">789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="spacrSlider-790"><a href="#spacrSlider-790"><span class="linenos">790</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">insertbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrSlider-791"><a href="#spacrSlider-791"><span class="linenos">791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="spacrSlider-792"><a href="#spacrSlider-792"><span class="linenos">792</span></a>            <span class="c1"># Bind the entry to update the slider on change</span>
</span><span id="spacrSlider-793"><a href="#spacrSlider-793"><span class="linenos">793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Return&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_slider_from_entry</span><span class="p">)</span>
</span><span id="spacrSlider-794"><a href="#spacrSlider-794"><span class="linenos">794</span></a>
</span><span id="spacrSlider-795"><a href="#spacrSlider-795"><span class="linenos">795</span></a>        <span class="c1"># Create the slider canvas</span>
</span><span id="spacrSlider-796"><a href="#spacrSlider-796"><span class="linenos">796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">knob_radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrSlider-797"><a href="#spacrSlider-797"><span class="linenos">797</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="spacrSlider-798"><a href="#spacrSlider-798"><span class="linenos">798</span></a>
</span><span id="spacrSlider-799"><a href="#spacrSlider-799"><span class="linenos">799</span></a>        <span class="c1"># Set initial length to specified length or default value</span>
</span><span id="spacrSlider-800"><a href="#spacrSlider-800"><span class="linenos">800</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span>
</span><span id="spacrSlider-801"><a href="#spacrSlider-801"><span class="linenos">801</span></a>
</span><span id="spacrSlider-802"><a href="#spacrSlider-802"><span class="linenos">802</span></a>        <span class="c1"># Calculate initial knob position based on the initial value</span>
</span><span id="spacrSlider-803"><a href="#spacrSlider-803"><span class="linenos">803</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider-804"><a href="#spacrSlider-804"><span class="linenos">804</span></a>
</span><span id="spacrSlider-805"><a href="#spacrSlider-805"><span class="linenos">805</span></a>        <span class="c1"># Bind resize event to dynamically adjust the slider length if no length is specified</span>
</span><span id="spacrSlider-806"><a href="#spacrSlider-806"><span class="linenos">806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_slider</span><span class="p">)</span>
</span><span id="spacrSlider-807"><a href="#spacrSlider-807"><span class="linenos">807</span></a>
</span><span id="spacrSlider-808"><a href="#spacrSlider-808"><span class="linenos">808</span></a>        <span class="c1"># Draw the slider components</span>
</span><span id="spacrSlider-809"><a href="#spacrSlider-809"><span class="linenos">809</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrSlider-810"><a href="#spacrSlider-810"><span class="linenos">810</span></a>
</span><span id="spacrSlider-811"><a href="#spacrSlider-811"><span class="linenos">811</span></a>        <span class="c1"># Bind mouse events to the knob and slider</span>
</span><span id="spacrSlider-812"><a href="#spacrSlider-812"><span class="linenos">812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_knob</span><span class="p">)</span>
</span><span id="spacrSlider-813"><a href="#spacrSlider-813"><span class="linenos">813</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">activate_knob</span><span class="p">)</span>  <span class="c1"># Activate knob on click</span>
</span><span id="spacrSlider-814"><a href="#spacrSlider-814"><span class="linenos">814</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">release_knob</span><span class="p">)</span>  <span class="c1"># Trigger command on release</span>
</span><span id="spacrSlider-815"><a href="#spacrSlider-815"><span class="linenos">815</span></a>
</span><span id="spacrSlider-816"><a href="#spacrSlider-816"><span class="linenos">816</span></a>    <span class="k">def</span> <span class="nf">resize_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider-817"><a href="#spacrSlider-817"><span class="linenos">817</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrSlider-818"><a href="#spacrSlider-818"><span class="linenos">818</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span>
</span><span id="spacrSlider-819"><a href="#spacrSlider-819"><span class="linenos">819</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrSlider-820"><a href="#spacrSlider-820"><span class="linenos">820</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span>  <span class="c1"># 90% of the container width</span>
</span><span id="spacrSlider-821"><a href="#spacrSlider-821"><span class="linenos">821</span></a>        
</span><span id="spacrSlider-822"><a href="#spacrSlider-822"><span class="linenos">822</span></a>        <span class="c1"># Calculate the horizontal offset based on the position</span>
</span><span id="spacrSlider-823"><a href="#spacrSlider-823"><span class="linenos">823</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
</span><span id="spacrSlider-824"><a href="#spacrSlider-824"><span class="linenos">824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="spacrSlider-825"><a href="#spacrSlider-825"><span class="linenos">825</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="spacrSlider-826"><a href="#spacrSlider-826"><span class="linenos">826</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
</span><span id="spacrSlider-827"><a href="#spacrSlider-827"><span class="linenos">827</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># position is &quot;left&quot;</span>
</span><span id="spacrSlider-828"><a href="#spacrSlider-828"><span class="linenos">828</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="spacrSlider-829"><a href="#spacrSlider-829"><span class="linenos">829</span></a>
</span><span id="spacrSlider-830"><a href="#spacrSlider-830"><span class="linenos">830</span></a>        <span class="c1"># Update the knob position after resizing</span>
</span><span id="spacrSlider-831"><a href="#spacrSlider-831"><span class="linenos">831</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider-832"><a href="#spacrSlider-832"><span class="linenos">832</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrSlider-833"><a href="#spacrSlider-833"><span class="linenos">833</span></a>
</span><span id="spacrSlider-834"><a href="#spacrSlider-834"><span class="linenos">834</span></a>    <span class="k">def</span> <span class="nf">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrSlider-835"><a href="#spacrSlider-835"><span class="linenos">835</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">:</span>
</span><span id="spacrSlider-836"><a href="#spacrSlider-836"><span class="linenos">836</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span>
</span><span id="spacrSlider-837"><a href="#spacrSlider-837"><span class="linenos">837</span></a>        <span class="n">relative_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span>
</span><span id="spacrSlider-838"><a href="#spacrSlider-838"><span class="linenos">838</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="n">relative_value</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="spacrSlider-839"><a href="#spacrSlider-839"><span class="linenos">839</span></a>
</span><span id="spacrSlider-840"><a href="#spacrSlider-840"><span class="linenos">840</span></a>    <span class="k">def</span> <span class="nf">position_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
</span><span id="spacrSlider-841"><a href="#spacrSlider-841"><span class="linenos">841</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">:</span>
</span><span id="spacrSlider-842"><a href="#spacrSlider-842"><span class="linenos">842</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span>
</span><span id="spacrSlider-843"><a href="#spacrSlider-843"><span class="linenos">843</span></a>        <span class="n">relative_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="spacrSlider-844"><a href="#spacrSlider-844"><span class="linenos">844</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span> <span class="o">+</span> <span class="n">relative_position</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span>
</span><span id="spacrSlider-845"><a href="#spacrSlider-845"><span class="linenos">845</span></a>
</span><span id="spacrSlider-846"><a href="#spacrSlider-846"><span class="linenos">846</span></a>    <span class="k">def</span> <span class="nf">draw_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="spacrSlider-847"><a href="#spacrSlider-847"><span class="linenos">847</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrSlider-848"><a href="#spacrSlider-848"><span class="linenos">848</span></a>
</span><span id="spacrSlider-849"><a href="#spacrSlider-849"><span class="linenos">849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slider_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span>
</span><span id="spacrSlider-850"><a href="#spacrSlider-850"><span class="linenos">850</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-851"><a href="#spacrSlider-851"><span class="linenos">851</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-852"><a href="#spacrSlider-852"><span class="linenos">852</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-853"><a href="#spacrSlider-853"><span class="linenos">853</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-854"><a href="#spacrSlider-854"><span class="linenos">854</span></a>            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> 
</span><span id="spacrSlider-855"><a href="#spacrSlider-855"><span class="linenos">855</span></a>            <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>
</span><span id="spacrSlider-856"><a href="#spacrSlider-856"><span class="linenos">856</span></a>        <span class="p">)</span>
</span><span id="spacrSlider-857"><a href="#spacrSlider-857"><span class="linenos">857</span></a>
</span><span id="spacrSlider-858"><a href="#spacrSlider-858"><span class="linenos">858</span></a>        <span class="n">knob_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="k">if</span> <span class="n">inactive</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span>
</span><span id="spacrSlider-859"><a href="#spacrSlider-859"><span class="linenos">859</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span>
</span><span id="spacrSlider-860"><a href="#spacrSlider-860"><span class="linenos">860</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-861"><a href="#spacrSlider-861"><span class="linenos">861</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-862"><a href="#spacrSlider-862"><span class="linenos">862</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-863"><a href="#spacrSlider-863"><span class="linenos">863</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-864"><a href="#spacrSlider-864"><span class="linenos">864</span></a>            <span class="n">fill</span><span class="o">=</span><span class="n">knob_color</span><span class="p">,</span> 
</span><span id="spacrSlider-865"><a href="#spacrSlider-865"><span class="linenos">865</span></a>            <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span id="spacrSlider-866"><a href="#spacrSlider-866"><span class="linenos">866</span></a>        <span class="p">)</span>
</span><span id="spacrSlider-867"><a href="#spacrSlider-867"><span class="linenos">867</span></a>
</span><span id="spacrSlider-868"><a href="#spacrSlider-868"><span class="linenos">868</span></a>    <span class="k">def</span> <span class="nf">move_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider-869"><a href="#spacrSlider-869"><span class="linenos">869</span></a>        <span class="n">new_position</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="spacrSlider-870"><a href="#spacrSlider-870"><span class="linenos">870</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="n">new_position</span>
</span><span id="spacrSlider-871"><a href="#spacrSlider-871"><span class="linenos">871</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position_to_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span><span class="p">)</span>
</span><span id="spacrSlider-872"><a href="#spacrSlider-872"><span class="linenos">872</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span>
</span><span id="spacrSlider-873"><a href="#spacrSlider-873"><span class="linenos">873</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob</span><span class="p">,</span> 
</span><span id="spacrSlider-874"><a href="#spacrSlider-874"><span class="linenos">874</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-875"><a href="#spacrSlider-875"><span class="linenos">875</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-876"><a href="#spacrSlider-876"><span class="linenos">876</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider-877"><a href="#spacrSlider-877"><span class="linenos">877</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span>
</span><span id="spacrSlider-878"><a href="#spacrSlider-878"><span class="linenos">878</span></a>        <span class="p">)</span>
</span><span id="spacrSlider-879"><a href="#spacrSlider-879"><span class="linenos">879</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="spacrSlider-880"><a href="#spacrSlider-880"><span class="linenos">880</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="spacrSlider-881"><a href="#spacrSlider-881"><span class="linenos">881</span></a>
</span><span id="spacrSlider-882"><a href="#spacrSlider-882"><span class="linenos">882</span></a>    <span class="k">def</span> <span class="nf">activate_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider-883"><a href="#spacrSlider-883"><span class="linenos">883</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrSlider-884"><a href="#spacrSlider-884"><span class="linenos">884</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">move_knob</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="spacrSlider-885"><a href="#spacrSlider-885"><span class="linenos">885</span></a>
</span><span id="spacrSlider-886"><a href="#spacrSlider-886"><span class="linenos">886</span></a>    <span class="k">def</span> <span class="nf">release_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider-887"><a href="#spacrSlider-887"><span class="linenos">887</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrSlider-888"><a href="#spacrSlider-888"><span class="linenos">888</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrSlider-889"><a href="#spacrSlider-889"><span class="linenos">889</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Call the command with the final value when the knob is released</span>
</span><span id="spacrSlider-890"><a href="#spacrSlider-890"><span class="linenos">890</span></a>
</span><span id="spacrSlider-891"><a href="#spacrSlider-891"><span class="linenos">891</span></a>    <span class="k">def</span> <span class="nf">set_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_to</span><span class="p">):</span>
</span><span id="spacrSlider-892"><a href="#spacrSlider-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="spacrSlider-893"><a href="#spacrSlider-893"><span class="linenos">893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider-894"><a href="#spacrSlider-894"><span class="linenos">894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrSlider-895"><a href="#spacrSlider-895"><span class="linenos">895</span></a>
</span><span id="spacrSlider-896"><a href="#spacrSlider-896"><span class="linenos">896</span></a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSlider-897"><a href="#spacrSlider-897"><span class="linenos">897</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="spacrSlider-898"><a href="#spacrSlider-898"><span class="linenos">898</span></a>
</span><span id="spacrSlider-899"><a href="#spacrSlider-899"><span class="linenos">899</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrSlider-900"><a href="#spacrSlider-900"><span class="linenos">900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the slider&#39;s value and update the knob position.&quot;&quot;&quot;</span>
</span><span id="spacrSlider-901"><a href="#spacrSlider-901"><span class="linenos">901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">))</span>  <span class="c1"># Ensure the value is within bounds</span>
</span><span id="spacrSlider-902"><a href="#spacrSlider-902"><span class="linenos">902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider-903"><a href="#spacrSlider-903"><span class="linenos">903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrSlider-904"><a href="#spacrSlider-904"><span class="linenos">904</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="spacrSlider-905"><a href="#spacrSlider-905"><span class="linenos">905</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="spacrSlider-906"><a href="#spacrSlider-906"><span class="linenos">906</span></a>
</span><span id="spacrSlider-907"><a href="#spacrSlider-907"><span class="linenos">907</span></a>    <span class="k">def</span> <span class="nf">jump_to_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider-908"><a href="#spacrSlider-908"><span class="linenos">908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">activate_knob</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="spacrSlider-909"><a href="#spacrSlider-909"><span class="linenos">909</span></a>
</span><span id="spacrSlider-910"><a href="#spacrSlider-910"><span class="linenos">910</span></a>    <span class="k">def</span> <span class="nf">update_slider_from_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider-911"><a href="#spacrSlider-911"><span class="linenos">911</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the slider&#39;s value from the entry.&quot;&quot;&quot;</span>
</span><span id="spacrSlider-912"><a href="#spacrSlider-912"><span class="linenos">912</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="spacrSlider-913"><a href="#spacrSlider-913"><span class="linenos">913</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="spacrSlider-914"><a href="#spacrSlider-914"><span class="linenos">914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="spacrSlider-915"><a href="#spacrSlider-915"><span class="linenos">915</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrSlider-916"><a href="#spacrSlider-916"><span class="linenos">916</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider-917"><a href="#spacrSlider-917"><span class="linenos">917</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="spacrSlider-918"><a href="#spacrSlider-918"><span class="linenos">918</span></a>            <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrSlider.__init__" class="classattr">
                                        <input id="spacrSlider.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrSlider</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">master</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">length</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">thickness</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">knob_radius</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">position</span><span class="o">=</span><span class="s1">&#39;center&#39;</span>,</span><span class="param">	<span class="n">from_</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">to</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">value</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">show_index</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">command</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrSlider.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.__init__-757"><a href="#spacrSlider.__init__-757"><span class="linenos">757</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">knob_radius</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrSlider.__init__-758"><a href="#spacrSlider.__init__-758"><span class="linenos">758</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-759"><a href="#spacrSlider.__init__-759"><span class="linenos">759</span></a>
</span><span id="spacrSlider.__init__-760"><a href="#spacrSlider.__init__-760"><span class="linenos">760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="o">=</span> <span class="n">length</span>  <span class="c1"># Store the specified length, if any</span>
</span><span id="spacrSlider.__init__-761"><a href="#spacrSlider.__init__-761"><span class="linenos">761</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">=</span> <span class="n">knob_radius</span>
</span><span id="spacrSlider.__init__-762"><a href="#spacrSlider.__init__-762"><span class="linenos">762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
</span><span id="spacrSlider.__init__-763"><a href="#spacrSlider.__init__-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="n">knob_radius</span>  <span class="c1"># Start at the beginning of the slider</span>
</span><span id="spacrSlider.__init__-764"><a href="#spacrSlider.__init__-764"><span class="linenos">764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slider_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrSlider.__init__-765"><a href="#spacrSlider.__init__-765"><span class="linenos">765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrSlider.__init__-766"><a href="#spacrSlider.__init__-766"><span class="linenos">766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># Store the position option</span>
</span><span id="spacrSlider.__init__-767"><a href="#spacrSlider.__init__-767"><span class="linenos">767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Initialize offset</span>
</span><span id="spacrSlider.__init__-768"><a href="#spacrSlider.__init__-768"><span class="linenos">768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">from_</span> <span class="o">=</span> <span class="n">from_</span>  <span class="c1"># Minimum value of the slider</span>
</span><span id="spacrSlider.__init__-769"><a href="#spacrSlider.__init__-769"><span class="linenos">769</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">=</span> <span class="n">to</span>  <span class="c1"># Maximum value of the slider</span>
</span><span id="spacrSlider.__init__-770"><a href="#spacrSlider.__init__-770"><span class="linenos">770</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">from_</span>  <span class="c1"># Initial value of the slider</span>
</span><span id="spacrSlider.__init__-771"><a href="#spacrSlider.__init__-771"><span class="linenos">771</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span> <span class="o">=</span> <span class="n">show_index</span>  <span class="c1"># Whether to show the index Entry widget</span>
</span><span id="spacrSlider.__init__-772"><a href="#spacrSlider.__init__-772"><span class="linenos">772</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>  <span class="c1"># Callback function to handle value changes</span>
</span><span id="spacrSlider.__init__-773"><a href="#spacrSlider.__init__-773"><span class="linenos">773</span></a>
</span><span id="spacrSlider.__init__-774"><a href="#spacrSlider.__init__-774"><span class="linenos">774</span></a>        <span class="c1"># Initialize the style and colors</span>
</span><span id="spacrSlider.__init__-775"><a href="#spacrSlider.__init__-775"><span class="linenos">775</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrSlider.__init__-776"><a href="#spacrSlider.__init__-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider.__init__-777"><a href="#spacrSlider.__init__-777"><span class="linenos">777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider.__init__-778"><a href="#spacrSlider.__init__-778"><span class="linenos">778</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider.__init__-779"><a href="#spacrSlider.__init__-779"><span class="linenos">779</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrSlider.__init__-780"><a href="#spacrSlider.__init__-780"><span class="linenos">780</span></a>
</span><span id="spacrSlider.__init__-781"><a href="#spacrSlider.__init__-781"><span class="linenos">781</span></a>        <span class="c1"># Configure the frame&#39;s background color</span>
</span><span id="spacrSlider.__init__-782"><a href="#spacrSlider.__init__-782"><span class="linenos">782</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-783"><a href="#spacrSlider.__init__-783"><span class="linenos">783</span></a>
</span><span id="spacrSlider.__init__-784"><a href="#spacrSlider.__init__-784"><span class="linenos">784</span></a>        <span class="c1"># Create a frame for the slider and entry if needed</span>
</span><span id="spacrSlider.__init__-785"><a href="#spacrSlider.__init__-785"><span class="linenos">785</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-786"><a href="#spacrSlider.__init__-786"><span class="linenos">786</span></a>
</span><span id="spacrSlider.__init__-787"><a href="#spacrSlider.__init__-787"><span class="linenos">787</span></a>        <span class="c1"># Entry widget for showing and editing index, if enabled</span>
</span><span id="spacrSlider.__init__-788"><a href="#spacrSlider.__init__-788"><span class="linenos">788</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="spacrSlider.__init__-789"><a href="#spacrSlider.__init__-789"><span class="linenos">789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="spacrSlider.__init__-790"><a href="#spacrSlider.__init__-790"><span class="linenos">790</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">insertbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-791"><a href="#spacrSlider.__init__-791"><span class="linenos">791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-792"><a href="#spacrSlider.__init__-792"><span class="linenos">792</span></a>            <span class="c1"># Bind the entry to update the slider on change</span>
</span><span id="spacrSlider.__init__-793"><a href="#spacrSlider.__init__-793"><span class="linenos">793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Return&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_slider_from_entry</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-794"><a href="#spacrSlider.__init__-794"><span class="linenos">794</span></a>
</span><span id="spacrSlider.__init__-795"><a href="#spacrSlider.__init__-795"><span class="linenos">795</span></a>        <span class="c1"># Create the slider canvas</span>
</span><span id="spacrSlider.__init__-796"><a href="#spacrSlider.__init__-796"><span class="linenos">796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">knob_radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-797"><a href="#spacrSlider.__init__-797"><span class="linenos">797</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-798"><a href="#spacrSlider.__init__-798"><span class="linenos">798</span></a>
</span><span id="spacrSlider.__init__-799"><a href="#spacrSlider.__init__-799"><span class="linenos">799</span></a>        <span class="c1"># Set initial length to specified length or default value</span>
</span><span id="spacrSlider.__init__-800"><a href="#spacrSlider.__init__-800"><span class="linenos">800</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span>
</span><span id="spacrSlider.__init__-801"><a href="#spacrSlider.__init__-801"><span class="linenos">801</span></a>
</span><span id="spacrSlider.__init__-802"><a href="#spacrSlider.__init__-802"><span class="linenos">802</span></a>        <span class="c1"># Calculate initial knob position based on the initial value</span>
</span><span id="spacrSlider.__init__-803"><a href="#spacrSlider.__init__-803"><span class="linenos">803</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-804"><a href="#spacrSlider.__init__-804"><span class="linenos">804</span></a>
</span><span id="spacrSlider.__init__-805"><a href="#spacrSlider.__init__-805"><span class="linenos">805</span></a>        <span class="c1"># Bind resize event to dynamically adjust the slider length if no length is specified</span>
</span><span id="spacrSlider.__init__-806"><a href="#spacrSlider.__init__-806"><span class="linenos">806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_slider</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-807"><a href="#spacrSlider.__init__-807"><span class="linenos">807</span></a>
</span><span id="spacrSlider.__init__-808"><a href="#spacrSlider.__init__-808"><span class="linenos">808</span></a>        <span class="c1"># Draw the slider components</span>
</span><span id="spacrSlider.__init__-809"><a href="#spacrSlider.__init__-809"><span class="linenos">809</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-810"><a href="#spacrSlider.__init__-810"><span class="linenos">810</span></a>
</span><span id="spacrSlider.__init__-811"><a href="#spacrSlider.__init__-811"><span class="linenos">811</span></a>        <span class="c1"># Bind mouse events to the knob and slider</span>
</span><span id="spacrSlider.__init__-812"><a href="#spacrSlider.__init__-812"><span class="linenos">812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_knob</span><span class="p">)</span>
</span><span id="spacrSlider.__init__-813"><a href="#spacrSlider.__init__-813"><span class="linenos">813</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">activate_knob</span><span class="p">)</span>  <span class="c1"># Activate knob on click</span>
</span><span id="spacrSlider.__init__-814"><a href="#spacrSlider.__init__-814"><span class="linenos">814</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">release_knob</span><span class="p">)</span>  <span class="c1"># Trigger command on release</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrSlider.specified_length" class="classattr">
                                <div class="attr variable">
            <span class="name">specified_length</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.specified_length"></a>
    
    

                            </div>
                            <div id="spacrSlider.knob_radius" class="classattr">
                                <div class="attr variable">
            <span class="name">knob_radius</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.knob_radius"></a>
    
    

                            </div>
                            <div id="spacrSlider.thickness" class="classattr">
                                <div class="attr variable">
            <span class="name">thickness</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.thickness"></a>
    
    

                            </div>
                            <div id="spacrSlider.knob_position" class="classattr">
                                <div class="attr variable">
            <span class="name">knob_position</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.knob_position"></a>
    
    

                            </div>
                            <div id="spacrSlider.slider_line" class="classattr">
                                <div class="attr variable">
            <span class="name">slider_line</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.slider_line"></a>
    
    

                            </div>
                            <div id="spacrSlider.knob" class="classattr">
                                <div class="attr variable">
            <span class="name">knob</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.knob"></a>
    
    

                            </div>
                            <div id="spacrSlider.position" class="classattr">
                                <div class="attr variable">
            <span class="name">position</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.position"></a>
    
    

                            </div>
                            <div id="spacrSlider.offset" class="classattr">
                                <div class="attr variable">
            <span class="name">offset</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.offset"></a>
    
    

                            </div>
                            <div id="spacrSlider.from_" class="classattr">
                                <div class="attr variable">
            <span class="name">from_</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.from_"></a>
    
    

                            </div>
                            <div id="spacrSlider.to" class="classattr">
                                <div class="attr variable">
            <span class="name">to</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.to"></a>
    
    

                            </div>
                            <div id="spacrSlider.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.value"></a>
    
    

                            </div>
                            <div id="spacrSlider.show_index" class="classattr">
                                <div class="attr variable">
            <span class="name">show_index</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.show_index"></a>
    
    

                            </div>
                            <div id="spacrSlider.command" class="classattr">
                                <div class="attr variable">
            <span class="name">command</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.command"></a>
    
    

                            </div>
                            <div id="spacrSlider.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.fg_color"></a>
    
    

                            </div>
                            <div id="spacrSlider.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.bg_color"></a>
    
    

                            </div>
                            <div id="spacrSlider.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.active_color"></a>
    
    

                            </div>
                            <div id="spacrSlider.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrSlider.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.canvas"></a>
    
    

                            </div>
                            <div id="spacrSlider.length" class="classattr">
                                <div class="attr variable">
            <span class="name">length</span>

        
    </div>
    <a class="headerlink" href="#spacrSlider.length"></a>
    
    

                            </div>
                            <div id="spacrSlider.resize_slider" class="classattr">
                                        <input id="spacrSlider.resize_slider-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">resize_slider</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.resize_slider-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.resize_slider"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.resize_slider-816"><a href="#spacrSlider.resize_slider-816"><span class="linenos">816</span></a>    <span class="k">def</span> <span class="nf">resize_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider.resize_slider-817"><a href="#spacrSlider.resize_slider-817"><span class="linenos">817</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrSlider.resize_slider-818"><a href="#spacrSlider.resize_slider-818"><span class="linenos">818</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specified_length</span>
</span><span id="spacrSlider.resize_slider-819"><a href="#spacrSlider.resize_slider-819"><span class="linenos">819</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrSlider.resize_slider-820"><a href="#spacrSlider.resize_slider-820"><span class="linenos">820</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span>  <span class="c1"># 90% of the container width</span>
</span><span id="spacrSlider.resize_slider-821"><a href="#spacrSlider.resize_slider-821"><span class="linenos">821</span></a>        
</span><span id="spacrSlider.resize_slider-822"><a href="#spacrSlider.resize_slider-822"><span class="linenos">822</span></a>        <span class="c1"># Calculate the horizontal offset based on the position</span>
</span><span id="spacrSlider.resize_slider-823"><a href="#spacrSlider.resize_slider-823"><span class="linenos">823</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
</span><span id="spacrSlider.resize_slider-824"><a href="#spacrSlider.resize_slider-824"><span class="linenos">824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="spacrSlider.resize_slider-825"><a href="#spacrSlider.resize_slider-825"><span class="linenos">825</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="spacrSlider.resize_slider-826"><a href="#spacrSlider.resize_slider-826"><span class="linenos">826</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
</span><span id="spacrSlider.resize_slider-827"><a href="#spacrSlider.resize_slider-827"><span class="linenos">827</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># position is &quot;left&quot;</span>
</span><span id="spacrSlider.resize_slider-828"><a href="#spacrSlider.resize_slider-828"><span class="linenos">828</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="spacrSlider.resize_slider-829"><a href="#spacrSlider.resize_slider-829"><span class="linenos">829</span></a>
</span><span id="spacrSlider.resize_slider-830"><a href="#spacrSlider.resize_slider-830"><span class="linenos">830</span></a>        <span class="c1"># Update the knob position after resizing</span>
</span><span id="spacrSlider.resize_slider-831"><a href="#spacrSlider.resize_slider-831"><span class="linenos">831</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider.resize_slider-832"><a href="#spacrSlider.resize_slider-832"><span class="linenos">832</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.value_to_position" class="classattr">
                                        <input id="spacrSlider.value_to_position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">value_to_position</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">value</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.value_to_position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.value_to_position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.value_to_position-834"><a href="#spacrSlider.value_to_position-834"><span class="linenos">834</span></a>    <span class="k">def</span> <span class="nf">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrSlider.value_to_position-835"><a href="#spacrSlider.value_to_position-835"><span class="linenos">835</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">:</span>
</span><span id="spacrSlider.value_to_position-836"><a href="#spacrSlider.value_to_position-836"><span class="linenos">836</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span>
</span><span id="spacrSlider.value_to_position-837"><a href="#spacrSlider.value_to_position-837"><span class="linenos">837</span></a>        <span class="n">relative_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span>
</span><span id="spacrSlider.value_to_position-838"><a href="#spacrSlider.value_to_position-838"><span class="linenos">838</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="n">relative_value</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.position_to_value" class="classattr">
                                        <input id="spacrSlider.position_to_value-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">position_to_value</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">position</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.position_to_value-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.position_to_value"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.position_to_value-840"><a href="#spacrSlider.position_to_value-840"><span class="linenos">840</span></a>    <span class="k">def</span> <span class="nf">position_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
</span><span id="spacrSlider.position_to_value-841"><a href="#spacrSlider.position_to_value-841"><span class="linenos">841</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">:</span>
</span><span id="spacrSlider.position_to_value-842"><a href="#spacrSlider.position_to_value-842"><span class="linenos">842</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span>
</span><span id="spacrSlider.position_to_value-843"><a href="#spacrSlider.position_to_value-843"><span class="linenos">843</span></a>        <span class="n">relative_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="spacrSlider.position_to_value-844"><a href="#spacrSlider.position_to_value-844"><span class="linenos">844</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span> <span class="o">+</span> <span class="n">relative_position</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.draw_slider" class="classattr">
                                        <input id="spacrSlider.draw_slider-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_slider</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.draw_slider-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.draw_slider"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.draw_slider-846"><a href="#spacrSlider.draw_slider-846"><span class="linenos">846</span></a>    <span class="k">def</span> <span class="nf">draw_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="spacrSlider.draw_slider-847"><a href="#spacrSlider.draw_slider-847"><span class="linenos">847</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="spacrSlider.draw_slider-848"><a href="#spacrSlider.draw_slider-848"><span class="linenos">848</span></a>
</span><span id="spacrSlider.draw_slider-849"><a href="#spacrSlider.draw_slider-849"><span class="linenos">849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slider_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span>
</span><span id="spacrSlider.draw_slider-850"><a href="#spacrSlider.draw_slider-850"><span class="linenos">850</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-851"><a href="#spacrSlider.draw_slider-851"><span class="linenos">851</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-852"><a href="#spacrSlider.draw_slider-852"><span class="linenos">852</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-853"><a href="#spacrSlider.draw_slider-853"><span class="linenos">853</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-854"><a href="#spacrSlider.draw_slider-854"><span class="linenos">854</span></a>            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-855"><a href="#spacrSlider.draw_slider-855"><span class="linenos">855</span></a>            <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>
</span><span id="spacrSlider.draw_slider-856"><a href="#spacrSlider.draw_slider-856"><span class="linenos">856</span></a>        <span class="p">)</span>
</span><span id="spacrSlider.draw_slider-857"><a href="#spacrSlider.draw_slider-857"><span class="linenos">857</span></a>
</span><span id="spacrSlider.draw_slider-858"><a href="#spacrSlider.draw_slider-858"><span class="linenos">858</span></a>        <span class="n">knob_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="k">if</span> <span class="n">inactive</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span>
</span><span id="spacrSlider.draw_slider-859"><a href="#spacrSlider.draw_slider-859"><span class="linenos">859</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span>
</span><span id="spacrSlider.draw_slider-860"><a href="#spacrSlider.draw_slider-860"><span class="linenos">860</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-861"><a href="#spacrSlider.draw_slider-861"><span class="linenos">861</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-862"><a href="#spacrSlider.draw_slider-862"><span class="linenos">862</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-863"><a href="#spacrSlider.draw_slider-863"><span class="linenos">863</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-864"><a href="#spacrSlider.draw_slider-864"><span class="linenos">864</span></a>            <span class="n">fill</span><span class="o">=</span><span class="n">knob_color</span><span class="p">,</span> 
</span><span id="spacrSlider.draw_slider-865"><a href="#spacrSlider.draw_slider-865"><span class="linenos">865</span></a>            <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span id="spacrSlider.draw_slider-866"><a href="#spacrSlider.draw_slider-866"><span class="linenos">866</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.move_knob" class="classattr">
                                        <input id="spacrSlider.move_knob-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">move_knob</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.move_knob-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.move_knob"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.move_knob-868"><a href="#spacrSlider.move_knob-868"><span class="linenos">868</span></a>    <span class="k">def</span> <span class="nf">move_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider.move_knob-869"><a href="#spacrSlider.move_knob-869"><span class="linenos">869</span></a>        <span class="n">new_position</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">)</span>
</span><span id="spacrSlider.move_knob-870"><a href="#spacrSlider.move_knob-870"><span class="linenos">870</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="n">new_position</span>
</span><span id="spacrSlider.move_knob-871"><a href="#spacrSlider.move_knob-871"><span class="linenos">871</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position_to_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span><span class="p">)</span>
</span><span id="spacrSlider.move_knob-872"><a href="#spacrSlider.move_knob-872"><span class="linenos">872</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span>
</span><span id="spacrSlider.move_knob-873"><a href="#spacrSlider.move_knob-873"><span class="linenos">873</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob</span><span class="p">,</span> 
</span><span id="spacrSlider.move_knob-874"><a href="#spacrSlider.move_knob-874"><span class="linenos">874</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.move_knob-875"><a href="#spacrSlider.move_knob-875"><span class="linenos">875</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.move_knob-876"><a href="#spacrSlider.move_knob-876"><span class="linenos">876</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span><span class="p">,</span> 
</span><span id="spacrSlider.move_knob-877"><a href="#spacrSlider.move_knob-877"><span class="linenos">877</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">knob_radius</span>
</span><span id="spacrSlider.move_knob-878"><a href="#spacrSlider.move_knob-878"><span class="linenos">878</span></a>        <span class="p">)</span>
</span><span id="spacrSlider.move_knob-879"><a href="#spacrSlider.move_knob-879"><span class="linenos">879</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="spacrSlider.move_knob-880"><a href="#spacrSlider.move_knob-880"><span class="linenos">880</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.activate_knob" class="classattr">
                                        <input id="spacrSlider.activate_knob-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">activate_knob</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.activate_knob-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.activate_knob"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.activate_knob-882"><a href="#spacrSlider.activate_knob-882"><span class="linenos">882</span></a>    <span class="k">def</span> <span class="nf">activate_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider.activate_knob-883"><a href="#spacrSlider.activate_knob-883"><span class="linenos">883</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrSlider.activate_knob-884"><a href="#spacrSlider.activate_knob-884"><span class="linenos">884</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">move_knob</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.release_knob" class="classattr">
                                        <input id="spacrSlider.release_knob-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">release_knob</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.release_knob-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.release_knob"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.release_knob-886"><a href="#spacrSlider.release_knob-886"><span class="linenos">886</span></a>    <span class="k">def</span> <span class="nf">release_knob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider.release_knob-887"><a href="#spacrSlider.release_knob-887"><span class="linenos">887</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrSlider.release_knob-888"><a href="#spacrSlider.release_knob-888"><span class="linenos">888</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrSlider.release_knob-889"><a href="#spacrSlider.release_knob-889"><span class="linenos">889</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Call the command with the final value when the knob is released</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.set_to" class="classattr">
                                        <input id="spacrSlider.set_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">new_to</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.set_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.set_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.set_to-891"><a href="#spacrSlider.set_to-891"><span class="linenos">891</span></a>    <span class="k">def</span> <span class="nf">set_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_to</span><span class="p">):</span>
</span><span id="spacrSlider.set_to-892"><a href="#spacrSlider.set_to-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="spacrSlider.set_to-893"><a href="#spacrSlider.set_to-893"><span class="linenos">893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider.set_to-894"><a href="#spacrSlider.set_to-894"><span class="linenos">894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.get" class="classattr">
                                        <input id="spacrSlider.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.get-896"><a href="#spacrSlider.get-896"><span class="linenos">896</span></a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSlider.get-897"><a href="#spacrSlider.get-897"><span class="linenos">897</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.set" class="classattr">
                                        <input id="spacrSlider.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">value</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.set-899"><a href="#spacrSlider.set-899"><span class="linenos">899</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrSlider.set-900"><a href="#spacrSlider.set-900"><span class="linenos">900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the slider&#39;s value and update the knob position.&quot;&quot;&quot;</span>
</span><span id="spacrSlider.set-901"><a href="#spacrSlider.set-901"><span class="linenos">901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">))</span>  <span class="c1"># Ensure the value is within bounds</span>
</span><span id="spacrSlider.set-902"><a href="#spacrSlider.set-902"><span class="linenos">902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">knob_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_to_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider.set-903"><a href="#spacrSlider.set-903"><span class="linenos">903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_slider</span><span class="p">(</span><span class="n">inactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="spacrSlider.set-904"><a href="#spacrSlider.set-904"><span class="linenos">904</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_index</span><span class="p">:</span>
</span><span id="spacrSlider.set-905"><a href="#spacrSlider.set-905"><span class="linenos">905</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Set the slider's value and update the knob position.</p>
</div>


                            </div>
                            <div id="spacrSlider.jump_to_click" class="classattr">
                                        <input id="spacrSlider.jump_to_click-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">jump_to_click</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.jump_to_click-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.jump_to_click"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.jump_to_click-907"><a href="#spacrSlider.jump_to_click-907"><span class="linenos">907</span></a>    <span class="k">def</span> <span class="nf">jump_to_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider.jump_to_click-908"><a href="#spacrSlider.jump_to_click-908"><span class="linenos">908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">activate_knob</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSlider.update_slider_from_entry" class="classattr">
                                        <input id="spacrSlider.update_slider_from_entry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_slider_from_entry</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSlider.update_slider_from_entry-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSlider.update_slider_from_entry"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSlider.update_slider_from_entry-910"><a href="#spacrSlider.update_slider_from_entry-910"><span class="linenos">910</span></a>    <span class="k">def</span> <span class="nf">update_slider_from_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrSlider.update_slider_from_entry-911"><a href="#spacrSlider.update_slider_from_entry-911"><span class="linenos">911</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the slider&#39;s value from the entry.&quot;&quot;&quot;</span>
</span><span id="spacrSlider.update_slider_from_entry-912"><a href="#spacrSlider.update_slider_from_entry-912"><span class="linenos">912</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="spacrSlider.update_slider_from_entry-913"><a href="#spacrSlider.update_slider_from_entry-913"><span class="linenos">913</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="spacrSlider.update_slider_from_entry-914"><a href="#spacrSlider.update_slider_from_entry-914"><span class="linenos">914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="spacrSlider.update_slider_from_entry-915"><a href="#spacrSlider.update_slider_from_entry-915"><span class="linenos">915</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrSlider.update_slider_from_entry-916"><a href="#spacrSlider.update_slider_from_entry-916"><span class="linenos">916</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSlider.update_slider_from_entry-917"><a href="#spacrSlider.update_slider_from_entry-917"><span class="linenos">917</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="spacrSlider.update_slider_from_entry-918"><a href="#spacrSlider.update_slider_from_entry-918"><span class="linenos">918</span></a>            <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the slider's value from the entry.</p>
</div>


                            </div>
                </section>
                <section id="spacrScrollbarStyle">
                            <input id="spacrScrollbarStyle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">spacrScrollbarStyle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">style</span>, </span><span class="param"><span class="n">inactive_color</span>, </span><span class="param"><span class="n">active_color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrScrollbarStyle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrScrollbarStyle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrScrollbarStyle-920"><a href="#spacrScrollbarStyle-920"><span class="linenos">920</span></a><span class="k">def</span> <span class="nf">spacrScrollbarStyle</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">,</span> <span class="n">active_color</span><span class="p">):</span>
</span><span id="spacrScrollbarStyle-921"><a href="#spacrScrollbarStyle-921"><span class="linenos">921</span></a>    <span class="c1"># Check if custom elements already exist to avoid duplication</span>
</span><span id="spacrScrollbarStyle-922"><a href="#spacrScrollbarStyle-922"><span class="linenos">922</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="o">.</span><span class="n">element_names</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.trough&#39;</span><span class="p">):</span>
</span><span id="spacrScrollbarStyle-923"><a href="#spacrScrollbarStyle-923"><span class="linenos">923</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">element_create</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.trough&#39;</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;clam&#39;</span><span class="p">)</span>
</span><span id="spacrScrollbarStyle-924"><a href="#spacrScrollbarStyle-924"><span class="linenos">924</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">style</span><span class="o">.</span><span class="n">element_names</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.thumb&#39;</span><span class="p">):</span>
</span><span id="spacrScrollbarStyle-925"><a href="#spacrScrollbarStyle-925"><span class="linenos">925</span></a>        <span class="n">style</span><span class="o">.</span><span class="n">element_create</span><span class="p">(</span><span class="s1">&#39;custom.Vertical.Scrollbar.thumb&#39;</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;clam&#39;</span><span class="p">)</span>
</span><span id="spacrScrollbarStyle-926"><a href="#spacrScrollbarStyle-926"><span class="linenos">926</span></a>
</span><span id="spacrScrollbarStyle-927"><a href="#spacrScrollbarStyle-927"><span class="linenos">927</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-928"><a href="#spacrScrollbarStyle-928"><span class="linenos">928</span></a>                 <span class="p">[(</span><span class="s1">&#39;Vertical.Scrollbar.trough&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;Vertical.Scrollbar.thumb&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;expand&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;sticky&#39;</span><span class="p">:</span> <span class="s1">&#39;nswe&#39;</span><span class="p">})],</span> <span class="s1">&#39;sticky&#39;</span><span class="p">:</span> <span class="s1">&#39;ns&#39;</span><span class="p">})])</span>
</span><span id="spacrScrollbarStyle-929"><a href="#spacrScrollbarStyle-929"><span class="linenos">929</span></a>
</span><span id="spacrScrollbarStyle-930"><a href="#spacrScrollbarStyle-930"><span class="linenos">930</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-931"><a href="#spacrScrollbarStyle-931"><span class="linenos">931</span></a>                    <span class="n">background</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-932"><a href="#spacrScrollbarStyle-932"><span class="linenos">932</span></a>                    <span class="n">troughcolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-933"><a href="#spacrScrollbarStyle-933"><span class="linenos">933</span></a>                    <span class="n">bordercolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-934"><a href="#spacrScrollbarStyle-934"><span class="linenos">934</span></a>                    <span class="n">lightcolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-935"><a href="#spacrScrollbarStyle-935"><span class="linenos">935</span></a>                    <span class="n">darkcolor</span><span class="o">=</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrScrollbarStyle-936"><a href="#spacrScrollbarStyle-936"><span class="linenos">936</span></a>
</span><span id="spacrScrollbarStyle-937"><a href="#spacrScrollbarStyle-937"><span class="linenos">937</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">,</span>
</span><span id="spacrScrollbarStyle-938"><a href="#spacrScrollbarStyle-938"><span class="linenos">938</span></a>              <span class="n">background</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="p">)],</span>
</span><span id="spacrScrollbarStyle-939"><a href="#spacrScrollbarStyle-939"><span class="linenos">939</span></a>              <span class="n">troughcolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">)],</span>
</span><span id="spacrScrollbarStyle-940"><a href="#spacrScrollbarStyle-940"><span class="linenos">940</span></a>              <span class="n">bordercolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">)],</span>
</span><span id="spacrScrollbarStyle-941"><a href="#spacrScrollbarStyle-941"><span class="linenos">941</span></a>              <span class="n">lightcolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="p">)],</span>
</span><span id="spacrScrollbarStyle-942"><a href="#spacrScrollbarStyle-942"><span class="linenos">942</span></a>              <span class="n">darkcolor</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;!active&#39;</span><span class="p">,</span> <span class="n">inactive_color</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="n">active_color</span><span class="p">)])</span>
</span></pre></div>


    

                </section>
                <section id="spacrFrame">
                            <input id="spacrFrame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrFrame</span><wbr>(<span class="base">tkinter.ttk.Frame</span>):

                <label class="view-source-button" for="spacrFrame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFrame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFrame-944"><a href="#spacrFrame-944"><span class="linenos"> 944</span></a><span class="k">class</span> <span class="nc">spacrFrame</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrFrame-945"><a href="#spacrFrame-945"><span class="linenos"> 945</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scrollbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">textbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrFrame-946"><a href="#spacrFrame-946"><span class="linenos"> 946</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrFrame-947"><a href="#spacrFrame-947"><span class="linenos"> 947</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;TFrame&#39;</span><span class="p">)</span>
</span><span id="spacrFrame-948"><a href="#spacrFrame-948"><span class="linenos"> 948</span></a>        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrFrame-949"><a href="#spacrFrame-949"><span class="linenos"> 949</span></a>            <span class="n">screen_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
</span><span id="spacrFrame-950"><a href="#spacrFrame-950"><span class="linenos"> 950</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="spacrFrame-951"><a href="#spacrFrame-951"><span class="linenos"> 951</span></a>
</span><span id="spacrFrame-952"><a href="#spacrFrame-952"><span class="linenos"> 952</span></a>        <span class="c1"># Create the canvas</span>
</span><span id="spacrFrame-953"><a href="#spacrFrame-953"><span class="linenos"> 953</span></a>        <span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrFrame-954"><a href="#spacrFrame-954"><span class="linenos"> 954</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rounded_rectangle</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">(),</span> <span class="n">radius</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">bg</span><span class="p">)</span>
</span><span id="spacrFrame-955"><a href="#spacrFrame-955"><span class="linenos"> 955</span></a>
</span><span id="spacrFrame-956"><a href="#spacrFrame-956"><span class="linenos"> 956</span></a>        <span class="c1"># Define scrollbar styles</span>
</span><span id="spacrFrame-957"><a href="#spacrFrame-957"><span class="linenos"> 957</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrFrame-958"><a href="#spacrFrame-958"><span class="linenos"> 958</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrFrame-959"><a href="#spacrFrame-959"><span class="linenos"> 959</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrFrame-960"><a href="#spacrFrame-960"><span class="linenos"> 960</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>  <span class="c1"># Foreground color for text</span>
</span><span id="spacrFrame-961"><a href="#spacrFrame-961"><span class="linenos"> 961</span></a>
</span><span id="spacrFrame-962"><a href="#spacrFrame-962"><span class="linenos"> 962</span></a>        <span class="c1"># Set custom scrollbar style</span>
</span><span id="spacrFrame-963"><a href="#spacrFrame-963"><span class="linenos"> 963</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrFrame-964"><a href="#spacrFrame-964"><span class="linenos"> 964</span></a>        <span class="n">spacrScrollbarStyle</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrFrame-965"><a href="#spacrFrame-965"><span class="linenos"> 965</span></a>
</span><span id="spacrFrame-966"><a href="#spacrFrame-966"><span class="linenos"> 966</span></a>        <span class="c1"># Create scrollbar with custom style if scrollbar option is True</span>
</span><span id="spacrFrame-967"><a href="#spacrFrame-967"><span class="linenos"> 967</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame-968"><a href="#spacrFrame-968"><span class="linenos"> 968</span></a>            <span class="n">scrollbar_widget</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">yview</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">)</span>
</span><span id="spacrFrame-969"><a href="#spacrFrame-969"><span class="linenos"> 969</span></a>        
</span><span id="spacrFrame-970"><a href="#spacrFrame-970"><span class="linenos"> 970</span></a>        <span class="k">if</span> <span class="n">textbox</span><span class="p">:</span>
</span><span id="spacrFrame-971"><a href="#spacrFrame-971"><span class="linenos"> 971</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
</span><span id="spacrFrame-972"><a href="#spacrFrame-972"><span class="linenos"> 972</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrFrame-973"><a href="#spacrFrame-973"><span class="linenos"> 973</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;TFrame&#39;</span><span class="p">)</span>
</span><span id="spacrFrame-974"><a href="#spacrFrame-974"><span class="linenos"> 974</span></a>        
</span><span id="spacrFrame-975"><a href="#spacrFrame-975"><span class="linenos"> 975</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
</span><span id="spacrFrame-976"><a href="#spacrFrame-976"><span class="linenos"> 976</span></a>            <span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span>
</span><span id="spacrFrame-977"><a href="#spacrFrame-977"><span class="linenos"> 977</span></a>            <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">scrollregion</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
</span><span id="spacrFrame-978"><a href="#spacrFrame-978"><span class="linenos"> 978</span></a>        <span class="p">)</span>
</span><span id="spacrFrame-979"><a href="#spacrFrame-979"><span class="linenos"> 979</span></a>        <span class="n">canvas</span><span class="o">.</span><span class="n">create_window</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;nw&quot;</span><span class="p">)</span>
</span><span id="spacrFrame-980"><a href="#spacrFrame-980"><span class="linenos"> 980</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame-981"><a href="#spacrFrame-981"><span class="linenos"> 981</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">scrollbar_widget</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="spacrFrame-982"><a href="#spacrFrame-982"><span class="linenos"> 982</span></a>        
</span><span id="spacrFrame-983"><a href="#spacrFrame-983"><span class="linenos"> 983</span></a>        <span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="spacrFrame-984"><a href="#spacrFrame-984"><span class="linenos"> 984</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame-985"><a href="#spacrFrame-985"><span class="linenos"> 985</span></a>            <span class="n">scrollbar_widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">)</span>
</span><span id="spacrFrame-986"><a href="#spacrFrame-986"><span class="linenos"> 986</span></a>
</span><span id="spacrFrame-987"><a href="#spacrFrame-987"><span class="linenos"> 987</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrFrame-988"><a href="#spacrFrame-988"><span class="linenos"> 988</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrFrame-989"><a href="#spacrFrame-989"><span class="linenos"> 989</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame-990"><a href="#spacrFrame-990"><span class="linenos"> 990</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrFrame-991"><a href="#spacrFrame-991"><span class="linenos"> 991</span></a>        
</span><span id="spacrFrame-992"><a href="#spacrFrame-992"><span class="linenos"> 992</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="p">])</span>
</span><span id="spacrFrame-993"><a href="#spacrFrame-993"><span class="linenos"> 993</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame-994"><a href="#spacrFrame-994"><span class="linenos"> 994</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">scrollbar_widget</span><span class="p">])</span>
</span><span id="spacrFrame-995"><a href="#spacrFrame-995"><span class="linenos"> 995</span></a>
</span><span id="spacrFrame-996"><a href="#spacrFrame-996"><span class="linenos"> 996</span></a>    <span class="k">def</span> <span class="nf">rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrFrame-997"><a href="#spacrFrame-997"><span class="linenos"> 997</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="spacrFrame-998"><a href="#spacrFrame-998"><span class="linenos"> 998</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame-999"><a href="#spacrFrame-999"><span class="linenos"> 999</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame-1000"><a href="#spacrFrame-1000"><span class="linenos">1000</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame-1001"><a href="#spacrFrame-1001"><span class="linenos">1001</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame-1002"><a href="#spacrFrame-1002"><span class="linenos">1002</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1003"><a href="#spacrFrame-1003"><span class="linenos">1003</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1004"><a href="#spacrFrame-1004"><span class="linenos">1004</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1005"><a href="#spacrFrame-1005"><span class="linenos">1005</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame-1006"><a href="#spacrFrame-1006"><span class="linenos">1006</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame-1007"><a href="#spacrFrame-1007"><span class="linenos">1007</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame-1008"><a href="#spacrFrame-1008"><span class="linenos">1008</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame-1009"><a href="#spacrFrame-1009"><span class="linenos">1009</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame-1010"><a href="#spacrFrame-1010"><span class="linenos">1010</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1011"><a href="#spacrFrame-1011"><span class="linenos">1011</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1012"><a href="#spacrFrame-1012"><span class="linenos">1012</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1013"><a href="#spacrFrame-1013"><span class="linenos">1013</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame-1014"><a href="#spacrFrame-1014"><span class="linenos">1014</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="spacrFrame-1015"><a href="#spacrFrame-1015"><span class="linenos">1015</span></a>        <span class="p">]</span>
</span><span id="spacrFrame-1016"><a href="#spacrFrame-1016"><span class="linenos">1016</span></a>        <span class="k">return</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ttk Frame widget is a container, used to group other widgets
together.</p>
</div>


                            <div id="spacrFrame.__init__" class="classattr">
                                        <input id="spacrFrame.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrFrame</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">container</span>,</span><span class="param">	<span class="n">width</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">radius</span><span class="o">=</span><span class="mi">20</span>,</span><span class="param">	<span class="n">scrollbar</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">textbox</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrFrame.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFrame.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFrame.__init__-945"><a href="#spacrFrame.__init__-945"><span class="linenos">945</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scrollbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">textbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrFrame.__init__-946"><a href="#spacrFrame.__init__-946"><span class="linenos">946</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-947"><a href="#spacrFrame.__init__-947"><span class="linenos">947</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;TFrame&#39;</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-948"><a href="#spacrFrame.__init__-948"><span class="linenos">948</span></a>        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-949"><a href="#spacrFrame.__init__-949"><span class="linenos">949</span></a>            <span class="n">screen_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
</span><span id="spacrFrame.__init__-950"><a href="#spacrFrame.__init__-950"><span class="linenos">950</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="spacrFrame.__init__-951"><a href="#spacrFrame.__init__-951"><span class="linenos">951</span></a>
</span><span id="spacrFrame.__init__-952"><a href="#spacrFrame.__init__-952"><span class="linenos">952</span></a>        <span class="c1"># Create the canvas</span>
</span><span id="spacrFrame.__init__-953"><a href="#spacrFrame.__init__-953"><span class="linenos">953</span></a>        <span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-954"><a href="#spacrFrame.__init__-954"><span class="linenos">954</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rounded_rectangle</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">(),</span> <span class="n">radius</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">bg</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-955"><a href="#spacrFrame.__init__-955"><span class="linenos">955</span></a>
</span><span id="spacrFrame.__init__-956"><a href="#spacrFrame.__init__-956"><span class="linenos">956</span></a>        <span class="c1"># Define scrollbar styles</span>
</span><span id="spacrFrame.__init__-957"><a href="#spacrFrame.__init__-957"><span class="linenos">957</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrFrame.__init__-958"><a href="#spacrFrame.__init__-958"><span class="linenos">958</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrFrame.__init__-959"><a href="#spacrFrame.__init__-959"><span class="linenos">959</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrFrame.__init__-960"><a href="#spacrFrame.__init__-960"><span class="linenos">960</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>  <span class="c1"># Foreground color for text</span>
</span><span id="spacrFrame.__init__-961"><a href="#spacrFrame.__init__-961"><span class="linenos">961</span></a>
</span><span id="spacrFrame.__init__-962"><a href="#spacrFrame.__init__-962"><span class="linenos">962</span></a>        <span class="c1"># Set custom scrollbar style</span>
</span><span id="spacrFrame.__init__-963"><a href="#spacrFrame.__init__-963"><span class="linenos">963</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrFrame.__init__-964"><a href="#spacrFrame.__init__-964"><span class="linenos">964</span></a>        <span class="n">spacrScrollbarStyle</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-965"><a href="#spacrFrame.__init__-965"><span class="linenos">965</span></a>
</span><span id="spacrFrame.__init__-966"><a href="#spacrFrame.__init__-966"><span class="linenos">966</span></a>        <span class="c1"># Create scrollbar with custom style if scrollbar option is True</span>
</span><span id="spacrFrame.__init__-967"><a href="#spacrFrame.__init__-967"><span class="linenos">967</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-968"><a href="#spacrFrame.__init__-968"><span class="linenos">968</span></a>            <span class="n">scrollbar_widget</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">yview</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;Custom.Vertical.TScrollbar&#39;</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-969"><a href="#spacrFrame.__init__-969"><span class="linenos">969</span></a>        
</span><span id="spacrFrame.__init__-970"><a href="#spacrFrame.__init__-970"><span class="linenos">970</span></a>        <span class="k">if</span> <span class="n">textbox</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-971"><a href="#spacrFrame.__init__-971"><span class="linenos">971</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-972"><a href="#spacrFrame.__init__-972"><span class="linenos">972</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-973"><a href="#spacrFrame.__init__-973"><span class="linenos">973</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;TFrame&#39;</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-974"><a href="#spacrFrame.__init__-974"><span class="linenos">974</span></a>        
</span><span id="spacrFrame.__init__-975"><a href="#spacrFrame.__init__-975"><span class="linenos">975</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
</span><span id="spacrFrame.__init__-976"><a href="#spacrFrame.__init__-976"><span class="linenos">976</span></a>            <span class="s2">&quot;&lt;Configure&gt;&quot;</span><span class="p">,</span>
</span><span id="spacrFrame.__init__-977"><a href="#spacrFrame.__init__-977"><span class="linenos">977</span></a>            <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">scrollregion</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
</span><span id="spacrFrame.__init__-978"><a href="#spacrFrame.__init__-978"><span class="linenos">978</span></a>        <span class="p">)</span>
</span><span id="spacrFrame.__init__-979"><a href="#spacrFrame.__init__-979"><span class="linenos">979</span></a>        <span class="n">canvas</span><span class="o">.</span><span class="n">create_window</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;nw&quot;</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-980"><a href="#spacrFrame.__init__-980"><span class="linenos">980</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-981"><a href="#spacrFrame.__init__-981"><span class="linenos">981</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="n">scrollbar_widget</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-982"><a href="#spacrFrame.__init__-982"><span class="linenos">982</span></a>        
</span><span id="spacrFrame.__init__-983"><a href="#spacrFrame.__init__-983"><span class="linenos">983</span></a>        <span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-984"><a href="#spacrFrame.__init__-984"><span class="linenos">984</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-985"><a href="#spacrFrame.__init__-985"><span class="linenos">985</span></a>            <span class="n">scrollbar_widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-986"><a href="#spacrFrame.__init__-986"><span class="linenos">986</span></a>
</span><span id="spacrFrame.__init__-987"><a href="#spacrFrame.__init__-987"><span class="linenos">987</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-988"><a href="#spacrFrame.__init__-988"><span class="linenos">988</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-989"><a href="#spacrFrame.__init__-989"><span class="linenos">989</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-990"><a href="#spacrFrame.__init__-990"><span class="linenos">990</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrFrame.__init__-991"><a href="#spacrFrame.__init__-991"><span class="linenos">991</span></a>        
</span><span id="spacrFrame.__init__-992"><a href="#spacrFrame.__init__-992"><span class="linenos">992</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_frame</span><span class="p">])</span>
</span><span id="spacrFrame.__init__-993"><a href="#spacrFrame.__init__-993"><span class="linenos">993</span></a>        <span class="k">if</span> <span class="n">scrollbar</span><span class="p">:</span>
</span><span id="spacrFrame.__init__-994"><a href="#spacrFrame.__init__-994"><span class="linenos">994</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">scrollbar_widget</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Construct a Ttk Frame with parent master.</p>

<p>STANDARD OPTIONS</p>

<pre><code>class, cursor, style, takefocus
</code></pre>

<p>WIDGET-SPECIFIC OPTIONS</p>

<pre><code>borderwidth, relief, padding, width, height
</code></pre>
</div>


                            </div>
                            <div id="spacrFrame.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrFrame.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrFrame.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrFrame.active_color"></a>
    
    

                            </div>
                            <div id="spacrFrame.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrFrame.fg_color"></a>
    
    

                            </div>
                            <div id="spacrFrame.rounded_rectangle" class="classattr">
                                        <input id="spacrFrame.rounded_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rounded_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">canvas</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">radius</span><span class="o">=</span><span class="mi">20</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrFrame.rounded_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrFrame.rounded_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrFrame.rounded_rectangle-996"><a href="#spacrFrame.rounded_rectangle-996"><span class="linenos"> 996</span></a>    <span class="k">def</span> <span class="nf">rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrFrame.rounded_rectangle-997"><a href="#spacrFrame.rounded_rectangle-997"><span class="linenos"> 997</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="spacrFrame.rounded_rectangle-998"><a href="#spacrFrame.rounded_rectangle-998"><span class="linenos"> 998</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-999"><a href="#spacrFrame.rounded_rectangle-999"><span class="linenos"> 999</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1000"><a href="#spacrFrame.rounded_rectangle-1000"><span class="linenos">1000</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1001"><a href="#spacrFrame.rounded_rectangle-1001"><span class="linenos">1001</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1002"><a href="#spacrFrame.rounded_rectangle-1002"><span class="linenos">1002</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1003"><a href="#spacrFrame.rounded_rectangle-1003"><span class="linenos">1003</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1004"><a href="#spacrFrame.rounded_rectangle-1004"><span class="linenos">1004</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1005"><a href="#spacrFrame.rounded_rectangle-1005"><span class="linenos">1005</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1006"><a href="#spacrFrame.rounded_rectangle-1006"><span class="linenos">1006</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1007"><a href="#spacrFrame.rounded_rectangle-1007"><span class="linenos">1007</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1008"><a href="#spacrFrame.rounded_rectangle-1008"><span class="linenos">1008</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1009"><a href="#spacrFrame.rounded_rectangle-1009"><span class="linenos">1009</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1010"><a href="#spacrFrame.rounded_rectangle-1010"><span class="linenos">1010</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1011"><a href="#spacrFrame.rounded_rectangle-1011"><span class="linenos">1011</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1012"><a href="#spacrFrame.rounded_rectangle-1012"><span class="linenos">1012</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1013"><a href="#spacrFrame.rounded_rectangle-1013"><span class="linenos">1013</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrFrame.rounded_rectangle-1014"><a href="#spacrFrame.rounded_rectangle-1014"><span class="linenos">1014</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="spacrFrame.rounded_rectangle-1015"><a href="#spacrFrame.rounded_rectangle-1015"><span class="linenos">1015</span></a>        <span class="p">]</span>
</span><span id="spacrFrame.rounded_rectangle-1016"><a href="#spacrFrame.rounded_rectangle-1016"><span class="linenos">1016</span></a>        <span class="k">return</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrLabel">
                            <input id="spacrLabel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrLabel</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrLabel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrLabel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrLabel-1018"><a href="#spacrLabel-1018"><span class="linenos">1018</span></a><span class="k">class</span> <span class="nc">spacrLabel</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrLabel-1019"><a href="#spacrLabel-1019"><span class="linenos">1019</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrLabel-1020"><a href="#spacrLabel-1020"><span class="linenos">1020</span></a>        <span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;foreground&#39;</span><span class="p">,</span> <span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="s1">&#39;anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;justify&#39;</span><span class="p">,</span> <span class="s1">&#39;wraplength&#39;</span><span class="p">]}</span>
</span><span id="spacrLabel-1021"><a href="#spacrLabel-1021"><span class="linenos">1021</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">valid_kwargs</span><span class="p">)</span>
</span><span id="spacrLabel-1022"><a href="#spacrLabel-1022"><span class="linenos">1022</span></a>        
</span><span id="spacrLabel-1023"><a href="#spacrLabel-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrLabel-1024"><a href="#spacrLabel-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="n">align</span>
</span><span id="spacrLabel-1025"><a href="#spacrLabel-1025"><span class="linenos">1025</span></a>
</span><span id="spacrLabel-1026"><a href="#spacrLabel-1026"><span class="linenos">1026</span></a>        <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrLabel-1027"><a href="#spacrLabel-1027"><span class="linenos">1027</span></a>            <span class="n">screen_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
</span><span id="spacrLabel-1028"><a href="#spacrLabel-1028"><span class="linenos">1028</span></a>            <span class="n">label_height</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">50</span>
</span><span id="spacrLabel-1029"><a href="#spacrLabel-1029"><span class="linenos">1029</span></a>            <span class="n">label_width</span> <span class="o">=</span> <span class="n">label_height</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="spacrLabel-1030"><a href="#spacrLabel-1030"><span class="linenos">1030</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel-1031"><a href="#spacrLabel-1031"><span class="linenos">1031</span></a>            <span class="n">label_height</span> <span class="o">=</span> <span class="n">height</span>
</span><span id="spacrLabel-1032"><a href="#spacrLabel-1032"><span class="linenos">1032</span></a>            <span class="n">label_width</span> <span class="o">=</span> <span class="n">label_height</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="spacrLabel-1033"><a href="#spacrLabel-1033"><span class="linenos">1033</span></a>
</span><span id="spacrLabel-1034"><a href="#spacrLabel-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrLabel-1035"><a href="#spacrLabel-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrLabel-1036"><a href="#spacrLabel-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrLabel-1037"><a href="#spacrLabel-1037"><span class="linenos">1037</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrLabel-1038"><a href="#spacrLabel-1038"><span class="linenos">1038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrLabel-1039"><a href="#spacrLabel-1039"><span class="linenos">1039</span></a>
</span><span id="spacrLabel-1040"><a href="#spacrLabel-1040"><span class="linenos">1040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">label_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">label_height</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrLabel-1041"><a href="#spacrLabel-1041"><span class="linenos">1041</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="spacrLabel-1042"><a href="#spacrLabel-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="spacrLabel-1043"><a href="#spacrLabel-1043"><span class="linenos">1043</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="n">tkFont</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>
</span><span id="spacrLabel-1044"><a href="#spacrLabel-1044"><span class="linenos">1044</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>
</span><span id="spacrLabel-1045"><a href="#spacrLabel-1045"><span class="linenos">1045</span></a>
</span><span id="spacrLabel-1046"><a href="#spacrLabel-1046"><span class="linenos">1046</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
</span><span id="spacrLabel-1047"><a href="#spacrLabel-1047"><span class="linenos">1047</span></a>            <span class="n">anchor_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span>
</span><span id="spacrLabel-1048"><a href="#spacrLabel-1048"><span class="linenos">1048</span></a>            <span class="n">text_anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
</span><span id="spacrLabel-1049"><a href="#spacrLabel-1049"><span class="linenos">1049</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># default to right alignment</span>
</span><span id="spacrLabel-1050"><a href="#spacrLabel-1050"><span class="linenos">1050</span></a>            <span class="n">anchor_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span>
</span><span id="spacrLabel-1051"><a href="#spacrLabel-1051"><span class="linenos">1051</span></a>            <span class="n">text_anchor</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
</span><span id="spacrLabel-1052"><a href="#spacrLabel-1052"><span class="linenos">1052</span></a>
</span><span id="spacrLabel-1053"><a href="#spacrLabel-1053"><span class="linenos">1053</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
</span><span id="spacrLabel-1054"><a href="#spacrLabel-1054"><span class="linenos">1054</span></a>            <span class="n">ttk_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrLabel-1055"><a href="#spacrLabel-1055"><span class="linenos">1055</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrLabel-1056"><a href="#spacrLabel-1056"><span class="linenos">1056</span></a>                <span class="n">ttk_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrLabel-1057"><a href="#spacrLabel-1057"><span class="linenos">1057</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel-1058"><a href="#spacrLabel-1058"><span class="linenos">1058</span></a>                <span class="n">ttk_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrLabel-1059"><a href="#spacrLabel-1059"><span class="linenos">1059</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">text_anchor</span><span class="p">)</span>
</span><span id="spacrLabel-1060"><a href="#spacrLabel-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrLabel-1061"><a href="#spacrLabel-1061"><span class="linenos">1061</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel-1062"><a href="#spacrLabel-1062"><span class="linenos">1062</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrLabel-1063"><a href="#spacrLabel-1063"><span class="linenos">1063</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">label_width</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span> <span class="k">else</span> <span class="n">label_width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> 
</span><span id="spacrLabel-1064"><a href="#spacrLabel-1064"><span class="linenos">1064</span></a>                                                          <span class="n">label_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> 
</span><span id="spacrLabel-1065"><a href="#spacrLabel-1065"><span class="linenos">1065</span></a>                                                          <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor_value</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="spacrLabel-1066"><a href="#spacrLabel-1066"><span class="linenos">1066</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel-1067"><a href="#spacrLabel-1067"><span class="linenos">1067</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">label_width</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span> <span class="k">else</span> <span class="n">label_width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> 
</span><span id="spacrLabel-1068"><a href="#spacrLabel-1068"><span class="linenos">1068</span></a>                                                        <span class="n">label_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> 
</span><span id="spacrLabel-1069"><a href="#spacrLabel-1069"><span class="linenos">1069</span></a>                                                        <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor_value</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="spacrLabel-1070"><a href="#spacrLabel-1070"><span class="linenos">1070</span></a>        
</span><span id="spacrLabel-1071"><a href="#spacrLabel-1071"><span class="linenos">1071</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="spacrLabel-1072"><a href="#spacrLabel-1072"><span class="linenos">1072</span></a>
</span><span id="spacrLabel-1073"><a href="#spacrLabel-1073"><span class="linenos">1073</span></a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="spacrLabel-1074"><a href="#spacrLabel-1074"><span class="linenos">1074</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
</span><span id="spacrLabel-1075"><a href="#spacrLabel-1075"><span class="linenos">1075</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="spacrLabel-1076"><a href="#spacrLabel-1076"><span class="linenos">1076</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel-1077"><a href="#spacrLabel-1077"><span class="linenos">1077</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrLabel.__init__" class="classattr">
                                        <input id="spacrLabel.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrLabel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">parent</span>,</span><span class="param">	<span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">font</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">style</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">align</span><span class="o">=</span><span class="s1">&#39;right&#39;</span>,</span><span class="param">	<span class="n">height</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrLabel.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrLabel.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrLabel.__init__-1019"><a href="#spacrLabel.__init__-1019"><span class="linenos">1019</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrLabel.__init__-1020"><a href="#spacrLabel.__init__-1020"><span class="linenos">1020</span></a>        <span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;foreground&#39;</span><span class="p">,</span> <span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="s1">&#39;anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;justify&#39;</span><span class="p">,</span> <span class="s1">&#39;wraplength&#39;</span><span class="p">]}</span>
</span><span id="spacrLabel.__init__-1021"><a href="#spacrLabel.__init__-1021"><span class="linenos">1021</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">valid_kwargs</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1022"><a href="#spacrLabel.__init__-1022"><span class="linenos">1022</span></a>        
</span><span id="spacrLabel.__init__-1023"><a href="#spacrLabel.__init__-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrLabel.__init__-1024"><a href="#spacrLabel.__init__-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="n">align</span>
</span><span id="spacrLabel.__init__-1025"><a href="#spacrLabel.__init__-1025"><span class="linenos">1025</span></a>
</span><span id="spacrLabel.__init__-1026"><a href="#spacrLabel.__init__-1026"><span class="linenos">1026</span></a>        <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1027"><a href="#spacrLabel.__init__-1027"><span class="linenos">1027</span></a>            <span class="n">screen_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
</span><span id="spacrLabel.__init__-1028"><a href="#spacrLabel.__init__-1028"><span class="linenos">1028</span></a>            <span class="n">label_height</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="mi">50</span>
</span><span id="spacrLabel.__init__-1029"><a href="#spacrLabel.__init__-1029"><span class="linenos">1029</span></a>            <span class="n">label_width</span> <span class="o">=</span> <span class="n">label_height</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="spacrLabel.__init__-1030"><a href="#spacrLabel.__init__-1030"><span class="linenos">1030</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1031"><a href="#spacrLabel.__init__-1031"><span class="linenos">1031</span></a>            <span class="n">label_height</span> <span class="o">=</span> <span class="n">height</span>
</span><span id="spacrLabel.__init__-1032"><a href="#spacrLabel.__init__-1032"><span class="linenos">1032</span></a>            <span class="n">label_width</span> <span class="o">=</span> <span class="n">label_height</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="spacrLabel.__init__-1033"><a href="#spacrLabel.__init__-1033"><span class="linenos">1033</span></a>
</span><span id="spacrLabel.__init__-1034"><a href="#spacrLabel.__init__-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrLabel.__init__-1035"><a href="#spacrLabel.__init__-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrLabel.__init__-1036"><a href="#spacrLabel.__init__-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrLabel.__init__-1037"><a href="#spacrLabel.__init__-1037"><span class="linenos">1037</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span>
</span><span id="spacrLabel.__init__-1038"><a href="#spacrLabel.__init__-1038"><span class="linenos">1038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrLabel.__init__-1039"><a href="#spacrLabel.__init__-1039"><span class="linenos">1039</span></a>
</span><span id="spacrLabel.__init__-1040"><a href="#spacrLabel.__init__-1040"><span class="linenos">1040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">label_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">label_height</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrLabel.__init__-1041"><a href="#spacrLabel.__init__-1041"><span class="linenos">1041</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;ew&quot;</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1042"><a href="#spacrLabel.__init__-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;OpenSans&#39;</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1043"><a href="#spacrLabel.__init__-1043"><span class="linenos">1043</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_family&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="n">tkFont</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1044"><a href="#spacrLabel.__init__-1044"><span class="linenos">1044</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>
</span><span id="spacrLabel.__init__-1045"><a href="#spacrLabel.__init__-1045"><span class="linenos">1045</span></a>
</span><span id="spacrLabel.__init__-1046"><a href="#spacrLabel.__init__-1046"><span class="linenos">1046</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1047"><a href="#spacrLabel.__init__-1047"><span class="linenos">1047</span></a>            <span class="n">anchor_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">CENTER</span>
</span><span id="spacrLabel.__init__-1048"><a href="#spacrLabel.__init__-1048"><span class="linenos">1048</span></a>            <span class="n">text_anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
</span><span id="spacrLabel.__init__-1049"><a href="#spacrLabel.__init__-1049"><span class="linenos">1049</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># default to right alignment</span>
</span><span id="spacrLabel.__init__-1050"><a href="#spacrLabel.__init__-1050"><span class="linenos">1050</span></a>            <span class="n">anchor_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span>
</span><span id="spacrLabel.__init__-1051"><a href="#spacrLabel.__init__-1051"><span class="linenos">1051</span></a>            <span class="n">text_anchor</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
</span><span id="spacrLabel.__init__-1052"><a href="#spacrLabel.__init__-1052"><span class="linenos">1052</span></a>
</span><span id="spacrLabel.__init__-1053"><a href="#spacrLabel.__init__-1053"><span class="linenos">1053</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1054"><a href="#spacrLabel.__init__-1054"><span class="linenos">1054</span></a>            <span class="n">ttk_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrLabel.__init__-1055"><a href="#spacrLabel.__init__-1055"><span class="linenos">1055</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1056"><a href="#spacrLabel.__init__-1056"><span class="linenos">1056</span></a>                <span class="n">ttk_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrLabel.__init__-1057"><a href="#spacrLabel.__init__-1057"><span class="linenos">1057</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1058"><a href="#spacrLabel.__init__-1058"><span class="linenos">1058</span></a>                <span class="n">ttk_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">],</span> <span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrLabel.__init__-1059"><a href="#spacrLabel.__init__-1059"><span class="linenos">1059</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">text_anchor</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1060"><a href="#spacrLabel.__init__-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1061"><a href="#spacrLabel.__init__-1061"><span class="linenos">1061</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1062"><a href="#spacrLabel.__init__-1062"><span class="linenos">1062</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1063"><a href="#spacrLabel.__init__-1063"><span class="linenos">1063</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">label_width</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span> <span class="k">else</span> <span class="n">label_width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> 
</span><span id="spacrLabel.__init__-1064"><a href="#spacrLabel.__init__-1064"><span class="linenos">1064</span></a>                                                          <span class="n">label_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> 
</span><span id="spacrLabel.__init__-1065"><a href="#spacrLabel.__init__-1065"><span class="linenos">1065</span></a>                                                          <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor_value</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1066"><a href="#spacrLabel.__init__-1066"><span class="linenos">1066</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel.__init__-1067"><a href="#spacrLabel.__init__-1067"><span class="linenos">1067</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">label_width</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span> <span class="k">else</span> <span class="n">label_width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> 
</span><span id="spacrLabel.__init__-1068"><a href="#spacrLabel.__init__-1068"><span class="linenos">1068</span></a>                                                        <span class="n">label_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> 
</span><span id="spacrLabel.__init__-1069"><a href="#spacrLabel.__init__-1069"><span class="linenos">1069</span></a>                                                        <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor_value</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="spacrLabel.__init__-1070"><a href="#spacrLabel.__init__-1070"><span class="linenos">1070</span></a>        
</span><span id="spacrLabel.__init__-1071"><a href="#spacrLabel.__init__-1071"><span class="linenos">1071</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrLabel.text" class="classattr">
                                <div class="attr variable">
            <span class="name">text</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.text"></a>
    
    

                            </div>
                            <div id="spacrLabel.align" class="classattr">
                                <div class="attr variable">
            <span class="name">align</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.align"></a>
    
    

                            </div>
                            <div id="spacrLabel.style_out" class="classattr">
                                <div class="attr variable">
            <span class="name">style_out</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.style_out"></a>
    
    

                            </div>
                            <div id="spacrLabel.font_style" class="classattr">
                                <div class="attr variable">
            <span class="name">font_style</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.font_style"></a>
    
    

                            </div>
                            <div id="spacrLabel.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.font_size"></a>
    
    

                            </div>
                            <div id="spacrLabel.font_family" class="classattr">
                                <div class="attr variable">
            <span class="name">font_family</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.font_family"></a>
    
    

                            </div>
                            <div id="spacrLabel.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.font_loader"></a>
    
    

                            </div>
                            <div id="spacrLabel.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.canvas"></a>
    
    

                            </div>
                            <div id="spacrLabel.style" class="classattr">
                                <div class="attr variable">
            <span class="name">style</span>

        
    </div>
    <a class="headerlink" href="#spacrLabel.style"></a>
    
    

                            </div>
                            <div id="spacrLabel.set_text" class="classattr">
                                        <input id="spacrLabel.set_text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_text</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">text</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrLabel.set_text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrLabel.set_text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrLabel.set_text-1073"><a href="#spacrLabel.set_text-1073"><span class="linenos">1073</span></a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="spacrLabel.set_text-1074"><a href="#spacrLabel.set_text-1074"><span class="linenos">1074</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
</span><span id="spacrLabel.set_text-1075"><a href="#spacrLabel.set_text-1075"><span class="linenos">1075</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="spacrLabel.set_text-1076"><a href="#spacrLabel.set_text-1076"><span class="linenos">1076</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrLabel.set_text-1077"><a href="#spacrLabel.set_text-1077"><span class="linenos">1077</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_text</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrButton">
                            <input id="spacrButton-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrButton</span><wbr>(<span class="base">tkinter.Frame</span>):

                <label class="view-source-button" for="spacrButton-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton-1079"><a href="#spacrButton-1079"><span class="linenos">1079</span></a><span class="k">class</span> <span class="nc">spacrButton</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrButton-1080"><a href="#spacrButton-1080"><span class="linenos">1080</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">icon_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">show_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">animation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrButton-1081"><a href="#spacrButton-1081"><span class="linenos">1081</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrButton-1082"><a href="#spacrButton-1082"><span class="linenos">1082</span></a>        
</span><span id="spacrButton-1083"><a href="#spacrButton-1083"><span class="linenos">1083</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>  <span class="c1"># Capitalize only the first letter of the text</span>
</span><span id="spacrButton-1084"><a href="#spacrButton-1084"><span class="linenos">1084</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrButton-1085"><a href="#spacrButton-1085"><span class="linenos">1085</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_name</span> <span class="k">if</span> <span class="n">icon_name</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="spacrButton-1086"><a href="#spacrButton-1086"><span class="linenos">1086</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</span><span id="spacrButton-1087"><a href="#spacrButton-1087"><span class="linenos">1087</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span> <span class="o">=</span> <span class="n">show_text</span>
</span><span id="spacrButton-1088"><a href="#spacrButton-1088"><span class="linenos">1088</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>
</span><span id="spacrButton-1089"><a href="#spacrButton-1089"><span class="linenos">1089</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">animation</span>  <span class="c1"># Add animation attribute</span>
</span><span id="spacrButton-1090"><a href="#spacrButton-1090"><span class="linenos">1090</span></a>
</span><span id="spacrButton-1091"><a href="#spacrButton-1091"><span class="linenos">1091</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrButton-1092"><a href="#spacrButton-1092"><span class="linenos">1092</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrButton-1093"><a href="#spacrButton-1093"><span class="linenos">1093</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrButton-1094"><a href="#spacrButton-1094"><span class="linenos">1094</span></a>
</span><span id="spacrButton-1095"><a href="#spacrButton-1095"><span class="linenos">1095</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
</span><span id="spacrButton-1096"><a href="#spacrButton-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="spacrButton-1097"><a href="#spacrButton-1097"><span class="linenos">1097</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton-1098"><a href="#spacrButton-1098"><span class="linenos">1098</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># Make the button width equal to the size if show_text is False</span>
</span><span id="spacrButton-1099"><a href="#spacrButton-1099"><span class="linenos">1099</span></a>
</span><span id="spacrButton-1100"><a href="#spacrButton-1100"><span class="linenos">1100</span></a>        <span class="c1"># Create the canvas first</span>
</span><span id="spacrButton-1101"><a href="#spacrButton-1101"><span class="linenos">1101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrButton-1102"><a href="#spacrButton-1102"><span class="linenos">1102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrButton-1103"><a href="#spacrButton-1103"><span class="linenos">1103</span></a>
</span><span id="spacrButton-1104"><a href="#spacrButton-1104"><span class="linenos">1104</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="spacrButton-1105"><a href="#spacrButton-1105"><span class="linenos">1105</span></a>        <span class="n">color_settings</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="spacrButton-1106"><a href="#spacrButton-1106"><span class="linenos">1106</span></a>
</span><span id="spacrButton-1107"><a href="#spacrButton-1107"><span class="linenos">1107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrButton-1108"><a href="#spacrButton-1108"><span class="linenos">1108</span></a>
</span><span id="spacrButton-1109"><a href="#spacrButton-1109"><span class="linenos">1109</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="p">:</span>
</span><span id="spacrButton-1110"><a href="#spacrButton-1110"><span class="linenos">1110</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrButton-1111"><a href="#spacrButton-1111"><span class="linenos">1111</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton-1112"><a href="#spacrButton-1112"><span class="linenos">1112</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrButton-1113"><a href="#spacrButton-1113"><span class="linenos">1113</span></a>        
</span><span id="spacrButton-1114"><a href="#spacrButton-1114"><span class="linenos">1114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_icon</span><span class="p">()</span>
</span><span id="spacrButton-1115"><a href="#spacrButton-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrButton-1116"><a href="#spacrButton-1116"><span class="linenos">1116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrButton-1117"><a href="#spacrButton-1117"><span class="linenos">1117</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton-1118"><a href="#spacrButton-1118"><span class="linenos">1118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="spacrButton-1119"><a href="#spacrButton-1119"><span class="linenos">1119</span></a>        
</span><span id="spacrButton-1120"><a href="#spacrButton-1120"><span class="linenos">1120</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
</span><span id="spacrButton-1121"><a href="#spacrButton-1121"><span class="linenos">1121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>  <span class="c1"># Align text to the left of the specified point</span>
</span><span id="spacrButton-1122"><a href="#spacrButton-1122"><span class="linenos">1122</span></a>
</span><span id="spacrButton-1123"><a href="#spacrButton-1123"><span class="linenos">1123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrButton-1124"><a href="#spacrButton-1124"><span class="linenos">1124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrButton-1125"><a href="#spacrButton-1125"><span class="linenos">1125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrButton-1126"><a href="#spacrButton-1126"><span class="linenos">1126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrButton-1127"><a href="#spacrButton-1127"><span class="linenos">1127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrButton-1128"><a href="#spacrButton-1128"><span class="linenos">1128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrButton-1129"><a href="#spacrButton-1129"><span class="linenos">1129</span></a>
</span><span id="spacrButton-1130"><a href="#spacrButton-1130"><span class="linenos">1130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span>
</span><span id="spacrButton-1131"><a href="#spacrButton-1131"><span class="linenos">1131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrButton-1132"><a href="#spacrButton-1132"><span class="linenos">1132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrButton-1133"><a href="#spacrButton-1133"><span class="linenos">1133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Track zoom state for smooth transitions</span>
</span><span id="spacrButton-1134"><a href="#spacrButton-1134"><span class="linenos">1134</span></a>
</span><span id="spacrButton-1135"><a href="#spacrButton-1135"><span class="linenos">1135</span></a>    <span class="k">def</span> <span class="nf">load_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrButton-1136"><a href="#spacrButton-1136"><span class="linenos">1136</span></a>        <span class="n">icon_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_name</span><span class="p">)</span>
</span><span id="spacrButton-1137"><a href="#spacrButton-1137"><span class="linenos">1137</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="spacrButton-1138"><a href="#spacrButton-1138"><span class="linenos">1138</span></a>            <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
</span><span id="spacrButton-1139"><a href="#spacrButton-1139"><span class="linenos">1139</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">UnidentifiedImageError</span><span class="p">):</span>
</span><span id="spacrButton-1140"><a href="#spacrButton-1140"><span class="linenos">1140</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="spacrButton-1141"><a href="#spacrButton-1141"><span class="linenos">1141</span></a>                <span class="n">icon_path</span> <span class="o">=</span> <span class="n">icon_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="spacrButton-1142"><a href="#spacrButton-1142"><span class="linenos">1142</span></a>                <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
</span><span id="spacrButton-1143"><a href="#spacrButton-1143"><span class="linenos">1143</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">UnidentifiedImageError</span><span class="p">):</span>
</span><span id="spacrButton-1144"><a href="#spacrButton-1144"><span class="linenos">1144</span></a>                <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
</span><span id="spacrButton-1145"><a href="#spacrButton-1145"><span class="linenos">1145</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Icon not found: </span><span class="si">{</span><span class="n">icon_path</span><span class="si">}</span><span class="s1">. Using default icon instead.&#39;</span><span class="p">)</span>
</span><span id="spacrButton-1146"><a href="#spacrButton-1146"><span class="linenos">1146</span></a>
</span><span id="spacrButton-1147"><a href="#spacrButton-1147"><span class="linenos">1147</span></a>        <span class="n">initial_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.65</span><span class="p">)</span>  <span class="c1"># 65% of button size initially</span>
</span><span id="spacrButton-1148"><a href="#spacrButton-1148"><span class="linenos">1148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span> <span class="o">=</span> <span class="n">icon_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">initial_size</span><span class="p">,</span> <span class="n">initial_size</span><span class="p">),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
</span><span id="spacrButton-1149"><a href="#spacrButton-1149"><span class="linenos">1149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span><span class="p">)</span>
</span><span id="spacrButton-1150"><a href="#spacrButton-1150"><span class="linenos">1150</span></a>
</span><span id="spacrButton-1151"><a href="#spacrButton-1151"><span class="linenos">1151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span><span class="p">)</span>
</span><span id="spacrButton-1152"><a href="#spacrButton-1152"><span class="linenos">1152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span>  <span class="c1"># Keep a reference to avoid garbage collection</span>
</span><span id="spacrButton-1153"><a href="#spacrButton-1153"><span class="linenos">1153</span></a>
</span><span id="spacrButton-1154"><a href="#spacrButton-1154"><span class="linenos">1154</span></a>    <span class="k">def</span> <span class="nf">get_icon_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon_name</span><span class="p">):</span>
</span><span id="spacrButton-1155"><a href="#spacrButton-1155"><span class="linenos">1155</span></a>        <span class="n">icon_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="s1">&#39;icons&#39;</span><span class="p">)</span>
</span><span id="spacrButton-1156"><a href="#spacrButton-1156"><span class="linenos">1156</span></a>        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">icon_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">icon_name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
</span><span id="spacrButton-1157"><a href="#spacrButton-1157"><span class="linenos">1157</span></a>
</span><span id="spacrButton-1158"><a href="#spacrButton-1158"><span class="linenos">1158</span></a>    <span class="k">def</span> <span class="nf">on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrButton-1159"><a href="#spacrButton-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrButton-1160"><a href="#spacrButton-1160"><span class="linenos">1160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_description</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="spacrButton-1161"><a href="#spacrButton-1161"><span class="linenos">1161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span><span class="p">:</span>
</span><span id="spacrButton-1162"><a href="#spacrButton-1162"><span class="linenos">1162</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">animate_zoom</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>  <span class="c1"># Zoom in the icon to 85% of button size</span>
</span><span id="spacrButton-1163"><a href="#spacrButton-1163"><span class="linenos">1163</span></a>
</span><span id="spacrButton-1164"><a href="#spacrButton-1164"><span class="linenos">1164</span></a>    <span class="k">def</span> <span class="nf">on_leave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrButton-1165"><a href="#spacrButton-1165"><span class="linenos">1165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrButton-1166"><a href="#spacrButton-1166"><span class="linenos">1166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_description</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="spacrButton-1167"><a href="#spacrButton-1167"><span class="linenos">1167</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span><span class="p">:</span>
</span><span id="spacrButton-1168"><a href="#spacrButton-1168"><span class="linenos">1168</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">animate_zoom</span><span class="p">(</span><span class="mf">0.65</span><span class="p">)</span>  <span class="c1"># Reset the icon size to 65% of button size</span>
</span><span id="spacrButton-1169"><a href="#spacrButton-1169"><span class="linenos">1169</span></a>
</span><span id="spacrButton-1170"><a href="#spacrButton-1170"><span class="linenos">1170</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrButton-1171"><a href="#spacrButton-1171"><span class="linenos">1171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrButton-1172"><a href="#spacrButton-1172"><span class="linenos">1172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span><span id="spacrButton-1173"><a href="#spacrButton-1173"><span class="linenos">1173</span></a>
</span><span id="spacrButton-1174"><a href="#spacrButton-1174"><span class="linenos">1174</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrButton-1175"><a href="#spacrButton-1175"><span class="linenos">1175</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="spacrButton-1176"><a href="#spacrButton-1176"><span class="linenos">1176</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton-1177"><a href="#spacrButton-1177"><span class="linenos">1177</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton-1178"><a href="#spacrButton-1178"><span class="linenos">1178</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton-1179"><a href="#spacrButton-1179"><span class="linenos">1179</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton-1180"><a href="#spacrButton-1180"><span class="linenos">1180</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1181"><a href="#spacrButton-1181"><span class="linenos">1181</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1182"><a href="#spacrButton-1182"><span class="linenos">1182</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1183"><a href="#spacrButton-1183"><span class="linenos">1183</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton-1184"><a href="#spacrButton-1184"><span class="linenos">1184</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton-1185"><a href="#spacrButton-1185"><span class="linenos">1185</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton-1186"><a href="#spacrButton-1186"><span class="linenos">1186</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton-1187"><a href="#spacrButton-1187"><span class="linenos">1187</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton-1188"><a href="#spacrButton-1188"><span class="linenos">1188</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1189"><a href="#spacrButton-1189"><span class="linenos">1189</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1190"><a href="#spacrButton-1190"><span class="linenos">1190</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1191"><a href="#spacrButton-1191"><span class="linenos">1191</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton-1192"><a href="#spacrButton-1192"><span class="linenos">1192</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="spacrButton-1193"><a href="#spacrButton-1193"><span class="linenos">1193</span></a>        <span class="p">]</span>
</span><span id="spacrButton-1194"><a href="#spacrButton-1194"><span class="linenos">1194</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrButton-1195"><a href="#spacrButton-1195"><span class="linenos">1195</span></a>    
</span><span id="spacrButton-1196"><a href="#spacrButton-1196"><span class="linenos">1196</span></a>    <span class="k">def</span> <span class="nf">update_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrButton-1197"><a href="#spacrButton-1197"><span class="linenos">1197</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
</span><span id="spacrButton-1198"><a href="#spacrButton-1198"><span class="linenos">1198</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="spacrButton-1199"><a href="#spacrButton-1199"><span class="linenos">1199</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;show_description&#39;</span><span class="p">):</span>
</span><span id="spacrButton-1200"><a href="#spacrButton-1200"><span class="linenos">1200</span></a>                <span class="n">parent</span><span class="o">.</span><span class="n">show_description</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">main_buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">additional_buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;No description available.&quot;</span><span class="p">)))</span>
</span><span id="spacrButton-1201"><a href="#spacrButton-1201"><span class="linenos">1201</span></a>                <span class="k">return</span>
</span><span id="spacrButton-1202"><a href="#spacrButton-1202"><span class="linenos">1202</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">master</span>
</span><span id="spacrButton-1203"><a href="#spacrButton-1203"><span class="linenos">1203</span></a>
</span><span id="spacrButton-1204"><a href="#spacrButton-1204"><span class="linenos">1204</span></a>    <span class="k">def</span> <span class="nf">clear_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrButton-1205"><a href="#spacrButton-1205"><span class="linenos">1205</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
</span><span id="spacrButton-1206"><a href="#spacrButton-1206"><span class="linenos">1206</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="spacrButton-1207"><a href="#spacrButton-1207"><span class="linenos">1207</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;clear_description&#39;</span><span class="p">):</span>
</span><span id="spacrButton-1208"><a href="#spacrButton-1208"><span class="linenos">1208</span></a>                <span class="n">parent</span><span class="o">.</span><span class="n">clear_description</span><span class="p">()</span>
</span><span id="spacrButton-1209"><a href="#spacrButton-1209"><span class="linenos">1209</span></a>                <span class="k">return</span>
</span><span id="spacrButton-1210"><a href="#spacrButton-1210"><span class="linenos">1210</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">master</span>
</span><span id="spacrButton-1211"><a href="#spacrButton-1211"><span class="linenos">1211</span></a>
</span><span id="spacrButton-1212"><a href="#spacrButton-1212"><span class="linenos">1212</span></a>    <span class="k">def</span> <span class="nf">animate_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_scale</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="spacrButton-1213"><a href="#spacrButton-1213"><span class="linenos">1213</span></a>        <span class="n">current_scale</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="k">else</span> <span class="mf">0.65</span>
</span><span id="spacrButton-1214"><a href="#spacrButton-1214"><span class="linenos">1214</span></a>        <span class="n">step_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">target_scale</span> <span class="o">-</span> <span class="n">current_scale</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps</span>
</span><span id="spacrButton-1215"><a href="#spacrButton-1215"><span class="linenos">1215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_animate_step</span><span class="p">(</span><span class="n">current_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
</span><span id="spacrButton-1216"><a href="#spacrButton-1216"><span class="linenos">1216</span></a>
</span><span id="spacrButton-1217"><a href="#spacrButton-1217"><span class="linenos">1217</span></a>    <span class="k">def</span> <span class="nf">_animate_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
</span><span id="spacrButton-1218"><a href="#spacrButton-1218"><span class="linenos">1218</span></a>        <span class="k">if</span> <span class="n">steps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="spacrButton-1219"><a href="#spacrButton-1219"><span class="linenos">1219</span></a>            <span class="n">new_scale</span> <span class="o">=</span> <span class="n">current_scale</span> <span class="o">+</span> <span class="n">step_scale</span>
</span><span id="spacrButton-1220"><a href="#spacrButton-1220"><span class="linenos">1220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_icon</span><span class="p">(</span><span class="n">new_scale</span><span class="p">)</span>
</span><span id="spacrButton-1221"><a href="#spacrButton-1221"><span class="linenos">1221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_animate_step</span><span class="p">,</span> <span class="n">new_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
</span><span id="spacrButton-1222"><a href="#spacrButton-1222"><span class="linenos">1222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton-1223"><a href="#spacrButton-1223"><span class="linenos">1223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span>
</span><span id="spacrButton-1224"><a href="#spacrButton-1224"><span class="linenos">1224</span></a>
</span><span id="spacrButton-1225"><a href="#spacrButton-1225"><span class="linenos">1225</span></a>    <span class="k">def</span> <span class="nf">zoom_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
</span><span id="spacrButton-1226"><a href="#spacrButton-1226"><span class="linenos">1226</span></a>        <span class="c1"># Resize the original icon image</span>
</span><span id="spacrButton-1227"><a href="#spacrButton-1227"><span class="linenos">1227</span></a>        <span class="n">new_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">scale_factor</span><span class="p">)</span>
</span><span id="spacrButton-1228"><a href="#spacrButton-1228"><span class="linenos">1228</span></a>        <span class="n">resized_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">new_size</span><span class="p">,</span> <span class="n">new_size</span><span class="p">),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
</span><span id="spacrButton-1229"><a href="#spacrButton-1229"><span class="linenos">1229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">resized_icon</span><span class="p">)</span>
</span><span id="spacrButton-1230"><a href="#spacrButton-1230"><span class="linenos">1230</span></a>
</span><span id="spacrButton-1231"><a href="#spacrButton-1231"><span class="linenos">1231</span></a>        <span class="c1"># Update the icon on the canvas</span>
</span><span id="spacrButton-1232"><a href="#spacrButton-1232"><span class="linenos">1232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_icon</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span><span class="p">)</span>
</span><span id="spacrButton-1233"><a href="#spacrButton-1233"><span class="linenos">1233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span>
</span></pre></div>


            <div class="docstring"><p>Frame widget which may contain other widgets and can have a 3D border.</p>
</div>


                            <div id="spacrButton.__init__" class="classattr">
                                        <input id="spacrButton.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrButton</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">parent</span>,</span><span class="param">	<span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">command</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">font</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">icon_name</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">size</span><span class="o">=</span><span class="mi">50</span>,</span><span class="param">	<span class="n">show_text</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">outline</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">animation</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrButton.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.__init__-1080"><a href="#spacrButton.__init__-1080"><span class="linenos">1080</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">icon_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">show_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">animation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrButton.__init__-1081"><a href="#spacrButton.__init__-1081"><span class="linenos">1081</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1082"><a href="#spacrButton.__init__-1082"><span class="linenos">1082</span></a>        
</span><span id="spacrButton.__init__-1083"><a href="#spacrButton.__init__-1083"><span class="linenos">1083</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>  <span class="c1"># Capitalize only the first letter of the text</span>
</span><span id="spacrButton.__init__-1084"><a href="#spacrButton.__init__-1084"><span class="linenos">1084</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrButton.__init__-1085"><a href="#spacrButton.__init__-1085"><span class="linenos">1085</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_name</span> <span class="o">=</span> <span class="n">icon_name</span> <span class="k">if</span> <span class="n">icon_name</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="spacrButton.__init__-1086"><a href="#spacrButton.__init__-1086"><span class="linenos">1086</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</span><span id="spacrButton.__init__-1087"><a href="#spacrButton.__init__-1087"><span class="linenos">1087</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span> <span class="o">=</span> <span class="n">show_text</span>
</span><span id="spacrButton.__init__-1088"><a href="#spacrButton.__init__-1088"><span class="linenos">1088</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>
</span><span id="spacrButton.__init__-1089"><a href="#spacrButton.__init__-1089"><span class="linenos">1089</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">animation</span>  <span class="c1"># Add animation attribute</span>
</span><span id="spacrButton.__init__-1090"><a href="#spacrButton.__init__-1090"><span class="linenos">1090</span></a>
</span><span id="spacrButton.__init__-1091"><a href="#spacrButton.__init__-1091"><span class="linenos">1091</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="spacrButton.__init__-1092"><a href="#spacrButton.__init__-1092"><span class="linenos">1092</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="spacrButton.__init__-1093"><a href="#spacrButton.__init__-1093"><span class="linenos">1093</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="spacrButton.__init__-1094"><a href="#spacrButton.__init__-1094"><span class="linenos">1094</span></a>
</span><span id="spacrButton.__init__-1095"><a href="#spacrButton.__init__-1095"><span class="linenos">1095</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1096"><a href="#spacrButton.__init__-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1097"><a href="#spacrButton.__init__-1097"><span class="linenos">1097</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1098"><a href="#spacrButton.__init__-1098"><span class="linenos">1098</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># Make the button width equal to the size if show_text is False</span>
</span><span id="spacrButton.__init__-1099"><a href="#spacrButton.__init__-1099"><span class="linenos">1099</span></a>
</span><span id="spacrButton.__init__-1100"><a href="#spacrButton.__init__-1100"><span class="linenos">1100</span></a>        <span class="c1"># Create the canvas first</span>
</span><span id="spacrButton.__init__-1101"><a href="#spacrButton.__init__-1101"><span class="linenos">1101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="spacrButton.__init__-1102"><a href="#spacrButton.__init__-1102"><span class="linenos">1102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1103"><a href="#spacrButton.__init__-1103"><span class="linenos">1103</span></a>
</span><span id="spacrButton.__init__-1104"><a href="#spacrButton.__init__-1104"><span class="linenos">1104</span></a>        <span class="c1"># Apply dark style and get color settings</span>
</span><span id="spacrButton.__init__-1105"><a href="#spacrButton.__init__-1105"><span class="linenos">1105</span></a>        <span class="n">color_settings</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(),</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
</span><span id="spacrButton.__init__-1106"><a href="#spacrButton.__init__-1106"><span class="linenos">1106</span></a>
</span><span id="spacrButton.__init__-1107"><a href="#spacrButton.__init__-1107"><span class="linenos">1107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="spacrButton.__init__-1108"><a href="#spacrButton.__init__-1108"><span class="linenos">1108</span></a>
</span><span id="spacrButton.__init__-1109"><a href="#spacrButton.__init__-1109"><span class="linenos">1109</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1110"><a href="#spacrButton.__init__-1110"><span class="linenos">1110</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">])</span>
</span><span id="spacrButton.__init__-1111"><a href="#spacrButton.__init__-1111"><span class="linenos">1111</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1112"><a href="#spacrButton.__init__-1112"><span class="linenos">1112</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1113"><a href="#spacrButton.__init__-1113"><span class="linenos">1113</span></a>        
</span><span id="spacrButton.__init__-1114"><a href="#spacrButton.__init__-1114"><span class="linenos">1114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_icon</span><span class="p">()</span>
</span><span id="spacrButton.__init__-1115"><a href="#spacrButton.__init__-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1116"><a href="#spacrButton.__init__-1116"><span class="linenos">1116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1117"><a href="#spacrButton.__init__-1117"><span class="linenos">1117</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1118"><a href="#spacrButton.__init__-1118"><span class="linenos">1118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="n">font</span> <span class="k">if</span> <span class="n">font</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1119"><a href="#spacrButton.__init__-1119"><span class="linenos">1119</span></a>        
</span><span id="spacrButton.__init__-1120"><a href="#spacrButton.__init__-1120"><span class="linenos">1120</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
</span><span id="spacrButton.__init__-1121"><a href="#spacrButton.__init__-1121"><span class="linenos">1121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">button_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">],</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>  <span class="c1"># Align text to the left of the specified point</span>
</span><span id="spacrButton.__init__-1122"><a href="#spacrButton.__init__-1122"><span class="linenos">1122</span></a>
</span><span id="spacrButton.__init__-1123"><a href="#spacrButton.__init__-1123"><span class="linenos">1123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1124"><a href="#spacrButton.__init__-1124"><span class="linenos">1124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1125"><a href="#spacrButton.__init__-1125"><span class="linenos">1125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1126"><a href="#spacrButton.__init__-1126"><span class="linenos">1126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_enter</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1127"><a href="#spacrButton.__init__-1127"><span class="linenos">1127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_leave</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1128"><a href="#spacrButton.__init__-1128"><span class="linenos">1128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
</span><span id="spacrButton.__init__-1129"><a href="#spacrButton.__init__-1129"><span class="linenos">1129</span></a>
</span><span id="spacrButton.__init__-1130"><a href="#spacrButton.__init__-1130"><span class="linenos">1130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span>
</span><span id="spacrButton.__init__-1131"><a href="#spacrButton.__init__-1131"><span class="linenos">1131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="spacrButton.__init__-1132"><a href="#spacrButton.__init__-1132"><span class="linenos">1132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">color_settings</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="spacrButton.__init__-1133"><a href="#spacrButton.__init__-1133"><span class="linenos">1133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Track zoom state for smooth transitions</span>
</span></pre></div>


            <div class="docstring"><p>Construct a frame widget with the parent MASTER.</p>

<p>Valid resource names: background, bd, bg, borderwidth, class,
colormap, container, cursor, height, highlightbackground,
highlightcolor, highlightthickness, relief, takefocus, visual, width.</p>
</div>


                            </div>
                            <div id="spacrButton.text" class="classattr">
                                <div class="attr variable">
            <span class="name">text</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.text"></a>
    
    

                            </div>
                            <div id="spacrButton.command" class="classattr">
                                <div class="attr variable">
            <span class="name">command</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.command"></a>
    
    

                            </div>
                            <div id="spacrButton.icon_name" class="classattr">
                                <div class="attr variable">
            <span class="name">icon_name</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.icon_name"></a>
    
    

                            </div>
                            <div id="spacrButton.size" class="classattr">
                                        <input id="spacrButton.size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">size</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.size-1818"><a href="#spacrButton.size-1818"><span class="linenos">1818</span></a>    <span class="k">def</span> <span class="nf">grid_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrButton.size-1819"><a href="#spacrButton.size-1819"><span class="linenos">1819</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tuple of the number of column and rows in the grid.&quot;&quot;&quot;</span>
</span><span id="spacrButton.size-1820"><a href="#spacrButton.size-1820"><span class="linenos">1820</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getints</span><span class="p">(</span>
</span><span id="spacrButton.size-1821"><a href="#spacrButton.size-1821"><span class="linenos">1821</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Return a tuple of the number of column and rows in the grid.</p>
</div>


                            </div>
                            <div id="spacrButton.show_text" class="classattr">
                                <div class="attr variable">
            <span class="name">show_text</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.show_text"></a>
    
    

                            </div>
                            <div id="spacrButton.outline" class="classattr">
                                <div class="attr variable">
            <span class="name">outline</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.outline"></a>
    
    

                            </div>
                            <div id="spacrButton.animation" class="classattr">
                                <div class="attr variable">
            <span class="name">animation</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.animation"></a>
    
    

                            </div>
                            <div id="spacrButton.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.font_size"></a>
    
    

                            </div>
                            <div id="spacrButton.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.font_loader"></a>
    
    

                            </div>
                            <div id="spacrButton.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.canvas"></a>
    
    

                            </div>
                            <div id="spacrButton.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.inactive_color"></a>
    
    

                            </div>
                            <div id="spacrButton.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.bg_color"></a>
    
    

                            </div>
                            <div id="spacrButton.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.active_color"></a>
    
    

                            </div>
                            <div id="spacrButton.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.fg_color"></a>
    
    

                            </div>
                            <div id="spacrButton.is_zoomed_in" class="classattr">
                                <div class="attr variable">
            <span class="name">is_zoomed_in</span>

        
    </div>
    <a class="headerlink" href="#spacrButton.is_zoomed_in"></a>
    
    

                            </div>
                            <div id="spacrButton.load_icon" class="classattr">
                                        <input id="spacrButton.load_icon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_icon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.load_icon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.load_icon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.load_icon-1135"><a href="#spacrButton.load_icon-1135"><span class="linenos">1135</span></a>    <span class="k">def</span> <span class="nf">load_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrButton.load_icon-1136"><a href="#spacrButton.load_icon-1136"><span class="linenos">1136</span></a>        <span class="n">icon_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_name</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1137"><a href="#spacrButton.load_icon-1137"><span class="linenos">1137</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="spacrButton.load_icon-1138"><a href="#spacrButton.load_icon-1138"><span class="linenos">1138</span></a>            <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1139"><a href="#spacrButton.load_icon-1139"><span class="linenos">1139</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">UnidentifiedImageError</span><span class="p">):</span>
</span><span id="spacrButton.load_icon-1140"><a href="#spacrButton.load_icon-1140"><span class="linenos">1140</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="spacrButton.load_icon-1141"><a href="#spacrButton.load_icon-1141"><span class="linenos">1141</span></a>                <span class="n">icon_path</span> <span class="o">=</span> <span class="n">icon_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1142"><a href="#spacrButton.load_icon-1142"><span class="linenos">1142</span></a>                <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1143"><a href="#spacrButton.load_icon-1143"><span class="linenos">1143</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">UnidentifiedImageError</span><span class="p">):</span>
</span><span id="spacrButton.load_icon-1144"><a href="#spacrButton.load_icon-1144"><span class="linenos">1144</span></a>                <span class="n">icon_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
</span><span id="spacrButton.load_icon-1145"><a href="#spacrButton.load_icon-1145"><span class="linenos">1145</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Icon not found: </span><span class="si">{</span><span class="n">icon_path</span><span class="si">}</span><span class="s1">. Using default icon instead.&#39;</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1146"><a href="#spacrButton.load_icon-1146"><span class="linenos">1146</span></a>
</span><span id="spacrButton.load_icon-1147"><a href="#spacrButton.load_icon-1147"><span class="linenos">1147</span></a>        <span class="n">initial_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.65</span><span class="p">)</span>  <span class="c1"># 65% of button size initially</span>
</span><span id="spacrButton.load_icon-1148"><a href="#spacrButton.load_icon-1148"><span class="linenos">1148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span> <span class="o">=</span> <span class="n">icon_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">initial_size</span><span class="p">,</span> <span class="n">initial_size</span><span class="p">),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1149"><a href="#spacrButton.load_icon-1149"><span class="linenos">1149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1150"><a href="#spacrButton.load_icon-1150"><span class="linenos">1150</span></a>
</span><span id="spacrButton.load_icon-1151"><a href="#spacrButton.load_icon-1151"><span class="linenos">1151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span><span class="p">)</span>
</span><span id="spacrButton.load_icon-1152"><a href="#spacrButton.load_icon-1152"><span class="linenos">1152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span>  <span class="c1"># Keep a reference to avoid garbage collection</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.get_icon_path" class="classattr">
                                        <input id="spacrButton.get_icon_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_icon_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">icon_name</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.get_icon_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.get_icon_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.get_icon_path-1154"><a href="#spacrButton.get_icon_path-1154"><span class="linenos">1154</span></a>    <span class="k">def</span> <span class="nf">get_icon_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon_name</span><span class="p">):</span>
</span><span id="spacrButton.get_icon_path-1155"><a href="#spacrButton.get_icon_path-1155"><span class="linenos">1155</span></a>        <span class="n">icon_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="s1">&#39;icons&#39;</span><span class="p">)</span>
</span><span id="spacrButton.get_icon_path-1156"><a href="#spacrButton.get_icon_path-1156"><span class="linenos">1156</span></a>        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">icon_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">icon_name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.on_enter" class="classattr">
                                        <input id="spacrButton.on_enter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_enter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.on_enter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.on_enter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.on_enter-1158"><a href="#spacrButton.on_enter-1158"><span class="linenos">1158</span></a>    <span class="k">def</span> <span class="nf">on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrButton.on_enter-1159"><a href="#spacrButton.on_enter-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="spacrButton.on_enter-1160"><a href="#spacrButton.on_enter-1160"><span class="linenos">1160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_description</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="spacrButton.on_enter-1161"><a href="#spacrButton.on_enter-1161"><span class="linenos">1161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span><span class="p">:</span>
</span><span id="spacrButton.on_enter-1162"><a href="#spacrButton.on_enter-1162"><span class="linenos">1162</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">animate_zoom</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>  <span class="c1"># Zoom in the icon to 85% of button size</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.on_leave" class="classattr">
                                        <input id="spacrButton.on_leave-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_leave</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.on_leave-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.on_leave"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.on_leave-1164"><a href="#spacrButton.on_leave-1164"><span class="linenos">1164</span></a>    <span class="k">def</span> <span class="nf">on_leave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrButton.on_leave-1165"><a href="#spacrButton.on_leave-1165"><span class="linenos">1165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bg</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span><span class="p">)</span>
</span><span id="spacrButton.on_leave-1166"><a href="#spacrButton.on_leave-1166"><span class="linenos">1166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_description</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="spacrButton.on_leave-1167"><a href="#spacrButton.on_leave-1167"><span class="linenos">1167</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span><span class="p">:</span>
</span><span id="spacrButton.on_leave-1168"><a href="#spacrButton.on_leave-1168"><span class="linenos">1168</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">animate_zoom</span><span class="p">(</span><span class="mf">0.65</span><span class="p">)</span>  <span class="c1"># Reset the icon size to 65% of button size</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.on_click" class="classattr">
                                        <input id="spacrButton.on_click-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_click</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.on_click-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.on_click"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.on_click-1170"><a href="#spacrButton.on_click-1170"><span class="linenos">1170</span></a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrButton.on_click-1171"><a href="#spacrButton.on_click-1171"><span class="linenos">1171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrButton.on_click-1172"><a href="#spacrButton.on_click-1172"><span class="linenos">1172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.create_rounded_rectangle" class="classattr">
                                        <input id="spacrButton.create_rounded_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_rounded_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">radius</span><span class="o">=</span><span class="mi">20</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.create_rounded_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.create_rounded_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.create_rounded_rectangle-1174"><a href="#spacrButton.create_rounded_rectangle-1174"><span class="linenos">1174</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrButton.create_rounded_rectangle-1175"><a href="#spacrButton.create_rounded_rectangle-1175"><span class="linenos">1175</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="spacrButton.create_rounded_rectangle-1176"><a href="#spacrButton.create_rounded_rectangle-1176"><span class="linenos">1176</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1177"><a href="#spacrButton.create_rounded_rectangle-1177"><span class="linenos">1177</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1178"><a href="#spacrButton.create_rounded_rectangle-1178"><span class="linenos">1178</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1179"><a href="#spacrButton.create_rounded_rectangle-1179"><span class="linenos">1179</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1180"><a href="#spacrButton.create_rounded_rectangle-1180"><span class="linenos">1180</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1181"><a href="#spacrButton.create_rounded_rectangle-1181"><span class="linenos">1181</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1182"><a href="#spacrButton.create_rounded_rectangle-1182"><span class="linenos">1182</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1183"><a href="#spacrButton.create_rounded_rectangle-1183"><span class="linenos">1183</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1184"><a href="#spacrButton.create_rounded_rectangle-1184"><span class="linenos">1184</span></a>            <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1185"><a href="#spacrButton.create_rounded_rectangle-1185"><span class="linenos">1185</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1186"><a href="#spacrButton.create_rounded_rectangle-1186"><span class="linenos">1186</span></a>            <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1187"><a href="#spacrButton.create_rounded_rectangle-1187"><span class="linenos">1187</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1188"><a href="#spacrButton.create_rounded_rectangle-1188"><span class="linenos">1188</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1189"><a href="#spacrButton.create_rounded_rectangle-1189"><span class="linenos">1189</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1190"><a href="#spacrButton.create_rounded_rectangle-1190"><span class="linenos">1190</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1191"><a href="#spacrButton.create_rounded_rectangle-1191"><span class="linenos">1191</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrButton.create_rounded_rectangle-1192"><a href="#spacrButton.create_rounded_rectangle-1192"><span class="linenos">1192</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>
</span><span id="spacrButton.create_rounded_rectangle-1193"><a href="#spacrButton.create_rounded_rectangle-1193"><span class="linenos">1193</span></a>        <span class="p">]</span>
</span><span id="spacrButton.create_rounded_rectangle-1194"><a href="#spacrButton.create_rounded_rectangle-1194"><span class="linenos">1194</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.update_description" class="classattr">
                                        <input id="spacrButton.update_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_description</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.update_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.update_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.update_description-1196"><a href="#spacrButton.update_description-1196"><span class="linenos">1196</span></a>    <span class="k">def</span> <span class="nf">update_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrButton.update_description-1197"><a href="#spacrButton.update_description-1197"><span class="linenos">1197</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
</span><span id="spacrButton.update_description-1198"><a href="#spacrButton.update_description-1198"><span class="linenos">1198</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="spacrButton.update_description-1199"><a href="#spacrButton.update_description-1199"><span class="linenos">1199</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;show_description&#39;</span><span class="p">):</span>
</span><span id="spacrButton.update_description-1200"><a href="#spacrButton.update_description-1200"><span class="linenos">1200</span></a>                <span class="n">parent</span><span class="o">.</span><span class="n">show_description</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">main_buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">additional_buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;No description available.&quot;</span><span class="p">)))</span>
</span><span id="spacrButton.update_description-1201"><a href="#spacrButton.update_description-1201"><span class="linenos">1201</span></a>                <span class="k">return</span>
</span><span id="spacrButton.update_description-1202"><a href="#spacrButton.update_description-1202"><span class="linenos">1202</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">master</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.clear_description" class="classattr">
                                        <input id="spacrButton.clear_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_description</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.clear_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.clear_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.clear_description-1204"><a href="#spacrButton.clear_description-1204"><span class="linenos">1204</span></a>    <span class="k">def</span> <span class="nf">clear_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrButton.clear_description-1205"><a href="#spacrButton.clear_description-1205"><span class="linenos">1205</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
</span><span id="spacrButton.clear_description-1206"><a href="#spacrButton.clear_description-1206"><span class="linenos">1206</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="spacrButton.clear_description-1207"><a href="#spacrButton.clear_description-1207"><span class="linenos">1207</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;clear_description&#39;</span><span class="p">):</span>
</span><span id="spacrButton.clear_description-1208"><a href="#spacrButton.clear_description-1208"><span class="linenos">1208</span></a>                <span class="n">parent</span><span class="o">.</span><span class="n">clear_description</span><span class="p">()</span>
</span><span id="spacrButton.clear_description-1209"><a href="#spacrButton.clear_description-1209"><span class="linenos">1209</span></a>                <span class="k">return</span>
</span><span id="spacrButton.clear_description-1210"><a href="#spacrButton.clear_description-1210"><span class="linenos">1210</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">master</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.animate_zoom" class="classattr">
                                        <input id="spacrButton.animate_zoom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">animate_zoom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target_scale</span>, </span><span class="param"><span class="n">steps</span><span class="o">=</span><span class="mi">10</span>, </span><span class="param"><span class="n">delay</span><span class="o">=</span><span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.animate_zoom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.animate_zoom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.animate_zoom-1212"><a href="#spacrButton.animate_zoom-1212"><span class="linenos">1212</span></a>    <span class="k">def</span> <span class="nf">animate_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_scale</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="spacrButton.animate_zoom-1213"><a href="#spacrButton.animate_zoom-1213"><span class="linenos">1213</span></a>        <span class="n">current_scale</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zoomed_in</span> <span class="k">else</span> <span class="mf">0.65</span>
</span><span id="spacrButton.animate_zoom-1214"><a href="#spacrButton.animate_zoom-1214"><span class="linenos">1214</span></a>        <span class="n">step_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">target_scale</span> <span class="o">-</span> <span class="n">current_scale</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps</span>
</span><span id="spacrButton.animate_zoom-1215"><a href="#spacrButton.animate_zoom-1215"><span class="linenos">1215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_animate_step</span><span class="p">(</span><span class="n">current_scale</span><span class="p">,</span> <span class="n">step_scale</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrButton.zoom_icon" class="classattr">
                                        <input id="spacrButton.zoom_icon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">zoom_icon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scale_factor</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrButton.zoom_icon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrButton.zoom_icon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrButton.zoom_icon-1225"><a href="#spacrButton.zoom_icon-1225"><span class="linenos">1225</span></a>    <span class="k">def</span> <span class="nf">zoom_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
</span><span id="spacrButton.zoom_icon-1226"><a href="#spacrButton.zoom_icon-1226"><span class="linenos">1226</span></a>        <span class="c1"># Resize the original icon image</span>
</span><span id="spacrButton.zoom_icon-1227"><a href="#spacrButton.zoom_icon-1227"><span class="linenos">1227</span></a>        <span class="n">new_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">scale_factor</span><span class="p">)</span>
</span><span id="spacrButton.zoom_icon-1228"><a href="#spacrButton.zoom_icon-1228"><span class="linenos">1228</span></a>        <span class="n">resized_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_icon_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">new_size</span><span class="p">,</span> <span class="n">new_size</span><span class="p">),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
</span><span id="spacrButton.zoom_icon-1229"><a href="#spacrButton.zoom_icon-1229"><span class="linenos">1229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">resized_icon</span><span class="p">)</span>
</span><span id="spacrButton.zoom_icon-1230"><a href="#spacrButton.zoom_icon-1230"><span class="linenos">1230</span></a>
</span><span id="spacrButton.zoom_icon-1231"><a href="#spacrButton.zoom_icon-1231"><span class="linenos">1231</span></a>        <span class="c1"># Update the icon on the canvas</span>
</span><span id="spacrButton.zoom_icon-1232"><a href="#spacrButton.zoom_icon-1232"><span class="linenos">1232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_icon</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span><span class="p">)</span>
</span><span id="spacrButton.zoom_icon-1233"><a href="#spacrButton.zoom_icon-1233"><span class="linenos">1233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_photo</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrSwitch">
                            <input id="spacrSwitch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrSwitch</span><wbr>(<span class="base">tkinter.ttk.Frame</span>):

                <label class="view-source-button" for="spacrSwitch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch-1235"><a href="#spacrSwitch-1235"><span class="linenos">1235</span></a><span class="k">class</span> <span class="nc">spacrSwitch</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
</span><span id="spacrSwitch-1236"><a href="#spacrSwitch-1236"><span class="linenos">1236</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrSwitch-1237"><a href="#spacrSwitch-1237"><span class="linenos">1237</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrSwitch-1238"><a href="#spacrSwitch-1238"><span class="linenos">1238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrSwitch-1239"><a href="#spacrSwitch-1239"><span class="linenos">1239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span> <span class="k">if</span> <span class="n">variable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="spacrSwitch-1240"><a href="#spacrSwitch-1240"><span class="linenos">1240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrSwitch-1241"><a href="#spacrSwitch-1241"><span class="linenos">1241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrSwitch-1242"><a href="#spacrSwitch-1242"><span class="linenos">1242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="spacrSwitch-1243"><a href="#spacrSwitch-1243"><span class="linenos">1243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">switch_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#fff&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch-1244"><a href="#spacrSwitch-1244"><span class="linenos">1244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">switch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#800080&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch-1245"><a href="#spacrSwitch-1245"><span class="linenos">1245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">spacrLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="spacrSwitch-1246"><a href="#spacrSwitch-1246"><span class="linenos">1246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="spacrSwitch-1247"><a href="#spacrSwitch-1247"><span class="linenos">1247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="spacrSwitch-1248"><a href="#spacrSwitch-1248"><span class="linenos">1248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="spacrSwitch-1249"><a href="#spacrSwitch-1249"><span class="linenos">1249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="spacrSwitch-1250"><a href="#spacrSwitch-1250"><span class="linenos">1250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_switch</span><span class="p">()</span>
</span><span id="spacrSwitch-1251"><a href="#spacrSwitch-1251"><span class="linenos">1251</span></a>
</span><span id="spacrSwitch-1252"><a href="#spacrSwitch-1252"><span class="linenos">1252</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrSwitch-1253"><a href="#spacrSwitch-1253"><span class="linenos">1253</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">])</span>
</span><span id="spacrSwitch-1254"><a href="#spacrSwitch-1254"><span class="linenos">1254</span></a>
</span><span id="spacrSwitch-1255"><a href="#spacrSwitch-1255"><span class="linenos">1255</span></a>    <span class="k">def</span> <span class="nf">toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrSwitch-1256"><a href="#spacrSwitch-1256"><span class="linenos">1256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="spacrSwitch-1257"><a href="#spacrSwitch-1257"><span class="linenos">1257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animate_switch</span><span class="p">()</span>
</span><span id="spacrSwitch-1258"><a href="#spacrSwitch-1258"><span class="linenos">1258</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrSwitch-1259"><a href="#spacrSwitch-1259"><span class="linenos">1259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span><span id="spacrSwitch-1260"><a href="#spacrSwitch-1260"><span class="linenos">1260</span></a>
</span><span id="spacrSwitch-1261"><a href="#spacrSwitch-1261"><span class="linenos">1261</span></a>    <span class="k">def</span> <span class="nf">update_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSwitch-1262"><a href="#spacrSwitch-1262"><span class="linenos">1262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="spacrSwitch-1263"><a href="#spacrSwitch-1263"><span class="linenos">1263</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch-1264"><a href="#spacrSwitch-1264"><span class="linenos">1264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="spacrSwitch-1265"><a href="#spacrSwitch-1265"><span class="linenos">1265</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrSwitch-1266"><a href="#spacrSwitch-1266"><span class="linenos">1266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#800080&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch-1267"><a href="#spacrSwitch-1267"><span class="linenos">1267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="spacrSwitch-1268"><a href="#spacrSwitch-1268"><span class="linenos">1268</span></a>
</span><span id="spacrSwitch-1269"><a href="#spacrSwitch-1269"><span class="linenos">1269</span></a>    <span class="k">def</span> <span class="nf">animate_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSwitch-1270"><a href="#spacrSwitch-1270"><span class="linenos">1270</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="spacrSwitch-1271"><a href="#spacrSwitch-1271"><span class="linenos">1271</span></a>            <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span>
</span><span id="spacrSwitch-1272"><a href="#spacrSwitch-1272"><span class="linenos">1272</span></a>            <span class="n">final_color</span> <span class="o">=</span> <span class="s2">&quot;#008080&quot;</span>
</span><span id="spacrSwitch-1273"><a href="#spacrSwitch-1273"><span class="linenos">1273</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrSwitch-1274"><a href="#spacrSwitch-1274"><span class="linenos">1274</span></a>            <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">4</span>
</span><span id="spacrSwitch-1275"><a href="#spacrSwitch-1275"><span class="linenos">1275</span></a>            <span class="n">final_color</span> <span class="o">=</span> <span class="s2">&quot;#800080&quot;</span>
</span><span id="spacrSwitch-1276"><a href="#spacrSwitch-1276"><span class="linenos">1276</span></a>
</span><span id="spacrSwitch-1277"><a href="#spacrSwitch-1277"><span class="linenos">1277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animate_movement</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">final_color</span><span class="p">)</span>
</span><span id="spacrSwitch-1278"><a href="#spacrSwitch-1278"><span class="linenos">1278</span></a>
</span><span id="spacrSwitch-1279"><a href="#spacrSwitch-1279"><span class="linenos">1279</span></a>    <span class="k">def</span> <span class="nf">animate_movement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">final_color</span><span class="p">):</span>
</span><span id="spacrSwitch-1280"><a href="#spacrSwitch-1280"><span class="linenos">1280</span></a>        <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">start_x</span> <span class="o">&lt;</span> <span class="n">end_x</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="spacrSwitch-1281"><a href="#spacrSwitch-1281"><span class="linenos">1281</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</span><span id="spacrSwitch-1282"><a href="#spacrSwitch-1282"><span class="linenos">1282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="spacrSwitch-1283"><a href="#spacrSwitch-1283"><span class="linenos">1283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="spacrSwitch-1284"><a href="#spacrSwitch-1284"><span class="linenos">1284</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="spacrSwitch-1285"><a href="#spacrSwitch-1285"><span class="linenos">1285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">final_color</span><span class="p">)</span>
</span><span id="spacrSwitch-1286"><a href="#spacrSwitch-1286"><span class="linenos">1286</span></a>
</span><span id="spacrSwitch-1287"><a href="#spacrSwitch-1287"><span class="linenos">1287</span></a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSwitch-1288"><a href="#spacrSwitch-1288"><span class="linenos">1288</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="spacrSwitch-1289"><a href="#spacrSwitch-1289"><span class="linenos">1289</span></a>
</span><span id="spacrSwitch-1290"><a href="#spacrSwitch-1290"><span class="linenos">1290</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrSwitch-1291"><a href="#spacrSwitch-1291"><span class="linenos">1291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSwitch-1292"><a href="#spacrSwitch-1292"><span class="linenos">1292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_switch</span><span class="p">()</span>
</span><span id="spacrSwitch-1293"><a href="#spacrSwitch-1293"><span class="linenos">1293</span></a>
</span><span id="spacrSwitch-1294"><a href="#spacrSwitch-1294"><span class="linenos">1294</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrSwitch-1295"><a href="#spacrSwitch-1295"><span class="linenos">1295</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch-1296"><a href="#spacrSwitch-1296"><span class="linenos">1296</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch-1297"><a href="#spacrSwitch-1297"><span class="linenos">1297</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch-1298"><a href="#spacrSwitch-1298"><span class="linenos">1298</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch-1299"><a href="#spacrSwitch-1299"><span class="linenos">1299</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch-1300"><a href="#spacrSwitch-1300"><span class="linenos">1300</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1301"><a href="#spacrSwitch-1301"><span class="linenos">1301</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1302"><a href="#spacrSwitch-1302"><span class="linenos">1302</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1303"><a href="#spacrSwitch-1303"><span class="linenos">1303</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1304"><a href="#spacrSwitch-1304"><span class="linenos">1304</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch-1305"><a href="#spacrSwitch-1305"><span class="linenos">1305</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch-1306"><a href="#spacrSwitch-1306"><span class="linenos">1306</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch-1307"><a href="#spacrSwitch-1307"><span class="linenos">1307</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch-1308"><a href="#spacrSwitch-1308"><span class="linenos">1308</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch-1309"><a href="#spacrSwitch-1309"><span class="linenos">1309</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch-1310"><a href="#spacrSwitch-1310"><span class="linenos">1310</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1311"><a href="#spacrSwitch-1311"><span class="linenos">1311</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1312"><a href="#spacrSwitch-1312"><span class="linenos">1312</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1313"><a href="#spacrSwitch-1313"><span class="linenos">1313</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch-1314"><a href="#spacrSwitch-1314"><span class="linenos">1314</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span>
</span><span id="spacrSwitch-1315"><a href="#spacrSwitch-1315"><span class="linenos">1315</span></a>
</span><span id="spacrSwitch-1316"><a href="#spacrSwitch-1316"><span class="linenos">1316</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ttk Frame widget is a container, used to group other widgets
together.</p>
</div>


                            <div id="spacrSwitch.__init__" class="classattr">
                                        <input id="spacrSwitch.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrSwitch</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span>, </span><span class="param"><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span>, </span><span class="param"><span class="n">variable</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">command</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="spacrSwitch.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.__init__-1236"><a href="#spacrSwitch.__init__-1236"><span class="linenos">1236</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrSwitch.__init__-1237"><a href="#spacrSwitch.__init__-1237"><span class="linenos">1237</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1238"><a href="#spacrSwitch.__init__-1238"><span class="linenos">1238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrSwitch.__init__-1239"><a href="#spacrSwitch.__init__-1239"><span class="linenos">1239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span> <span class="k">if</span> <span class="n">variable</span> <span class="k">else</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="spacrSwitch.__init__-1240"><a href="#spacrSwitch.__init__-1240"><span class="linenos">1240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="spacrSwitch.__init__-1241"><a href="#spacrSwitch.__init__-1241"><span class="linenos">1241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1242"><a href="#spacrSwitch.__init__-1242"><span class="linenos">1242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="spacrSwitch.__init__-1243"><a href="#spacrSwitch.__init__-1243"><span class="linenos">1243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">switch_bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rounded_rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#fff&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1244"><a href="#spacrSwitch.__init__-1244"><span class="linenos">1244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">switch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#800080&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1245"><a href="#spacrSwitch.__init__-1245"><span class="linenos">1245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">spacrLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1246"><a href="#spacrSwitch.__init__-1246"><span class="linenos">1246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="spacrSwitch.__init__-1247"><a href="#spacrSwitch.__init__-1247"><span class="linenos">1247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1248"><a href="#spacrSwitch.__init__-1248"><span class="linenos">1248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1249"><a href="#spacrSwitch.__init__-1249"><span class="linenos">1249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
</span><span id="spacrSwitch.__init__-1250"><a href="#spacrSwitch.__init__-1250"><span class="linenos">1250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_switch</span><span class="p">()</span>
</span><span id="spacrSwitch.__init__-1251"><a href="#spacrSwitch.__init__-1251"><span class="linenos">1251</span></a>
</span><span id="spacrSwitch.__init__-1252"><a href="#spacrSwitch.__init__-1252"><span class="linenos">1252</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrSwitch.__init__-1253"><a href="#spacrSwitch.__init__-1253"><span class="linenos">1253</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Construct a Ttk Frame with parent master.</p>

<p>STANDARD OPTIONS</p>

<pre><code>class, cursor, style, takefocus
</code></pre>

<p>WIDGET-SPECIFIC OPTIONS</p>

<pre><code>borderwidth, relief, padding, width, height
</code></pre>
</div>


                            </div>
                            <div id="spacrSwitch.text" class="classattr">
                                <div class="attr variable">
            <span class="name">text</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.text"></a>
    
    

                            </div>
                            <div id="spacrSwitch.variable" class="classattr">
                                <div class="attr variable">
            <span class="name">variable</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.variable"></a>
    
    

                            </div>
                            <div id="spacrSwitch.command" class="classattr">
                                <div class="attr variable">
            <span class="name">command</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.command"></a>
    
    

                            </div>
                            <div id="spacrSwitch.canvas" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.canvas"></a>
    
    

                            </div>
                            <div id="spacrSwitch.switch_bg" class="classattr">
                                <div class="attr variable">
            <span class="name">switch_bg</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.switch_bg"></a>
    
    

                            </div>
                            <div id="spacrSwitch.switch" class="classattr">
                                <div class="attr variable">
            <span class="name">switch</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.switch"></a>
    
    

                            </div>
                            <div id="spacrSwitch.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span>

        
    </div>
    <a class="headerlink" href="#spacrSwitch.label"></a>
    
    

                            </div>
                            <div id="spacrSwitch.toggle" class="classattr">
                                        <input id="spacrSwitch.toggle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.toggle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.toggle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.toggle-1255"><a href="#spacrSwitch.toggle-1255"><span class="linenos">1255</span></a>    <span class="k">def</span> <span class="nf">toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="spacrSwitch.toggle-1256"><a href="#spacrSwitch.toggle-1256"><span class="linenos">1256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="spacrSwitch.toggle-1257"><a href="#spacrSwitch.toggle-1257"><span class="linenos">1257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animate_switch</span><span class="p">()</span>
</span><span id="spacrSwitch.toggle-1258"><a href="#spacrSwitch.toggle-1258"><span class="linenos">1258</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span id="spacrSwitch.toggle-1259"><a href="#spacrSwitch.toggle-1259"><span class="linenos">1259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSwitch.update_switch" class="classattr">
                                        <input id="spacrSwitch.update_switch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_switch</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.update_switch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.update_switch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.update_switch-1261"><a href="#spacrSwitch.update_switch-1261"><span class="linenos">1261</span></a>    <span class="k">def</span> <span class="nf">update_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSwitch.update_switch-1262"><a href="#spacrSwitch.update_switch-1262"><span class="linenos">1262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="spacrSwitch.update_switch-1263"><a href="#spacrSwitch.update_switch-1263"><span class="linenos">1263</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#008080&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch.update_switch-1264"><a href="#spacrSwitch.update_switch-1264"><span class="linenos">1264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="spacrSwitch.update_switch-1265"><a href="#spacrSwitch.update_switch-1265"><span class="linenos">1265</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrSwitch.update_switch-1266"><a href="#spacrSwitch.update_switch-1266"><span class="linenos">1266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;#800080&quot;</span><span class="p">)</span>
</span><span id="spacrSwitch.update_switch-1267"><a href="#spacrSwitch.update_switch-1267"><span class="linenos">1267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSwitch.animate_switch" class="classattr">
                                        <input id="spacrSwitch.animate_switch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">animate_switch</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.animate_switch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.animate_switch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.animate_switch-1269"><a href="#spacrSwitch.animate_switch-1269"><span class="linenos">1269</span></a>    <span class="k">def</span> <span class="nf">animate_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSwitch.animate_switch-1270"><a href="#spacrSwitch.animate_switch-1270"><span class="linenos">1270</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="spacrSwitch.animate_switch-1271"><a href="#spacrSwitch.animate_switch-1271"><span class="linenos">1271</span></a>            <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span>
</span><span id="spacrSwitch.animate_switch-1272"><a href="#spacrSwitch.animate_switch-1272"><span class="linenos">1272</span></a>            <span class="n">final_color</span> <span class="o">=</span> <span class="s2">&quot;#008080&quot;</span>
</span><span id="spacrSwitch.animate_switch-1273"><a href="#spacrSwitch.animate_switch-1273"><span class="linenos">1273</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="spacrSwitch.animate_switch-1274"><a href="#spacrSwitch.animate_switch-1274"><span class="linenos">1274</span></a>            <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">4</span>
</span><span id="spacrSwitch.animate_switch-1275"><a href="#spacrSwitch.animate_switch-1275"><span class="linenos">1275</span></a>            <span class="n">final_color</span> <span class="o">=</span> <span class="s2">&quot;#800080&quot;</span>
</span><span id="spacrSwitch.animate_switch-1276"><a href="#spacrSwitch.animate_switch-1276"><span class="linenos">1276</span></a>
</span><span id="spacrSwitch.animate_switch-1277"><a href="#spacrSwitch.animate_switch-1277"><span class="linenos">1277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animate_movement</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">final_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSwitch.animate_movement" class="classattr">
                                        <input id="spacrSwitch.animate_movement-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">animate_movement</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">start_x</span>, </span><span class="param"><span class="n">end_x</span>, </span><span class="param"><span class="n">final_color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.animate_movement-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.animate_movement"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.animate_movement-1279"><a href="#spacrSwitch.animate_movement-1279"><span class="linenos">1279</span></a>    <span class="k">def</span> <span class="nf">animate_movement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">final_color</span><span class="p">):</span>
</span><span id="spacrSwitch.animate_movement-1280"><a href="#spacrSwitch.animate_movement-1280"><span class="linenos">1280</span></a>        <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">start_x</span> <span class="o">&lt;</span> <span class="n">end_x</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="spacrSwitch.animate_movement-1281"><a href="#spacrSwitch.animate_movement-1281"><span class="linenos">1281</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">end_x</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</span><span id="spacrSwitch.animate_movement-1282"><a href="#spacrSwitch.animate_movement-1282"><span class="linenos">1282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="spacrSwitch.animate_movement-1283"><a href="#spacrSwitch.animate_movement-1283"><span class="linenos">1283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="spacrSwitch.animate_movement-1284"><a href="#spacrSwitch.animate_movement-1284"><span class="linenos">1284</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="spacrSwitch.animate_movement-1285"><a href="#spacrSwitch.animate_movement-1285"><span class="linenos">1285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">final_color</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSwitch.get" class="classattr">
                                        <input id="spacrSwitch.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.get-1287"><a href="#spacrSwitch.get-1287"><span class="linenos">1287</span></a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="spacrSwitch.get-1288"><a href="#spacrSwitch.get-1288"><span class="linenos">1288</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSwitch.set" class="classattr">
                                        <input id="spacrSwitch.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">value</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.set-1290"><a href="#spacrSwitch.set-1290"><span class="linenos">1290</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="spacrSwitch.set-1291"><a href="#spacrSwitch.set-1291"><span class="linenos">1291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="spacrSwitch.set-1292"><a href="#spacrSwitch.set-1292"><span class="linenos">1292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_switch</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrSwitch.create_rounded_rectangle" class="classattr">
                                        <input id="spacrSwitch.create_rounded_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_rounded_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">radius</span><span class="o">=</span><span class="mi">9</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrSwitch.create_rounded_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrSwitch.create_rounded_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrSwitch.create_rounded_rectangle-1294"><a href="#spacrSwitch.create_rounded_rectangle-1294"><span class="linenos">1294</span></a>    <span class="k">def</span> <span class="nf">create_rounded_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1295"><a href="#spacrSwitch.create_rounded_rectangle-1295"><span class="linenos">1295</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1296"><a href="#spacrSwitch.create_rounded_rectangle-1296"><span class="linenos">1296</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1297"><a href="#spacrSwitch.create_rounded_rectangle-1297"><span class="linenos">1297</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1298"><a href="#spacrSwitch.create_rounded_rectangle-1298"><span class="linenos">1298</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1299"><a href="#spacrSwitch.create_rounded_rectangle-1299"><span class="linenos">1299</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1300"><a href="#spacrSwitch.create_rounded_rectangle-1300"><span class="linenos">1300</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1301"><a href="#spacrSwitch.create_rounded_rectangle-1301"><span class="linenos">1301</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1302"><a href="#spacrSwitch.create_rounded_rectangle-1302"><span class="linenos">1302</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1303"><a href="#spacrSwitch.create_rounded_rectangle-1303"><span class="linenos">1303</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1304"><a href="#spacrSwitch.create_rounded_rectangle-1304"><span class="linenos">1304</span></a>                  <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1305"><a href="#spacrSwitch.create_rounded_rectangle-1305"><span class="linenos">1305</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1306"><a href="#spacrSwitch.create_rounded_rectangle-1306"><span class="linenos">1306</span></a>                  <span class="n">x2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1307"><a href="#spacrSwitch.create_rounded_rectangle-1307"><span class="linenos">1307</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1308"><a href="#spacrSwitch.create_rounded_rectangle-1308"><span class="linenos">1308</span></a>                  <span class="n">x1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1309"><a href="#spacrSwitch.create_rounded_rectangle-1309"><span class="linenos">1309</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1310"><a href="#spacrSwitch.create_rounded_rectangle-1310"><span class="linenos">1310</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1311"><a href="#spacrSwitch.create_rounded_rectangle-1311"><span class="linenos">1311</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1312"><a href="#spacrSwitch.create_rounded_rectangle-1312"><span class="linenos">1312</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1313"><a href="#spacrSwitch.create_rounded_rectangle-1313"><span class="linenos">1313</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1314"><a href="#spacrSwitch.create_rounded_rectangle-1314"><span class="linenos">1314</span></a>                  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span>
</span><span id="spacrSwitch.create_rounded_rectangle-1315"><a href="#spacrSwitch.create_rounded_rectangle-1315"><span class="linenos">1315</span></a>
</span><span id="spacrSwitch.create_rounded_rectangle-1316"><a href="#spacrSwitch.create_rounded_rectangle-1316"><span class="linenos">1316</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="spacrToolTip">
                            <input id="spacrToolTip-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">spacrToolTip</span>:

                <label class="view-source-button" for="spacrToolTip-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrToolTip"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrToolTip-1318"><a href="#spacrToolTip-1318"><span class="linenos">1318</span></a><span class="k">class</span> <span class="nc">spacrToolTip</span><span class="p">:</span>
</span><span id="spacrToolTip-1319"><a href="#spacrToolTip-1319"><span class="linenos">1319</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="spacrToolTip-1320"><a href="#spacrToolTip-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span>
</span><span id="spacrToolTip-1321"><a href="#spacrToolTip-1321"><span class="linenos">1321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrToolTip-1322"><a href="#spacrToolTip-1322"><span class="linenos">1322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrToolTip-1323"><a href="#spacrToolTip-1323"><span class="linenos">1323</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_tooltip</span><span class="p">)</span>
</span><span id="spacrToolTip-1324"><a href="#spacrToolTip-1324"><span class="linenos">1324</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_tooltip</span><span class="p">)</span>
</span><span id="spacrToolTip-1325"><a href="#spacrToolTip-1325"><span class="linenos">1325</span></a>
</span><span id="spacrToolTip-1326"><a href="#spacrToolTip-1326"><span class="linenos">1326</span></a>    <span class="k">def</span> <span class="nf">show_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrToolTip-1327"><a href="#spacrToolTip-1327"><span class="linenos">1327</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span> <span class="o">+</span> <span class="mi">20</span>
</span><span id="spacrToolTip-1328"><a href="#spacrToolTip-1328"><span class="linenos">1328</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="o">+</span> <span class="mi">10</span>
</span><span id="spacrToolTip-1329"><a href="#spacrToolTip-1329"><span class="linenos">1329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
</span><span id="spacrToolTip-1330"><a href="#spacrToolTip-1330"><span class="linenos">1330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrToolTip-1331"><a href="#spacrToolTip-1331"><span class="linenos">1331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">wm_geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrToolTip-1332"><a href="#spacrToolTip-1332"><span class="linenos">1332</span></a>        <span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrToolTip-1333"><a href="#spacrToolTip-1333"><span class="linenos">1333</span></a>        <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="spacrToolTip-1334"><a href="#spacrToolTip-1334"><span class="linenos">1334</span></a>
</span><span id="spacrToolTip-1335"><a href="#spacrToolTip-1335"><span class="linenos">1335</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrToolTip-1336"><a href="#spacrToolTip-1336"><span class="linenos">1336</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
</span><span id="spacrToolTip-1337"><a href="#spacrToolTip-1337"><span class="linenos">1337</span></a>
</span><span id="spacrToolTip-1338"><a href="#spacrToolTip-1338"><span class="linenos">1338</span></a>    <span class="k">def</span> <span class="nf">hide_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrToolTip-1339"><a href="#spacrToolTip-1339"><span class="linenos">1339</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">:</span>
</span><span id="spacrToolTip-1340"><a href="#spacrToolTip-1340"><span class="linenos">1340</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="spacrToolTip-1341"><a href="#spacrToolTip-1341"><span class="linenos">1341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            <div id="spacrToolTip.__init__" class="classattr">
                                        <input id="spacrToolTip.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">spacrToolTip</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">widget</span>, </span><span class="param"><span class="n">text</span></span>)</span>

                <label class="view-source-button" for="spacrToolTip.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrToolTip.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrToolTip.__init__-1319"><a href="#spacrToolTip.__init__-1319"><span class="linenos">1319</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="spacrToolTip.__init__-1320"><a href="#spacrToolTip.__init__-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span>
</span><span id="spacrToolTip.__init__-1321"><a href="#spacrToolTip.__init__-1321"><span class="linenos">1321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="spacrToolTip.__init__-1322"><a href="#spacrToolTip.__init__-1322"><span class="linenos">1322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="spacrToolTip.__init__-1323"><a href="#spacrToolTip.__init__-1323"><span class="linenos">1323</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_tooltip</span><span class="p">)</span>
</span><span id="spacrToolTip.__init__-1324"><a href="#spacrToolTip.__init__-1324"><span class="linenos">1324</span></a>        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_tooltip</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrToolTip.widget" class="classattr">
                                <div class="attr variable">
            <span class="name">widget</span>

        
    </div>
    <a class="headerlink" href="#spacrToolTip.widget"></a>
    
    

                            </div>
                            <div id="spacrToolTip.text" class="classattr">
                                <div class="attr variable">
            <span class="name">text</span>

        
    </div>
    <a class="headerlink" href="#spacrToolTip.text"></a>
    
    

                            </div>
                            <div id="spacrToolTip.tooltip_window" class="classattr">
                                <div class="attr variable">
            <span class="name">tooltip_window</span>

        
    </div>
    <a class="headerlink" href="#spacrToolTip.tooltip_window"></a>
    
    

                            </div>
                            <div id="spacrToolTip.show_tooltip" class="classattr">
                                        <input id="spacrToolTip.show_tooltip-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_tooltip</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrToolTip.show_tooltip-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrToolTip.show_tooltip"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrToolTip.show_tooltip-1326"><a href="#spacrToolTip.show_tooltip-1326"><span class="linenos">1326</span></a>    <span class="k">def</span> <span class="nf">show_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrToolTip.show_tooltip-1327"><a href="#spacrToolTip.show_tooltip-1327"><span class="linenos">1327</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span> <span class="o">+</span> <span class="mi">20</span>
</span><span id="spacrToolTip.show_tooltip-1328"><a href="#spacrToolTip.show_tooltip-1328"><span class="linenos">1328</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span> <span class="o">+</span> <span class="mi">10</span>
</span><span id="spacrToolTip.show_tooltip-1329"><a href="#spacrToolTip.show_tooltip-1329"><span class="linenos">1329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
</span><span id="spacrToolTip.show_tooltip-1330"><a href="#spacrToolTip.show_tooltip-1330"><span class="linenos">1330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="spacrToolTip.show_tooltip-1331"><a href="#spacrToolTip.show_tooltip-1331"><span class="linenos">1331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">wm_geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="spacrToolTip.show_tooltip-1332"><a href="#spacrToolTip.show_tooltip-1332"><span class="linenos">1332</span></a>        <span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="spacrToolTip.show_tooltip-1333"><a href="#spacrToolTip.show_tooltip-1333"><span class="linenos">1333</span></a>        <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="spacrToolTip.show_tooltip-1334"><a href="#spacrToolTip.show_tooltip-1334"><span class="linenos">1334</span></a>
</span><span id="spacrToolTip.show_tooltip-1335"><a href="#spacrToolTip.show_tooltip-1335"><span class="linenos">1335</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="spacrToolTip.show_tooltip-1336"><a href="#spacrToolTip.show_tooltip-1336"><span class="linenos">1336</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">],</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
</span></pre></div>


    

                            </div>
                            <div id="spacrToolTip.hide_tooltip" class="classattr">
                                        <input id="spacrToolTip.hide_tooltip-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hide_tooltip</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacrToolTip.hide_tooltip-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacrToolTip.hide_tooltip"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacrToolTip.hide_tooltip-1338"><a href="#spacrToolTip.hide_tooltip-1338"><span class="linenos">1338</span></a>    <span class="k">def</span> <span class="nf">hide_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="spacrToolTip.hide_tooltip-1339"><a href="#spacrToolTip.hide_tooltip-1339"><span class="linenos">1339</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="p">:</span>
</span><span id="spacrToolTip.hide_tooltip-1340"><a href="#spacrToolTip.hide_tooltip-1340"><span class="linenos">1340</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="spacrToolTip.hide_tooltip-1341"><a href="#spacrToolTip.hide_tooltip-1341"><span class="linenos">1341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tooltip_window</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="ModifyMaskApp">
                            <input id="ModifyMaskApp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ModifyMaskApp</span>:

                <label class="view-source-button" for="ModifyMaskApp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp-1343"><a href="#ModifyMaskApp-1343"><span class="linenos">1343</span></a><span class="k">class</span> <span class="nc">ModifyMaskApp</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1344"><a href="#ModifyMaskApp-1344"><span class="linenos">1344</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1345"><a href="#ModifyMaskApp-1345"><span class="linenos">1345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
</span><span id="ModifyMaskApp-1346"><a href="#ModifyMaskApp-1346"><span class="linenos">1346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span> <span class="o">=</span> <span class="n">folder_path</span>
</span><span id="ModifyMaskApp-1347"><a href="#ModifyMaskApp-1347"><span class="linenos">1347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
</span><span id="ModifyMaskApp-1348"><a href="#ModifyMaskApp-1348"><span class="linenos">1348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;.tiff&#39;</span><span class="p">))])</span>
</span><span id="ModifyMaskApp-1349"><a href="#ModifyMaskApp-1349"><span class="linenos">1349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">masks_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1350"><a href="#ModifyMaskApp-1350"><span class="linenos">1350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-1351"><a href="#ModifyMaskApp-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1352"><a href="#ModifyMaskApp-1352"><span class="linenos">1352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="ModifyMaskApp-1353"><a href="#ModifyMaskApp-1353"><span class="linenos">1353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="ModifyMaskApp-1354"><a href="#ModifyMaskApp-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1355"><a href="#ModifyMaskApp-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_navigation_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1356"><a href="#ModifyMaskApp-1356"><span class="linenos">1356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_mode_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1357"><a href="#ModifyMaskApp-1357"><span class="linenos">1357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_function_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1358"><a href="#ModifyMaskApp-1358"><span class="linenos">1358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_zoom_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1359"><a href="#ModifyMaskApp-1359"><span class="linenos">1359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_canvas</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1360"><a href="#ModifyMaskApp-1360"><span class="linenos">1360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_first_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1361"><a href="#ModifyMaskApp-1361"><span class="linenos">1361</span></a>    
</span><span id="ModifyMaskApp-1362"><a href="#ModifyMaskApp-1362"><span class="linenos">1362</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1363"><a href="#ModifyMaskApp-1363"><span class="linenos">1363</span></a>    <span class="c1"># Helper functions#</span>
</span><span id="ModifyMaskApp-1364"><a href="#ModifyMaskApp-1364"><span class="linenos">1364</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1365"><a href="#ModifyMaskApp-1365"><span class="linenos">1365</span></a>    
</span><span id="ModifyMaskApp-1366"><a href="#ModifyMaskApp-1366"><span class="linenos">1366</span></a>    <span class="k">def</span> <span class="nf">update_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1367"><a href="#ModifyMaskApp-1367"><span class="linenos">1367</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1368"><a href="#ModifyMaskApp-1368"><span class="linenos">1368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_zoomed_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1369"><a href="#ModifyMaskApp-1369"><span class="linenos">1369</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1370"><a href="#ModifyMaskApp-1370"><span class="linenos">1370</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1371"><a href="#ModifyMaskApp-1371"><span class="linenos">1371</span></a>    
</span><span id="ModifyMaskApp-1372"><a href="#ModifyMaskApp-1372"><span class="linenos">1372</span></a>    <span class="k">def</span> <span class="nf">update_original_mask_from_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1373"><a href="#ModifyMaskApp-1373"><span class="linenos">1373</span></a>        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="ModifyMaskApp-1374"><a href="#ModifyMaskApp-1374"><span class="linenos">1374</span></a>        <span class="n">zoomed_mask_resized</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1375"><a href="#ModifyMaskApp-1375"><span class="linenos">1375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_mask_resized</span>
</span><span id="ModifyMaskApp-1376"><a href="#ModifyMaskApp-1376"><span class="linenos">1376</span></a>        
</span><span id="ModifyMaskApp-1377"><a href="#ModifyMaskApp-1377"><span class="linenos">1377</span></a>    <span class="k">def</span> <span class="nf">update_original_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1378"><a href="#ModifyMaskApp-1378"><span class="linenos">1378</span></a>        <span class="n">actual_mask_region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1379"><a href="#ModifyMaskApp-1379"><span class="linenos">1379</span></a>        <span class="n">target_shape</span> <span class="o">=</span> <span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp-1380"><a href="#ModifyMaskApp-1380"><span class="linenos">1380</span></a>        <span class="n">resized_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">target_shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1381"><a href="#ModifyMaskApp-1381"><span class="linenos">1381</span></a>        <span class="k">if</span> <span class="n">resized_mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1382"><a href="#ModifyMaskApp-1382"><span class="linenos">1382</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape mismatch: resized_mask </span><span class="si">{</span><span class="n">resized_mask</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, actual_mask_region </span><span class="si">{</span><span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1383"><a href="#ModifyMaskApp-1383"><span class="linenos">1383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">actual_mask_region</span><span class="p">,</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1384"><a href="#ModifyMaskApp-1384"><span class="linenos">1384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1385"><a href="#ModifyMaskApp-1385"><span class="linenos">1385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">],</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1386"><a href="#ModifyMaskApp-1386"><span class="linenos">1386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1387"><a href="#ModifyMaskApp-1387"><span class="linenos">1387</span></a>
</span><span id="ModifyMaskApp-1388"><a href="#ModifyMaskApp-1388"><span class="linenos">1388</span></a>    <span class="k">def</span> <span class="nf">get_scaling_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_width</span><span class="p">,</span> <span class="n">img_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1389"><a href="#ModifyMaskApp-1389"><span class="linenos">1389</span></a>        <span class="n">x_scale</span> <span class="o">=</span> <span class="n">img_width</span> <span class="o">/</span> <span class="n">canvas_width</span>
</span><span id="ModifyMaskApp-1390"><a href="#ModifyMaskApp-1390"><span class="linenos">1390</span></a>        <span class="n">y_scale</span> <span class="o">=</span> <span class="n">img_height</span> <span class="o">/</span> <span class="n">canvas_height</span>
</span><span id="ModifyMaskApp-1391"><a href="#ModifyMaskApp-1391"><span class="linenos">1391</span></a>        <span class="k">return</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span>
</span><span id="ModifyMaskApp-1392"><a href="#ModifyMaskApp-1392"><span class="linenos">1392</span></a>    
</span><span id="ModifyMaskApp-1393"><a href="#ModifyMaskApp-1393"><span class="linenos">1393</span></a>    <span class="k">def</span> <span class="nf">canvas_to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_canvas</span><span class="p">,</span> <span class="n">y_canvas</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1394"><a href="#ModifyMaskApp-1394"><span class="linenos">1394</span></a>        <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scaling_factors</span><span class="p">(</span>
</span><span id="ModifyMaskApp-1395"><a href="#ModifyMaskApp-1395"><span class="linenos">1395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="ModifyMaskApp-1396"><a href="#ModifyMaskApp-1396"><span class="linenos">1396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span>
</span><span id="ModifyMaskApp-1397"><a href="#ModifyMaskApp-1397"><span class="linenos">1397</span></a>        <span class="p">)</span>
</span><span id="ModifyMaskApp-1398"><a href="#ModifyMaskApp-1398"><span class="linenos">1398</span></a>        <span class="n">x_image</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_canvas</span> <span class="o">*</span> <span class="n">x_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1399"><a href="#ModifyMaskApp-1399"><span class="linenos">1399</span></a>        <span class="n">y_image</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_canvas</span> <span class="o">*</span> <span class="n">y_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1400"><a href="#ModifyMaskApp-1400"><span class="linenos">1400</span></a>        <span class="k">return</span> <span class="n">x_image</span><span class="p">,</span> <span class="n">y_image</span>
</span><span id="ModifyMaskApp-1401"><a href="#ModifyMaskApp-1401"><span class="linenos">1401</span></a>
</span><span id="ModifyMaskApp-1402"><a href="#ModifyMaskApp-1402"><span class="linenos">1402</span></a>    <span class="k">def</span> <span class="nf">apply_zoom_on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1403"><a href="#ModifyMaskApp-1403"><span class="linenos">1403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1404"><a href="#ModifyMaskApp-1404"><span class="linenos">1404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_end</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1405"><a href="#ModifyMaskApp-1405"><span class="linenos">1405</span></a>        
</span><span id="ModifyMaskApp-1406"><a href="#ModifyMaskApp-1406"><span class="linenos">1406</span></a>    <span class="k">def</span> <span class="nf">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1407"><a href="#ModifyMaskApp-1407"><span class="linenos">1407</span></a>        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1408"><a href="#ModifyMaskApp-1408"><span class="linenos">1408</span></a>        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1409"><a href="#ModifyMaskApp-1409"><span class="linenos">1409</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1410"><a href="#ModifyMaskApp-1410"><span class="linenos">1410</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized</span> <span class="o">-</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">upper_bound</span> <span class="o">-</span> <span class="n">lower_bound</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1411"><a href="#ModifyMaskApp-1411"><span class="linenos">1411</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
</span><span id="ModifyMaskApp-1412"><a href="#ModifyMaskApp-1412"><span class="linenos">1412</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized</span> <span class="o">*</span> <span class="n">max_value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1413"><a href="#ModifyMaskApp-1413"><span class="linenos">1413</span></a>        <span class="k">return</span> <span class="n">normalized</span>
</span><span id="ModifyMaskApp-1414"><a href="#ModifyMaskApp-1414"><span class="linenos">1414</span></a>    
</span><span id="ModifyMaskApp-1415"><a href="#ModifyMaskApp-1415"><span class="linenos">1415</span></a>    <span class="k">def</span> <span class="nf">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1416"><a href="#ModifyMaskApp-1416"><span class="linenos">1416</span></a>        <span class="n">original_dtype</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="ModifyMaskApp-1417"><a href="#ModifyMaskApp-1417"><span class="linenos">1417</span></a>        <span class="n">scaled_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1418"><a href="#ModifyMaskApp-1418"><span class="linenos">1418</span></a>        <span class="n">scaled_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1419"><a href="#ModifyMaskApp-1419"><span class="linenos">1419</span></a>        <span class="n">scaled_img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">scaled_height</span><span class="p">,</span> <span class="n">scaled_width</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1420"><a href="#ModifyMaskApp-1420"><span class="linenos">1420</span></a>        <span class="n">scaled_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="n">scaled_height</span><span class="p">,</span> <span class="n">scaled_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1421"><a href="#ModifyMaskApp-1421"><span class="linenos">1421</span></a>        <span class="n">stretched_img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">scaled_img</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1422"><a href="#ModifyMaskApp-1422"><span class="linenos">1422</span></a>        <span class="n">stretched_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">scaled_mask</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1423"><a href="#ModifyMaskApp-1423"><span class="linenos">1423</span></a>        <span class="k">return</span> <span class="n">stretched_img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">original_dtype</span><span class="p">),</span> <span class="n">stretched_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">original_dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1424"><a href="#ModifyMaskApp-1424"><span class="linenos">1424</span></a>    
</span><span id="ModifyMaskApp-1425"><a href="#ModifyMaskApp-1425"><span class="linenos">1425</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1426"><a href="#ModifyMaskApp-1426"><span class="linenos">1426</span></a>    <span class="c1">#Initiate canvas elements#</span>
</span><span id="ModifyMaskApp-1427"><a href="#ModifyMaskApp-1427"><span class="linenos">1427</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1428"><a href="#ModifyMaskApp-1428"><span class="linenos">1428</span></a>    
</span><span id="ModifyMaskApp-1429"><a href="#ModifyMaskApp-1429"><span class="linenos">1429</span></a>    <span class="k">def</span> <span class="nf">load_first_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1430"><a href="#ModifyMaskApp-1430"><span class="linenos">1430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1431"><a href="#ModifyMaskApp-1431"><span class="linenos">1431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp-1432"><a href="#ModifyMaskApp-1432"><span class="linenos">1432</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1433"><a href="#ModifyMaskApp-1433"><span class="linenos">1433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1434"><a href="#ModifyMaskApp-1434"><span class="linenos">1434</span></a>
</span><span id="ModifyMaskApp-1435"><a href="#ModifyMaskApp-1435"><span class="linenos">1435</span></a>    <span class="k">def</span> <span class="nf">setup_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1436"><a href="#ModifyMaskApp-1436"><span class="linenos">1436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1437"><a href="#ModifyMaskApp-1437"><span class="linenos">1437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1438"><a href="#ModifyMaskApp-1438"><span class="linenos">1438</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1439"><a href="#ModifyMaskApp-1439"><span class="linenos">1439</span></a>
</span><span id="ModifyMaskApp-1440"><a href="#ModifyMaskApp-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">initialize_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1441"><a href="#ModifyMaskApp-1441"><span class="linenos">1441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1442"><a href="#ModifyMaskApp-1442"><span class="linenos">1442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1443"><a href="#ModifyMaskApp-1443"><span class="linenos">1443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1444"><a href="#ModifyMaskApp-1444"><span class="linenos">1444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1445"><a href="#ModifyMaskApp-1445"><span class="linenos">1445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1446"><a href="#ModifyMaskApp-1446"><span class="linenos">1446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1447"><a href="#ModifyMaskApp-1447"><span class="linenos">1447</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1448"><a href="#ModifyMaskApp-1448"><span class="linenos">1448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1449"><a href="#ModifyMaskApp-1449"><span class="linenos">1449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1450"><a href="#ModifyMaskApp-1450"><span class="linenos">1450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1451"><a href="#ModifyMaskApp-1451"><span class="linenos">1451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp-1452"><a href="#ModifyMaskApp-1452"><span class="linenos">1452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1453"><a href="#ModifyMaskApp-1453"><span class="linenos">1453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1454"><a href="#ModifyMaskApp-1454"><span class="linenos">1454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1455"><a href="#ModifyMaskApp-1455"><span class="linenos">1455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1456"><a href="#ModifyMaskApp-1456"><span class="linenos">1456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1457"><a href="#ModifyMaskApp-1457"><span class="linenos">1457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp-1458"><a href="#ModifyMaskApp-1458"><span class="linenos">1458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1459"><a href="#ModifyMaskApp-1459"><span class="linenos">1459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1460"><a href="#ModifyMaskApp-1460"><span class="linenos">1460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;99.9&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1461"><a href="#ModifyMaskApp-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1462"><a href="#ModifyMaskApp-1462"><span class="linenos">1462</span></a>
</span><span id="ModifyMaskApp-1463"><a href="#ModifyMaskApp-1463"><span class="linenos">1463</span></a>    <span class="k">def</span> <span class="nf">update_mouse_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1464"><a href="#ModifyMaskApp-1464"><span class="linenos">1464</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-1465"><a href="#ModifyMaskApp-1465"><span class="linenos">1465</span></a>        <span class="n">intensity</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp-1466"><a href="#ModifyMaskApp-1466"><span class="linenos">1466</span></a>        <span class="n">mask_value</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp-1467"><a href="#ModifyMaskApp-1467"><span class="linenos">1467</span></a>        <span class="n">pixel_count</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>  
</span><span id="ModifyMaskApp-1468"><a href="#ModifyMaskApp-1468"><span class="linenos">1468</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1469"><a href="#ModifyMaskApp-1469"><span class="linenos">1469</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1470"><a href="#ModifyMaskApp-1470"><span class="linenos">1470</span></a>                <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp-1471"><a href="#ModifyMaskApp-1471"><span class="linenos">1471</span></a>                <span class="n">mask_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp-1472"><a href="#ModifyMaskApp-1472"><span class="linenos">1472</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1473"><a href="#ModifyMaskApp-1473"><span class="linenos">1473</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ModifyMaskApp-1474"><a href="#ModifyMaskApp-1474"><span class="linenos">1474</span></a>                <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1475"><a href="#ModifyMaskApp-1475"><span class="linenos">1475</span></a>                <span class="n">mask_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1476"><a href="#ModifyMaskApp-1476"><span class="linenos">1476</span></a>        <span class="k">if</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1477"><a href="#ModifyMaskApp-1477"><span class="linenos">1477</span></a>            <span class="n">pixel_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">mask_value</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1478"><a href="#ModifyMaskApp-1478"><span class="linenos">1478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Intensity: </span><span class="si">{</span><span class="n">intensity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1479"><a href="#ModifyMaskApp-1479"><span class="linenos">1479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mask: </span><span class="si">{</span><span class="n">mask_value</span><span class="si">}</span><span class="s2">, Area: </span><span class="si">{</span><span class="n">pixel_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1480"><a href="#ModifyMaskApp-1480"><span class="linenos">1480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mask: </span><span class="si">{</span><span class="n">mask_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1481"><a href="#ModifyMaskApp-1481"><span class="linenos">1481</span></a>        <span class="k">if</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1482"><a href="#ModifyMaskApp-1482"><span class="linenos">1482</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area: </span><span class="si">{</span><span class="n">pixel_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1483"><a href="#ModifyMaskApp-1483"><span class="linenos">1483</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1484"><a href="#ModifyMaskApp-1484"><span class="linenos">1484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Area: N/A&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1485"><a href="#ModifyMaskApp-1485"><span class="linenos">1485</span></a>    
</span><span id="ModifyMaskApp-1486"><a href="#ModifyMaskApp-1486"><span class="linenos">1486</span></a>    <span class="k">def</span> <span class="nf">setup_navigation_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1487"><a href="#ModifyMaskApp-1487"><span class="linenos">1487</span></a>        <span class="n">navigation_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1488"><a href="#ModifyMaskApp-1488"><span class="linenos">1488</span></a>        <span class="n">navigation_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1489"><a href="#ModifyMaskApp-1489"><span class="linenos">1489</span></a>        <span class="n">prev_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Previous&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_image</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1490"><a href="#ModifyMaskApp-1490"><span class="linenos">1490</span></a>        <span class="n">prev_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1491"><a href="#ModifyMaskApp-1491"><span class="linenos">1491</span></a>        <span class="n">next_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_image</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1492"><a href="#ModifyMaskApp-1492"><span class="linenos">1492</span></a>        <span class="n">next_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1493"><a href="#ModifyMaskApp-1493"><span class="linenos">1493</span></a>        <span class="n">save_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_mask</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1494"><a href="#ModifyMaskApp-1494"><span class="linenos">1494</span></a>        <span class="n">save_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1495"><a href="#ModifyMaskApp-1495"><span class="linenos">1495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Image: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1496"><a href="#ModifyMaskApp-1496"><span class="linenos">1496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1497"><a href="#ModifyMaskApp-1497"><span class="linenos">1497</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Mask: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1498"><a href="#ModifyMaskApp-1498"><span class="linenos">1498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1499"><a href="#ModifyMaskApp-1499"><span class="linenos">1499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Area: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1500"><a href="#ModifyMaskApp-1500"><span class="linenos">1500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1501"><a href="#ModifyMaskApp-1501"><span class="linenos">1501</span></a>
</span><span id="ModifyMaskApp-1502"><a href="#ModifyMaskApp-1502"><span class="linenos">1502</span></a>    <span class="k">def</span> <span class="nf">setup_mode_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1503"><a href="#ModifyMaskApp-1503"><span class="linenos">1503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1504"><a href="#ModifyMaskApp-1504"><span class="linenos">1504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1505"><a href="#ModifyMaskApp-1505"><span class="linenos">1505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_draw_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1506"><a href="#ModifyMaskApp-1506"><span class="linenos">1506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1507"><a href="#ModifyMaskApp-1507"><span class="linenos">1507</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_magic_wand_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1508"><a href="#ModifyMaskApp-1508"><span class="linenos">1508</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1509"><a href="#ModifyMaskApp-1509"><span class="linenos">1509</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Tolerance:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1510"><a href="#ModifyMaskApp-1510"><span class="linenos">1510</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1511"><a href="#ModifyMaskApp-1511"><span class="linenos">1511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1512"><a href="#ModifyMaskApp-1512"><span class="linenos">1512</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Max Pixels:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1513"><a href="#ModifyMaskApp-1513"><span class="linenos">1513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1514"><a href="#ModifyMaskApp-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1515"><a href="#ModifyMaskApp-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1516"><a href="#ModifyMaskApp-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_erase_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1517"><a href="#ModifyMaskApp-1517"><span class="linenos">1517</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1518"><a href="#ModifyMaskApp-1518"><span class="linenos">1518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_brush_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1519"><a href="#ModifyMaskApp-1519"><span class="linenos">1519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1520"><a href="#ModifyMaskApp-1520"><span class="linenos">1520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1521"><a href="#ModifyMaskApp-1521"><span class="linenos">1521</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1522"><a href="#ModifyMaskApp-1522"><span class="linenos">1522</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1523"><a href="#ModifyMaskApp-1523"><span class="linenos">1523</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush Size:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1524"><a href="#ModifyMaskApp-1524"><span class="linenos">1524</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_dividing_line_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1525"><a href="#ModifyMaskApp-1525"><span class="linenos">1525</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1526"><a href="#ModifyMaskApp-1526"><span class="linenos">1526</span></a>
</span><span id="ModifyMaskApp-1527"><a href="#ModifyMaskApp-1527"><span class="linenos">1527</span></a>    <span class="k">def</span> <span class="nf">setup_function_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1528"><a href="#ModifyMaskApp-1528"><span class="linenos">1528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1529"><a href="#ModifyMaskApp-1529"><span class="linenos">1529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1530"><a href="#ModifyMaskApp-1530"><span class="linenos">1530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Fill&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1531"><a href="#ModifyMaskApp-1531"><span class="linenos">1531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1532"><a href="#ModifyMaskApp-1532"><span class="linenos">1532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Relabel&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relabel_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1533"><a href="#ModifyMaskApp-1533"><span class="linenos">1533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1534"><a href="#ModifyMaskApp-1534"><span class="linenos">1534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Clear&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1535"><a href="#ModifyMaskApp-1535"><span class="linenos">1535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1536"><a href="#ModifyMaskApp-1536"><span class="linenos">1536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">invert_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Invert&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">invert_mask</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1537"><a href="#ModifyMaskApp-1537"><span class="linenos">1537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">invert_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1538"><a href="#ModifyMaskApp-1538"><span class="linenos">1538</span></a>        <span class="n">remove_small_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove Small&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_small_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1539"><a href="#ModifyMaskApp-1539"><span class="linenos">1539</span></a>        <span class="n">remove_small_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1540"><a href="#ModifyMaskApp-1540"><span class="linenos">1540</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Min Area:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1541"><a href="#ModifyMaskApp-1541"><span class="linenos">1541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1542"><a href="#ModifyMaskApp-1542"><span class="linenos">1542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>  <span class="c1"># Default minimum area</span>
</span><span id="ModifyMaskApp-1543"><a href="#ModifyMaskApp-1543"><span class="linenos">1543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1544"><a href="#ModifyMaskApp-1544"><span class="linenos">1544</span></a>
</span><span id="ModifyMaskApp-1545"><a href="#ModifyMaskApp-1545"><span class="linenos">1545</span></a>    <span class="k">def</span> <span class="nf">setup_zoom_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1546"><a href="#ModifyMaskApp-1546"><span class="linenos">1546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1547"><a href="#ModifyMaskApp-1547"><span class="linenos">1547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1548"><a href="#ModifyMaskApp-1548"><span class="linenos">1548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_zoom_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1549"><a href="#ModifyMaskApp-1549"><span class="linenos">1549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1550"><a href="#ModifyMaskApp-1550"><span class="linenos">1550</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply Normalization&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_normalization</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1551"><a href="#ModifyMaskApp-1551"><span class="linenos">1551</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1552"><a href="#ModifyMaskApp-1552"><span class="linenos">1552</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Lower Percentile:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1553"><a href="#ModifyMaskApp-1553"><span class="linenos">1553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1554"><a href="#ModifyMaskApp-1554"><span class="linenos">1554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1555"><a href="#ModifyMaskApp-1555"><span class="linenos">1555</span></a>        
</span><span id="ModifyMaskApp-1556"><a href="#ModifyMaskApp-1556"><span class="linenos">1556</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Upper Percentile:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1557"><a href="#ModifyMaskApp-1557"><span class="linenos">1557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1558"><a href="#ModifyMaskApp-1558"><span class="linenos">1558</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1559"><a href="#ModifyMaskApp-1559"><span class="linenos">1559</span></a>    
</span><span id="ModifyMaskApp-1560"><a href="#ModifyMaskApp-1560"><span class="linenos">1560</span></a>    <span class="k">def</span> <span class="nf">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1561"><a href="#ModifyMaskApp-1561"><span class="linenos">1561</span></a>        <span class="c1"># Load the image</span>
</span><span id="ModifyMaskApp-1562"><a href="#ModifyMaskApp-1562"><span class="linenos">1562</span></a>        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="ModifyMaskApp-1563"><a href="#ModifyMaskApp-1563"><span class="linenos">1563</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1564"><a href="#ModifyMaskApp-1564"><span class="linenos">1564</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Image shape: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, dtype: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1565"><a href="#ModifyMaskApp-1565"><span class="linenos">1565</span></a>
</span><span id="ModifyMaskApp-1566"><a href="#ModifyMaskApp-1566"><span class="linenos">1566</span></a>        <span class="c1"># Handle multi-channel or transparency issues</span>
</span><span id="ModifyMaskApp-1567"><a href="#ModifyMaskApp-1567"><span class="linenos">1567</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1568"><a href="#ModifyMaskApp-1568"><span class="linenos">1568</span></a>            <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># If the image has an alpha channel (RGBA)</span>
</span><span id="ModifyMaskApp-1569"><a href="#ModifyMaskApp-1569"><span class="linenos">1569</span></a>                <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Remove the alpha channel</span>
</span><span id="ModifyMaskApp-1570"><a href="#ModifyMaskApp-1570"><span class="linenos">1570</span></a>
</span><span id="ModifyMaskApp-1571"><a href="#ModifyMaskApp-1571"><span class="linenos">1571</span></a>            <span class="c1"># Convert RGB to grayscale using weighted average</span>
</span><span id="ModifyMaskApp-1572"><a href="#ModifyMaskApp-1572"><span class="linenos">1572</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2989</span><span class="p">,</span> <span class="mf">0.5870</span><span class="p">,</span> <span class="mf">0.1140</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1573"><a href="#ModifyMaskApp-1573"><span class="linenos">1573</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converted to grayscale: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1574"><a href="#ModifyMaskApp-1574"><span class="linenos">1574</span></a>
</span><span id="ModifyMaskApp-1575"><a href="#ModifyMaskApp-1575"><span class="linenos">1575</span></a>        <span class="c1"># Ensure the shape is (height, width) without extra channel</span>
</span><span id="ModifyMaskApp-1576"><a href="#ModifyMaskApp-1576"><span class="linenos">1576</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1577"><a href="#ModifyMaskApp-1577"><span class="linenos">1577</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1578"><a href="#ModifyMaskApp-1578"><span class="linenos">1578</span></a>
</span><span id="ModifyMaskApp-1579"><a href="#ModifyMaskApp-1579"><span class="linenos">1579</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1580"><a href="#ModifyMaskApp-1580"><span class="linenos">1580</span></a>            <span class="c1"># Scale the image to fit the 16-bit range (065535)</span>
</span><span id="ModifyMaskApp-1581"><a href="#ModifyMaskApp-1581"><span class="linenos">1581</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">/</span> <span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">65535</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1582"><a href="#ModifyMaskApp-1582"><span class="linenos">1582</span></a>            <span class="c1"># eventually remove this images should not have to be 16 bit look into downstream function (non 16bit images are jsut black)</span>
</span><span id="ModifyMaskApp-1583"><a href="#ModifyMaskApp-1583"><span class="linenos">1583</span></a>
</span><span id="ModifyMaskApp-1584"><a href="#ModifyMaskApp-1584"><span class="linenos">1584</span></a>        <span class="c1"># Load the corresponding mask</span>
</span><span id="ModifyMaskApp-1585"><a href="#ModifyMaskApp-1585"><span class="linenos">1585</span></a>        <span class="n">mask_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masks_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="ModifyMaskApp-1586"><a href="#ModifyMaskApp-1586"><span class="linenos">1586</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">mask_path</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1587"><a href="#ModifyMaskApp-1587"><span class="linenos">1587</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading mask: </span><span class="si">{</span><span class="n">mask_path</span><span class="si">}</span><span class="s1"> for image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1588"><a href="#ModifyMaskApp-1588"><span class="linenos">1588</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">mask_path</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1589"><a href="#ModifyMaskApp-1589"><span class="linenos">1589</span></a>
</span><span id="ModifyMaskApp-1590"><a href="#ModifyMaskApp-1590"><span class="linenos">1590</span></a>            <span class="c1"># Ensure mask is uint8</span>
</span><span id="ModifyMaskApp-1591"><a href="#ModifyMaskApp-1591"><span class="linenos">1591</span></a>            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1592"><a href="#ModifyMaskApp-1592"><span class="linenos">1592</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1593"><a href="#ModifyMaskApp-1593"><span class="linenos">1593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1594"><a href="#ModifyMaskApp-1594"><span class="linenos">1594</span></a>            <span class="c1"># Create a new mask with the same size as the image</span>
</span><span id="ModifyMaskApp-1595"><a href="#ModifyMaskApp-1595"><span class="linenos">1595</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1596"><a href="#ModifyMaskApp-1596"><span class="linenos">1596</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded new mask for image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1597"><a href="#ModifyMaskApp-1597"><span class="linenos">1597</span></a>
</span><span id="ModifyMaskApp-1598"><a href="#ModifyMaskApp-1598"><span class="linenos">1598</span></a>        <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span>
</span><span id="ModifyMaskApp-1599"><a href="#ModifyMaskApp-1599"><span class="linenos">1599</span></a>    
</span><span id="ModifyMaskApp-1600"><a href="#ModifyMaskApp-1600"><span class="linenos">1600</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1601"><a href="#ModifyMaskApp-1601"><span class="linenos">1601</span></a>    <span class="c1"># Image Display functions#</span>
</span><span id="ModifyMaskApp-1602"><a href="#ModifyMaskApp-1602"><span class="linenos">1602</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1603"><a href="#ModifyMaskApp-1603"><span class="linenos">1603</span></a>    <span class="k">def</span> <span class="nf">display_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1604"><a href="#ModifyMaskApp-1604"><span class="linenos">1604</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1605"><a href="#ModifyMaskApp-1605"><span class="linenos">1605</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1606"><a href="#ModifyMaskApp-1606"><span class="linenos">1606</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1607"><a href="#ModifyMaskApp-1607"><span class="linenos">1607</span></a>        <span class="n">lower_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="ModifyMaskApp-1608"><a href="#ModifyMaskApp-1608"><span class="linenos">1608</span></a>        <span class="n">upper_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">99.9</span>
</span><span id="ModifyMaskApp-1609"><a href="#ModifyMaskApp-1609"><span class="linenos">1609</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1610"><a href="#ModifyMaskApp-1610"><span class="linenos">1610</span></a>        <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_mask_on_image</span><span class="p">(</span><span class="n">normalized</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1611"><a href="#ModifyMaskApp-1611"><span class="linenos">1611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
</span><span id="ModifyMaskApp-1612"><a href="#ModifyMaskApp-1612"><span class="linenos">1612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;nw&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1613"><a href="#ModifyMaskApp-1613"><span class="linenos">1613</span></a>
</span><span id="ModifyMaskApp-1614"><a href="#ModifyMaskApp-1614"><span class="linenos">1614</span></a>    <span class="k">def</span> <span class="nf">display_zoomed_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1615"><a href="#ModifyMaskApp-1615"><span class="linenos">1615</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1616"><a href="#ModifyMaskApp-1616"><span class="linenos">1616</span></a>            <span class="c1"># Convert canvas coordinates to image coordinates</span>
</span><span id="ModifyMaskApp-1617"><a href="#ModifyMaskApp-1617"><span class="linenos">1617</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1618"><a href="#ModifyMaskApp-1618"><span class="linenos">1618</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1619"><a href="#ModifyMaskApp-1619"><span class="linenos">1619</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1620"><a href="#ModifyMaskApp-1620"><span class="linenos">1620</span></a>            <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1621"><a href="#ModifyMaskApp-1621"><span class="linenos">1621</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="n">x0</span>
</span><span id="ModifyMaskApp-1622"><a href="#ModifyMaskApp-1622"><span class="linenos">1622</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="n">y0</span>
</span><span id="ModifyMaskApp-1623"><a href="#ModifyMaskApp-1623"><span class="linenos">1623</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="n">x1</span>
</span><span id="ModifyMaskApp-1624"><a href="#ModifyMaskApp-1624"><span class="linenos">1624</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="ModifyMaskApp-1625"><a href="#ModifyMaskApp-1625"><span class="linenos">1625</span></a>            <span class="c1"># Normalize the entire image</span>
</span><span id="ModifyMaskApp-1626"><a href="#ModifyMaskApp-1626"><span class="linenos">1626</span></a>            <span class="n">lower_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="ModifyMaskApp-1627"><a href="#ModifyMaskApp-1627"><span class="linenos">1627</span></a>            <span class="n">upper_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">99.9</span>
</span><span id="ModifyMaskApp-1628"><a href="#ModifyMaskApp-1628"><span class="linenos">1628</span></a>            <span class="n">normalized_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1629"><a href="#ModifyMaskApp-1629"><span class="linenos">1629</span></a>            <span class="c1"># Extract the zoomed portion of the normalized image and mask</span>
</span><span id="ModifyMaskApp-1630"><a href="#ModifyMaskApp-1630"><span class="linenos">1630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="n">normalized_image</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1631"><a href="#ModifyMaskApp-1631"><span class="linenos">1631</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1632"><a href="#ModifyMaskApp-1632"><span class="linenos">1632</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1633"><a href="#ModifyMaskApp-1633"><span class="linenos">1633</span></a>            <span class="n">original_mask_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1634"><a href="#ModifyMaskApp-1634"><span class="linenos">1634</span></a>            <span class="n">zoom_mask_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1635"><a href="#ModifyMaskApp-1635"><span class="linenos">1635</span></a>            <span class="k">if</span> <span class="n">original_mask_area</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1636"><a href="#ModifyMaskApp-1636"><span class="linenos">1636</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span> <span class="o">=</span> <span class="n">original_mask_area</span><span class="o">/</span><span class="n">zoom_mask_area</span>
</span><span id="ModifyMaskApp-1637"><a href="#ModifyMaskApp-1637"><span class="linenos">1637</span></a>            <span class="c1"># Resize the zoomed image and mask to fit the canvas</span>
</span><span id="ModifyMaskApp-1638"><a href="#ModifyMaskApp-1638"><span class="linenos">1638</span></a>            <span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1639"><a href="#ModifyMaskApp-1639"><span class="linenos">1639</span></a>            <span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1640"><a href="#ModifyMaskApp-1640"><span class="linenos">1640</span></a>            
</span><span id="ModifyMaskApp-1641"><a href="#ModifyMaskApp-1641"><span class="linenos">1641</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">canvas_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">canvas_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1642"><a href="#ModifyMaskApp-1642"><span class="linenos">1642</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1643"><a href="#ModifyMaskApp-1643"><span class="linenos">1643</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1644"><a href="#ModifyMaskApp-1644"><span class="linenos">1644</span></a>                <span class="c1">#self.zoom_mask = resize(self.zoom_mask, (canvas_height, canvas_width), preserve_range=True).astype(np.uint8)</span>
</span><span id="ModifyMaskApp-1645"><a href="#ModifyMaskApp-1645"><span class="linenos">1645</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1646"><a href="#ModifyMaskApp-1646"><span class="linenos">1646</span></a>                <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_mask_on_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1647"><a href="#ModifyMaskApp-1647"><span class="linenos">1647</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
</span><span id="ModifyMaskApp-1648"><a href="#ModifyMaskApp-1648"><span class="linenos">1648</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;nw&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1649"><a href="#ModifyMaskApp-1649"><span class="linenos">1649</span></a>
</span><span id="ModifyMaskApp-1650"><a href="#ModifyMaskApp-1650"><span class="linenos">1650</span></a>    <span class="k">def</span> <span class="nf">overlay_mask_on_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1651"><a href="#ModifyMaskApp-1651"><span class="linenos">1651</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1652"><a href="#ModifyMaskApp-1652"><span class="linenos">1652</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">image</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1653"><a href="#ModifyMaskApp-1653"><span class="linenos">1653</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1654"><a href="#ModifyMaskApp-1654"><span class="linenos">1654</span></a>        <span class="n">max_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1655"><a href="#ModifyMaskApp-1655"><span class="linenos">1655</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1656"><a href="#ModifyMaskApp-1656"><span class="linenos">1656</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">max_label</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1657"><a href="#ModifyMaskApp-1657"><span class="linenos">1657</span></a>        <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># background color</span>
</span><span id="ModifyMaskApp-1658"><a href="#ModifyMaskApp-1658"><span class="linenos">1658</span></a>        <span class="n">colored_mask</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1659"><a href="#ModifyMaskApp-1659"><span class="linenos">1659</span></a>        <span class="n">image_8bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">/</span> <span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1660"><a href="#ModifyMaskApp-1660"><span class="linenos">1660</span></a>        <span class="c1"># Blend the mask and the image with transparency</span>
</span><span id="ModifyMaskApp-1661"><a href="#ModifyMaskApp-1661"><span class="linenos">1661</span></a>        <span class="n">combined_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> 
</span><span id="ModifyMaskApp-1662"><a href="#ModifyMaskApp-1662"><span class="linenos">1662</span></a>                                  <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image_8bit</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">colored_mask</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> 
</span><span id="ModifyMaskApp-1663"><a href="#ModifyMaskApp-1663"><span class="linenos">1663</span></a>                                  <span class="n">image_8bit</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1664"><a href="#ModifyMaskApp-1664"><span class="linenos">1664</span></a>        <span class="c1"># Convert the final image back to uint8</span>
</span><span id="ModifyMaskApp-1665"><a href="#ModifyMaskApp-1665"><span class="linenos">1665</span></a>        <span class="n">combined_image</span> <span class="o">=</span> <span class="n">combined_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1666"><a href="#ModifyMaskApp-1666"><span class="linenos">1666</span></a>        <span class="k">return</span> <span class="n">combined_image</span>
</span><span id="ModifyMaskApp-1667"><a href="#ModifyMaskApp-1667"><span class="linenos">1667</span></a>    
</span><span id="ModifyMaskApp-1668"><a href="#ModifyMaskApp-1668"><span class="linenos">1668</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1669"><a href="#ModifyMaskApp-1669"><span class="linenos">1669</span></a>    <span class="c1"># Navigation functions#</span>
</span><span id="ModifyMaskApp-1670"><a href="#ModifyMaskApp-1670"><span class="linenos">1670</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1671"><a href="#ModifyMaskApp-1671"><span class="linenos">1671</span></a>    
</span><span id="ModifyMaskApp-1672"><a href="#ModifyMaskApp-1672"><span class="linenos">1672</span></a>    <span class="k">def</span> <span class="nf">previous_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1673"><a href="#ModifyMaskApp-1673"><span class="linenos">1673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1674"><a href="#ModifyMaskApp-1674"><span class="linenos">1674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp-1675"><a href="#ModifyMaskApp-1675"><span class="linenos">1675</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>            
</span><span id="ModifyMaskApp-1676"><a href="#ModifyMaskApp-1676"><span class="linenos">1676</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1677"><a href="#ModifyMaskApp-1677"><span class="linenos">1677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp-1678"><a href="#ModifyMaskApp-1678"><span class="linenos">1678</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1679"><a href="#ModifyMaskApp-1679"><span class="linenos">1679</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1680"><a href="#ModifyMaskApp-1680"><span class="linenos">1680</span></a>
</span><span id="ModifyMaskApp-1681"><a href="#ModifyMaskApp-1681"><span class="linenos">1681</span></a>    <span class="k">def</span> <span class="nf">next_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1682"><a href="#ModifyMaskApp-1682"><span class="linenos">1682</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1683"><a href="#ModifyMaskApp-1683"><span class="linenos">1683</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp-1684"><a href="#ModifyMaskApp-1684"><span class="linenos">1684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>            
</span><span id="ModifyMaskApp-1685"><a href="#ModifyMaskApp-1685"><span class="linenos">1685</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1686"><a href="#ModifyMaskApp-1686"><span class="linenos">1686</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp-1687"><a href="#ModifyMaskApp-1687"><span class="linenos">1687</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1688"><a href="#ModifyMaskApp-1688"><span class="linenos">1688</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1689"><a href="#ModifyMaskApp-1689"><span class="linenos">1689</span></a>            
</span><span id="ModifyMaskApp-1690"><a href="#ModifyMaskApp-1690"><span class="linenos">1690</span></a>    <span class="k">def</span> <span class="nf">save_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1691"><a href="#ModifyMaskApp-1691"><span class="linenos">1691</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1692"><a href="#ModifyMaskApp-1692"><span class="linenos">1692</span></a>            <span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span>
</span><span id="ModifyMaskApp-1693"><a href="#ModifyMaskApp-1693"><span class="linenos">1693</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">original_size</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1694"><a href="#ModifyMaskApp-1694"><span class="linenos">1694</span></a>                <span class="n">resized_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">original_size</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1695"><a href="#ModifyMaskApp-1695"><span class="linenos">1695</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1696"><a href="#ModifyMaskApp-1696"><span class="linenos">1696</span></a>                <span class="n">resized_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
</span><span id="ModifyMaskApp-1697"><a href="#ModifyMaskApp-1697"><span class="linenos">1697</span></a>            <span class="n">resized_mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">resized_mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1698"><a href="#ModifyMaskApp-1698"><span class="linenos">1698</span></a>            <span class="n">save_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1699"><a href="#ModifyMaskApp-1699"><span class="linenos">1699</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_folder</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1700"><a href="#ModifyMaskApp-1700"><span class="linenos">1700</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_folder</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1701"><a href="#ModifyMaskApp-1701"><span class="linenos">1701</span></a>            <span class="n">image_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span>
</span><span id="ModifyMaskApp-1702"><a href="#ModifyMaskApp-1702"><span class="linenos">1702</span></a>            <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_folder</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1703"><a href="#ModifyMaskApp-1703"><span class="linenos">1703</span></a>
</span><span id="ModifyMaskApp-1704"><a href="#ModifyMaskApp-1704"><span class="linenos">1704</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving mask to: </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Debug print</span>
</span><span id="ModifyMaskApp-1705"><a href="#ModifyMaskApp-1705"><span class="linenos">1705</span></a>            <span class="n">imageio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1706"><a href="#ModifyMaskApp-1706"><span class="linenos">1706</span></a>
</span><span id="ModifyMaskApp-1707"><a href="#ModifyMaskApp-1707"><span class="linenos">1707</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1708"><a href="#ModifyMaskApp-1708"><span class="linenos">1708</span></a>    <span class="c1"># Zoom Functions #</span>
</span><span id="ModifyMaskApp-1709"><a href="#ModifyMaskApp-1709"><span class="linenos">1709</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1710"><a href="#ModifyMaskApp-1710"><span class="linenos">1710</span></a>    <span class="k">def</span> <span class="nf">set_zoom_rectangle_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1711"><a href="#ModifyMaskApp-1711"><span class="linenos">1711</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1712"><a href="#ModifyMaskApp-1712"><span class="linenos">1712</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1713"><a href="#ModifyMaskApp-1713"><span class="linenos">1713</span></a>    
</span><span id="ModifyMaskApp-1714"><a href="#ModifyMaskApp-1714"><span class="linenos">1714</span></a>    <span class="k">def</span> <span class="nf">set_zoom_rectangle_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1715"><a href="#ModifyMaskApp-1715"><span class="linenos">1715</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1716"><a href="#ModifyMaskApp-1716"><span class="linenos">1716</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1717"><a href="#ModifyMaskApp-1717"><span class="linenos">1717</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1718"><a href="#ModifyMaskApp-1718"><span class="linenos">1718</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1719"><a href="#ModifyMaskApp-1719"><span class="linenos">1719</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1720"><a href="#ModifyMaskApp-1720"><span class="linenos">1720</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_zoomed_image</span><span class="p">()</span>  
</span><span id="ModifyMaskApp-1721"><a href="#ModifyMaskApp-1721"><span class="linenos">1721</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>  
</span><span id="ModifyMaskApp-1722"><a href="#ModifyMaskApp-1722"><span class="linenos">1722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1723"><a href="#ModifyMaskApp-1723"><span class="linenos">1723</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>  
</span><span id="ModifyMaskApp-1724"><a href="#ModifyMaskApp-1724"><span class="linenos">1724</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1725"><a href="#ModifyMaskApp-1725"><span class="linenos">1725</span></a>            
</span><span id="ModifyMaskApp-1726"><a href="#ModifyMaskApp-1726"><span class="linenos">1726</span></a>    <span class="k">def</span> <span class="nf">update_zoom_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1727"><a href="#ModifyMaskApp-1727"><span class="linenos">1727</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1728"><a href="#ModifyMaskApp-1728"><span class="linenos">1728</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1729"><a href="#ModifyMaskApp-1729"><span class="linenos">1729</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1730"><a href="#ModifyMaskApp-1730"><span class="linenos">1730</span></a>            <span class="c1"># Assuming event.x and event.y are already in image coordinates</span>
</span><span id="ModifyMaskApp-1731"><a href="#ModifyMaskApp-1731"><span class="linenos">1731</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1732"><a href="#ModifyMaskApp-1732"><span class="linenos">1732</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span>
</span><span id="ModifyMaskApp-1733"><a href="#ModifyMaskApp-1733"><span class="linenos">1733</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span>
</span><span id="ModifyMaskApp-1734"><a href="#ModifyMaskApp-1734"><span class="linenos">1734</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1735"><a href="#ModifyMaskApp-1735"><span class="linenos">1735</span></a>    
</span><span id="ModifyMaskApp-1736"><a href="#ModifyMaskApp-1736"><span class="linenos">1736</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1737"><a href="#ModifyMaskApp-1737"><span class="linenos">1737</span></a>    <span class="c1"># Mode activation#</span>
</span><span id="ModifyMaskApp-1738"><a href="#ModifyMaskApp-1738"><span class="linenos">1738</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1739"><a href="#ModifyMaskApp-1739"><span class="linenos">1739</span></a>    
</span><span id="ModifyMaskApp-1740"><a href="#ModifyMaskApp-1740"><span class="linenos">1740</span></a>    <span class="k">def</span> <span class="nf">toggle_zoom_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1741"><a href="#ModifyMaskApp-1741"><span class="linenos">1741</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1742"><a href="#ModifyMaskApp-1742"><span class="linenos">1742</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1743"><a href="#ModifyMaskApp-1743"><span class="linenos">1743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1744"><a href="#ModifyMaskApp-1744"><span class="linenos">1744</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1745"><a href="#ModifyMaskApp-1745"><span class="linenos">1745</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1746"><a href="#ModifyMaskApp-1746"><span class="linenos">1746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1747"><a href="#ModifyMaskApp-1747"><span class="linenos">1747</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ModifyMaskApp-1748"><a href="#ModifyMaskApp-1748"><span class="linenos">1748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1749"><a href="#ModifyMaskApp-1749"><span class="linenos">1749</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1750"><a href="#ModifyMaskApp-1750"><span class="linenos">1750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1751"><a href="#ModifyMaskApp-1751"><span class="linenos">1751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1752"><a href="#ModifyMaskApp-1752"><span class="linenos">1752</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1753"><a href="#ModifyMaskApp-1753"><span class="linenos">1753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1754"><a href="#ModifyMaskApp-1754"><span class="linenos">1754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1755"><a href="#ModifyMaskApp-1755"><span class="linenos">1755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1756"><a href="#ModifyMaskApp-1756"><span class="linenos">1756</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1757"><a href="#ModifyMaskApp-1757"><span class="linenos">1757</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1758"><a href="#ModifyMaskApp-1758"><span class="linenos">1758</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1759"><a href="#ModifyMaskApp-1759"><span class="linenos">1759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1760"><a href="#ModifyMaskApp-1760"><span class="linenos">1760</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1761"><a href="#ModifyMaskApp-1761"><span class="linenos">1761</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_start</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1762"><a href="#ModifyMaskApp-1762"><span class="linenos">1762</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_end</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1763"><a href="#ModifyMaskApp-1763"><span class="linenos">1763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_zoom_box</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1764"><a href="#ModifyMaskApp-1764"><span class="linenos">1764</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1765"><a href="#ModifyMaskApp-1765"><span class="linenos">1765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1766"><a href="#ModifyMaskApp-1766"><span class="linenos">1766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1767"><a href="#ModifyMaskApp-1767"><span class="linenos">1767</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1768"><a href="#ModifyMaskApp-1768"><span class="linenos">1768</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1769"><a href="#ModifyMaskApp-1769"><span class="linenos">1769</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1770"><a href="#ModifyMaskApp-1770"><span class="linenos">1770</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1771"><a href="#ModifyMaskApp-1771"><span class="linenos">1771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1772"><a href="#ModifyMaskApp-1772"><span class="linenos">1772</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1773"><a href="#ModifyMaskApp-1773"><span class="linenos">1773</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1774"><a href="#ModifyMaskApp-1774"><span class="linenos">1774</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1775"><a href="#ModifyMaskApp-1775"><span class="linenos">1775</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1776"><a href="#ModifyMaskApp-1776"><span class="linenos">1776</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1777"><a href="#ModifyMaskApp-1777"><span class="linenos">1777</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1778"><a href="#ModifyMaskApp-1778"><span class="linenos">1778</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1779"><a href="#ModifyMaskApp-1779"><span class="linenos">1779</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1780"><a href="#ModifyMaskApp-1780"><span class="linenos">1780</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1781"><a href="#ModifyMaskApp-1781"><span class="linenos">1781</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1782"><a href="#ModifyMaskApp-1782"><span class="linenos">1782</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1783"><a href="#ModifyMaskApp-1783"><span class="linenos">1783</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1784"><a href="#ModifyMaskApp-1784"><span class="linenos">1784</span></a>
</span><span id="ModifyMaskApp-1785"><a href="#ModifyMaskApp-1785"><span class="linenos">1785</span></a>    <span class="k">def</span> <span class="nf">toggle_brush_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1786"><a href="#ModifyMaskApp-1786"><span class="linenos">1786</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span>
</span><span id="ModifyMaskApp-1787"><a href="#ModifyMaskApp-1787"><span class="linenos">1787</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1788"><a href="#ModifyMaskApp-1788"><span class="linenos">1788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1789"><a href="#ModifyMaskApp-1789"><span class="linenos">1789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1790"><a href="#ModifyMaskApp-1790"><span class="linenos">1790</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1791"><a href="#ModifyMaskApp-1791"><span class="linenos">1791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1792"><a href="#ModifyMaskApp-1792"><span class="linenos">1792</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1793"><a href="#ModifyMaskApp-1793"><span class="linenos">1793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1794"><a href="#ModifyMaskApp-1794"><span class="linenos">1794</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1795"><a href="#ModifyMaskApp-1795"><span class="linenos">1795</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1796"><a href="#ModifyMaskApp-1796"><span class="linenos">1796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1797"><a href="#ModifyMaskApp-1797"><span class="linenos">1797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1798"><a href="#ModifyMaskApp-1798"><span class="linenos">1798</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_brush</span><span class="p">)</span>  <span class="c1"># Left click and drag to apply brush</span>
</span><span id="ModifyMaskApp-1799"><a href="#ModifyMaskApp-1799"><span class="linenos">1799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_brush</span><span class="p">)</span>  <span class="c1"># Right click and drag to erase with brush</span>
</span><span id="ModifyMaskApp-1800"><a href="#ModifyMaskApp-1800"><span class="linenos">1800</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_brush_release</span><span class="p">)</span>  <span class="c1"># Left button release</span>
</span><span id="ModifyMaskApp-1801"><a href="#ModifyMaskApp-1801"><span class="linenos">1801</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_brush_release</span><span class="p">)</span>  <span class="c1"># Right button release</span>
</span><span id="ModifyMaskApp-1802"><a href="#ModifyMaskApp-1802"><span class="linenos">1802</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1803"><a href="#ModifyMaskApp-1803"><span class="linenos">1803</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1804"><a href="#ModifyMaskApp-1804"><span class="linenos">1804</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1805"><a href="#ModifyMaskApp-1805"><span class="linenos">1805</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1806"><a href="#ModifyMaskApp-1806"><span class="linenos">1806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1807"><a href="#ModifyMaskApp-1807"><span class="linenos">1807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1808"><a href="#ModifyMaskApp-1808"><span class="linenos">1808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1809"><a href="#ModifyMaskApp-1809"><span class="linenos">1809</span></a>
</span><span id="ModifyMaskApp-1810"><a href="#ModifyMaskApp-1810"><span class="linenos">1810</span></a>    <span class="k">def</span> <span class="nf">image_to_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_image</span><span class="p">,</span> <span class="n">y_image</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1811"><a href="#ModifyMaskApp-1811"><span class="linenos">1811</span></a>        <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scaling_factors</span><span class="p">(</span>
</span><span id="ModifyMaskApp-1812"><a href="#ModifyMaskApp-1812"><span class="linenos">1812</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="ModifyMaskApp-1813"><a href="#ModifyMaskApp-1813"><span class="linenos">1813</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span>
</span><span id="ModifyMaskApp-1814"><a href="#ModifyMaskApp-1814"><span class="linenos">1814</span></a>        <span class="p">)</span>
</span><span id="ModifyMaskApp-1815"><a href="#ModifyMaskApp-1815"><span class="linenos">1815</span></a>        <span class="n">x_canvas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_image</span> <span class="o">/</span> <span class="n">x_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1816"><a href="#ModifyMaskApp-1816"><span class="linenos">1816</span></a>        <span class="n">y_canvas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_image</span> <span class="o">/</span> <span class="n">y_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1817"><a href="#ModifyMaskApp-1817"><span class="linenos">1817</span></a>        <span class="k">return</span> <span class="n">x_canvas</span><span class="p">,</span> <span class="n">y_canvas</span>
</span><span id="ModifyMaskApp-1818"><a href="#ModifyMaskApp-1818"><span class="linenos">1818</span></a>
</span><span id="ModifyMaskApp-1819"><a href="#ModifyMaskApp-1819"><span class="linenos">1819</span></a>    <span class="k">def</span> <span class="nf">toggle_dividing_line_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1820"><a href="#ModifyMaskApp-1820"><span class="linenos">1820</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span>
</span><span id="ModifyMaskApp-1821"><a href="#ModifyMaskApp-1821"><span class="linenos">1821</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1822"><a href="#ModifyMaskApp-1822"><span class="linenos">1822</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1823"><a href="#ModifyMaskApp-1823"><span class="linenos">1823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1824"><a href="#ModifyMaskApp-1824"><span class="linenos">1824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1825"><a href="#ModifyMaskApp-1825"><span class="linenos">1825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1826"><a href="#ModifyMaskApp-1826"><span class="linenos">1826</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1827"><a href="#ModifyMaskApp-1827"><span class="linenos">1827</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1828"><a href="#ModifyMaskApp-1828"><span class="linenos">1828</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1829"><a href="#ModifyMaskApp-1829"><span class="linenos">1829</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1830"><a href="#ModifyMaskApp-1830"><span class="linenos">1830</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1831"><a href="#ModifyMaskApp-1831"><span class="linenos">1831</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1832"><a href="#ModifyMaskApp-1832"><span class="linenos">1832</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1833"><a href="#ModifyMaskApp-1833"><span class="linenos">1833</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1834"><a href="#ModifyMaskApp-1834"><span class="linenos">1834</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_dividing_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1835"><a href="#ModifyMaskApp-1835"><span class="linenos">1835</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">finish_dividing_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1836"><a href="#ModifyMaskApp-1836"><span class="linenos">1836</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dividing_line_preview</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1837"><a href="#ModifyMaskApp-1837"><span class="linenos">1837</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1838"><a href="#ModifyMaskApp-1838"><span class="linenos">1838</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dividing Line Mode: OFF&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1839"><a href="#ModifyMaskApp-1839"><span class="linenos">1839</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1840"><a href="#ModifyMaskApp-1840"><span class="linenos">1840</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1841"><a href="#ModifyMaskApp-1841"><span class="linenos">1841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1842"><a href="#ModifyMaskApp-1842"><span class="linenos">1842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1843"><a href="#ModifyMaskApp-1843"><span class="linenos">1843</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1844"><a href="#ModifyMaskApp-1844"><span class="linenos">1844</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1845"><a href="#ModifyMaskApp-1845"><span class="linenos">1845</span></a>
</span><span id="ModifyMaskApp-1846"><a href="#ModifyMaskApp-1846"><span class="linenos">1846</span></a>    <span class="k">def</span> <span class="nf">start_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1847"><a href="#ModifyMaskApp-1847"><span class="linenos">1847</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1848"><a href="#ModifyMaskApp-1848"><span class="linenos">1848</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
</span><span id="ModifyMaskApp-1849"><a href="#ModifyMaskApp-1849"><span class="linenos">1849</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1850"><a href="#ModifyMaskApp-1850"><span class="linenos">1850</span></a>
</span><span id="ModifyMaskApp-1851"><a href="#ModifyMaskApp-1851"><span class="linenos">1851</span></a>    <span class="k">def</span> <span class="nf">finish_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1852"><a href="#ModifyMaskApp-1852"><span class="linenos">1852</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1853"><a href="#ModifyMaskApp-1853"><span class="linenos">1853</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="ModifyMaskApp-1854"><a href="#ModifyMaskApp-1854"><span class="linenos">1854</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1855"><a href="#ModifyMaskApp-1855"><span class="linenos">1855</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1856"><a href="#ModifyMaskApp-1856"><span class="linenos">1856</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_dividing_line</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1857"><a href="#ModifyMaskApp-1857"><span class="linenos">1857</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1858"><a href="#ModifyMaskApp-1858"><span class="linenos">1858</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp-1859"><a href="#ModifyMaskApp-1859"><span class="linenos">1859</span></a>
</span><span id="ModifyMaskApp-1860"><a href="#ModifyMaskApp-1860"><span class="linenos">1860</span></a>    <span class="k">def</span> <span class="nf">update_dividing_line_preview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1861"><a href="#ModifyMaskApp-1861"><span class="linenos">1861</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1862"><a href="#ModifyMaskApp-1862"><span class="linenos">1862</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-1863"><a href="#ModifyMaskApp-1863"><span class="linenos">1863</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1864"><a href="#ModifyMaskApp-1864"><span class="linenos">1864</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1865"><a href="#ModifyMaskApp-1865"><span class="linenos">1865</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="ModifyMaskApp-1866"><a href="#ModifyMaskApp-1866"><span class="linenos">1866</span></a>            <span class="n">canvas_coords</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_to_canvas</span><span class="p">(</span><span class="o">*</span><span class="n">pt</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1867"><a href="#ModifyMaskApp-1867"><span class="linenos">1867</span></a>            <span class="n">flat_canvas_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">canvas_coords</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">pt</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1868"><a href="#ModifyMaskApp-1868"><span class="linenos">1868</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span><span class="p">,</span> <span class="o">*</span><span class="n">flat_canvas_coords</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1869"><a href="#ModifyMaskApp-1869"><span class="linenos">1869</span></a>
</span><span id="ModifyMaskApp-1870"><a href="#ModifyMaskApp-1870"><span class="linenos">1870</span></a>    <span class="k">def</span> <span class="nf">apply_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1871"><a href="#ModifyMaskApp-1871"><span class="linenos">1871</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1872"><a href="#ModifyMaskApp-1872"><span class="linenos">1872</span></a>            <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span>
</span><span id="ModifyMaskApp-1873"><a href="#ModifyMaskApp-1873"><span class="linenos">1873</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1874"><a href="#ModifyMaskApp-1874"><span class="linenos">1874</span></a>                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
</span><span id="ModifyMaskApp-1875"><a href="#ModifyMaskApp-1875"><span class="linenos">1875</span></a>
</span><span id="ModifyMaskApp-1876"><a href="#ModifyMaskApp-1876"><span class="linenos">1876</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp-1877"><a href="#ModifyMaskApp-1877"><span class="linenos">1877</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
</span><span id="ModifyMaskApp-1878"><a href="#ModifyMaskApp-1878"><span class="linenos">1878</span></a>                <span class="n">line_rr</span><span class="p">,</span> <span class="n">line_cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1879"><a href="#ModifyMaskApp-1879"><span class="linenos">1879</span></a>                <span class="n">rr</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_rr</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1880"><a href="#ModifyMaskApp-1880"><span class="linenos">1880</span></a>                <span class="n">cc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_cc</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1881"><a href="#ModifyMaskApp-1881"><span class="linenos">1881</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1882"><a href="#ModifyMaskApp-1882"><span class="linenos">1882</span></a>
</span><span id="ModifyMaskApp-1883"><a href="#ModifyMaskApp-1883"><span class="linenos">1883</span></a>            <span class="n">mask_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1884"><a href="#ModifyMaskApp-1884"><span class="linenos">1884</span></a>
</span><span id="ModifyMaskApp-1885"><a href="#ModifyMaskApp-1885"><span class="linenos">1885</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1886"><a href="#ModifyMaskApp-1886"><span class="linenos">1886</span></a>                <span class="c1"># Update the zoomed mask</span>
</span><span id="ModifyMaskApp-1887"><a href="#ModifyMaskApp-1887"><span class="linenos">1887</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-1888"><a href="#ModifyMaskApp-1888"><span class="linenos">1888</span></a>                <span class="c1"># Reflect changes to the original mask</span>
</span><span id="ModifyMaskApp-1889"><a href="#ModifyMaskApp-1889"><span class="linenos">1889</span></a>                <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="ModifyMaskApp-1890"><a href="#ModifyMaskApp-1890"><span class="linenos">1890</span></a>                <span class="n">zoomed_mask_resized_back</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1891"><a href="#ModifyMaskApp-1891"><span class="linenos">1891</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_mask_resized_back</span>
</span><span id="ModifyMaskApp-1892"><a href="#ModifyMaskApp-1892"><span class="linenos">1892</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1893"><a href="#ModifyMaskApp-1893"><span class="linenos">1893</span></a>                <span class="c1"># Directly update the original mask</span>
</span><span id="ModifyMaskApp-1894"><a href="#ModifyMaskApp-1894"><span class="linenos">1894</span></a>                <span class="n">mask_copy</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-1895"><a href="#ModifyMaskApp-1895"><span class="linenos">1895</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask_copy</span>
</span><span id="ModifyMaskApp-1896"><a href="#ModifyMaskApp-1896"><span class="linenos">1896</span></a>
</span><span id="ModifyMaskApp-1897"><a href="#ModifyMaskApp-1897"><span class="linenos">1897</span></a>            <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1898"><a href="#ModifyMaskApp-1898"><span class="linenos">1898</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="ModifyMaskApp-1899"><a href="#ModifyMaskApp-1899"><span class="linenos">1899</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1900"><a href="#ModifyMaskApp-1900"><span class="linenos">1900</span></a>
</span><span id="ModifyMaskApp-1901"><a href="#ModifyMaskApp-1901"><span class="linenos">1901</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp-1902"><a href="#ModifyMaskApp-1902"><span class="linenos">1902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1903"><a href="#ModifyMaskApp-1903"><span class="linenos">1903</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1904"><a href="#ModifyMaskApp-1904"><span class="linenos">1904</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1905"><a href="#ModifyMaskApp-1905"><span class="linenos">1905</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1906"><a href="#ModifyMaskApp-1906"><span class="linenos">1906</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1907"><a href="#ModifyMaskApp-1907"><span class="linenos">1907</span></a>
</span><span id="ModifyMaskApp-1908"><a href="#ModifyMaskApp-1908"><span class="linenos">1908</span></a>    <span class="k">def</span> <span class="nf">toggle_draw_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1909"><a href="#ModifyMaskApp-1909"><span class="linenos">1909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span>
</span><span id="ModifyMaskApp-1910"><a href="#ModifyMaskApp-1910"><span class="linenos">1910</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1911"><a href="#ModifyMaskApp-1911"><span class="linenos">1911</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1912"><a href="#ModifyMaskApp-1912"><span class="linenos">1912</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1913"><a href="#ModifyMaskApp-1913"><span class="linenos">1913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1914"><a href="#ModifyMaskApp-1914"><span class="linenos">1914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1915"><a href="#ModifyMaskApp-1915"><span class="linenos">1915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1916"><a href="#ModifyMaskApp-1916"><span class="linenos">1916</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1917"><a href="#ModifyMaskApp-1917"><span class="linenos">1917</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1918"><a href="#ModifyMaskApp-1918"><span class="linenos">1918</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1919"><a href="#ModifyMaskApp-1919"><span class="linenos">1919</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1920"><a href="#ModifyMaskApp-1920"><span class="linenos">1920</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1921"><a href="#ModifyMaskApp-1921"><span class="linenos">1921</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1922"><a href="#ModifyMaskApp-1922"><span class="linenos">1922</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp-1923"><a href="#ModifyMaskApp-1923"><span class="linenos">1923</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1924"><a href="#ModifyMaskApp-1924"><span class="linenos">1924</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1925"><a href="#ModifyMaskApp-1925"><span class="linenos">1925</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1926"><a href="#ModifyMaskApp-1926"><span class="linenos">1926</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">finish_drawing</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1927"><a href="#ModifyMaskApp-1927"><span class="linenos">1927</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1928"><a href="#ModifyMaskApp-1928"><span class="linenos">1928</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1929"><a href="#ModifyMaskApp-1929"><span class="linenos">1929</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1930"><a href="#ModifyMaskApp-1930"><span class="linenos">1930</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1931"><a href="#ModifyMaskApp-1931"><span class="linenos">1931</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1932"><a href="#ModifyMaskApp-1932"><span class="linenos">1932</span></a>            
</span><span id="ModifyMaskApp-1933"><a href="#ModifyMaskApp-1933"><span class="linenos">1933</span></a>    <span class="k">def</span> <span class="nf">toggle_magic_wand_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1934"><a href="#ModifyMaskApp-1934"><span class="linenos">1934</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span>
</span><span id="ModifyMaskApp-1935"><a href="#ModifyMaskApp-1935"><span class="linenos">1935</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1936"><a href="#ModifyMaskApp-1936"><span class="linenos">1936</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1937"><a href="#ModifyMaskApp-1937"><span class="linenos">1937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1938"><a href="#ModifyMaskApp-1938"><span class="linenos">1938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1939"><a href="#ModifyMaskApp-1939"><span class="linenos">1939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1940"><a href="#ModifyMaskApp-1940"><span class="linenos">1940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1941"><a href="#ModifyMaskApp-1941"><span class="linenos">1941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1942"><a href="#ModifyMaskApp-1942"><span class="linenos">1942</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1943"><a href="#ModifyMaskApp-1943"><span class="linenos">1943</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1944"><a href="#ModifyMaskApp-1944"><span class="linenos">1944</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1945"><a href="#ModifyMaskApp-1945"><span class="linenos">1945</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1946"><a href="#ModifyMaskApp-1946"><span class="linenos">1946</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1947"><a href="#ModifyMaskApp-1947"><span class="linenos">1947</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_magic_wand</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1948"><a href="#ModifyMaskApp-1948"><span class="linenos">1948</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_magic_wand</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1949"><a href="#ModifyMaskApp-1949"><span class="linenos">1949</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1950"><a href="#ModifyMaskApp-1950"><span class="linenos">1950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1951"><a href="#ModifyMaskApp-1951"><span class="linenos">1951</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1952"><a href="#ModifyMaskApp-1952"><span class="linenos">1952</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1953"><a href="#ModifyMaskApp-1953"><span class="linenos">1953</span></a>            
</span><span id="ModifyMaskApp-1954"><a href="#ModifyMaskApp-1954"><span class="linenos">1954</span></a>    <span class="k">def</span> <span class="nf">toggle_erase_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1955"><a href="#ModifyMaskApp-1955"><span class="linenos">1955</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span>
</span><span id="ModifyMaskApp-1956"><a href="#ModifyMaskApp-1956"><span class="linenos">1956</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1957"><a href="#ModifyMaskApp-1957"><span class="linenos">1957</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1958"><a href="#ModifyMaskApp-1958"><span class="linenos">1958</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1959"><a href="#ModifyMaskApp-1959"><span class="linenos">1959</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1960"><a href="#ModifyMaskApp-1960"><span class="linenos">1960</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1961"><a href="#ModifyMaskApp-1961"><span class="linenos">1961</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1962"><a href="#ModifyMaskApp-1962"><span class="linenos">1962</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1963"><a href="#ModifyMaskApp-1963"><span class="linenos">1963</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_object</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1964"><a href="#ModifyMaskApp-1964"><span class="linenos">1964</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1965"><a href="#ModifyMaskApp-1965"><span class="linenos">1965</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1966"><a href="#ModifyMaskApp-1966"><span class="linenos">1966</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1967"><a href="#ModifyMaskApp-1967"><span class="linenos">1967</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1968"><a href="#ModifyMaskApp-1968"><span class="linenos">1968</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1969"><a href="#ModifyMaskApp-1969"><span class="linenos">1969</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1970"><a href="#ModifyMaskApp-1970"><span class="linenos">1970</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp-1971"><a href="#ModifyMaskApp-1971"><span class="linenos">1971</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1972"><a href="#ModifyMaskApp-1972"><span class="linenos">1972</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1973"><a href="#ModifyMaskApp-1973"><span class="linenos">1973</span></a>    
</span><span id="ModifyMaskApp-1974"><a href="#ModifyMaskApp-1974"><span class="linenos">1974</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1975"><a href="#ModifyMaskApp-1975"><span class="linenos">1975</span></a>    <span class="c1"># Mode functions#</span>
</span><span id="ModifyMaskApp-1976"><a href="#ModifyMaskApp-1976"><span class="linenos">1976</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-1977"><a href="#ModifyMaskApp-1977"><span class="linenos">1977</span></a>    
</span><span id="ModifyMaskApp-1978"><a href="#ModifyMaskApp-1978"><span class="linenos">1978</span></a>    <span class="k">def</span> <span class="nf">apply_brush_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1979"><a href="#ModifyMaskApp-1979"><span class="linenos">1979</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;brush_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1980"><a href="#ModifyMaskApp-1980"><span class="linenos">1980</span></a>            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">brush_size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1981"><a href="#ModifyMaskApp-1981"><span class="linenos">1981</span></a>                <span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1982"><a href="#ModifyMaskApp-1982"><span class="linenos">1982</span></a>                <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_x</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1983"><a href="#ModifyMaskApp-1983"><span class="linenos">1983</span></a>                <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_y</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1984"><a href="#ModifyMaskApp-1984"><span class="linenos">1984</span></a>                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_x</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="ModifyMaskApp-1985"><a href="#ModifyMaskApp-1985"><span class="linenos">1985</span></a>                <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_y</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ModifyMaskApp-1986"><a href="#ModifyMaskApp-1986"><span class="linenos">1986</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1987"><a href="#ModifyMaskApp-1987"><span class="linenos">1987</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp-1988"><a href="#ModifyMaskApp-1988"><span class="linenos">1988</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask_from_zoom</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1989"><a href="#ModifyMaskApp-1989"><span class="linenos">1989</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1990"><a href="#ModifyMaskApp-1990"><span class="linenos">1990</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp-1991"><a href="#ModifyMaskApp-1991"><span class="linenos">1991</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span>
</span><span id="ModifyMaskApp-1992"><a href="#ModifyMaskApp-1992"><span class="linenos">1992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1993"><a href="#ModifyMaskApp-1993"><span class="linenos">1993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-1994"><a href="#ModifyMaskApp-1994"><span class="linenos">1994</span></a>
</span><span id="ModifyMaskApp-1995"><a href="#ModifyMaskApp-1995"><span class="linenos">1995</span></a>    <span class="k">def</span> <span class="nf">erase_brush_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1996"><a href="#ModifyMaskApp-1996"><span class="linenos">1996</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;erase_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp-1997"><a href="#ModifyMaskApp-1997"><span class="linenos">1997</span></a>            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">brush_size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span><span class="p">:</span>
</span><span id="ModifyMaskApp-1998"><a href="#ModifyMaskApp-1998"><span class="linenos">1998</span></a>                <span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-1999"><a href="#ModifyMaskApp-1999"><span class="linenos">1999</span></a>                <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_x</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2000"><a href="#ModifyMaskApp-2000"><span class="linenos">2000</span></a>                <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_y</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2001"><a href="#ModifyMaskApp-2001"><span class="linenos">2001</span></a>                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_x</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="ModifyMaskApp-2002"><a href="#ModifyMaskApp-2002"><span class="linenos">2002</span></a>                <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_y</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ModifyMaskApp-2003"><a href="#ModifyMaskApp-2003"><span class="linenos">2003</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2004"><a href="#ModifyMaskApp-2004"><span class="linenos">2004</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>                    
</span><span id="ModifyMaskApp-2005"><a href="#ModifyMaskApp-2005"><span class="linenos">2005</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask_from_zoom</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2006"><a href="#ModifyMaskApp-2006"><span class="linenos">2006</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2007"><a href="#ModifyMaskApp-2007"><span class="linenos">2007</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-2008"><a href="#ModifyMaskApp-2008"><span class="linenos">2008</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span>
</span><span id="ModifyMaskApp-2009"><a href="#ModifyMaskApp-2009"><span class="linenos">2009</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2010"><a href="#ModifyMaskApp-2010"><span class="linenos">2010</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2011"><a href="#ModifyMaskApp-2011"><span class="linenos">2011</span></a>        
</span><span id="ModifyMaskApp-2012"><a href="#ModifyMaskApp-2012"><span class="linenos">2012</span></a>    <span class="k">def</span> <span class="nf">apply_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2013"><a href="#ModifyMaskApp-2013"><span class="linenos">2013</span></a>        <span class="n">brush_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2014"><a href="#ModifyMaskApp-2014"><span class="linenos">2014</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-2015"><a href="#ModifyMaskApp-2015"><span class="linenos">2015</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;brush_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2016"><a href="#ModifyMaskApp-2016"><span class="linenos">2016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp-2017"><a href="#ModifyMaskApp-2017"><span class="linenos">2017</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2018"><a href="#ModifyMaskApp-2018"><span class="linenos">2018</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2019"><a href="#ModifyMaskApp-2019"><span class="linenos">2019</span></a>            <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span>
</span><span id="ModifyMaskApp-2020"><a href="#ModifyMaskApp-2020"><span class="linenos">2020</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">last_y</span><span class="p">,</span> <span class="n">last_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2021"><a href="#ModifyMaskApp-2021"><span class="linenos">2021</span></a>            <span class="k">for</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2022"><a href="#ModifyMaskApp-2022"><span class="linenos">2022</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">brush_size</span><span class="p">))</span>
</span><span id="ModifyMaskApp-2023"><a href="#ModifyMaskApp-2023"><span class="linenos">2023</span></a>
</span><span id="ModifyMaskApp-2024"><a href="#ModifyMaskApp-2024"><span class="linenos">2024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">brush_size</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2025"><a href="#ModifyMaskApp-2025"><span class="linenos">2025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2026"><a href="#ModifyMaskApp-2026"><span class="linenos">2026</span></a>
</span><span id="ModifyMaskApp-2027"><a href="#ModifyMaskApp-2027"><span class="linenos">2027</span></a>    <span class="k">def</span> <span class="nf">erase_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2028"><a href="#ModifyMaskApp-2028"><span class="linenos">2028</span></a>        <span class="n">brush_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2029"><a href="#ModifyMaskApp-2029"><span class="linenos">2029</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-2030"><a href="#ModifyMaskApp-2030"><span class="linenos">2030</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;erase_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2031"><a href="#ModifyMaskApp-2031"><span class="linenos">2031</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp-2032"><a href="#ModifyMaskApp-2032"><span class="linenos">2032</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2033"><a href="#ModifyMaskApp-2033"><span class="linenos">2033</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2034"><a href="#ModifyMaskApp-2034"><span class="linenos">2034</span></a>            <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span>
</span><span id="ModifyMaskApp-2035"><a href="#ModifyMaskApp-2035"><span class="linenos">2035</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">last_y</span><span class="p">,</span> <span class="n">last_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2036"><a href="#ModifyMaskApp-2036"><span class="linenos">2036</span></a>            <span class="k">for</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2037"><a href="#ModifyMaskApp-2037"><span class="linenos">2037</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">brush_size</span><span class="p">))</span>
</span><span id="ModifyMaskApp-2038"><a href="#ModifyMaskApp-2038"><span class="linenos">2038</span></a>
</span><span id="ModifyMaskApp-2039"><a href="#ModifyMaskApp-2039"><span class="linenos">2039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">brush_size</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2040"><a href="#ModifyMaskApp-2040"><span class="linenos">2040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2041"><a href="#ModifyMaskApp-2041"><span class="linenos">2041</span></a>
</span><span id="ModifyMaskApp-2042"><a href="#ModifyMaskApp-2042"><span class="linenos">2042</span></a>    <span class="k">def</span> <span class="nf">erase_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2043"><a href="#ModifyMaskApp-2043"><span class="linenos">2043</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-2044"><a href="#ModifyMaskApp-2044"><span class="linenos">2044</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2045"><a href="#ModifyMaskApp-2045"><span class="linenos">2045</span></a>            <span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="ModifyMaskApp-2046"><a href="#ModifyMaskApp-2046"><span class="linenos">2046</span></a>            <span class="n">zoomed_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvas_x</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">))</span>
</span><span id="ModifyMaskApp-2047"><a href="#ModifyMaskApp-2047"><span class="linenos">2047</span></a>            <span class="n">zoomed_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvas_y</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">))</span>
</span><span id="ModifyMaskApp-2048"><a href="#ModifyMaskApp-2048"><span class="linenos">2048</span></a>            <span class="n">orig_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoomed_x</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2049"><a href="#ModifyMaskApp-2049"><span class="linenos">2049</span></a>            <span class="n">orig_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoomed_y</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2050"><a href="#ModifyMaskApp-2050"><span class="linenos">2050</span></a>            <span class="k">if</span> <span class="n">orig_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">orig_y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">orig_x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">orig_y</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ModifyMaskApp-2051"><a href="#ModifyMaskApp-2051"><span class="linenos">2051</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Point is out of bounds in the original image.&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2052"><a href="#ModifyMaskApp-2052"><span class="linenos">2052</span></a>                <span class="k">return</span>
</span><span id="ModifyMaskApp-2053"><a href="#ModifyMaskApp-2053"><span class="linenos">2053</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2054"><a href="#ModifyMaskApp-2054"><span class="linenos">2054</span></a>            <span class="n">orig_x</span><span class="p">,</span> <span class="n">orig_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="ModifyMaskApp-2055"><a href="#ModifyMaskApp-2055"><span class="linenos">2055</span></a>        <span class="n">label_to_remove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">orig_y</span><span class="p">,</span> <span class="n">orig_x</span><span class="p">]</span>
</span><span id="ModifyMaskApp-2056"><a href="#ModifyMaskApp-2056"><span class="linenos">2056</span></a>        <span class="k">if</span> <span class="n">label_to_remove</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2057"><a href="#ModifyMaskApp-2057"><span class="linenos">2057</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">label_to_remove</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-2058"><a href="#ModifyMaskApp-2058"><span class="linenos">2058</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2059"><a href="#ModifyMaskApp-2059"><span class="linenos">2059</span></a>            
</span><span id="ModifyMaskApp-2060"><a href="#ModifyMaskApp-2060"><span class="linenos">2060</span></a>    <span class="k">def</span> <span class="nf">use_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2061"><a href="#ModifyMaskApp-2061"><span class="linenos">2061</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-2062"><a href="#ModifyMaskApp-2062"><span class="linenos">2062</span></a>        <span class="n">tolerance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2063"><a href="#ModifyMaskApp-2063"><span class="linenos">2063</span></a>        <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2064"><a href="#ModifyMaskApp-2064"><span class="linenos">2064</span></a>        <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;add&#39;</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;erase&#39;</span>
</span><span id="ModifyMaskApp-2065"><a href="#ModifyMaskApp-2065"><span class="linenos">2065</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2066"><a href="#ModifyMaskApp-2066"><span class="linenos">2066</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_zoomed</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2067"><a href="#ModifyMaskApp-2067"><span class="linenos">2067</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2068"><a href="#ModifyMaskApp-2068"><span class="linenos">2068</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_normal</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2069"><a href="#ModifyMaskApp-2069"><span class="linenos">2069</span></a>    
</span><span id="ModifyMaskApp-2070"><a href="#ModifyMaskApp-2070"><span class="linenos">2070</span></a>    <span class="k">def</span> <span class="nf">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2071"><a href="#ModifyMaskApp-2071"><span class="linenos">2071</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">seed_point</span>
</span><span id="ModifyMaskApp-2072"><a href="#ModifyMaskApp-2072"><span class="linenos">2072</span></a>        <span class="n">initial_value</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2073"><a href="#ModifyMaskApp-2073"><span class="linenos">2073</span></a>        <span class="n">visited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2074"><a href="#ModifyMaskApp-2074"><span class="linenos">2074</span></a>        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
</span><span id="ModifyMaskApp-2075"><a href="#ModifyMaskApp-2075"><span class="linenos">2075</span></a>        <span class="n">added_pixels</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-2076"><a href="#ModifyMaskApp-2076"><span class="linenos">2076</span></a>
</span><span id="ModifyMaskApp-2077"><a href="#ModifyMaskApp-2077"><span class="linenos">2077</span></a>        <span class="k">while</span> <span class="n">queue</span> <span class="ow">and</span> <span class="n">added_pixels</span> <span class="o">&lt;</span> <span class="n">maximum</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2078"><a href="#ModifyMaskApp-2078"><span class="linenos">2078</span></a>            <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2079"><a href="#ModifyMaskApp-2079"><span class="linenos">2079</span></a>            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]:</span>
</span><span id="ModifyMaskApp-2080"><a href="#ModifyMaskApp-2080"><span class="linenos">2080</span></a>                <span class="k">continue</span>
</span><span id="ModifyMaskApp-2081"><a href="#ModifyMaskApp-2081"><span class="linenos">2081</span></a>            <span class="n">visited</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ModifyMaskApp-2082"><a href="#ModifyMaskApp-2082"><span class="linenos">2082</span></a>            <span class="n">current_value</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2083"><a href="#ModifyMaskApp-2083"><span class="linenos">2083</span></a>
</span><span id="ModifyMaskApp-2084"><a href="#ModifyMaskApp-2084"><span class="linenos">2084</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">current_value</span> <span class="o">-</span> <span class="n">initial_value</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2085"><a href="#ModifyMaskApp-2085"><span class="linenos">2085</span></a>                <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2086"><a href="#ModifyMaskApp-2086"><span class="linenos">2086</span></a>                    <span class="n">added_pixels</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp-2087"><a href="#ModifyMaskApp-2087"><span class="linenos">2087</span></a>                <span class="n">mask</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-2088"><a href="#ModifyMaskApp-2088"><span class="linenos">2088</span></a>
</span><span id="ModifyMaskApp-2089"><a href="#ModifyMaskApp-2089"><span class="linenos">2089</span></a>                <span class="k">if</span> <span class="n">added_pixels</span> <span class="o">&gt;=</span> <span class="n">maximum</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2090"><a href="#ModifyMaskApp-2090"><span class="linenos">2090</span></a>                    <span class="k">break</span>
</span><span id="ModifyMaskApp-2091"><a href="#ModifyMaskApp-2091"><span class="linenos">2091</span></a>
</span><span id="ModifyMaskApp-2092"><a href="#ModifyMaskApp-2092"><span class="linenos">2092</span></a>                <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]:</span>
</span><span id="ModifyMaskApp-2093"><a href="#ModifyMaskApp-2093"><span class="linenos">2093</span></a>                    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dy</span>
</span><span id="ModifyMaskApp-2094"><a href="#ModifyMaskApp-2094"><span class="linenos">2094</span></a>                    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nx</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ny</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">]:</span>
</span><span id="ModifyMaskApp-2095"><a href="#ModifyMaskApp-2095"><span class="linenos">2095</span></a>                        <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
</span><span id="ModifyMaskApp-2096"><a href="#ModifyMaskApp-2096"><span class="linenos">2096</span></a>        <span class="k">return</span> <span class="n">mask</span>
</span><span id="ModifyMaskApp-2097"><a href="#ModifyMaskApp-2097"><span class="linenos">2097</span></a>
</span><span id="ModifyMaskApp-2098"><a href="#ModifyMaskApp-2098"><span class="linenos">2098</span></a>    <span class="k">def</span> <span class="nf">magic_wand_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2099"><a href="#ModifyMaskApp-2099"><span class="linenos">2099</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2100"><a href="#ModifyMaskApp-2100"><span class="linenos">2100</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2101"><a href="#ModifyMaskApp-2101"><span class="linenos">2101</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2102"><a href="#ModifyMaskApp-2102"><span class="linenos">2102</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid maximum value; using default of 1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2103"><a href="#ModifyMaskApp-2103"><span class="linenos">2103</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1000</span> 
</span><span id="ModifyMaskApp-2104"><a href="#ModifyMaskApp-2104"><span class="linenos">2104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2105"><a href="#ModifyMaskApp-2105"><span class="linenos">2105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2106"><a href="#ModifyMaskApp-2106"><span class="linenos">2106</span></a>        
</span><span id="ModifyMaskApp-2107"><a href="#ModifyMaskApp-2107"><span class="linenos">2107</span></a>    <span class="k">def</span> <span class="nf">magic_wand_zoomed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2108"><a href="#ModifyMaskApp-2108"><span class="linenos">2108</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2109"><a href="#ModifyMaskApp-2109"><span class="linenos">2109</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Zoomed image or mask not initialized&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2110"><a href="#ModifyMaskApp-2110"><span class="linenos">2110</span></a>            <span class="k">return</span>
</span><span id="ModifyMaskApp-2111"><a href="#ModifyMaskApp-2111"><span class="linenos">2111</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2112"><a href="#ModifyMaskApp-2112"><span class="linenos">2112</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2113"><a href="#ModifyMaskApp-2113"><span class="linenos">2113</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="n">maximum</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span>
</span><span id="ModifyMaskApp-2114"><a href="#ModifyMaskApp-2114"><span class="linenos">2114</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2115"><a href="#ModifyMaskApp-2115"><span class="linenos">2115</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid maximum value; using default of 1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2116"><a href="#ModifyMaskApp-2116"><span class="linenos">2116</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="ModifyMaskApp-2117"><a href="#ModifyMaskApp-2117"><span class="linenos">2117</span></a>            
</span><span id="ModifyMaskApp-2118"><a href="#ModifyMaskApp-2118"><span class="linenos">2118</span></a>        <span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span> <span class="o">=</span> <span class="n">seed_point</span>
</span><span id="ModifyMaskApp-2119"><a href="#ModifyMaskApp-2119"><span class="linenos">2119</span></a>        <span class="k">if</span> <span class="n">canvas_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">canvas_y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">canvas_x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">canvas_y</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ModifyMaskApp-2120"><a href="#ModifyMaskApp-2120"><span class="linenos">2120</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected point is out of bounds in the zoomed image.&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2121"><a href="#ModifyMaskApp-2121"><span class="linenos">2121</span></a>            <span class="k">return</span>
</span><span id="ModifyMaskApp-2122"><a href="#ModifyMaskApp-2122"><span class="linenos">2122</span></a>        
</span><span id="ModifyMaskApp-2123"><a href="#ModifyMaskApp-2123"><span class="linenos">2123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2124"><a href="#ModifyMaskApp-2124"><span class="linenos">2124</span></a>        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="ModifyMaskApp-2125"><a href="#ModifyMaskApp-2125"><span class="linenos">2125</span></a>        <span class="n">zoomed_mask_resized_back</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2126"><a href="#ModifyMaskApp-2126"><span class="linenos">2126</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;erase&#39;</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2127"><a href="#ModifyMaskApp-2127"><span class="linenos">2127</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zoomed_mask_resized_back</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">])</span>
</span><span id="ModifyMaskApp-2128"><a href="#ModifyMaskApp-2128"><span class="linenos">2128</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2129"><a href="#ModifyMaskApp-2129"><span class="linenos">2129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zoomed_mask_resized_back</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zoomed_mask_resized_back</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">])</span>
</span><span id="ModifyMaskApp-2130"><a href="#ModifyMaskApp-2130"><span class="linenos">2130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2131"><a href="#ModifyMaskApp-2131"><span class="linenos">2131</span></a>                
</span><span id="ModifyMaskApp-2132"><a href="#ModifyMaskApp-2132"><span class="linenos">2132</span></a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2133"><a href="#ModifyMaskApp-2133"><span class="linenos">2133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2134"><a href="#ModifyMaskApp-2134"><span class="linenos">2134</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp-2135"><a href="#ModifyMaskApp-2135"><span class="linenos">2135</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2136"><a href="#ModifyMaskApp-2136"><span class="linenos">2136</span></a>                <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ModifyMaskApp-2137"><a href="#ModifyMaskApp-2137"><span class="linenos">2137</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2138"><a href="#ModifyMaskApp-2138"><span class="linenos">2138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="ModifyMaskApp-2139"><a href="#ModifyMaskApp-2139"><span class="linenos">2139</span></a>            
</span><span id="ModifyMaskApp-2140"><a href="#ModifyMaskApp-2140"><span class="linenos">2140</span></a>    <span class="k">def</span> <span class="nf">draw_on_zoomed_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_coordinates</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2141"><a href="#ModifyMaskApp-2141"><span class="linenos">2141</span></a>        <span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2142"><a href="#ModifyMaskApp-2142"><span class="linenos">2142</span></a>        <span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2143"><a href="#ModifyMaskApp-2143"><span class="linenos">2143</span></a>        <span class="n">zoomed_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2144"><a href="#ModifyMaskApp-2144"><span class="linenos">2144</span></a>        <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">zoomed_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2145"><a href="#ModifyMaskApp-2145"><span class="linenos">2145</span></a>        <span class="n">zoomed_mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp-2146"><a href="#ModifyMaskApp-2146"><span class="linenos">2146</span></a>        <span class="k">return</span> <span class="n">zoomed_mask</span>
</span><span id="ModifyMaskApp-2147"><a href="#ModifyMaskApp-2147"><span class="linenos">2147</span></a>            
</span><span id="ModifyMaskApp-2148"><a href="#ModifyMaskApp-2148"><span class="linenos">2148</span></a>    <span class="k">def</span> <span class="nf">finish_drawing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2149"><a href="#ModifyMaskApp-2149"><span class="linenos">2149</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2150"><a href="#ModifyMaskApp-2150"><span class="linenos">2150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ModifyMaskApp-2151"><a href="#ModifyMaskApp-2151"><span class="linenos">2151</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2152"><a href="#ModifyMaskApp-2152"><span class="linenos">2152</span></a>                <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span>
</span><span id="ModifyMaskApp-2153"><a href="#ModifyMaskApp-2153"><span class="linenos">2153</span></a>                <span class="n">zoomed_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_on_zoomed_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2154"><a href="#ModifyMaskApp-2154"><span class="linenos">2154</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask</span><span class="p">(</span><span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2155"><a href="#ModifyMaskApp-2155"><span class="linenos">2155</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2156"><a href="#ModifyMaskApp-2156"><span class="linenos">2156</span></a>                <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2157"><a href="#ModifyMaskApp-2157"><span class="linenos">2157</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">],</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2158"><a href="#ModifyMaskApp-2158"><span class="linenos">2158</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2159"><a href="#ModifyMaskApp-2159"><span class="linenos">2159</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2160"><a href="#ModifyMaskApp-2160"><span class="linenos">2160</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2161"><a href="#ModifyMaskApp-2161"><span class="linenos">2161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2162"><a href="#ModifyMaskApp-2162"><span class="linenos">2162</span></a>            
</span><span id="ModifyMaskApp-2163"><a href="#ModifyMaskApp-2163"><span class="linenos">2163</span></a>    <span class="k">def</span> <span class="nf">finish_drawing_if_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2164"><a href="#ModifyMaskApp-2164"><span class="linenos">2164</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2165"><a href="#ModifyMaskApp-2165"><span class="linenos">2165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">finish_drawing</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2166"><a href="#ModifyMaskApp-2166"><span class="linenos">2166</span></a>
</span><span id="ModifyMaskApp-2167"><a href="#ModifyMaskApp-2167"><span class="linenos">2167</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-2168"><a href="#ModifyMaskApp-2168"><span class="linenos">2168</span></a>    <span class="c1"># Single function butons#</span>
</span><span id="ModifyMaskApp-2169"><a href="#ModifyMaskApp-2169"><span class="linenos">2169</span></a>    <span class="c1">####################################################################################################</span>
</span><span id="ModifyMaskApp-2170"><a href="#ModifyMaskApp-2170"><span class="linenos">2170</span></a>            
</span><span id="ModifyMaskApp-2171"><a href="#ModifyMaskApp-2171"><span class="linenos">2171</span></a>    <span class="k">def</span> <span class="nf">apply_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2172"><a href="#ModifyMaskApp-2172"><span class="linenos">2172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2173"><a href="#ModifyMaskApp-2173"><span class="linenos">2173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2174"><a href="#ModifyMaskApp-2174"><span class="linenos">2174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2175"><a href="#ModifyMaskApp-2175"><span class="linenos">2175</span></a>
</span><span id="ModifyMaskApp-2176"><a href="#ModifyMaskApp-2176"><span class="linenos">2176</span></a>    <span class="k">def</span> <span class="nf">fill_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2177"><a href="#ModifyMaskApp-2177"><span class="linenos">2177</span></a>        <span class="n">binary_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp-2178"><a href="#ModifyMaskApp-2178"><span class="linenos">2178</span></a>        <span class="n">filled_mask</span> <span class="o">=</span> <span class="n">binary_fill_holes</span><span class="p">(</span><span class="n">binary_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2179"><a href="#ModifyMaskApp-2179"><span class="linenos">2179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">filled_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp-2180"><a href="#ModifyMaskApp-2180"><span class="linenos">2180</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">filled_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2181"><a href="#ModifyMaskApp-2181"><span class="linenos">2181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="ModifyMaskApp-2182"><a href="#ModifyMaskApp-2182"><span class="linenos">2182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2183"><a href="#ModifyMaskApp-2183"><span class="linenos">2183</span></a>
</span><span id="ModifyMaskApp-2184"><a href="#ModifyMaskApp-2184"><span class="linenos">2184</span></a>    <span class="k">def</span> <span class="nf">relabel_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2185"><a href="#ModifyMaskApp-2185"><span class="linenos">2185</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
</span><span id="ModifyMaskApp-2186"><a href="#ModifyMaskApp-2186"><span class="linenos">2186</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2187"><a href="#ModifyMaskApp-2187"><span class="linenos">2187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="ModifyMaskApp-2188"><a href="#ModifyMaskApp-2188"><span class="linenos">2188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2189"><a href="#ModifyMaskApp-2189"><span class="linenos">2189</span></a>        
</span><span id="ModifyMaskApp-2190"><a href="#ModifyMaskApp-2190"><span class="linenos">2190</span></a>    <span class="k">def</span> <span class="nf">clear_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2191"><a href="#ModifyMaskApp-2191"><span class="linenos">2191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2192"><a href="#ModifyMaskApp-2192"><span class="linenos">2192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2193"><a href="#ModifyMaskApp-2193"><span class="linenos">2193</span></a>
</span><span id="ModifyMaskApp-2194"><a href="#ModifyMaskApp-2194"><span class="linenos">2194</span></a>    <span class="k">def</span> <span class="nf">invert_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2195"><a href="#ModifyMaskApp-2195"><span class="linenos">2195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2196"><a href="#ModifyMaskApp-2196"><span class="linenos">2196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_objects</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2197"><a href="#ModifyMaskApp-2197"><span class="linenos">2197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp-2198"><a href="#ModifyMaskApp-2198"><span class="linenos">2198</span></a>        
</span><span id="ModifyMaskApp-2199"><a href="#ModifyMaskApp-2199"><span class="linenos">2199</span></a>    <span class="k">def</span> <span class="nf">remove_small_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp-2200"><a href="#ModifyMaskApp-2200"><span class="linenos">2200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2201"><a href="#ModifyMaskApp-2201"><span class="linenos">2201</span></a>            <span class="n">min_area</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp-2202"><a href="#ModifyMaskApp-2202"><span class="linenos">2202</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2203"><a href="#ModifyMaskApp-2203"><span class="linenos">2203</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid minimum area value; using default of 100&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2204"><a href="#ModifyMaskApp-2204"><span class="linenos">2204</span></a>            <span class="n">min_area</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="ModifyMaskApp-2205"><a href="#ModifyMaskApp-2205"><span class="linenos">2205</span></a>
</span><span id="ModifyMaskApp-2206"><a href="#ModifyMaskApp-2206"><span class="linenos">2206</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp-2207"><a href="#ModifyMaskApp-2207"><span class="linenos">2207</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># Skip background</span>
</span><span id="ModifyMaskApp-2208"><a href="#ModifyMaskApp-2208"><span class="linenos">2208</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">labeled_mask</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_area</span><span class="p">:</span>
</span><span id="ModifyMaskApp-2209"><a href="#ModifyMaskApp-2209"><span class="linenos">2209</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">labeled_mask</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Remove small objects</span>
</span><span id="ModifyMaskApp-2210"><a href="#ModifyMaskApp-2210"><span class="linenos">2210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="ModifyMaskApp.__init__" class="classattr">
                                        <input id="ModifyMaskApp.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ModifyMaskApp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">root</span>, </span><span class="param"><span class="n">folder_path</span>, </span><span class="param"><span class="n">scale_factor</span></span>)</span>

                <label class="view-source-button" for="ModifyMaskApp.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.__init__-1344"><a href="#ModifyMaskApp.__init__-1344"><span class="linenos">1344</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
</span><span id="ModifyMaskApp.__init__-1345"><a href="#ModifyMaskApp.__init__-1345"><span class="linenos">1345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
</span><span id="ModifyMaskApp.__init__-1346"><a href="#ModifyMaskApp.__init__-1346"><span class="linenos">1346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span> <span class="o">=</span> <span class="n">folder_path</span>
</span><span id="ModifyMaskApp.__init__-1347"><a href="#ModifyMaskApp.__init__-1347"><span class="linenos">1347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
</span><span id="ModifyMaskApp.__init__-1348"><a href="#ModifyMaskApp.__init__-1348"><span class="linenos">1348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;.tiff&#39;</span><span class="p">))])</span>
</span><span id="ModifyMaskApp.__init__-1349"><a href="#ModifyMaskApp.__init__-1349"><span class="linenos">1349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">masks_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.__init__-1350"><a href="#ModifyMaskApp.__init__-1350"><span class="linenos">1350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.__init__-1351"><a href="#ModifyMaskApp.__init__-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>
</span><span id="ModifyMaskApp.__init__-1352"><a href="#ModifyMaskApp.__init__-1352"><span class="linenos">1352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="ModifyMaskApp.__init__-1353"><a href="#ModifyMaskApp.__init__-1353"><span class="linenos">1353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="ModifyMaskApp.__init__-1354"><a href="#ModifyMaskApp.__init__-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.__init__-1355"><a href="#ModifyMaskApp.__init__-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_navigation_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp.__init__-1356"><a href="#ModifyMaskApp.__init__-1356"><span class="linenos">1356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_mode_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp.__init__-1357"><a href="#ModifyMaskApp.__init__-1357"><span class="linenos">1357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_function_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp.__init__-1358"><a href="#ModifyMaskApp.__init__-1358"><span class="linenos">1358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_zoom_toolbar</span><span class="p">()</span>
</span><span id="ModifyMaskApp.__init__-1359"><a href="#ModifyMaskApp.__init__-1359"><span class="linenos">1359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_canvas</span><span class="p">()</span>
</span><span id="ModifyMaskApp.__init__-1360"><a href="#ModifyMaskApp.__init__-1360"><span class="linenos">1360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_first_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.root" class="classattr">
                                <div class="attr variable">
            <span class="name">root</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.root"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.folder_path" class="classattr">
                                <div class="attr variable">
            <span class="name">folder_path</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.folder_path"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.scale_factor" class="classattr">
                                <div class="attr variable">
            <span class="name">scale_factor</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.scale_factor"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.image_filenames" class="classattr">
                                <div class="attr variable">
            <span class="name">image_filenames</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.image_filenames"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.masks_folder" class="classattr">
                                <div class="attr variable">
            <span class="name">masks_folder</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.masks_folder"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.current_image_index" class="classattr">
                                <div class="attr variable">
            <span class="name">current_image_index</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.current_image_index"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.canvas_width" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_width</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.canvas_width"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.canvas_height" class="classattr">
                                <div class="attr variable">
            <span class="name">canvas_height</span>

        
    </div>
    <a class="headerlink" href="#ModifyMaskApp.canvas_height"></a>
    
    

                            </div>
                            <div id="ModifyMaskApp.update_display" class="classattr">
                                        <input id="ModifyMaskApp.update_display-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_display</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.update_display-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.update_display"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.update_display-1366"><a href="#ModifyMaskApp.update_display-1366"><span class="linenos">1366</span></a>    <span class="k">def</span> <span class="nf">update_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.update_display-1367"><a href="#ModifyMaskApp.update_display-1367"><span class="linenos">1367</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_display-1368"><a href="#ModifyMaskApp.update_display-1368"><span class="linenos">1368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_zoomed_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp.update_display-1369"><a href="#ModifyMaskApp.update_display-1369"><span class="linenos">1369</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_display-1370"><a href="#ModifyMaskApp.update_display-1370"><span class="linenos">1370</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.update_original_mask_from_zoom" class="classattr">
                                        <input id="ModifyMaskApp.update_original_mask_from_zoom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_original_mask_from_zoom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.update_original_mask_from_zoom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.update_original_mask_from_zoom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.update_original_mask_from_zoom-1372"><a href="#ModifyMaskApp.update_original_mask_from_zoom-1372"><span class="linenos">1372</span></a>    <span class="k">def</span> <span class="nf">update_original_mask_from_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.update_original_mask_from_zoom-1373"><a href="#ModifyMaskApp.update_original_mask_from_zoom-1373"><span class="linenos">1373</span></a>        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="ModifyMaskApp.update_original_mask_from_zoom-1374"><a href="#ModifyMaskApp.update_original_mask_from_zoom-1374"><span class="linenos">1374</span></a>        <span class="n">zoomed_mask_resized</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_original_mask_from_zoom-1375"><a href="#ModifyMaskApp.update_original_mask_from_zoom-1375"><span class="linenos">1375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_mask_resized</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.update_original_mask" class="classattr">
                                        <input id="ModifyMaskApp.update_original_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_original_mask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">zoomed_mask</span>, </span><span class="param"><span class="n">x0</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y0</span>, </span><span class="param"><span class="n">y1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.update_original_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.update_original_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.update_original_mask-1377"><a href="#ModifyMaskApp.update_original_mask-1377"><span class="linenos">1377</span></a>    <span class="k">def</span> <span class="nf">update_original_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
</span><span id="ModifyMaskApp.update_original_mask-1378"><a href="#ModifyMaskApp.update_original_mask-1378"><span class="linenos">1378</span></a>        <span class="n">actual_mask_region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.update_original_mask-1379"><a href="#ModifyMaskApp.update_original_mask-1379"><span class="linenos">1379</span></a>        <span class="n">target_shape</span> <span class="o">=</span> <span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp.update_original_mask-1380"><a href="#ModifyMaskApp.update_original_mask-1380"><span class="linenos">1380</span></a>        <span class="n">resized_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">target_shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_original_mask-1381"><a href="#ModifyMaskApp.update_original_mask-1381"><span class="linenos">1381</span></a>        <span class="k">if</span> <span class="n">resized_mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_original_mask-1382"><a href="#ModifyMaskApp.update_original_mask-1382"><span class="linenos">1382</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape mismatch: resized_mask </span><span class="si">{</span><span class="n">resized_mask</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, actual_mask_region </span><span class="si">{</span><span class="n">actual_mask_region</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_original_mask-1383"><a href="#ModifyMaskApp.update_original_mask-1383"><span class="linenos">1383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">actual_mask_region</span><span class="p">,</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_original_mask-1384"><a href="#ModifyMaskApp.update_original_mask-1384"><span class="linenos">1384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp.update_original_mask-1385"><a href="#ModifyMaskApp.update_original_mask-1385"><span class="linenos">1385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">],</span> <span class="n">resized_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_original_mask-1386"><a href="#ModifyMaskApp.update_original_mask-1386"><span class="linenos">1386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.get_scaling_factors" class="classattr">
                                        <input id="ModifyMaskApp.get_scaling_factors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_scaling_factors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">img_width</span>, </span><span class="param"><span class="n">img_height</span>, </span><span class="param"><span class="n">canvas_width</span>, </span><span class="param"><span class="n">canvas_height</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.get_scaling_factors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.get_scaling_factors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.get_scaling_factors-1388"><a href="#ModifyMaskApp.get_scaling_factors-1388"><span class="linenos">1388</span></a>    <span class="k">def</span> <span class="nf">get_scaling_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_width</span><span class="p">,</span> <span class="n">img_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">):</span>
</span><span id="ModifyMaskApp.get_scaling_factors-1389"><a href="#ModifyMaskApp.get_scaling_factors-1389"><span class="linenos">1389</span></a>        <span class="n">x_scale</span> <span class="o">=</span> <span class="n">img_width</span> <span class="o">/</span> <span class="n">canvas_width</span>
</span><span id="ModifyMaskApp.get_scaling_factors-1390"><a href="#ModifyMaskApp.get_scaling_factors-1390"><span class="linenos">1390</span></a>        <span class="n">y_scale</span> <span class="o">=</span> <span class="n">img_height</span> <span class="o">/</span> <span class="n">canvas_height</span>
</span><span id="ModifyMaskApp.get_scaling_factors-1391"><a href="#ModifyMaskApp.get_scaling_factors-1391"><span class="linenos">1391</span></a>        <span class="k">return</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.canvas_to_image" class="classattr">
                                        <input id="ModifyMaskApp.canvas_to_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">canvas_to_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x_canvas</span>, </span><span class="param"><span class="n">y_canvas</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.canvas_to_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.canvas_to_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.canvas_to_image-1393"><a href="#ModifyMaskApp.canvas_to_image-1393"><span class="linenos">1393</span></a>    <span class="k">def</span> <span class="nf">canvas_to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_canvas</span><span class="p">,</span> <span class="n">y_canvas</span><span class="p">):</span>
</span><span id="ModifyMaskApp.canvas_to_image-1394"><a href="#ModifyMaskApp.canvas_to_image-1394"><span class="linenos">1394</span></a>        <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scaling_factors</span><span class="p">(</span>
</span><span id="ModifyMaskApp.canvas_to_image-1395"><a href="#ModifyMaskApp.canvas_to_image-1395"><span class="linenos">1395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="ModifyMaskApp.canvas_to_image-1396"><a href="#ModifyMaskApp.canvas_to_image-1396"><span class="linenos">1396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span>
</span><span id="ModifyMaskApp.canvas_to_image-1397"><a href="#ModifyMaskApp.canvas_to_image-1397"><span class="linenos">1397</span></a>        <span class="p">)</span>
</span><span id="ModifyMaskApp.canvas_to_image-1398"><a href="#ModifyMaskApp.canvas_to_image-1398"><span class="linenos">1398</span></a>        <span class="n">x_image</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_canvas</span> <span class="o">*</span> <span class="n">x_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp.canvas_to_image-1399"><a href="#ModifyMaskApp.canvas_to_image-1399"><span class="linenos">1399</span></a>        <span class="n">y_image</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_canvas</span> <span class="o">*</span> <span class="n">y_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp.canvas_to_image-1400"><a href="#ModifyMaskApp.canvas_to_image-1400"><span class="linenos">1400</span></a>        <span class="k">return</span> <span class="n">x_image</span><span class="p">,</span> <span class="n">y_image</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.apply_zoom_on_enter" class="classattr">
                                        <input id="ModifyMaskApp.apply_zoom_on_enter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_zoom_on_enter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.apply_zoom_on_enter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.apply_zoom_on_enter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.apply_zoom_on_enter-1402"><a href="#ModifyMaskApp.apply_zoom_on_enter-1402"><span class="linenos">1402</span></a>    <span class="k">def</span> <span class="nf">apply_zoom_on_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_zoom_on_enter-1403"><a href="#ModifyMaskApp.apply_zoom_on_enter-1403"><span class="linenos">1403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_zoom_on_enter-1404"><a href="#ModifyMaskApp.apply_zoom_on_enter-1404"><span class="linenos">1404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_end</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.normalize_image" class="classattr">
                                        <input id="ModifyMaskApp.normalize_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalize_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">lower_quantile</span>, </span><span class="param"><span class="n">upper_quantile</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.normalize_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.normalize_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.normalize_image-1406"><a href="#ModifyMaskApp.normalize_image-1406"><span class="linenos">1406</span></a>    <span class="k">def</span> <span class="nf">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">):</span>
</span><span id="ModifyMaskApp.normalize_image-1407"><a href="#ModifyMaskApp.normalize_image-1407"><span class="linenos">1407</span></a>        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp.normalize_image-1408"><a href="#ModifyMaskApp.normalize_image-1408"><span class="linenos">1408</span></a>        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp.normalize_image-1409"><a href="#ModifyMaskApp.normalize_image-1409"><span class="linenos">1409</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
</span><span id="ModifyMaskApp.normalize_image-1410"><a href="#ModifyMaskApp.normalize_image-1410"><span class="linenos">1410</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized</span> <span class="o">-</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">upper_bound</span> <span class="o">-</span> <span class="n">lower_bound</span><span class="p">)</span>
</span><span id="ModifyMaskApp.normalize_image-1411"><a href="#ModifyMaskApp.normalize_image-1411"><span class="linenos">1411</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
</span><span id="ModifyMaskApp.normalize_image-1412"><a href="#ModifyMaskApp.normalize_image-1412"><span class="linenos">1412</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized</span> <span class="o">*</span> <span class="n">max_value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp.normalize_image-1413"><a href="#ModifyMaskApp.normalize_image-1413"><span class="linenos">1413</span></a>        <span class="k">return</span> <span class="n">normalized</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.resize_arrays" class="classattr">
                                        <input id="ModifyMaskApp.resize_arrays-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">resize_arrays</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">img</span>, </span><span class="param"><span class="n">mask</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.resize_arrays-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.resize_arrays"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.resize_arrays-1415"><a href="#ModifyMaskApp.resize_arrays-1415"><span class="linenos">1415</span></a>    <span class="k">def</span> <span class="nf">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
</span><span id="ModifyMaskApp.resize_arrays-1416"><a href="#ModifyMaskApp.resize_arrays-1416"><span class="linenos">1416</span></a>        <span class="n">original_dtype</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="ModifyMaskApp.resize_arrays-1417"><a href="#ModifyMaskApp.resize_arrays-1417"><span class="linenos">1417</span></a>        <span class="n">scaled_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">)</span>
</span><span id="ModifyMaskApp.resize_arrays-1418"><a href="#ModifyMaskApp.resize_arrays-1418"><span class="linenos">1418</span></a>        <span class="n">scaled_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">)</span>
</span><span id="ModifyMaskApp.resize_arrays-1419"><a href="#ModifyMaskApp.resize_arrays-1419"><span class="linenos">1419</span></a>        <span class="n">scaled_img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">scaled_height</span><span class="p">,</span> <span class="n">scaled_width</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp.resize_arrays-1420"><a href="#ModifyMaskApp.resize_arrays-1420"><span class="linenos">1420</span></a>        <span class="n">scaled_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="n">scaled_height</span><span class="p">,</span> <span class="n">scaled_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp.resize_arrays-1421"><a href="#ModifyMaskApp.resize_arrays-1421"><span class="linenos">1421</span></a>        <span class="n">stretched_img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">scaled_img</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp.resize_arrays-1422"><a href="#ModifyMaskApp.resize_arrays-1422"><span class="linenos">1422</span></a>        <span class="n">stretched_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">scaled_mask</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ModifyMaskApp.resize_arrays-1423"><a href="#ModifyMaskApp.resize_arrays-1423"><span class="linenos">1423</span></a>        <span class="k">return</span> <span class="n">stretched_img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">original_dtype</span><span class="p">),</span> <span class="n">stretched_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">original_dtype</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.load_first_image" class="classattr">
                                        <input id="ModifyMaskApp.load_first_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_first_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.load_first_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.load_first_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.load_first_image-1429"><a href="#ModifyMaskApp.load_first_image-1429"><span class="linenos">1429</span></a>    <span class="k">def</span> <span class="nf">load_first_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.load_first_image-1430"><a href="#ModifyMaskApp.load_first_image-1430"><span class="linenos">1430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_first_image-1431"><a href="#ModifyMaskApp.load_first_image-1431"><span class="linenos">1431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp.load_first_image-1432"><a href="#ModifyMaskApp.load_first_image-1432"><span class="linenos">1432</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_first_image-1433"><a href="#ModifyMaskApp.load_first_image-1433"><span class="linenos">1433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.setup_canvas" class="classattr">
                                        <input id="ModifyMaskApp.setup_canvas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_canvas</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.setup_canvas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.setup_canvas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.setup_canvas-1435"><a href="#ModifyMaskApp.setup_canvas-1435"><span class="linenos">1435</span></a>    <span class="k">def</span> <span class="nf">setup_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.setup_canvas-1436"><a href="#ModifyMaskApp.setup_canvas-1436"><span class="linenos">1436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_canvas-1437"><a href="#ModifyMaskApp.setup_canvas-1437"><span class="linenos">1437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="ModifyMaskApp.setup_canvas-1438"><a href="#ModifyMaskApp.setup_canvas-1438"><span class="linenos">1438</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.initialize_flags" class="classattr">
                                        <input id="ModifyMaskApp.initialize_flags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">initialize_flags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.initialize_flags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.initialize_flags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.initialize_flags-1440"><a href="#ModifyMaskApp.initialize_flags-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">initialize_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.initialize_flags-1441"><a href="#ModifyMaskApp.initialize_flags-1441"><span class="linenos">1441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1442"><a href="#ModifyMaskApp.initialize_flags-1442"><span class="linenos">1442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1443"><a href="#ModifyMaskApp.initialize_flags-1443"><span class="linenos">1443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1444"><a href="#ModifyMaskApp.initialize_flags-1444"><span class="linenos">1444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1445"><a href="#ModifyMaskApp.initialize_flags-1445"><span class="linenos">1445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1446"><a href="#ModifyMaskApp.initialize_flags-1446"><span class="linenos">1446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1447"><a href="#ModifyMaskApp.initialize_flags-1447"><span class="linenos">1447</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1448"><a href="#ModifyMaskApp.initialize_flags-1448"><span class="linenos">1448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1449"><a href="#ModifyMaskApp.initialize_flags-1449"><span class="linenos">1449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1450"><a href="#ModifyMaskApp.initialize_flags-1450"><span class="linenos">1450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1451"><a href="#ModifyMaskApp.initialize_flags-1451"><span class="linenos">1451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp.initialize_flags-1452"><a href="#ModifyMaskApp.initialize_flags-1452"><span class="linenos">1452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.initialize_flags-1453"><a href="#ModifyMaskApp.initialize_flags-1453"><span class="linenos">1453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.initialize_flags-1454"><a href="#ModifyMaskApp.initialize_flags-1454"><span class="linenos">1454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.initialize_flags-1455"><a href="#ModifyMaskApp.initialize_flags-1455"><span class="linenos">1455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.initialize_flags-1456"><a href="#ModifyMaskApp.initialize_flags-1456"><span class="linenos">1456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.initialize_flags-1457"><a href="#ModifyMaskApp.initialize_flags-1457"><span class="linenos">1457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp.initialize_flags-1458"><a href="#ModifyMaskApp.initialize_flags-1458"><span class="linenos">1458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.initialize_flags-1459"><a href="#ModifyMaskApp.initialize_flags-1459"><span class="linenos">1459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.initialize_flags-1460"><a href="#ModifyMaskApp.initialize_flags-1460"><span class="linenos">1460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;99.9&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.initialize_flags-1461"><a href="#ModifyMaskApp.initialize_flags-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1000&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.update_mouse_info" class="classattr">
                                        <input id="ModifyMaskApp.update_mouse_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_mouse_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.update_mouse_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.update_mouse_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.update_mouse_info-1463"><a href="#ModifyMaskApp.update_mouse_info-1463"><span class="linenos">1463</span></a>    <span class="k">def</span> <span class="nf">update_mouse_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.update_mouse_info-1464"><a href="#ModifyMaskApp.update_mouse_info-1464"><span class="linenos">1464</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.update_mouse_info-1465"><a href="#ModifyMaskApp.update_mouse_info-1465"><span class="linenos">1465</span></a>        <span class="n">intensity</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp.update_mouse_info-1466"><a href="#ModifyMaskApp.update_mouse_info-1466"><span class="linenos">1466</span></a>        <span class="n">mask_value</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp.update_mouse_info-1467"><a href="#ModifyMaskApp.update_mouse_info-1467"><span class="linenos">1467</span></a>        <span class="n">pixel_count</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>  
</span><span id="ModifyMaskApp.update_mouse_info-1468"><a href="#ModifyMaskApp.update_mouse_info-1468"><span class="linenos">1468</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1469"><a href="#ModifyMaskApp.update_mouse_info-1469"><span class="linenos">1469</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1470"><a href="#ModifyMaskApp.update_mouse_info-1470"><span class="linenos">1470</span></a>                <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp.update_mouse_info-1471"><a href="#ModifyMaskApp.update_mouse_info-1471"><span class="linenos">1471</span></a>                <span class="n">mask_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="ModifyMaskApp.update_mouse_info-1472"><a href="#ModifyMaskApp.update_mouse_info-1472"><span class="linenos">1472</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1473"><a href="#ModifyMaskApp.update_mouse_info-1473"><span class="linenos">1473</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1474"><a href="#ModifyMaskApp.update_mouse_info-1474"><span class="linenos">1474</span></a>                <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span id="ModifyMaskApp.update_mouse_info-1475"><a href="#ModifyMaskApp.update_mouse_info-1475"><span class="linenos">1475</span></a>                <span class="n">mask_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span id="ModifyMaskApp.update_mouse_info-1476"><a href="#ModifyMaskApp.update_mouse_info-1476"><span class="linenos">1476</span></a>        <span class="k">if</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1477"><a href="#ModifyMaskApp.update_mouse_info-1477"><span class="linenos">1477</span></a>            <span class="n">pixel_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">mask_value</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_mouse_info-1478"><a href="#ModifyMaskApp.update_mouse_info-1478"><span class="linenos">1478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Intensity: </span><span class="si">{</span><span class="n">intensity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_mouse_info-1479"><a href="#ModifyMaskApp.update_mouse_info-1479"><span class="linenos">1479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mask: </span><span class="si">{</span><span class="n">mask_value</span><span class="si">}</span><span class="s2">, Area: </span><span class="si">{</span><span class="n">pixel_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_mouse_info-1480"><a href="#ModifyMaskApp.update_mouse_info-1480"><span class="linenos">1480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mask: </span><span class="si">{</span><span class="n">mask_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_mouse_info-1481"><a href="#ModifyMaskApp.update_mouse_info-1481"><span class="linenos">1481</span></a>        <span class="k">if</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">mask_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1482"><a href="#ModifyMaskApp.update_mouse_info-1482"><span class="linenos">1482</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area: </span><span class="si">{</span><span class="n">pixel_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_mouse_info-1483"><a href="#ModifyMaskApp.update_mouse_info-1483"><span class="linenos">1483</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_mouse_info-1484"><a href="#ModifyMaskApp.update_mouse_info-1484"><span class="linenos">1484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Area: N/A&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.setup_navigation_toolbar" class="classattr">
                                        <input id="ModifyMaskApp.setup_navigation_toolbar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_navigation_toolbar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.setup_navigation_toolbar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.setup_navigation_toolbar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.setup_navigation_toolbar-1486"><a href="#ModifyMaskApp.setup_navigation_toolbar-1486"><span class="linenos">1486</span></a>    <span class="k">def</span> <span class="nf">setup_navigation_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1487"><a href="#ModifyMaskApp.setup_navigation_toolbar-1487"><span class="linenos">1487</span></a>        <span class="n">navigation_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1488"><a href="#ModifyMaskApp.setup_navigation_toolbar-1488"><span class="linenos">1488</span></a>        <span class="n">navigation_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1489"><a href="#ModifyMaskApp.setup_navigation_toolbar-1489"><span class="linenos">1489</span></a>        <span class="n">prev_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Previous&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_image</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1490"><a href="#ModifyMaskApp.setup_navigation_toolbar-1490"><span class="linenos">1490</span></a>        <span class="n">prev_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1491"><a href="#ModifyMaskApp.setup_navigation_toolbar-1491"><span class="linenos">1491</span></a>        <span class="n">next_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_image</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1492"><a href="#ModifyMaskApp.setup_navigation_toolbar-1492"><span class="linenos">1492</span></a>        <span class="n">next_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1493"><a href="#ModifyMaskApp.setup_navigation_toolbar-1493"><span class="linenos">1493</span></a>        <span class="n">save_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_mask</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1494"><a href="#ModifyMaskApp.setup_navigation_toolbar-1494"><span class="linenos">1494</span></a>        <span class="n">save_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1495"><a href="#ModifyMaskApp.setup_navigation_toolbar-1495"><span class="linenos">1495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Image: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1496"><a href="#ModifyMaskApp.setup_navigation_toolbar-1496"><span class="linenos">1496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intensity_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1497"><a href="#ModifyMaskApp.setup_navigation_toolbar-1497"><span class="linenos">1497</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Mask: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1498"><a href="#ModifyMaskApp.setup_navigation_toolbar-1498"><span class="linenos">1498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask_value_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1499"><a href="#ModifyMaskApp.setup_navigation_toolbar-1499"><span class="linenos">1499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">navigation_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Area: N/A&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_navigation_toolbar-1500"><a href="#ModifyMaskApp.setup_navigation_toolbar-1500"><span class="linenos">1500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_count_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.setup_mode_toolbar" class="classattr">
                                        <input id="ModifyMaskApp.setup_mode_toolbar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_mode_toolbar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.setup_mode_toolbar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.setup_mode_toolbar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.setup_mode_toolbar-1502"><a href="#ModifyMaskApp.setup_mode_toolbar-1502"><span class="linenos">1502</span></a>    <span class="k">def</span> <span class="nf">setup_mode_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1503"><a href="#ModifyMaskApp.setup_mode_toolbar-1503"><span class="linenos">1503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1504"><a href="#ModifyMaskApp.setup_mode_toolbar-1504"><span class="linenos">1504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1505"><a href="#ModifyMaskApp.setup_mode_toolbar-1505"><span class="linenos">1505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_draw_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1506"><a href="#ModifyMaskApp.setup_mode_toolbar-1506"><span class="linenos">1506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1507"><a href="#ModifyMaskApp.setup_mode_toolbar-1507"><span class="linenos">1507</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_magic_wand_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1508"><a href="#ModifyMaskApp.setup_mode_toolbar-1508"><span class="linenos">1508</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1509"><a href="#ModifyMaskApp.setup_mode_toolbar-1509"><span class="linenos">1509</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Tolerance:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1510"><a href="#ModifyMaskApp.setup_mode_toolbar-1510"><span class="linenos">1510</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1511"><a href="#ModifyMaskApp.setup_mode_toolbar-1511"><span class="linenos">1511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1512"><a href="#ModifyMaskApp.setup_mode_toolbar-1512"><span class="linenos">1512</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Max Pixels:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1513"><a href="#ModifyMaskApp.setup_mode_toolbar-1513"><span class="linenos">1513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1514"><a href="#ModifyMaskApp.setup_mode_toolbar-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1515"><a href="#ModifyMaskApp.setup_mode_toolbar-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1516"><a href="#ModifyMaskApp.setup_mode_toolbar-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_erase_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1517"><a href="#ModifyMaskApp.setup_mode_toolbar-1517"><span class="linenos">1517</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1518"><a href="#ModifyMaskApp.setup_mode_toolbar-1518"><span class="linenos">1518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_brush_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1519"><a href="#ModifyMaskApp.setup_mode_toolbar-1519"><span class="linenos">1519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1520"><a href="#ModifyMaskApp.setup_mode_toolbar-1520"><span class="linenos">1520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1521"><a href="#ModifyMaskApp.setup_mode_toolbar-1521"><span class="linenos">1521</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1522"><a href="#ModifyMaskApp.setup_mode_toolbar-1522"><span class="linenos">1522</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1523"><a href="#ModifyMaskApp.setup_mode_toolbar-1523"><span class="linenos">1523</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush Size:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1524"><a href="#ModifyMaskApp.setup_mode_toolbar-1524"><span class="linenos">1524</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_dividing_line_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_mode_toolbar-1525"><a href="#ModifyMaskApp.setup_mode_toolbar-1525"><span class="linenos">1525</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.setup_function_toolbar" class="classattr">
                                        <input id="ModifyMaskApp.setup_function_toolbar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_function_toolbar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.setup_function_toolbar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.setup_function_toolbar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.setup_function_toolbar-1527"><a href="#ModifyMaskApp.setup_function_toolbar-1527"><span class="linenos">1527</span></a>    <span class="k">def</span> <span class="nf">setup_function_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1528"><a href="#ModifyMaskApp.setup_function_toolbar-1528"><span class="linenos">1528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1529"><a href="#ModifyMaskApp.setup_function_toolbar-1529"><span class="linenos">1529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1530"><a href="#ModifyMaskApp.setup_function_toolbar-1530"><span class="linenos">1530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Fill&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1531"><a href="#ModifyMaskApp.setup_function_toolbar-1531"><span class="linenos">1531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1532"><a href="#ModifyMaskApp.setup_function_toolbar-1532"><span class="linenos">1532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Relabel&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relabel_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1533"><a href="#ModifyMaskApp.setup_function_toolbar-1533"><span class="linenos">1533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1534"><a href="#ModifyMaskApp.setup_function_toolbar-1534"><span class="linenos">1534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Clear&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1535"><a href="#ModifyMaskApp.setup_function_toolbar-1535"><span class="linenos">1535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1536"><a href="#ModifyMaskApp.setup_function_toolbar-1536"><span class="linenos">1536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">invert_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Invert&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">invert_mask</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1537"><a href="#ModifyMaskApp.setup_function_toolbar-1537"><span class="linenos">1537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">invert_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1538"><a href="#ModifyMaskApp.setup_function_toolbar-1538"><span class="linenos">1538</span></a>        <span class="n">remove_small_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove Small&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_small_objects</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1539"><a href="#ModifyMaskApp.setup_function_toolbar-1539"><span class="linenos">1539</span></a>        <span class="n">remove_small_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1540"><a href="#ModifyMaskApp.setup_function_toolbar-1540"><span class="linenos">1540</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Min Area:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1541"><a href="#ModifyMaskApp.setup_function_toolbar-1541"><span class="linenos">1541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1542"><a href="#ModifyMaskApp.setup_function_toolbar-1542"><span class="linenos">1542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>  <span class="c1"># Default minimum area</span>
</span><span id="ModifyMaskApp.setup_function_toolbar-1543"><a href="#ModifyMaskApp.setup_function_toolbar-1543"><span class="linenos">1543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.setup_zoom_toolbar" class="classattr">
                                        <input id="ModifyMaskApp.setup_zoom_toolbar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_zoom_toolbar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.setup_zoom_toolbar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.setup_zoom_toolbar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.setup_zoom_toolbar-1545"><a href="#ModifyMaskApp.setup_zoom_toolbar-1545"><span class="linenos">1545</span></a>    <span class="k">def</span> <span class="nf">setup_zoom_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1546"><a href="#ModifyMaskApp.setup_zoom_toolbar-1546"><span class="linenos">1546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1547"><a href="#ModifyMaskApp.setup_zoom_toolbar-1547"><span class="linenos">1547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1548"><a href="#ModifyMaskApp.setup_zoom_toolbar-1548"><span class="linenos">1548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_zoom_mode</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1549"><a href="#ModifyMaskApp.setup_zoom_toolbar-1549"><span class="linenos">1549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1550"><a href="#ModifyMaskApp.setup_zoom_toolbar-1550"><span class="linenos">1550</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply Normalization&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_normalization</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1551"><a href="#ModifyMaskApp.setup_zoom_toolbar-1551"><span class="linenos">1551</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_btn</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1552"><a href="#ModifyMaskApp.setup_zoom_toolbar-1552"><span class="linenos">1552</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Lower Percentile:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1553"><a href="#ModifyMaskApp.setup_zoom_toolbar-1553"><span class="linenos">1553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1554"><a href="#ModifyMaskApp.setup_zoom_toolbar-1554"><span class="linenos">1554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1555"><a href="#ModifyMaskApp.setup_zoom_toolbar-1555"><span class="linenos">1555</span></a>        
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1556"><a href="#ModifyMaskApp.setup_zoom_toolbar-1556"><span class="linenos">1556</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Upper Percentile:&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1557"><a href="#ModifyMaskApp.setup_zoom_toolbar-1557"><span class="linenos">1557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_toolbar</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.setup_zoom_toolbar-1558"><a href="#ModifyMaskApp.setup_zoom_toolbar-1558"><span class="linenos">1558</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.load_image_and_mask" class="classattr">
                                        <input id="ModifyMaskApp.load_image_and_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_image_and_mask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.load_image_and_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.load_image_and_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.load_image_and_mask-1560"><a href="#ModifyMaskApp.load_image_and_mask-1560"><span class="linenos">1560</span></a>    <span class="k">def</span> <span class="nf">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1561"><a href="#ModifyMaskApp.load_image_and_mask-1561"><span class="linenos">1561</span></a>        <span class="c1"># Load the image</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1562"><a href="#ModifyMaskApp.load_image_and_mask-1562"><span class="linenos">1562</span></a>        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1563"><a href="#ModifyMaskApp.load_image_and_mask-1563"><span class="linenos">1563</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1564"><a href="#ModifyMaskApp.load_image_and_mask-1564"><span class="linenos">1564</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Image shape: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, dtype: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1565"><a href="#ModifyMaskApp.load_image_and_mask-1565"><span class="linenos">1565</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1566"><a href="#ModifyMaskApp.load_image_and_mask-1566"><span class="linenos">1566</span></a>        <span class="c1"># Handle multi-channel or transparency issues</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1567"><a href="#ModifyMaskApp.load_image_and_mask-1567"><span class="linenos">1567</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1568"><a href="#ModifyMaskApp.load_image_and_mask-1568"><span class="linenos">1568</span></a>            <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># If the image has an alpha channel (RGBA)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1569"><a href="#ModifyMaskApp.load_image_and_mask-1569"><span class="linenos">1569</span></a>                <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Remove the alpha channel</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1570"><a href="#ModifyMaskApp.load_image_and_mask-1570"><span class="linenos">1570</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1571"><a href="#ModifyMaskApp.load_image_and_mask-1571"><span class="linenos">1571</span></a>            <span class="c1"># Convert RGB to grayscale using weighted average</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1572"><a href="#ModifyMaskApp.load_image_and_mask-1572"><span class="linenos">1572</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2989</span><span class="p">,</span> <span class="mf">0.5870</span><span class="p">,</span> <span class="mf">0.1140</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1573"><a href="#ModifyMaskApp.load_image_and_mask-1573"><span class="linenos">1573</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converted to grayscale: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1574"><a href="#ModifyMaskApp.load_image_and_mask-1574"><span class="linenos">1574</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1575"><a href="#ModifyMaskApp.load_image_and_mask-1575"><span class="linenos">1575</span></a>        <span class="c1"># Ensure the shape is (height, width) without extra channel</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1576"><a href="#ModifyMaskApp.load_image_and_mask-1576"><span class="linenos">1576</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1577"><a href="#ModifyMaskApp.load_image_and_mask-1577"><span class="linenos">1577</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1578"><a href="#ModifyMaskApp.load_image_and_mask-1578"><span class="linenos">1578</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1579"><a href="#ModifyMaskApp.load_image_and_mask-1579"><span class="linenos">1579</span></a>        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">:</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1580"><a href="#ModifyMaskApp.load_image_and_mask-1580"><span class="linenos">1580</span></a>            <span class="c1"># Scale the image to fit the 16-bit range (065535)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1581"><a href="#ModifyMaskApp.load_image_and_mask-1581"><span class="linenos">1581</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">/</span> <span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">65535</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1582"><a href="#ModifyMaskApp.load_image_and_mask-1582"><span class="linenos">1582</span></a>            <span class="c1"># eventually remove this images should not have to be 16 bit look into downstream function (non 16bit images are jsut black)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1583"><a href="#ModifyMaskApp.load_image_and_mask-1583"><span class="linenos">1583</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1584"><a href="#ModifyMaskApp.load_image_and_mask-1584"><span class="linenos">1584</span></a>        <span class="c1"># Load the corresponding mask</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1585"><a href="#ModifyMaskApp.load_image_and_mask-1585"><span class="linenos">1585</span></a>        <span class="n">mask_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masks_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1586"><a href="#ModifyMaskApp.load_image_and_mask-1586"><span class="linenos">1586</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">mask_path</span><span class="p">):</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1587"><a href="#ModifyMaskApp.load_image_and_mask-1587"><span class="linenos">1587</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading mask: </span><span class="si">{</span><span class="n">mask_path</span><span class="si">}</span><span class="s1"> for image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1588"><a href="#ModifyMaskApp.load_image_and_mask-1588"><span class="linenos">1588</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">mask_path</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1589"><a href="#ModifyMaskApp.load_image_and_mask-1589"><span class="linenos">1589</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1590"><a href="#ModifyMaskApp.load_image_and_mask-1590"><span class="linenos">1590</span></a>            <span class="c1"># Ensure mask is uint8</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1591"><a href="#ModifyMaskApp.load_image_and_mask-1591"><span class="linenos">1591</span></a>            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1592"><a href="#ModifyMaskApp.load_image_and_mask-1592"><span class="linenos">1592</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1593"><a href="#ModifyMaskApp.load_image_and_mask-1593"><span class="linenos">1593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1594"><a href="#ModifyMaskApp.load_image_and_mask-1594"><span class="linenos">1594</span></a>            <span class="c1"># Create a new mask with the same size as the image</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1595"><a href="#ModifyMaskApp.load_image_and_mask-1595"><span class="linenos">1595</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1596"><a href="#ModifyMaskApp.load_image_and_mask-1596"><span class="linenos">1596</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded new mask for image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.load_image_and_mask-1597"><a href="#ModifyMaskApp.load_image_and_mask-1597"><span class="linenos">1597</span></a>
</span><span id="ModifyMaskApp.load_image_and_mask-1598"><a href="#ModifyMaskApp.load_image_and_mask-1598"><span class="linenos">1598</span></a>        <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.display_image" class="classattr">
                                        <input id="ModifyMaskApp.display_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.display_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.display_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.display_image-1603"><a href="#ModifyMaskApp.display_image-1603"><span class="linenos">1603</span></a>    <span class="k">def</span> <span class="nf">display_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.display_image-1604"><a href="#ModifyMaskApp.display_image-1604"><span class="linenos">1604</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp.display_image-1605"><a href="#ModifyMaskApp.display_image-1605"><span class="linenos">1605</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_image-1606"><a href="#ModifyMaskApp.display_image-1606"><span class="linenos">1606</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.display_image-1607"><a href="#ModifyMaskApp.display_image-1607"><span class="linenos">1607</span></a>        <span class="n">lower_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="ModifyMaskApp.display_image-1608"><a href="#ModifyMaskApp.display_image-1608"><span class="linenos">1608</span></a>        <span class="n">upper_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">99.9</span>
</span><span id="ModifyMaskApp.display_image-1609"><a href="#ModifyMaskApp.display_image-1609"><span class="linenos">1609</span></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_image-1610"><a href="#ModifyMaskApp.display_image-1610"><span class="linenos">1610</span></a>        <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_mask_on_image</span><span class="p">(</span><span class="n">normalized</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_image-1611"><a href="#ModifyMaskApp.display_image-1611"><span class="linenos">1611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
</span><span id="ModifyMaskApp.display_image-1612"><a href="#ModifyMaskApp.display_image-1612"><span class="linenos">1612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;nw&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.display_zoomed_image" class="classattr">
                                        <input id="ModifyMaskApp.display_zoomed_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_zoomed_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.display_zoomed_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.display_zoomed_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.display_zoomed_image-1614"><a href="#ModifyMaskApp.display_zoomed_image-1614"><span class="linenos">1614</span></a>    <span class="k">def</span> <span class="nf">display_zoomed_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1615"><a href="#ModifyMaskApp.display_zoomed_image-1615"><span class="linenos">1615</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span><span class="p">:</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1616"><a href="#ModifyMaskApp.display_zoomed_image-1616"><span class="linenos">1616</span></a>            <span class="c1"># Convert canvas coordinates to image coordinates</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1617"><a href="#ModifyMaskApp.display_zoomed_image-1617"><span class="linenos">1617</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1618"><a href="#ModifyMaskApp.display_zoomed_image-1618"><span class="linenos">1618</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1619"><a href="#ModifyMaskApp.display_zoomed_image-1619"><span class="linenos">1619</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1620"><a href="#ModifyMaskApp.display_zoomed_image-1620"><span class="linenos">1620</span></a>            <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1621"><a href="#ModifyMaskApp.display_zoomed_image-1621"><span class="linenos">1621</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="n">x0</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1622"><a href="#ModifyMaskApp.display_zoomed_image-1622"><span class="linenos">1622</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="n">y0</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1623"><a href="#ModifyMaskApp.display_zoomed_image-1623"><span class="linenos">1623</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="n">x1</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1624"><a href="#ModifyMaskApp.display_zoomed_image-1624"><span class="linenos">1624</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1625"><a href="#ModifyMaskApp.display_zoomed_image-1625"><span class="linenos">1625</span></a>            <span class="c1"># Normalize the entire image</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1626"><a href="#ModifyMaskApp.display_zoomed_image-1626"><span class="linenos">1626</span></a>            <span class="n">lower_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1627"><a href="#ModifyMaskApp.display_zoomed_image-1627"><span class="linenos">1627</span></a>            <span class="n">upper_quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="mf">99.9</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1628"><a href="#ModifyMaskApp.display_zoomed_image-1628"><span class="linenos">1628</span></a>            <span class="n">normalized_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">lower_quantile</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1629"><a href="#ModifyMaskApp.display_zoomed_image-1629"><span class="linenos">1629</span></a>            <span class="c1"># Extract the zoomed portion of the normalized image and mask</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1630"><a href="#ModifyMaskApp.display_zoomed_image-1630"><span class="linenos">1630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="n">normalized_image</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1631"><a href="#ModifyMaskApp.display_zoomed_image-1631"><span class="linenos">1631</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1632"><a href="#ModifyMaskApp.display_zoomed_image-1632"><span class="linenos">1632</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1633"><a href="#ModifyMaskApp.display_zoomed_image-1633"><span class="linenos">1633</span></a>            <span class="n">original_mask_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1634"><a href="#ModifyMaskApp.display_zoomed_image-1634"><span class="linenos">1634</span></a>            <span class="n">zoom_mask_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1635"><a href="#ModifyMaskApp.display_zoomed_image-1635"><span class="linenos">1635</span></a>            <span class="k">if</span> <span class="n">original_mask_area</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1636"><a href="#ModifyMaskApp.display_zoomed_image-1636"><span class="linenos">1636</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span> <span class="o">=</span> <span class="n">original_mask_area</span><span class="o">/</span><span class="n">zoom_mask_area</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1637"><a href="#ModifyMaskApp.display_zoomed_image-1637"><span class="linenos">1637</span></a>            <span class="c1"># Resize the zoomed image and mask to fit the canvas</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1638"><a href="#ModifyMaskApp.display_zoomed_image-1638"><span class="linenos">1638</span></a>            <span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1639"><a href="#ModifyMaskApp.display_zoomed_image-1639"><span class="linenos">1639</span></a>            <span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1640"><a href="#ModifyMaskApp.display_zoomed_image-1640"><span class="linenos">1640</span></a>            
</span><span id="ModifyMaskApp.display_zoomed_image-1641"><a href="#ModifyMaskApp.display_zoomed_image-1641"><span class="linenos">1641</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">canvas_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">canvas_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1642"><a href="#ModifyMaskApp.display_zoomed_image-1642"><span class="linenos">1642</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1643"><a href="#ModifyMaskApp.display_zoomed_image-1643"><span class="linenos">1643</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1644"><a href="#ModifyMaskApp.display_zoomed_image-1644"><span class="linenos">1644</span></a>                <span class="c1">#self.zoom_mask = resize(self.zoom_mask, (canvas_height, canvas_width), preserve_range=True).astype(np.uint8)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1645"><a href="#ModifyMaskApp.display_zoomed_image-1645"><span class="linenos">1645</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1646"><a href="#ModifyMaskApp.display_zoomed_image-1646"><span class="linenos">1646</span></a>                <span class="n">combined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_mask_on_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1647"><a href="#ModifyMaskApp.display_zoomed_image-1647"><span class="linenos">1647</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
</span><span id="ModifyMaskApp.display_zoomed_image-1648"><a href="#ModifyMaskApp.display_zoomed_image-1648"><span class="linenos">1648</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;nw&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk_image</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.overlay_mask_on_image" class="classattr">
                                        <input id="ModifyMaskApp.overlay_mask_on_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">overlay_mask_on_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">mask</span>, </span><span class="param"><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.overlay_mask_on_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.overlay_mask_on_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.overlay_mask_on_image-1650"><a href="#ModifyMaskApp.overlay_mask_on_image-1650"><span class="linenos">1650</span></a>    <span class="k">def</span> <span class="nf">overlay_mask_on_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1651"><a href="#ModifyMaskApp.overlay_mask_on_image-1651"><span class="linenos">1651</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1652"><a href="#ModifyMaskApp.overlay_mask_on_image-1652"><span class="linenos">1652</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">image</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1653"><a href="#ModifyMaskApp.overlay_mask_on_image-1653"><span class="linenos">1653</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1654"><a href="#ModifyMaskApp.overlay_mask_on_image-1654"><span class="linenos">1654</span></a>        <span class="n">max_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1655"><a href="#ModifyMaskApp.overlay_mask_on_image-1655"><span class="linenos">1655</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1656"><a href="#ModifyMaskApp.overlay_mask_on_image-1656"><span class="linenos">1656</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">max_label</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1657"><a href="#ModifyMaskApp.overlay_mask_on_image-1657"><span class="linenos">1657</span></a>        <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># background color</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1658"><a href="#ModifyMaskApp.overlay_mask_on_image-1658"><span class="linenos">1658</span></a>        <span class="n">colored_mask</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1659"><a href="#ModifyMaskApp.overlay_mask_on_image-1659"><span class="linenos">1659</span></a>        <span class="n">image_8bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">/</span> <span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1660"><a href="#ModifyMaskApp.overlay_mask_on_image-1660"><span class="linenos">1660</span></a>        <span class="c1"># Blend the mask and the image with transparency</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1661"><a href="#ModifyMaskApp.overlay_mask_on_image-1661"><span class="linenos">1661</span></a>        <span class="n">combined_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> 
</span><span id="ModifyMaskApp.overlay_mask_on_image-1662"><a href="#ModifyMaskApp.overlay_mask_on_image-1662"><span class="linenos">1662</span></a>                                  <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image_8bit</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">colored_mask</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> 
</span><span id="ModifyMaskApp.overlay_mask_on_image-1663"><a href="#ModifyMaskApp.overlay_mask_on_image-1663"><span class="linenos">1663</span></a>                                  <span class="n">image_8bit</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1664"><a href="#ModifyMaskApp.overlay_mask_on_image-1664"><span class="linenos">1664</span></a>        <span class="c1"># Convert the final image back to uint8</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1665"><a href="#ModifyMaskApp.overlay_mask_on_image-1665"><span class="linenos">1665</span></a>        <span class="n">combined_image</span> <span class="o">=</span> <span class="n">combined_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.overlay_mask_on_image-1666"><a href="#ModifyMaskApp.overlay_mask_on_image-1666"><span class="linenos">1666</span></a>        <span class="k">return</span> <span class="n">combined_image</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.previous_image" class="classattr">
                                        <input id="ModifyMaskApp.previous_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">previous_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.previous_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.previous_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.previous_image-1672"><a href="#ModifyMaskApp.previous_image-1672"><span class="linenos">1672</span></a>    <span class="k">def</span> <span class="nf">previous_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.previous_image-1673"><a href="#ModifyMaskApp.previous_image-1673"><span class="linenos">1673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.previous_image-1674"><a href="#ModifyMaskApp.previous_image-1674"><span class="linenos">1674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp.previous_image-1675"><a href="#ModifyMaskApp.previous_image-1675"><span class="linenos">1675</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>            
</span><span id="ModifyMaskApp.previous_image-1676"><a href="#ModifyMaskApp.previous_image-1676"><span class="linenos">1676</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="ModifyMaskApp.previous_image-1677"><a href="#ModifyMaskApp.previous_image-1677"><span class="linenos">1677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp.previous_image-1678"><a href="#ModifyMaskApp.previous_image-1678"><span class="linenos">1678</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.previous_image-1679"><a href="#ModifyMaskApp.previous_image-1679"><span class="linenos">1679</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.next_image" class="classattr">
                                        <input id="ModifyMaskApp.next_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.next_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.next_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.next_image-1681"><a href="#ModifyMaskApp.next_image-1681"><span class="linenos">1681</span></a>    <span class="k">def</span> <span class="nf">next_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.next_image-1682"><a href="#ModifyMaskApp.next_image-1682"><span class="linenos">1682</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ModifyMaskApp.next_image-1683"><a href="#ModifyMaskApp.next_image-1683"><span class="linenos">1683</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp.next_image-1684"><a href="#ModifyMaskApp.next_image-1684"><span class="linenos">1684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_flags</span><span class="p">()</span>            
</span><span id="ModifyMaskApp.next_image-1685"><a href="#ModifyMaskApp.next_image-1685"><span class="linenos">1685</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_and_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">)</span>
</span><span id="ModifyMaskApp.next_image-1686"><a href="#ModifyMaskApp.next_image-1686"><span class="linenos">1686</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ModifyMaskApp.next_image-1687"><a href="#ModifyMaskApp.next_image-1687"><span class="linenos">1687</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize_arrays</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.next_image-1688"><a href="#ModifyMaskApp.next_image-1688"><span class="linenos">1688</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.save_mask" class="classattr">
                                        <input id="ModifyMaskApp.save_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_mask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.save_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.save_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.save_mask-1690"><a href="#ModifyMaskApp.save_mask-1690"><span class="linenos">1690</span></a>    <span class="k">def</span> <span class="nf">save_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.save_mask-1691"><a href="#ModifyMaskApp.save_mask-1691"><span class="linenos">1691</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">):</span>
</span><span id="ModifyMaskApp.save_mask-1692"><a href="#ModifyMaskApp.save_mask-1692"><span class="linenos">1692</span></a>            <span class="n">original_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span>
</span><span id="ModifyMaskApp.save_mask-1693"><a href="#ModifyMaskApp.save_mask-1693"><span class="linenos">1693</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">original_size</span><span class="p">:</span>
</span><span id="ModifyMaskApp.save_mask-1694"><a href="#ModifyMaskApp.save_mask-1694"><span class="linenos">1694</span></a>                <span class="n">resized_mask</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">original_size</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</span><span id="ModifyMaskApp.save_mask-1695"><a href="#ModifyMaskApp.save_mask-1695"><span class="linenos">1695</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.save_mask-1696"><a href="#ModifyMaskApp.save_mask-1696"><span class="linenos">1696</span></a>                <span class="n">resized_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
</span><span id="ModifyMaskApp.save_mask-1697"><a href="#ModifyMaskApp.save_mask-1697"><span class="linenos">1697</span></a>            <span class="n">resized_mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">resized_mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.save_mask-1698"><a href="#ModifyMaskApp.save_mask-1698"><span class="linenos">1698</span></a>            <span class="n">save_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.save_mask-1699"><a href="#ModifyMaskApp.save_mask-1699"><span class="linenos">1699</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_folder</span><span class="p">):</span>
</span><span id="ModifyMaskApp.save_mask-1700"><a href="#ModifyMaskApp.save_mask-1700"><span class="linenos">1700</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_folder</span><span class="p">)</span>
</span><span id="ModifyMaskApp.save_mask-1701"><a href="#ModifyMaskApp.save_mask-1701"><span class="linenos">1701</span></a>            <span class="n">image_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_filenames</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_image_index</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span>
</span><span id="ModifyMaskApp.save_mask-1702"><a href="#ModifyMaskApp.save_mask-1702"><span class="linenos">1702</span></a>            <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_folder</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">)</span>
</span><span id="ModifyMaskApp.save_mask-1703"><a href="#ModifyMaskApp.save_mask-1703"><span class="linenos">1703</span></a>
</span><span id="ModifyMaskApp.save_mask-1704"><a href="#ModifyMaskApp.save_mask-1704"><span class="linenos">1704</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving mask to: </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Debug print</span>
</span><span id="ModifyMaskApp.save_mask-1705"><a href="#ModifyMaskApp.save_mask-1705"><span class="linenos">1705</span></a>            <span class="n">imageio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">resized_mask</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.set_zoom_rectangle_start" class="classattr">
                                        <input id="ModifyMaskApp.set_zoom_rectangle_start-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_zoom_rectangle_start</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.set_zoom_rectangle_start-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.set_zoom_rectangle_start"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.set_zoom_rectangle_start-1710"><a href="#ModifyMaskApp.set_zoom_rectangle_start-1710"><span class="linenos">1710</span></a>    <span class="k">def</span> <span class="nf">set_zoom_rectangle_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_start-1711"><a href="#ModifyMaskApp.set_zoom_rectangle_start-1711"><span class="linenos">1711</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_start-1712"><a href="#ModifyMaskApp.set_zoom_rectangle_start-1712"><span class="linenos">1712</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.set_zoom_rectangle_end" class="classattr">
                                        <input id="ModifyMaskApp.set_zoom_rectangle_end-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_zoom_rectangle_end</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.set_zoom_rectangle_end-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.set_zoom_rectangle_end"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.set_zoom_rectangle_end-1714"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1714"><span class="linenos">1714</span></a>    <span class="k">def</span> <span class="nf">set_zoom_rectangle_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1715"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1715"><span class="linenos">1715</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1716"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1716"><span class="linenos">1716</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1717"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1717"><span class="linenos">1717</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1718"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1718"><span class="linenos">1718</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1719"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1719"><span class="linenos">1719</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1720"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1720"><span class="linenos">1720</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_zoomed_image</span><span class="p">()</span>  
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1721"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1721"><span class="linenos">1721</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>  
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1722"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1722"><span class="linenos">1722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1723"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1723"><span class="linenos">1723</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>  
</span><span id="ModifyMaskApp.set_zoom_rectangle_end-1724"><a href="#ModifyMaskApp.set_zoom_rectangle_end-1724"><span class="linenos">1724</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.update_zoom_box" class="classattr">
                                        <input id="ModifyMaskApp.update_zoom_box-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_zoom_box</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.update_zoom_box-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.update_zoom_box"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.update_zoom_box-1726"><a href="#ModifyMaskApp.update_zoom_box-1726"><span class="linenos">1726</span></a>    <span class="k">def</span> <span class="nf">update_zoom_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.update_zoom_box-1727"><a href="#ModifyMaskApp.update_zoom_box-1727"><span class="linenos">1727</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_zoom_box-1728"><a href="#ModifyMaskApp.update_zoom_box-1728"><span class="linenos">1728</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_zoom_box-1729"><a href="#ModifyMaskApp.update_zoom_box-1729"><span class="linenos">1729</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_zoom_box-1730"><a href="#ModifyMaskApp.update_zoom_box-1730"><span class="linenos">1730</span></a>            <span class="c1"># Assuming event.x and event.y are already in image coordinates</span>
</span><span id="ModifyMaskApp.update_zoom_box-1731"><a href="#ModifyMaskApp.update_zoom_box-1731"><span class="linenos">1731</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_zoom_box-1732"><a href="#ModifyMaskApp.update_zoom_box-1732"><span class="linenos">1732</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span>
</span><span id="ModifyMaskApp.update_zoom_box-1733"><a href="#ModifyMaskApp.update_zoom_box-1733"><span class="linenos">1733</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span>
</span><span id="ModifyMaskApp.update_zoom_box-1734"><a href="#ModifyMaskApp.update_zoom_box-1734"><span class="linenos">1734</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.toggle_zoom_mode" class="classattr">
                                        <input id="ModifyMaskApp.toggle_zoom_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_zoom_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.toggle_zoom_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.toggle_zoom_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.toggle_zoom_mode-1740"><a href="#ModifyMaskApp.toggle_zoom_mode-1740"><span class="linenos">1740</span></a>    <span class="k">def</span> <span class="nf">toggle_zoom_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1741"><a href="#ModifyMaskApp.toggle_zoom_mode-1741"><span class="linenos">1741</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1742"><a href="#ModifyMaskApp.toggle_zoom_mode-1742"><span class="linenos">1742</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1743"><a href="#ModifyMaskApp.toggle_zoom_mode-1743"><span class="linenos">1743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1744"><a href="#ModifyMaskApp.toggle_zoom_mode-1744"><span class="linenos">1744</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1745"><a href="#ModifyMaskApp.toggle_zoom_mode-1745"><span class="linenos">1745</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1746"><a href="#ModifyMaskApp.toggle_zoom_mode-1746"><span class="linenos">1746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1747"><a href="#ModifyMaskApp.toggle_zoom_mode-1747"><span class="linenos">1747</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1748"><a href="#ModifyMaskApp.toggle_zoom_mode-1748"><span class="linenos">1748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1749"><a href="#ModifyMaskApp.toggle_zoom_mode-1749"><span class="linenos">1749</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1750"><a href="#ModifyMaskApp.toggle_zoom_mode-1750"><span class="linenos">1750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1751"><a href="#ModifyMaskApp.toggle_zoom_mode-1751"><span class="linenos">1751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1752"><a href="#ModifyMaskApp.toggle_zoom_mode-1752"><span class="linenos">1752</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1753"><a href="#ModifyMaskApp.toggle_zoom_mode-1753"><span class="linenos">1753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1754"><a href="#ModifyMaskApp.toggle_zoom_mode-1754"><span class="linenos">1754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1755"><a href="#ModifyMaskApp.toggle_zoom_mode-1755"><span class="linenos">1755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1756"><a href="#ModifyMaskApp.toggle_zoom_mode-1756"><span class="linenos">1756</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1757"><a href="#ModifyMaskApp.toggle_zoom_mode-1757"><span class="linenos">1757</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1758"><a href="#ModifyMaskApp.toggle_zoom_mode-1758"><span class="linenos">1758</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1759"><a href="#ModifyMaskApp.toggle_zoom_mode-1759"><span class="linenos">1759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1760"><a href="#ModifyMaskApp.toggle_zoom_mode-1760"><span class="linenos">1760</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1761"><a href="#ModifyMaskApp.toggle_zoom_mode-1761"><span class="linenos">1761</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_start</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1762"><a href="#ModifyMaskApp.toggle_zoom_mode-1762"><span class="linenos">1762</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_zoom_rectangle_end</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1763"><a href="#ModifyMaskApp.toggle_zoom_mode-1763"><span class="linenos">1763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_zoom_box</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1764"><a href="#ModifyMaskApp.toggle_zoom_mode-1764"><span class="linenos">1764</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1765"><a href="#ModifyMaskApp.toggle_zoom_mode-1765"><span class="linenos">1765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1766"><a href="#ModifyMaskApp.toggle_zoom_mode-1766"><span class="linenos">1766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1767"><a href="#ModifyMaskApp.toggle_zoom_mode-1767"><span class="linenos">1767</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1768"><a href="#ModifyMaskApp.toggle_zoom_mode-1768"><span class="linenos">1768</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1769"><a href="#ModifyMaskApp.toggle_zoom_mode-1769"><span class="linenos">1769</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1770"><a href="#ModifyMaskApp.toggle_zoom_mode-1770"><span class="linenos">1770</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1771"><a href="#ModifyMaskApp.toggle_zoom_mode-1771"><span class="linenos">1771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1772"><a href="#ModifyMaskApp.toggle_zoom_mode-1772"><span class="linenos">1772</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1773"><a href="#ModifyMaskApp.toggle_zoom_mode-1773"><span class="linenos">1773</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mouse_info</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1774"><a href="#ModifyMaskApp.toggle_zoom_mode-1774"><span class="linenos">1774</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1775"><a href="#ModifyMaskApp.toggle_zoom_mode-1775"><span class="linenos">1775</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_end</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1776"><a href="#ModifyMaskApp.toggle_zoom_mode-1776"><span class="linenos">1776</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_rectangle_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1777"><a href="#ModifyMaskApp.toggle_zoom_mode-1777"><span class="linenos">1777</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1778"><a href="#ModifyMaskApp.toggle_zoom_mode-1778"><span class="linenos">1778</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1779"><a href="#ModifyMaskApp.toggle_zoom_mode-1779"><span class="linenos">1779</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1780"><a href="#ModifyMaskApp.toggle_zoom_mode-1780"><span class="linenos">1780</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1781"><a href="#ModifyMaskApp.toggle_zoom_mode-1781"><span class="linenos">1781</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1782"><a href="#ModifyMaskApp.toggle_zoom_mode-1782"><span class="linenos">1782</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ModifyMaskApp.toggle_zoom_mode-1783"><a href="#ModifyMaskApp.toggle_zoom_mode-1783"><span class="linenos">1783</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.toggle_brush_mode" class="classattr">
                                        <input id="ModifyMaskApp.toggle_brush_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_brush_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.toggle_brush_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.toggle_brush_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.toggle_brush_mode-1785"><a href="#ModifyMaskApp.toggle_brush_mode-1785"><span class="linenos">1785</span></a>    <span class="k">def</span> <span class="nf">toggle_brush_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1786"><a href="#ModifyMaskApp.toggle_brush_mode-1786"><span class="linenos">1786</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1787"><a href="#ModifyMaskApp.toggle_brush_mode-1787"><span class="linenos">1787</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1788"><a href="#ModifyMaskApp.toggle_brush_mode-1788"><span class="linenos">1788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1789"><a href="#ModifyMaskApp.toggle_brush_mode-1789"><span class="linenos">1789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1790"><a href="#ModifyMaskApp.toggle_brush_mode-1790"><span class="linenos">1790</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1791"><a href="#ModifyMaskApp.toggle_brush_mode-1791"><span class="linenos">1791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1792"><a href="#ModifyMaskApp.toggle_brush_mode-1792"><span class="linenos">1792</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1793"><a href="#ModifyMaskApp.toggle_brush_mode-1793"><span class="linenos">1793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1794"><a href="#ModifyMaskApp.toggle_brush_mode-1794"><span class="linenos">1794</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1795"><a href="#ModifyMaskApp.toggle_brush_mode-1795"><span class="linenos">1795</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1796"><a href="#ModifyMaskApp.toggle_brush_mode-1796"><span class="linenos">1796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1797"><a href="#ModifyMaskApp.toggle_brush_mode-1797"><span class="linenos">1797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1798"><a href="#ModifyMaskApp.toggle_brush_mode-1798"><span class="linenos">1798</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_brush</span><span class="p">)</span>  <span class="c1"># Left click and drag to apply brush</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1799"><a href="#ModifyMaskApp.toggle_brush_mode-1799"><span class="linenos">1799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_brush</span><span class="p">)</span>  <span class="c1"># Right click and drag to erase with brush</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1800"><a href="#ModifyMaskApp.toggle_brush_mode-1800"><span class="linenos">1800</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_brush_release</span><span class="p">)</span>  <span class="c1"># Left button release</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1801"><a href="#ModifyMaskApp.toggle_brush_mode-1801"><span class="linenos">1801</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_brush_release</span><span class="p">)</span>  <span class="c1"># Right button release</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1802"><a href="#ModifyMaskApp.toggle_brush_mode-1802"><span class="linenos">1802</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1803"><a href="#ModifyMaskApp.toggle_brush_mode-1803"><span class="linenos">1803</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1804"><a href="#ModifyMaskApp.toggle_brush_mode-1804"><span class="linenos">1804</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1805"><a href="#ModifyMaskApp.toggle_brush_mode-1805"><span class="linenos">1805</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1806"><a href="#ModifyMaskApp.toggle_brush_mode-1806"><span class="linenos">1806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1807"><a href="#ModifyMaskApp.toggle_brush_mode-1807"><span class="linenos">1807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_brush_mode-1808"><a href="#ModifyMaskApp.toggle_brush_mode-1808"><span class="linenos">1808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.image_to_canvas" class="classattr">
                                        <input id="ModifyMaskApp.image_to_canvas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">image_to_canvas</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x_image</span>, </span><span class="param"><span class="n">y_image</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.image_to_canvas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.image_to_canvas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.image_to_canvas-1810"><a href="#ModifyMaskApp.image_to_canvas-1810"><span class="linenos">1810</span></a>    <span class="k">def</span> <span class="nf">image_to_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_image</span><span class="p">,</span> <span class="n">y_image</span><span class="p">):</span>
</span><span id="ModifyMaskApp.image_to_canvas-1811"><a href="#ModifyMaskApp.image_to_canvas-1811"><span class="linenos">1811</span></a>        <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scaling_factors</span><span class="p">(</span>
</span><span id="ModifyMaskApp.image_to_canvas-1812"><a href="#ModifyMaskApp.image_to_canvas-1812"><span class="linenos">1812</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="ModifyMaskApp.image_to_canvas-1813"><a href="#ModifyMaskApp.image_to_canvas-1813"><span class="linenos">1813</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span>
</span><span id="ModifyMaskApp.image_to_canvas-1814"><a href="#ModifyMaskApp.image_to_canvas-1814"><span class="linenos">1814</span></a>        <span class="p">)</span>
</span><span id="ModifyMaskApp.image_to_canvas-1815"><a href="#ModifyMaskApp.image_to_canvas-1815"><span class="linenos">1815</span></a>        <span class="n">x_canvas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_image</span> <span class="o">/</span> <span class="n">x_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp.image_to_canvas-1816"><a href="#ModifyMaskApp.image_to_canvas-1816"><span class="linenos">1816</span></a>        <span class="n">y_canvas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_image</span> <span class="o">/</span> <span class="n">y_scale</span><span class="p">)</span>
</span><span id="ModifyMaskApp.image_to_canvas-1817"><a href="#ModifyMaskApp.image_to_canvas-1817"><span class="linenos">1817</span></a>        <span class="k">return</span> <span class="n">x_canvas</span><span class="p">,</span> <span class="n">y_canvas</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.toggle_dividing_line_mode" class="classattr">
                                        <input id="ModifyMaskApp.toggle_dividing_line_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_dividing_line_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.toggle_dividing_line_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.toggle_dividing_line_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.toggle_dividing_line_mode-1819"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1819"><span class="linenos">1819</span></a>    <span class="k">def</span> <span class="nf">toggle_dividing_line_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1820"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1820"><span class="linenos">1820</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1821"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1821"><span class="linenos">1821</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1822"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1822"><span class="linenos">1822</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1823"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1823"><span class="linenos">1823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1824"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1824"><span class="linenos">1824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1825"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1825"><span class="linenos">1825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1826"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1826"><span class="linenos">1826</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1827"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1827"><span class="linenos">1827</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1828"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1828"><span class="linenos">1828</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1829"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1829"><span class="linenos">1829</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1830"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1830"><span class="linenos">1830</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1831"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1831"><span class="linenos">1831</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1832"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1832"><span class="linenos">1832</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1833"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1833"><span class="linenos">1833</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1834"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1834"><span class="linenos">1834</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_dividing_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1835"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1835"><span class="linenos">1835</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">finish_dividing_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1836"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1836"><span class="linenos">1836</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dividing_line_preview</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1837"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1837"><span class="linenos">1837</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1838"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1838"><span class="linenos">1838</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dividing Line Mode: OFF&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1839"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1839"><span class="linenos">1839</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1840"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1840"><span class="linenos">1840</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1841"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1841"><span class="linenos">1841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1842"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1842"><span class="linenos">1842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1843"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1843"><span class="linenos">1843</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_dividing_line_mode-1844"><a href="#ModifyMaskApp.toggle_dividing_line_mode-1844"><span class="linenos">1844</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.start_dividing_line" class="classattr">
                                        <input id="ModifyMaskApp.start_dividing_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">start_dividing_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.start_dividing_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.start_dividing_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.start_dividing_line-1846"><a href="#ModifyMaskApp.start_dividing_line-1846"><span class="linenos">1846</span></a>    <span class="k">def</span> <span class="nf">start_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.start_dividing_line-1847"><a href="#ModifyMaskApp.start_dividing_line-1847"><span class="linenos">1847</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.start_dividing_line-1848"><a href="#ModifyMaskApp.start_dividing_line-1848"><span class="linenos">1848</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
</span><span id="ModifyMaskApp.start_dividing_line-1849"><a href="#ModifyMaskApp.start_dividing_line-1849"><span class="linenos">1849</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.finish_dividing_line" class="classattr">
                                        <input id="ModifyMaskApp.finish_dividing_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">finish_dividing_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.finish_dividing_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.finish_dividing_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.finish_dividing_line-1851"><a href="#ModifyMaskApp.finish_dividing_line-1851"><span class="linenos">1851</span></a>    <span class="k">def</span> <span class="nf">finish_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1852"><a href="#ModifyMaskApp.finish_dividing_line-1852"><span class="linenos">1852</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1853"><a href="#ModifyMaskApp.finish_dividing_line-1853"><span class="linenos">1853</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1854"><a href="#ModifyMaskApp.finish_dividing_line-1854"><span class="linenos">1854</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1855"><a href="#ModifyMaskApp.finish_dividing_line-1855"><span class="linenos">1855</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">]</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1856"><a href="#ModifyMaskApp.finish_dividing_line-1856"><span class="linenos">1856</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_dividing_line</span><span class="p">()</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1857"><a href="#ModifyMaskApp.finish_dividing_line-1857"><span class="linenos">1857</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp.finish_dividing_line-1858"><a href="#ModifyMaskApp.finish_dividing_line-1858"><span class="linenos">1858</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.update_dividing_line_preview" class="classattr">
                                        <input id="ModifyMaskApp.update_dividing_line_preview-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_dividing_line_preview</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.update_dividing_line_preview-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.update_dividing_line_preview"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.update_dividing_line_preview-1860"><a href="#ModifyMaskApp.update_dividing_line_preview-1860"><span class="linenos">1860</span></a>    <span class="k">def</span> <span class="nf">update_dividing_line_preview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1861"><a href="#ModifyMaskApp.update_dividing_line_preview-1861"><span class="linenos">1861</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1862"><a href="#ModifyMaskApp.update_dividing_line_preview-1862"><span class="linenos">1862</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1863"><a href="#ModifyMaskApp.update_dividing_line_preview-1863"><span class="linenos">1863</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1864"><a href="#ModifyMaskApp.update_dividing_line_preview-1864"><span class="linenos">1864</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1865"><a href="#ModifyMaskApp.update_dividing_line_preview-1865"><span class="linenos">1865</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1866"><a href="#ModifyMaskApp.update_dividing_line_preview-1866"><span class="linenos">1866</span></a>            <span class="n">canvas_coords</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_to_canvas</span><span class="p">(</span><span class="o">*</span><span class="n">pt</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">]</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1867"><a href="#ModifyMaskApp.update_dividing_line_preview-1867"><span class="linenos">1867</span></a>            <span class="n">flat_canvas_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">canvas_coords</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">pt</span><span class="p">]</span>
</span><span id="ModifyMaskApp.update_dividing_line_preview-1868"><a href="#ModifyMaskApp.update_dividing_line_preview-1868"><span class="linenos">1868</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dividing_line</span><span class="p">,</span> <span class="o">*</span><span class="n">flat_canvas_coords</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.apply_dividing_line" class="classattr">
                                        <input id="ModifyMaskApp.apply_dividing_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_dividing_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.apply_dividing_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.apply_dividing_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.apply_dividing_line-1870"><a href="#ModifyMaskApp.apply_dividing_line-1870"><span class="linenos">1870</span></a>    <span class="k">def</span> <span class="nf">apply_dividing_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1871"><a href="#ModifyMaskApp.apply_dividing_line-1871"><span class="linenos">1871</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1872"><a href="#ModifyMaskApp.apply_dividing_line-1872"><span class="linenos">1872</span></a>            <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1873"><a href="#ModifyMaskApp.apply_dividing_line-1873"><span class="linenos">1873</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1874"><a href="#ModifyMaskApp.apply_dividing_line-1874"><span class="linenos">1874</span></a>                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1875"><a href="#ModifyMaskApp.apply_dividing_line-1875"><span class="linenos">1875</span></a>
</span><span id="ModifyMaskApp.apply_dividing_line-1876"><a href="#ModifyMaskApp.apply_dividing_line-1876"><span class="linenos">1876</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1877"><a href="#ModifyMaskApp.apply_dividing_line-1877"><span class="linenos">1877</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1878"><a href="#ModifyMaskApp.apply_dividing_line-1878"><span class="linenos">1878</span></a>                <span class="n">line_rr</span><span class="p">,</span> <span class="n">line_cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1879"><a href="#ModifyMaskApp.apply_dividing_line-1879"><span class="linenos">1879</span></a>                <span class="n">rr</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_rr</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1880"><a href="#ModifyMaskApp.apply_dividing_line-1880"><span class="linenos">1880</span></a>                <span class="n">cc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_cc</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1881"><a href="#ModifyMaskApp.apply_dividing_line-1881"><span class="linenos">1881</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1882"><a href="#ModifyMaskApp.apply_dividing_line-1882"><span class="linenos">1882</span></a>
</span><span id="ModifyMaskApp.apply_dividing_line-1883"><a href="#ModifyMaskApp.apply_dividing_line-1883"><span class="linenos">1883</span></a>            <span class="n">mask_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1884"><a href="#ModifyMaskApp.apply_dividing_line-1884"><span class="linenos">1884</span></a>
</span><span id="ModifyMaskApp.apply_dividing_line-1885"><a href="#ModifyMaskApp.apply_dividing_line-1885"><span class="linenos">1885</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1886"><a href="#ModifyMaskApp.apply_dividing_line-1886"><span class="linenos">1886</span></a>                <span class="c1"># Update the zoomed mask</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1887"><a href="#ModifyMaskApp.apply_dividing_line-1887"><span class="linenos">1887</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1888"><a href="#ModifyMaskApp.apply_dividing_line-1888"><span class="linenos">1888</span></a>                <span class="c1"># Reflect changes to the original mask</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1889"><a href="#ModifyMaskApp.apply_dividing_line-1889"><span class="linenos">1889</span></a>                <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1890"><a href="#ModifyMaskApp.apply_dividing_line-1890"><span class="linenos">1890</span></a>                <span class="n">zoomed_mask_resized_back</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1891"><a href="#ModifyMaskApp.apply_dividing_line-1891"><span class="linenos">1891</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_mask_resized_back</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1892"><a href="#ModifyMaskApp.apply_dividing_line-1892"><span class="linenos">1892</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1893"><a href="#ModifyMaskApp.apply_dividing_line-1893"><span class="linenos">1893</span></a>                <span class="c1"># Directly update the original mask</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1894"><a href="#ModifyMaskApp.apply_dividing_line-1894"><span class="linenos">1894</span></a>                <span class="n">mask_copy</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1895"><a href="#ModifyMaskApp.apply_dividing_line-1895"><span class="linenos">1895</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask_copy</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1896"><a href="#ModifyMaskApp.apply_dividing_line-1896"><span class="linenos">1896</span></a>
</span><span id="ModifyMaskApp.apply_dividing_line-1897"><a href="#ModifyMaskApp.apply_dividing_line-1897"><span class="linenos">1897</span></a>            <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1898"><a href="#ModifyMaskApp.apply_dividing_line-1898"><span class="linenos">1898</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1899"><a href="#ModifyMaskApp.apply_dividing_line-1899"><span class="linenos">1899</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1900"><a href="#ModifyMaskApp.apply_dividing_line-1900"><span class="linenos">1900</span></a>
</span><span id="ModifyMaskApp.apply_dividing_line-1901"><a href="#ModifyMaskApp.apply_dividing_line-1901"><span class="linenos">1901</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1902"><a href="#ModifyMaskApp.apply_dividing_line-1902"><span class="linenos">1902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1903"><a href="#ModifyMaskApp.apply_dividing_line-1903"><span class="linenos">1903</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1904"><a href="#ModifyMaskApp.apply_dividing_line-1904"><span class="linenos">1904</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1905"><a href="#ModifyMaskApp.apply_dividing_line-1905"><span class="linenos">1905</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.apply_dividing_line-1906"><a href="#ModifyMaskApp.apply_dividing_line-1906"><span class="linenos">1906</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dividing_line_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Dividing Line&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.toggle_draw_mode" class="classattr">
                                        <input id="ModifyMaskApp.toggle_draw_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_draw_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.toggle_draw_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.toggle_draw_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.toggle_draw_mode-1908"><a href="#ModifyMaskApp.toggle_draw_mode-1908"><span class="linenos">1908</span></a>    <span class="k">def</span> <span class="nf">toggle_draw_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1909"><a href="#ModifyMaskApp.toggle_draw_mode-1909"><span class="linenos">1909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1910"><a href="#ModifyMaskApp.toggle_draw_mode-1910"><span class="linenos">1910</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1911"><a href="#ModifyMaskApp.toggle_draw_mode-1911"><span class="linenos">1911</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1912"><a href="#ModifyMaskApp.toggle_draw_mode-1912"><span class="linenos">1912</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1913"><a href="#ModifyMaskApp.toggle_draw_mode-1913"><span class="linenos">1913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1914"><a href="#ModifyMaskApp.toggle_draw_mode-1914"><span class="linenos">1914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1915"><a href="#ModifyMaskApp.toggle_draw_mode-1915"><span class="linenos">1915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1916"><a href="#ModifyMaskApp.toggle_draw_mode-1916"><span class="linenos">1916</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1917"><a href="#ModifyMaskApp.toggle_draw_mode-1917"><span class="linenos">1917</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1918"><a href="#ModifyMaskApp.toggle_draw_mode-1918"><span class="linenos">1918</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1919"><a href="#ModifyMaskApp.toggle_draw_mode-1919"><span class="linenos">1919</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1920"><a href="#ModifyMaskApp.toggle_draw_mode-1920"><span class="linenos">1920</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1921"><a href="#ModifyMaskApp.toggle_draw_mode-1921"><span class="linenos">1921</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1922"><a href="#ModifyMaskApp.toggle_draw_mode-1922"><span class="linenos">1922</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1923"><a href="#ModifyMaskApp.toggle_draw_mode-1923"><span class="linenos">1923</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1924"><a href="#ModifyMaskApp.toggle_draw_mode-1924"><span class="linenos">1924</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1925"><a href="#ModifyMaskApp.toggle_draw_mode-1925"><span class="linenos">1925</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1926"><a href="#ModifyMaskApp.toggle_draw_mode-1926"><span class="linenos">1926</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">finish_drawing</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1927"><a href="#ModifyMaskApp.toggle_draw_mode-1927"><span class="linenos">1927</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1928"><a href="#ModifyMaskApp.toggle_draw_mode-1928"><span class="linenos">1928</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1929"><a href="#ModifyMaskApp.toggle_draw_mode-1929"><span class="linenos">1929</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1930"><a href="#ModifyMaskApp.toggle_draw_mode-1930"><span class="linenos">1930</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_draw_mode-1931"><a href="#ModifyMaskApp.toggle_draw_mode-1931"><span class="linenos">1931</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.toggle_magic_wand_mode" class="classattr">
                                        <input id="ModifyMaskApp.toggle_magic_wand_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_magic_wand_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.toggle_magic_wand_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.toggle_magic_wand_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.toggle_magic_wand_mode-1933"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1933"><span class="linenos">1933</span></a>    <span class="k">def</span> <span class="nf">toggle_magic_wand_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1934"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1934"><span class="linenos">1934</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1935"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1935"><span class="linenos">1935</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1936"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1936"><span class="linenos">1936</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1937"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1937"><span class="linenos">1937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1938"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1938"><span class="linenos">1938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1939"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1939"><span class="linenos">1939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1940"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1940"><span class="linenos">1940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1941"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1941"><span class="linenos">1941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1942"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1942"><span class="linenos">1942</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1943"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1943"><span class="linenos">1943</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1944"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1944"><span class="linenos">1944</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1945"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1945"><span class="linenos">1945</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1946"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1946"><span class="linenos">1946</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1947"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1947"><span class="linenos">1947</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_magic_wand</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1948"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1948"><span class="linenos">1948</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_magic_wand</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1949"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1949"><span class="linenos">1949</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1950"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1950"><span class="linenos">1950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1951"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1951"><span class="linenos">1951</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_magic_wand_mode-1952"><a href="#ModifyMaskApp.toggle_magic_wand_mode-1952"><span class="linenos">1952</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-3&gt;&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.toggle_erase_mode" class="classattr">
                                        <input id="ModifyMaskApp.toggle_erase_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_erase_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.toggle_erase_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.toggle_erase_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.toggle_erase_mode-1954"><a href="#ModifyMaskApp.toggle_erase_mode-1954"><span class="linenos">1954</span></a>    <span class="k">def</span> <span class="nf">toggle_erase_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1955"><a href="#ModifyMaskApp.toggle_erase_mode-1955"><span class="linenos">1955</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1956"><a href="#ModifyMaskApp.toggle_erase_mode-1956"><span class="linenos">1956</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1957"><a href="#ModifyMaskApp.toggle_erase_mode-1957"><span class="linenos">1957</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Brush&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1958"><a href="#ModifyMaskApp.toggle_erase_mode-1958"><span class="linenos">1958</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B1-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1959"><a href="#ModifyMaskApp.toggle_erase_mode-1959"><span class="linenos">1959</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;B3-Motion&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1960"><a href="#ModifyMaskApp.toggle_erase_mode-1960"><span class="linenos">1960</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1961"><a href="#ModifyMaskApp.toggle_erase_mode-1961"><span class="linenos">1961</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease-3&gt;&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1962"><a href="#ModifyMaskApp.toggle_erase_mode-1962"><span class="linenos">1962</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase ON&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1963"><a href="#ModifyMaskApp.toggle_erase_mode-1963"><span class="linenos">1963</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_object</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1964"><a href="#ModifyMaskApp.toggle_erase_mode-1964"><span class="linenos">1964</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1965"><a href="#ModifyMaskApp.toggle_erase_mode-1965"><span class="linenos">1965</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1966"><a href="#ModifyMaskApp.toggle_erase_mode-1966"><span class="linenos">1966</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1967"><a href="#ModifyMaskApp.toggle_erase_mode-1967"><span class="linenos">1967</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1968"><a href="#ModifyMaskApp.toggle_erase_mode-1968"><span class="linenos">1968</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Magic Wand&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1969"><a href="#ModifyMaskApp.toggle_erase_mode-1969"><span class="linenos">1969</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1970"><a href="#ModifyMaskApp.toggle_erase_mode-1970"><span class="linenos">1970</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_active</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1971"><a href="#ModifyMaskApp.toggle_erase_mode-1971"><span class="linenos">1971</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Erase&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.toggle_erase_mode-1972"><a href="#ModifyMaskApp.toggle_erase_mode-1972"><span class="linenos">1972</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.apply_brush_release" class="classattr">
                                        <input id="ModifyMaskApp.apply_brush_release-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_brush_release</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.apply_brush_release-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.apply_brush_release"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.apply_brush_release-1978"><a href="#ModifyMaskApp.apply_brush_release-1978"><span class="linenos">1978</span></a>    <span class="k">def</span> <span class="nf">apply_brush_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_brush_release-1979"><a href="#ModifyMaskApp.apply_brush_release-1979"><span class="linenos">1979</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;brush_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_brush_release-1980"><a href="#ModifyMaskApp.apply_brush_release-1980"><span class="linenos">1980</span></a>            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">brush_size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_brush_release-1981"><a href="#ModifyMaskApp.apply_brush_release-1981"><span class="linenos">1981</span></a>                <span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush_release-1982"><a href="#ModifyMaskApp.apply_brush_release-1982"><span class="linenos">1982</span></a>                <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_x</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush_release-1983"><a href="#ModifyMaskApp.apply_brush_release-1983"><span class="linenos">1983</span></a>                <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_y</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush_release-1984"><a href="#ModifyMaskApp.apply_brush_release-1984"><span class="linenos">1984</span></a>                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_x</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="ModifyMaskApp.apply_brush_release-1985"><a href="#ModifyMaskApp.apply_brush_release-1985"><span class="linenos">1985</span></a>                <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_y</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ModifyMaskApp.apply_brush_release-1986"><a href="#ModifyMaskApp.apply_brush_release-1986"><span class="linenos">1986</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_brush_release-1987"><a href="#ModifyMaskApp.apply_brush_release-1987"><span class="linenos">1987</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp.apply_brush_release-1988"><a href="#ModifyMaskApp.apply_brush_release-1988"><span class="linenos">1988</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask_from_zoom</span><span class="p">()</span>
</span><span id="ModifyMaskApp.apply_brush_release-1989"><a href="#ModifyMaskApp.apply_brush_release-1989"><span class="linenos">1989</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_brush_release-1990"><a href="#ModifyMaskApp.apply_brush_release-1990"><span class="linenos">1990</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp.apply_brush_release-1991"><a href="#ModifyMaskApp.apply_brush_release-1991"><span class="linenos">1991</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span>
</span><span id="ModifyMaskApp.apply_brush_release-1992"><a href="#ModifyMaskApp.apply_brush_release-1992"><span class="linenos">1992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush_release-1993"><a href="#ModifyMaskApp.apply_brush_release-1993"><span class="linenos">1993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.erase_brush_release" class="classattr">
                                        <input id="ModifyMaskApp.erase_brush_release-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">erase_brush_release</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.erase_brush_release-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.erase_brush_release"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.erase_brush_release-1995"><a href="#ModifyMaskApp.erase_brush_release-1995"><span class="linenos">1995</span></a>    <span class="k">def</span> <span class="nf">erase_brush_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.erase_brush_release-1996"><a href="#ModifyMaskApp.erase_brush_release-1996"><span class="linenos">1996</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;erase_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp.erase_brush_release-1997"><a href="#ModifyMaskApp.erase_brush_release-1997"><span class="linenos">1997</span></a>            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">brush_size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_brush_release-1998"><a href="#ModifyMaskApp.erase_brush_release-1998"><span class="linenos">1998</span></a>                <span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_to_image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush_release-1999"><a href="#ModifyMaskApp.erase_brush_release-1999"><span class="linenos">1999</span></a>                <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_x</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush_release-2000"><a href="#ModifyMaskApp.erase_brush_release-2000"><span class="linenos">2000</span></a>                <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">img_y</span> <span class="o">-</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush_release-2001"><a href="#ModifyMaskApp.erase_brush_release-2001"><span class="linenos">2001</span></a>                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_x</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="ModifyMaskApp.erase_brush_release-2002"><a href="#ModifyMaskApp.erase_brush_release-2002"><span class="linenos">2002</span></a>                <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">img_y</span> <span class="o">+</span> <span class="n">brush_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ModifyMaskApp.erase_brush_release-2003"><a href="#ModifyMaskApp.erase_brush_release-2003"><span class="linenos">2003</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_brush_release-2004"><a href="#ModifyMaskApp.erase_brush_release-2004"><span class="linenos">2004</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>                    
</span><span id="ModifyMaskApp.erase_brush_release-2005"><a href="#ModifyMaskApp.erase_brush_release-2005"><span class="linenos">2005</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask_from_zoom</span><span class="p">()</span>
</span><span id="ModifyMaskApp.erase_brush_release-2006"><a href="#ModifyMaskApp.erase_brush_release-2006"><span class="linenos">2006</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_brush_release-2007"><a href="#ModifyMaskApp.erase_brush_release-2007"><span class="linenos">2007</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.erase_brush_release-2008"><a href="#ModifyMaskApp.erase_brush_release-2008"><span class="linenos">2008</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span>
</span><span id="ModifyMaskApp.erase_brush_release-2009"><a href="#ModifyMaskApp.erase_brush_release-2009"><span class="linenos">2009</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush_release-2010"><a href="#ModifyMaskApp.erase_brush_release-2010"><span class="linenos">2010</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.apply_brush" class="classattr">
                                        <input id="ModifyMaskApp.apply_brush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_brush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.apply_brush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.apply_brush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.apply_brush-2012"><a href="#ModifyMaskApp.apply_brush-2012"><span class="linenos">2012</span></a>    <span class="k">def</span> <span class="nf">apply_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_brush-2013"><a href="#ModifyMaskApp.apply_brush-2013"><span class="linenos">2013</span></a>        <span class="n">brush_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.apply_brush-2014"><a href="#ModifyMaskApp.apply_brush-2014"><span class="linenos">2014</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.apply_brush-2015"><a href="#ModifyMaskApp.apply_brush-2015"><span class="linenos">2015</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;brush_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_brush-2016"><a href="#ModifyMaskApp.apply_brush-2016"><span class="linenos">2016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp.apply_brush-2017"><a href="#ModifyMaskApp.apply_brush-2017"><span class="linenos">2017</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush-2018"><a href="#ModifyMaskApp.apply_brush-2018"><span class="linenos">2018</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_brush-2019"><a href="#ModifyMaskApp.apply_brush-2019"><span class="linenos">2019</span></a>            <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span>
</span><span id="ModifyMaskApp.apply_brush-2020"><a href="#ModifyMaskApp.apply_brush-2020"><span class="linenos">2020</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">last_y</span><span class="p">,</span> <span class="n">last_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush-2021"><a href="#ModifyMaskApp.apply_brush-2021"><span class="linenos">2021</span></a>            <span class="k">for</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_brush-2022"><a href="#ModifyMaskApp.apply_brush-2022"><span class="linenos">2022</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">brush_path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">brush_size</span><span class="p">))</span>
</span><span id="ModifyMaskApp.apply_brush-2023"><a href="#ModifyMaskApp.apply_brush-2023"><span class="linenos">2023</span></a>
</span><span id="ModifyMaskApp.apply_brush-2024"><a href="#ModifyMaskApp.apply_brush-2024"><span class="linenos">2024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">brush_size</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_brush-2025"><a href="#ModifyMaskApp.apply_brush-2025"><span class="linenos">2025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_brush_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.erase_brush" class="classattr">
                                        <input id="ModifyMaskApp.erase_brush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">erase_brush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.erase_brush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.erase_brush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.erase_brush-2027"><a href="#ModifyMaskApp.erase_brush-2027"><span class="linenos">2027</span></a>    <span class="k">def</span> <span class="nf">erase_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.erase_brush-2028"><a href="#ModifyMaskApp.erase_brush-2028"><span class="linenos">2028</span></a>        <span class="n">brush_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush_size_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.erase_brush-2029"><a href="#ModifyMaskApp.erase_brush-2029"><span class="linenos">2029</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.erase_brush-2030"><a href="#ModifyMaskApp.erase_brush-2030"><span class="linenos">2030</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;erase_path&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp.erase_brush-2031"><a href="#ModifyMaskApp.erase_brush-2031"><span class="linenos">2031</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ModifyMaskApp.erase_brush-2032"><a href="#ModifyMaskApp.erase_brush-2032"><span class="linenos">2032</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush-2033"><a href="#ModifyMaskApp.erase_brush-2033"><span class="linenos">2033</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_brush-2034"><a href="#ModifyMaskApp.erase_brush-2034"><span class="linenos">2034</span></a>            <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span>
</span><span id="ModifyMaskApp.erase_brush-2035"><a href="#ModifyMaskApp.erase_brush-2035"><span class="linenos">2035</span></a>            <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">last_y</span><span class="p">,</span> <span class="n">last_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush-2036"><a href="#ModifyMaskApp.erase_brush-2036"><span class="linenos">2036</span></a>            <span class="k">for</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
</span><span id="ModifyMaskApp.erase_brush-2037"><a href="#ModifyMaskApp.erase_brush-2037"><span class="linenos">2037</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">erase_path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">brush_size</span><span class="p">))</span>
</span><span id="ModifyMaskApp.erase_brush-2038"><a href="#ModifyMaskApp.erase_brush-2038"><span class="linenos">2038</span></a>
</span><span id="ModifyMaskApp.erase_brush-2039"><a href="#ModifyMaskApp.erase_brush-2039"><span class="linenos">2039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">brush_size</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;temp_line&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_brush-2040"><a href="#ModifyMaskApp.erase_brush-2040"><span class="linenos">2040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_erase_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.erase_object" class="classattr">
                                        <input id="ModifyMaskApp.erase_object-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">erase_object</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.erase_object-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.erase_object"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.erase_object-2042"><a href="#ModifyMaskApp.erase_object-2042"><span class="linenos">2042</span></a>    <span class="k">def</span> <span class="nf">erase_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.erase_object-2043"><a href="#ModifyMaskApp.erase_object-2043"><span class="linenos">2043</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.erase_object-2044"><a href="#ModifyMaskApp.erase_object-2044"><span class="linenos">2044</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_object-2045"><a href="#ModifyMaskApp.erase_object-2045"><span class="linenos">2045</span></a>            <span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="ModifyMaskApp.erase_object-2046"><a href="#ModifyMaskApp.erase_object-2046"><span class="linenos">2046</span></a>            <span class="n">zoomed_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvas_x</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">))</span>
</span><span id="ModifyMaskApp.erase_object-2047"><a href="#ModifyMaskApp.erase_object-2047"><span class="linenos">2047</span></a>            <span class="n">zoomed_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvas_y</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">))</span>
</span><span id="ModifyMaskApp.erase_object-2048"><a href="#ModifyMaskApp.erase_object-2048"><span class="linenos">2048</span></a>            <span class="n">orig_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoomed_x</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_width</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_object-2049"><a href="#ModifyMaskApp.erase_object-2049"><span class="linenos">2049</span></a>            <span class="n">orig_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoomed_y</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_height</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_object-2050"><a href="#ModifyMaskApp.erase_object-2050"><span class="linenos">2050</span></a>            <span class="k">if</span> <span class="n">orig_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">orig_y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">orig_x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">orig_y</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ModifyMaskApp.erase_object-2051"><a href="#ModifyMaskApp.erase_object-2051"><span class="linenos">2051</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Point is out of bounds in the original image.&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.erase_object-2052"><a href="#ModifyMaskApp.erase_object-2052"><span class="linenos">2052</span></a>                <span class="k">return</span>
</span><span id="ModifyMaskApp.erase_object-2053"><a href="#ModifyMaskApp.erase_object-2053"><span class="linenos">2053</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_object-2054"><a href="#ModifyMaskApp.erase_object-2054"><span class="linenos">2054</span></a>            <span class="n">orig_x</span><span class="p">,</span> <span class="n">orig_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="ModifyMaskApp.erase_object-2055"><a href="#ModifyMaskApp.erase_object-2055"><span class="linenos">2055</span></a>        <span class="n">label_to_remove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">orig_y</span><span class="p">,</span> <span class="n">orig_x</span><span class="p">]</span>
</span><span id="ModifyMaskApp.erase_object-2056"><a href="#ModifyMaskApp.erase_object-2056"><span class="linenos">2056</span></a>        <span class="k">if</span> <span class="n">label_to_remove</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.erase_object-2057"><a href="#ModifyMaskApp.erase_object-2057"><span class="linenos">2057</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">label_to_remove</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.erase_object-2058"><a href="#ModifyMaskApp.erase_object-2058"><span class="linenos">2058</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.use_magic_wand" class="classattr">
                                        <input id="ModifyMaskApp.use_magic_wand-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">use_magic_wand</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.use_magic_wand-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.use_magic_wand"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.use_magic_wand-2060"><a href="#ModifyMaskApp.use_magic_wand-2060"><span class="linenos">2060</span></a>    <span class="k">def</span> <span class="nf">use_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.use_magic_wand-2061"><a href="#ModifyMaskApp.use_magic_wand-2061"><span class="linenos">2061</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.use_magic_wand-2062"><a href="#ModifyMaskApp.use_magic_wand-2062"><span class="linenos">2062</span></a>        <span class="n">tolerance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_tolerance</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.use_magic_wand-2063"><a href="#ModifyMaskApp.use_magic_wand-2063"><span class="linenos">2063</span></a>        <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.use_magic_wand-2064"><a href="#ModifyMaskApp.use_magic_wand-2064"><span class="linenos">2064</span></a>        <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;add&#39;</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;erase&#39;</span>
</span><span id="ModifyMaskApp.use_magic_wand-2065"><a href="#ModifyMaskApp.use_magic_wand-2065"><span class="linenos">2065</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.use_magic_wand-2066"><a href="#ModifyMaskApp.use_magic_wand-2066"><span class="linenos">2066</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_zoomed</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp.use_magic_wand-2067"><a href="#ModifyMaskApp.use_magic_wand-2067"><span class="linenos">2067</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.use_magic_wand-2068"><a href="#ModifyMaskApp.use_magic_wand-2068"><span class="linenos">2068</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">magic_wand_normal</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.apply_magic_wand" class="classattr">
                                        <input id="ModifyMaskApp.apply_magic_wand-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_magic_wand</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">mask</span>, </span><span class="param"><span class="n">seed_point</span>, </span><span class="param"><span class="n">tolerance</span>, </span><span class="param"><span class="n">maximum</span>, </span><span class="param"><span class="n">action</span><span class="o">=</span><span class="s1">&#39;add&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.apply_magic_wand-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.apply_magic_wand"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.apply_magic_wand-2070"><a href="#ModifyMaskApp.apply_magic_wand-2070"><span class="linenos">2070</span></a>    <span class="k">def</span> <span class="nf">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2071"><a href="#ModifyMaskApp.apply_magic_wand-2071"><span class="linenos">2071</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">seed_point</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2072"><a href="#ModifyMaskApp.apply_magic_wand-2072"><span class="linenos">2072</span></a>        <span class="n">initial_value</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2073"><a href="#ModifyMaskApp.apply_magic_wand-2073"><span class="linenos">2073</span></a>        <span class="n">visited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2074"><a href="#ModifyMaskApp.apply_magic_wand-2074"><span class="linenos">2074</span></a>        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2075"><a href="#ModifyMaskApp.apply_magic_wand-2075"><span class="linenos">2075</span></a>        <span class="n">added_pixels</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2076"><a href="#ModifyMaskApp.apply_magic_wand-2076"><span class="linenos">2076</span></a>
</span><span id="ModifyMaskApp.apply_magic_wand-2077"><a href="#ModifyMaskApp.apply_magic_wand-2077"><span class="linenos">2077</span></a>        <span class="k">while</span> <span class="n">queue</span> <span class="ow">and</span> <span class="n">added_pixels</span> <span class="o">&lt;</span> <span class="n">maximum</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2078"><a href="#ModifyMaskApp.apply_magic_wand-2078"><span class="linenos">2078</span></a>            <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2079"><a href="#ModifyMaskApp.apply_magic_wand-2079"><span class="linenos">2079</span></a>            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2080"><a href="#ModifyMaskApp.apply_magic_wand-2080"><span class="linenos">2080</span></a>                <span class="k">continue</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2081"><a href="#ModifyMaskApp.apply_magic_wand-2081"><span class="linenos">2081</span></a>            <span class="n">visited</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2082"><a href="#ModifyMaskApp.apply_magic_wand-2082"><span class="linenos">2082</span></a>            <span class="n">current_value</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2083"><a href="#ModifyMaskApp.apply_magic_wand-2083"><span class="linenos">2083</span></a>
</span><span id="ModifyMaskApp.apply_magic_wand-2084"><a href="#ModifyMaskApp.apply_magic_wand-2084"><span class="linenos">2084</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">current_value</span> <span class="o">-</span> <span class="n">initial_value</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2085"><a href="#ModifyMaskApp.apply_magic_wand-2085"><span class="linenos">2085</span></a>                <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2086"><a href="#ModifyMaskApp.apply_magic_wand-2086"><span class="linenos">2086</span></a>                    <span class="n">added_pixels</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2087"><a href="#ModifyMaskApp.apply_magic_wand-2087"><span class="linenos">2087</span></a>                <span class="n">mask</span><span class="p">[</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2088"><a href="#ModifyMaskApp.apply_magic_wand-2088"><span class="linenos">2088</span></a>
</span><span id="ModifyMaskApp.apply_magic_wand-2089"><a href="#ModifyMaskApp.apply_magic_wand-2089"><span class="linenos">2089</span></a>                <span class="k">if</span> <span class="n">added_pixels</span> <span class="o">&gt;=</span> <span class="n">maximum</span><span class="p">:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2090"><a href="#ModifyMaskApp.apply_magic_wand-2090"><span class="linenos">2090</span></a>                    <span class="k">break</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2091"><a href="#ModifyMaskApp.apply_magic_wand-2091"><span class="linenos">2091</span></a>
</span><span id="ModifyMaskApp.apply_magic_wand-2092"><a href="#ModifyMaskApp.apply_magic_wand-2092"><span class="linenos">2092</span></a>                <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2093"><a href="#ModifyMaskApp.apply_magic_wand-2093"><span class="linenos">2093</span></a>                    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dy</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2094"><a href="#ModifyMaskApp.apply_magic_wand-2094"><span class="linenos">2094</span></a>                    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nx</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ny</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">]:</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2095"><a href="#ModifyMaskApp.apply_magic_wand-2095"><span class="linenos">2095</span></a>                        <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
</span><span id="ModifyMaskApp.apply_magic_wand-2096"><a href="#ModifyMaskApp.apply_magic_wand-2096"><span class="linenos">2096</span></a>        <span class="k">return</span> <span class="n">mask</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.magic_wand_normal" class="classattr">
                                        <input id="ModifyMaskApp.magic_wand_normal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">magic_wand_normal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">seed_point</span>, </span><span class="param"><span class="n">tolerance</span>, </span><span class="param"><span class="n">action</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.magic_wand_normal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.magic_wand_normal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.magic_wand_normal-2098"><a href="#ModifyMaskApp.magic_wand_normal-2098"><span class="linenos">2098</span></a>    <span class="k">def</span> <span class="nf">magic_wand_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
</span><span id="ModifyMaskApp.magic_wand_normal-2099"><a href="#ModifyMaskApp.magic_wand_normal-2099"><span class="linenos">2099</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_normal-2100"><a href="#ModifyMaskApp.magic_wand_normal-2100"><span class="linenos">2100</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.magic_wand_normal-2101"><a href="#ModifyMaskApp.magic_wand_normal-2101"><span class="linenos">2101</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_normal-2102"><a href="#ModifyMaskApp.magic_wand_normal-2102"><span class="linenos">2102</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid maximum value; using default of 1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_normal-2103"><a href="#ModifyMaskApp.magic_wand_normal-2103"><span class="linenos">2103</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1000</span> 
</span><span id="ModifyMaskApp.magic_wand_normal-2104"><a href="#ModifyMaskApp.magic_wand_normal-2104"><span class="linenos">2104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_normal-2105"><a href="#ModifyMaskApp.magic_wand_normal-2105"><span class="linenos">2105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display_image</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.magic_wand_zoomed" class="classattr">
                                        <input id="ModifyMaskApp.magic_wand_zoomed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">magic_wand_zoomed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">seed_point</span>, </span><span class="param"><span class="n">tolerance</span>, </span><span class="param"><span class="n">action</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.magic_wand_zoomed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.magic_wand_zoomed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.magic_wand_zoomed-2107"><a href="#ModifyMaskApp.magic_wand_zoomed-2107"><span class="linenos">2107</span></a>    <span class="k">def</span> <span class="nf">magic_wand_zoomed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_point</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2108"><a href="#ModifyMaskApp.magic_wand_zoomed-2108"><span class="linenos">2108</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2109"><a href="#ModifyMaskApp.magic_wand_zoomed-2109"><span class="linenos">2109</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Zoomed image or mask not initialized&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2110"><a href="#ModifyMaskApp.magic_wand_zoomed-2110"><span class="linenos">2110</span></a>            <span class="k">return</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2111"><a href="#ModifyMaskApp.magic_wand_zoomed-2111"><span class="linenos">2111</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2112"><a href="#ModifyMaskApp.magic_wand_zoomed-2112"><span class="linenos">2112</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_pixels_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2113"><a href="#ModifyMaskApp.magic_wand_zoomed-2113"><span class="linenos">2113</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="n">maximum</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_scale</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2114"><a href="#ModifyMaskApp.magic_wand_zoomed-2114"><span class="linenos">2114</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2115"><a href="#ModifyMaskApp.magic_wand_zoomed-2115"><span class="linenos">2115</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid maximum value; using default of 1000&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2116"><a href="#ModifyMaskApp.magic_wand_zoomed-2116"><span class="linenos">2116</span></a>            <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2117"><a href="#ModifyMaskApp.magic_wand_zoomed-2117"><span class="linenos">2117</span></a>            
</span><span id="ModifyMaskApp.magic_wand_zoomed-2118"><a href="#ModifyMaskApp.magic_wand_zoomed-2118"><span class="linenos">2118</span></a>        <span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span> <span class="o">=</span> <span class="n">seed_point</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2119"><a href="#ModifyMaskApp.magic_wand_zoomed-2119"><span class="linenos">2119</span></a>        <span class="k">if</span> <span class="n">canvas_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">canvas_y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">canvas_x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">canvas_y</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2120"><a href="#ModifyMaskApp.magic_wand_zoomed-2120"><span class="linenos">2120</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected point is out of bounds in the zoomed image.&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2121"><a href="#ModifyMaskApp.magic_wand_zoomed-2121"><span class="linenos">2121</span></a>            <span class="k">return</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2122"><a href="#ModifyMaskApp.magic_wand_zoomed-2122"><span class="linenos">2122</span></a>        
</span><span id="ModifyMaskApp.magic_wand_zoomed-2123"><a href="#ModifyMaskApp.magic_wand_zoomed-2123"><span class="linenos">2123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_magic_wand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_image_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_x</span><span class="p">,</span> <span class="n">canvas_y</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2124"><a href="#ModifyMaskApp.magic_wand_zoomed-2124"><span class="linenos">2124</span></a>        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2125"><a href="#ModifyMaskApp.magic_wand_zoomed-2125"><span class="linenos">2125</span></a>        <span class="n">zoomed_mask_resized_back</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2126"><a href="#ModifyMaskApp.magic_wand_zoomed-2126"><span class="linenos">2126</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;erase&#39;</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2127"><a href="#ModifyMaskApp.magic_wand_zoomed-2127"><span class="linenos">2127</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zoomed_mask_resized_back</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">])</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2128"><a href="#ModifyMaskApp.magic_wand_zoomed-2128"><span class="linenos">2128</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2129"><a href="#ModifyMaskApp.magic_wand_zoomed-2129"><span class="linenos">2129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zoomed_mask_resized_back</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zoomed_mask_resized_back</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">])</span>
</span><span id="ModifyMaskApp.magic_wand_zoomed-2130"><a href="#ModifyMaskApp.magic_wand_zoomed-2130"><span class="linenos">2130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.draw" class="classattr">
                                        <input id="ModifyMaskApp.draw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.draw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.draw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.draw-2132"><a href="#ModifyMaskApp.draw-2132"><span class="linenos">2132</span></a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.draw-2133"><a href="#ModifyMaskApp.draw-2133"><span class="linenos">2133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span><span class="p">:</span>
</span><span id="ModifyMaskApp.draw-2134"><a href="#ModifyMaskApp.draw-2134"><span class="linenos">2134</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span>
</span><span id="ModifyMaskApp.draw-2135"><a href="#ModifyMaskApp.draw-2135"><span class="linenos">2135</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">:</span>
</span><span id="ModifyMaskApp.draw-2136"><a href="#ModifyMaskApp.draw-2136"><span class="linenos">2136</span></a>                <span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ModifyMaskApp.draw-2137"><a href="#ModifyMaskApp.draw-2137"><span class="linenos">2137</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">last_x</span><span class="p">,</span> <span class="n">last_y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span id="ModifyMaskApp.draw-2138"><a href="#ModifyMaskApp.draw-2138"><span class="linenos">2138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.draw_on_zoomed_mask" class="classattr">
                                        <input id="ModifyMaskApp.draw_on_zoomed_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_on_zoomed_mask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">draw_coordinates</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.draw_on_zoomed_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.draw_on_zoomed_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.draw_on_zoomed_mask-2140"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2140"><span class="linenos">2140</span></a>    <span class="k">def</span> <span class="nf">draw_on_zoomed_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_coordinates</span><span class="p">):</span>
</span><span id="ModifyMaskApp.draw_on_zoomed_mask-2141"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2141"><span class="linenos">2141</span></a>        <span class="n">canvas_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="ModifyMaskApp.draw_on_zoomed_mask-2142"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2142"><span class="linenos">2142</span></a>        <span class="n">canvas_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="ModifyMaskApp.draw_on_zoomed_mask-2143"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2143"><span class="linenos">2143</span></a>        <span class="n">zoomed_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">canvas_height</span><span class="p">,</span> <span class="n">canvas_width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="ModifyMaskApp.draw_on_zoomed_mask-2144"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2144"><span class="linenos">2144</span></a>        <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">zoomed_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="ModifyMaskApp.draw_on_zoomed_mask-2145"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2145"><span class="linenos">2145</span></a>        <span class="n">zoomed_mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp.draw_on_zoomed_mask-2146"><a href="#ModifyMaskApp.draw_on_zoomed_mask-2146"><span class="linenos">2146</span></a>        <span class="k">return</span> <span class="n">zoomed_mask</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.finish_drawing" class="classattr">
                                        <input id="ModifyMaskApp.finish_drawing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">finish_drawing</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.finish_drawing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.finish_drawing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.finish_drawing-2148"><a href="#ModifyMaskApp.finish_drawing-2148"><span class="linenos">2148</span></a>    <span class="k">def</span> <span class="nf">finish_drawing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.finish_drawing-2149"><a href="#ModifyMaskApp.finish_drawing-2149"><span class="linenos">2149</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ModifyMaskApp.finish_drawing-2150"><a href="#ModifyMaskApp.finish_drawing-2150"><span class="linenos">2150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ModifyMaskApp.finish_drawing-2151"><a href="#ModifyMaskApp.finish_drawing-2151"><span class="linenos">2151</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_active</span><span class="p">:</span>
</span><span id="ModifyMaskApp.finish_drawing-2152"><a href="#ModifyMaskApp.finish_drawing-2152"><span class="linenos">2152</span></a>                <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom_y1</span>
</span><span id="ModifyMaskApp.finish_drawing-2153"><a href="#ModifyMaskApp.finish_drawing-2153"><span class="linenos">2153</span></a>                <span class="n">zoomed_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_on_zoomed_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span>
</span><span id="ModifyMaskApp.finish_drawing-2154"><a href="#ModifyMaskApp.finish_drawing-2154"><span class="linenos">2154</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_original_mask</span><span class="p">(</span><span class="n">zoomed_mask</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.finish_drawing-2155"><a href="#ModifyMaskApp.finish_drawing-2155"><span class="linenos">2155</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ModifyMaskApp.finish_drawing-2156"><a href="#ModifyMaskApp.finish_drawing-2156"><span class="linenos">2156</span></a>                <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="ModifyMaskApp.finish_drawing-2157"><a href="#ModifyMaskApp.finish_drawing-2157"><span class="linenos">2157</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span><span class="p">],</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="ModifyMaskApp.finish_drawing-2158"><a href="#ModifyMaskApp.finish_drawing-2158"><span class="linenos">2158</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ModifyMaskApp.finish_drawing-2159"><a href="#ModifyMaskApp.finish_drawing-2159"><span class="linenos">2159</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_line</span><span class="p">)</span>
</span><span id="ModifyMaskApp.finish_drawing-2160"><a href="#ModifyMaskApp.finish_drawing-2160"><span class="linenos">2160</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="ModifyMaskApp.finish_drawing-2161"><a href="#ModifyMaskApp.finish_drawing-2161"><span class="linenos">2161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.finish_drawing_if_active" class="classattr">
                                        <input id="ModifyMaskApp.finish_drawing_if_active-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">finish_drawing_if_active</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.finish_drawing_if_active-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.finish_drawing_if_active"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.finish_drawing_if_active-2163"><a href="#ModifyMaskApp.finish_drawing_if_active-2163"><span class="linenos">2163</span></a>    <span class="k">def</span> <span class="nf">finish_drawing_if_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="ModifyMaskApp.finish_drawing_if_active-2164"><a href="#ModifyMaskApp.finish_drawing_if_active-2164"><span class="linenos">2164</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawing</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ModifyMaskApp.finish_drawing_if_active-2165"><a href="#ModifyMaskApp.finish_drawing_if_active-2165"><span class="linenos">2165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">finish_drawing</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.apply_normalization" class="classattr">
                                        <input id="ModifyMaskApp.apply_normalization-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_normalization</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.apply_normalization-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.apply_normalization"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.apply_normalization-2171"><a href="#ModifyMaskApp.apply_normalization-2171"><span class="linenos">2171</span></a>    <span class="k">def</span> <span class="nf">apply_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.apply_normalization-2172"><a href="#ModifyMaskApp.apply_normalization-2172"><span class="linenos">2172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_quantile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.apply_normalization-2173"><a href="#ModifyMaskApp.apply_normalization-2173"><span class="linenos">2173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_quantile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.apply_normalization-2174"><a href="#ModifyMaskApp.apply_normalization-2174"><span class="linenos">2174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.fill_objects" class="classattr">
                                        <input id="ModifyMaskApp.fill_objects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fill_objects</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.fill_objects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.fill_objects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.fill_objects-2176"><a href="#ModifyMaskApp.fill_objects-2176"><span class="linenos">2176</span></a>    <span class="k">def</span> <span class="nf">fill_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.fill_objects-2177"><a href="#ModifyMaskApp.fill_objects-2177"><span class="linenos">2177</span></a>        <span class="n">binary_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="ModifyMaskApp.fill_objects-2178"><a href="#ModifyMaskApp.fill_objects-2178"><span class="linenos">2178</span></a>        <span class="n">filled_mask</span> <span class="o">=</span> <span class="n">binary_fill_holes</span><span class="p">(</span><span class="n">binary_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.fill_objects-2179"><a href="#ModifyMaskApp.fill_objects-2179"><span class="linenos">2179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">filled_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
</span><span id="ModifyMaskApp.fill_objects-2180"><a href="#ModifyMaskApp.fill_objects-2180"><span class="linenos">2180</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">filled_mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.fill_objects-2181"><a href="#ModifyMaskApp.fill_objects-2181"><span class="linenos">2181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="ModifyMaskApp.fill_objects-2182"><a href="#ModifyMaskApp.fill_objects-2182"><span class="linenos">2182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.relabel_objects" class="classattr">
                                        <input id="ModifyMaskApp.relabel_objects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">relabel_objects</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.relabel_objects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.relabel_objects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.relabel_objects-2184"><a href="#ModifyMaskApp.relabel_objects-2184"><span class="linenos">2184</span></a>    <span class="k">def</span> <span class="nf">relabel_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.relabel_objects-2185"><a href="#ModifyMaskApp.relabel_objects-2185"><span class="linenos">2185</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
</span><span id="ModifyMaskApp.relabel_objects-2186"><a href="#ModifyMaskApp.relabel_objects-2186"><span class="linenos">2186</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.relabel_objects-2187"><a href="#ModifyMaskApp.relabel_objects-2187"><span class="linenos">2187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">labeled_mask</span>
</span><span id="ModifyMaskApp.relabel_objects-2188"><a href="#ModifyMaskApp.relabel_objects-2188"><span class="linenos">2188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.clear_objects" class="classattr">
                                        <input id="ModifyMaskApp.clear_objects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_objects</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.clear_objects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.clear_objects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.clear_objects-2190"><a href="#ModifyMaskApp.clear_objects-2190"><span class="linenos">2190</span></a>    <span class="k">def</span> <span class="nf">clear_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.clear_objects-2191"><a href="#ModifyMaskApp.clear_objects-2191"><span class="linenos">2191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="ModifyMaskApp.clear_objects-2192"><a href="#ModifyMaskApp.clear_objects-2192"><span class="linenos">2192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.invert_mask" class="classattr">
                                        <input id="ModifyMaskApp.invert_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">invert_mask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.invert_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.invert_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.invert_mask-2194"><a href="#ModifyMaskApp.invert_mask-2194"><span class="linenos">2194</span></a>    <span class="k">def</span> <span class="nf">invert_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.invert_mask-2195"><a href="#ModifyMaskApp.invert_mask-2195"><span class="linenos">2195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ModifyMaskApp.invert_mask-2196"><a href="#ModifyMaskApp.invert_mask-2196"><span class="linenos">2196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_objects</span><span class="p">()</span>
</span><span id="ModifyMaskApp.invert_mask-2197"><a href="#ModifyMaskApp.invert_mask-2197"><span class="linenos">2197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="ModifyMaskApp.remove_small_objects" class="classattr">
                                        <input id="ModifyMaskApp.remove_small_objects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_small_objects</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ModifyMaskApp.remove_small_objects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ModifyMaskApp.remove_small_objects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ModifyMaskApp.remove_small_objects-2199"><a href="#ModifyMaskApp.remove_small_objects-2199"><span class="linenos">2199</span></a>    <span class="k">def</span> <span class="nf">remove_small_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ModifyMaskApp.remove_small_objects-2200"><a href="#ModifyMaskApp.remove_small_objects-2200"><span class="linenos">2200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ModifyMaskApp.remove_small_objects-2201"><a href="#ModifyMaskApp.remove_small_objects-2201"><span class="linenos">2201</span></a>            <span class="n">min_area</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_area_entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="ModifyMaskApp.remove_small_objects-2202"><a href="#ModifyMaskApp.remove_small_objects-2202"><span class="linenos">2202</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="ModifyMaskApp.remove_small_objects-2203"><a href="#ModifyMaskApp.remove_small_objects-2203"><span class="linenos">2203</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid minimum area value; using default of 100&quot;</span><span class="p">)</span>
</span><span id="ModifyMaskApp.remove_small_objects-2204"><a href="#ModifyMaskApp.remove_small_objects-2204"><span class="linenos">2204</span></a>            <span class="n">min_area</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="ModifyMaskApp.remove_small_objects-2205"><a href="#ModifyMaskApp.remove_small_objects-2205"><span class="linenos">2205</span></a>
</span><span id="ModifyMaskApp.remove_small_objects-2206"><a href="#ModifyMaskApp.remove_small_objects-2206"><span class="linenos">2206</span></a>        <span class="n">labeled_mask</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ModifyMaskApp.remove_small_objects-2207"><a href="#ModifyMaskApp.remove_small_objects-2207"><span class="linenos">2207</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># Skip background</span>
</span><span id="ModifyMaskApp.remove_small_objects-2208"><a href="#ModifyMaskApp.remove_small_objects-2208"><span class="linenos">2208</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">labeled_mask</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_area</span><span class="p">:</span>
</span><span id="ModifyMaskApp.remove_small_objects-2209"><a href="#ModifyMaskApp.remove_small_objects-2209"><span class="linenos">2209</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">labeled_mask</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Remove small objects</span>
</span><span id="ModifyMaskApp.remove_small_objects-2210"><a href="#ModifyMaskApp.remove_small_objects-2210"><span class="linenos">2210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="AnnotateApp">
                            <input id="AnnotateApp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AnnotateApp</span>:

                <label class="view-source-button" for="AnnotateApp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp-2212"><a href="#AnnotateApp-2212"><span class="linenos">2212</span></a><span class="k">class</span> <span class="nc">AnnotateApp</span><span class="p">:</span>
</span><span id="AnnotateApp-2213"><a href="#AnnotateApp-2213"><span class="linenos">2213</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">db_path</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">image_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">annotation_column</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="AnnotateApp-2214"><a href="#AnnotateApp-2214"><span class="linenos">2214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
</span><span id="AnnotateApp-2215"><a href="#AnnotateApp-2215"><span class="linenos">2215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>
</span><span id="AnnotateApp-2216"><a href="#AnnotateApp-2216"><span class="linenos">2216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span>
</span><span id="AnnotateApp-2217"><a href="#AnnotateApp-2217"><span class="linenos">2217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AnnotateApp-2218"><a href="#AnnotateApp-2218"><span class="linenos">2218</span></a>
</span><span id="AnnotateApp-2219"><a href="#AnnotateApp-2219"><span class="linenos">2219</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2220"><a href="#AnnotateApp-2220"><span class="linenos">2220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="AnnotateApp-2221"><a href="#AnnotateApp-2221"><span class="linenos">2221</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AnnotateApp-2222"><a href="#AnnotateApp-2222"><span class="linenos">2222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
</span><span id="AnnotateApp-2223"><a href="#AnnotateApp-2223"><span class="linenos">2223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2224"><a href="#AnnotateApp-2224"><span class="linenos">2224</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid image size&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2225"><a href="#AnnotateApp-2225"><span class="linenos">2225</span></a>        
</span><span id="AnnotateApp-2226"><a href="#AnnotateApp-2226"><span class="linenos">2226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_annotation_columns</span> <span class="o">=</span> <span class="n">annotation_column</span>
</span><span id="AnnotateApp-2227"><a href="#AnnotateApp-2227"><span class="linenos">2227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="n">annotation_column</span>
</span><span id="AnnotateApp-2228"><a href="#AnnotateApp-2228"><span class="linenos">2228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span> <span class="o">=</span> <span class="n">image_type</span>
</span><span id="AnnotateApp-2229"><a href="#AnnotateApp-2229"><span class="linenos">2229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">channels</span>
</span><span id="AnnotateApp-2230"><a href="#AnnotateApp-2230"><span class="linenos">2230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="AnnotateApp-2231"><a href="#AnnotateApp-2231"><span class="linenos">2231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span> <span class="o">=</span> <span class="n">percentiles</span>
</span><span id="AnnotateApp-2232"><a href="#AnnotateApp-2232"><span class="linenos">2232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp-2233"><a href="#AnnotateApp-2233"><span class="linenos">2233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp-2234"><a href="#AnnotateApp-2234"><span class="linenos">2234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AnnotateApp-2235"><a href="#AnnotateApp-2235"><span class="linenos">2235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp-2236"><a href="#AnnotateApp-2236"><span class="linenos">2236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AnnotateApp-2237"><a href="#AnnotateApp-2237"><span class="linenos">2237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
</span><span id="AnnotateApp-2238"><a href="#AnnotateApp-2238"><span class="linenos">2238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="n">measurement</span>
</span><span id="AnnotateApp-2239"><a href="#AnnotateApp-2239"><span class="linenos">2239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="AnnotateApp-2240"><a href="#AnnotateApp-2240"><span class="linenos">2240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span> <span class="o">=</span> <span class="n">normalize_channels</span>
</span><span id="AnnotateApp-2241"><a href="#AnnotateApp-2241"><span class="linenos">2241</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.normalize_channels&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span>
</span><span id="AnnotateApp-2242"><a href="#AnnotateApp-2242"><span class="linenos">2242</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="AnnotateApp-2243"><a href="#AnnotateApp-2243"><span class="linenos">2243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2244"><a href="#AnnotateApp-2244"><span class="linenos">2244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2245"><a href="#AnnotateApp-2245"><span class="linenos">2245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2246"><a href="#AnnotateApp-2246"><span class="linenos">2246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2247"><a href="#AnnotateApp-2247"><span class="linenos">2247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2248"><a href="#AnnotateApp-2248"><span class="linenos">2248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2249"><a href="#AnnotateApp-2249"><span class="linenos">2249</span></a>
</span><span id="AnnotateApp-2250"><a href="#AnnotateApp-2250"><span class="linenos">2250</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="AnnotateApp-2251"><a href="#AnnotateApp-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="AnnotateApp-2252"><a href="#AnnotateApp-2252"><span class="linenos">2252</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2253"><a href="#AnnotateApp-2253"><span class="linenos">2253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="AnnotateApp-2254"><a href="#AnnotateApp-2254"><span class="linenos">2254</span></a>        
</span><span id="AnnotateApp-2255"><a href="#AnnotateApp-2255"><span class="linenos">2255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp-2256"><a href="#AnnotateApp-2256"><span class="linenos">2256</span></a>
</span><span id="AnnotateApp-2257"><a href="#AnnotateApp-2257"><span class="linenos">2257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AnnotateApp-2258"><a href="#AnnotateApp-2258"><span class="linenos">2258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="AnnotateApp-2259"><a href="#AnnotateApp-2259"><span class="linenos">2259</span></a>
</span><span id="AnnotateApp-2260"><a href="#AnnotateApp-2260"><span class="linenos">2260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">update_database_worker</span><span class="p">)</span>
</span><span id="AnnotateApp-2261"><a href="#AnnotateApp-2261"><span class="linenos">2261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="AnnotateApp-2262"><a href="#AnnotateApp-2262"><span class="linenos">2262</span></a>
</span><span id="AnnotateApp-2263"><a href="#AnnotateApp-2263"><span class="linenos">2263</span></a>        <span class="c1"># Set the initial window size and make it fit the screen size</span>
</span><span id="AnnotateApp-2264"><a href="#AnnotateApp-2264"><span class="linenos">2264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2265"><a href="#AnnotateApp-2265"><span class="linenos">2265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
</span><span id="AnnotateApp-2266"><a href="#AnnotateApp-2266"><span class="linenos">2266</span></a>
</span><span id="AnnotateApp-2267"><a href="#AnnotateApp-2267"><span class="linenos">2267</span></a>        <span class="c1"># Create the status label</span>
</span><span id="AnnotateApp-2268"><a href="#AnnotateApp-2268"><span class="linenos">2268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp-2269"><a href="#AnnotateApp-2269"><span class="linenos">2269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2270"><a href="#AnnotateApp-2270"><span class="linenos">2270</span></a>
</span><span id="AnnotateApp-2271"><a href="#AnnotateApp-2271"><span class="linenos">2271</span></a>        <span class="c1"># Place the buttons at the bottom right</span>
</span><span id="AnnotateApp-2272"><a href="#AnnotateApp-2272"><span class="linenos">2272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp-2273"><a href="#AnnotateApp-2273"><span class="linenos">2273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;se&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2274"><a href="#AnnotateApp-2274"><span class="linenos">2274</span></a>
</span><span id="AnnotateApp-2275"><a href="#AnnotateApp-2275"><span class="linenos">2275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_page</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2276"><a href="#AnnotateApp-2276"><span class="linenos">2276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp-2277"><a href="#AnnotateApp-2277"><span class="linenos">2277</span></a>
</span><span id="AnnotateApp-2278"><a href="#AnnotateApp-2278"><span class="linenos">2278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_page</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2279"><a href="#AnnotateApp-2279"><span class="linenos">2279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp-2280"><a href="#AnnotateApp-2280"><span class="linenos">2280</span></a>
</span><span id="AnnotateApp-2281"><a href="#AnnotateApp-2281"><span class="linenos">2281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2282"><a href="#AnnotateApp-2282"><span class="linenos">2282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp-2283"><a href="#AnnotateApp-2283"><span class="linenos">2283</span></a>        
</span><span id="AnnotateApp-2284"><a href="#AnnotateApp-2284"><span class="linenos">2284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Train &amp; Classify (beta)&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_and_classify</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span><span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2285"><a href="#AnnotateApp-2285"><span class="linenos">2285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp-2286"><a href="#AnnotateApp-2286"><span class="linenos">2286</span></a>        
</span><span id="AnnotateApp-2287"><a href="#AnnotateApp-2287"><span class="linenos">2287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;orig.&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">swich_back_annotation_column</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span><span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2288"><a href="#AnnotateApp-2288"><span class="linenos">2288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp-2289"><a href="#AnnotateApp-2289"><span class="linenos">2289</span></a>        
</span><span id="AnnotateApp-2290"><a href="#AnnotateApp-2290"><span class="linenos">2290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_settings_window</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2291"><a href="#AnnotateApp-2291"><span class="linenos">2291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp-2292"><a href="#AnnotateApp-2292"><span class="linenos">2292</span></a>
</span><span id="AnnotateApp-2293"><a href="#AnnotateApp-2293"><span class="linenos">2293</span></a>        <span class="c1"># Calculate grid rows and columns based on the root window size and image size</span>
</span><span id="AnnotateApp-2294"><a href="#AnnotateApp-2294"><span class="linenos">2294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_dimensions</span><span class="p">()</span>
</span><span id="AnnotateApp-2295"><a href="#AnnotateApp-2295"><span class="linenos">2295</span></a>
</span><span id="AnnotateApp-2296"><a href="#AnnotateApp-2296"><span class="linenos">2296</span></a>        <span class="c1"># Create a frame to hold the image grid</span>
</span><span id="AnnotateApp-2297"><a href="#AnnotateApp-2297"><span class="linenos">2297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp-2298"><a href="#AnnotateApp-2298"><span class="linenos">2298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2299"><a href="#AnnotateApp-2299"><span class="linenos">2299</span></a>
</span><span id="AnnotateApp-2300"><a href="#AnnotateApp-2300"><span class="linenos">2300</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp-2301"><a href="#AnnotateApp-2301"><span class="linenos">2301</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp-2302"><a href="#AnnotateApp-2302"><span class="linenos">2302</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2303"><a href="#AnnotateApp-2303"><span class="linenos">2303</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="AnnotateApp-2304"><a href="#AnnotateApp-2304"><span class="linenos">2304</span></a>
</span><span id="AnnotateApp-2305"><a href="#AnnotateApp-2305"><span class="linenos">2305</span></a>        <span class="c1"># Make the grid frame resize with the window</span>
</span><span id="AnnotateApp-2306"><a href="#AnnotateApp-2306"><span class="linenos">2306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2307"><a href="#AnnotateApp-2307"><span class="linenos">2307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2308"><a href="#AnnotateApp-2308"><span class="linenos">2308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2309"><a href="#AnnotateApp-2309"><span class="linenos">2309</span></a>
</span><span id="AnnotateApp-2310"><a href="#AnnotateApp-2310"><span class="linenos">2310</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">):</span>
</span><span id="AnnotateApp-2311"><a href="#AnnotateApp-2311"><span class="linenos">2311</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2312"><a href="#AnnotateApp-2312"><span class="linenos">2312</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp-2313"><a href="#AnnotateApp-2313"><span class="linenos">2313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2314"><a href="#AnnotateApp-2314"><span class="linenos">2314</span></a>            
</span><span id="AnnotateApp-2315"><a href="#AnnotateApp-2315"><span class="linenos">2315</span></a>    <span class="k">def</span> <span class="nf">open_settings_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2316"><a href="#AnnotateApp-2316"><span class="linenos">2316</span></a>        <span class="kn">from</span> <span class="nn">.gui_utils</span> <span class="kn">import</span> <span class="n">generate_annotate_fields</span><span class="p">,</span> <span class="n">convert_to_number</span>
</span><span id="AnnotateApp-2317"><a href="#AnnotateApp-2317"><span class="linenos">2317</span></a>
</span><span id="AnnotateApp-2318"><a href="#AnnotateApp-2318"><span class="linenos">2318</span></a>        <span class="c1"># Create settings window</span>
</span><span id="AnnotateApp-2319"><a href="#AnnotateApp-2319"><span class="linenos">2319</span></a>        <span class="n">settings_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</span><span id="AnnotateApp-2320"><a href="#AnnotateApp-2320"><span class="linenos">2320</span></a>        <span class="n">settings_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Modify Annotation Settings&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2321"><a href="#AnnotateApp-2321"><span class="linenos">2321</span></a>
</span><span id="AnnotateApp-2322"><a href="#AnnotateApp-2322"><span class="linenos">2322</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="AnnotateApp-2323"><a href="#AnnotateApp-2323"><span class="linenos">2323</span></a>        <span class="n">settings_window</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp-2324"><a href="#AnnotateApp-2324"><span class="linenos">2324</span></a>        
</span><span id="AnnotateApp-2325"><a href="#AnnotateApp-2325"><span class="linenos">2325</span></a>        <span class="n">settings_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">settings_window</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp-2326"><a href="#AnnotateApp-2326"><span class="linenos">2326</span></a>        <span class="n">settings_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AnnotateApp-2327"><a href="#AnnotateApp-2327"><span class="linenos">2327</span></a>
</span><span id="AnnotateApp-2328"><a href="#AnnotateApp-2328"><span class="linenos">2328</span></a>        <span class="c1"># Generate fields with current settings pre-filled</span>
</span><span id="AnnotateApp-2329"><a href="#AnnotateApp-2329"><span class="linenos">2329</span></a>        <span class="n">vars_dict</span> <span class="o">=</span> <span class="n">generate_annotate_fields</span><span class="p">(</span><span class="n">settings_frame</span><span class="p">)</span>
</span><span id="AnnotateApp-2330"><a href="#AnnotateApp-2330"><span class="linenos">2330</span></a>
</span><span id="AnnotateApp-2331"><a href="#AnnotateApp-2331"><span class="linenos">2331</span></a>        <span class="c1"># Pre-fill the current settings into vars_dict</span>
</span><span id="AnnotateApp-2332"><a href="#AnnotateApp-2332"><span class="linenos">2332</span></a>        <span class="n">current_settings</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AnnotateApp-2333"><a href="#AnnotateApp-2333"><span class="linenos">2333</span></a>            <span class="s1">&#39;image_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp-2334"><a href="#AnnotateApp-2334"><span class="linenos">2334</span></a>            <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp-2335"><a href="#AnnotateApp-2335"><span class="linenos">2335</span></a>            <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AnnotateApp-2336"><a href="#AnnotateApp-2336"><span class="linenos">2336</span></a>            <span class="s1">&#39;annotation_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp-2337"><a href="#AnnotateApp-2337"><span class="linenos">2337</span></a>            <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">),</span>
</span><span id="AnnotateApp-2338"><a href="#AnnotateApp-2338"><span class="linenos">2338</span></a>            <span class="s1">&#39;percentiles&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span><span class="p">)),</span>
</span><span id="AnnotateApp-2339"><a href="#AnnotateApp-2339"><span class="linenos">2339</span></a>            <span class="s1">&#39;measurement&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp-2340"><a href="#AnnotateApp-2340"><span class="linenos">2340</span></a>            <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp-2341"><a href="#AnnotateApp-2341"><span class="linenos">2341</span></a>            <span class="s1">&#39;normalize_channels&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
</span><span id="AnnotateApp-2342"><a href="#AnnotateApp-2342"><span class="linenos">2342</span></a>        <span class="p">}</span>
</span><span id="AnnotateApp-2343"><a href="#AnnotateApp-2343"><span class="linenos">2343</span></a>
</span><span id="AnnotateApp-2344"><a href="#AnnotateApp-2344"><span class="linenos">2344</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">vars_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp-2345"><a href="#AnnotateApp-2345"><span class="linenos">2345</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">current_settings</span><span class="p">:</span>
</span><span id="AnnotateApp-2346"><a href="#AnnotateApp-2346"><span class="linenos">2346</span></a>                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
</span><span id="AnnotateApp-2347"><a href="#AnnotateApp-2347"><span class="linenos">2347</span></a>                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">current_settings</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="AnnotateApp-2348"><a href="#AnnotateApp-2348"><span class="linenos">2348</span></a>
</span><span id="AnnotateApp-2349"><a href="#AnnotateApp-2349"><span class="linenos">2349</span></a>        <span class="k">def</span> <span class="nf">apply_new_settings</span><span class="p">():</span>
</span><span id="AnnotateApp-2350"><a href="#AnnotateApp-2350"><span class="linenos">2350</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">vars_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="AnnotateApp-2351"><a href="#AnnotateApp-2351"><span class="linenos">2351</span></a>            
</span><span id="AnnotateApp-2352"><a href="#AnnotateApp-2352"><span class="linenos">2352</span></a>            <span class="c1"># Process settings exactly as your original initiation function does</span>
</span><span id="AnnotateApp-2353"><a href="#AnnotateApp-2353"><span class="linenos">2353</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2354"><a href="#AnnotateApp-2354"><span class="linenos">2354</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span>
</span><span id="AnnotateApp-2355"><a href="#AnnotateApp-2355"><span class="linenos">2355</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">convert_to_number</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
</span><span id="AnnotateApp-2356"><a href="#AnnotateApp-2356"><span class="linenos">2356</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span>
</span><span id="AnnotateApp-2357"><a href="#AnnotateApp-2357"><span class="linenos">2357</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2358"><a href="#AnnotateApp-2358"><span class="linenos">2358</span></a>
</span><span id="AnnotateApp-2359"><a href="#AnnotateApp-2359"><span class="linenos">2359</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="AnnotateApp-2360"><a href="#AnnotateApp-2360"><span class="linenos">2360</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2361"><a href="#AnnotateApp-2361"><span class="linenos">2361</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp-2362"><a href="#AnnotateApp-2362"><span class="linenos">2362</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="AnnotateApp-2363"><a href="#AnnotateApp-2363"><span class="linenos">2363</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2364"><a href="#AnnotateApp-2364"><span class="linenos">2364</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2365"><a href="#AnnotateApp-2365"><span class="linenos">2365</span></a>
</span><span id="AnnotateApp-2366"><a href="#AnnotateApp-2366"><span class="linenos">2366</span></a>            <span class="c1"># Convert empty strings to None</span>
</span><span id="AnnotateApp-2367"><a href="#AnnotateApp-2367"><span class="linenos">2367</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp-2368"><a href="#AnnotateApp-2368"><span class="linenos">2368</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2369"><a href="#AnnotateApp-2369"><span class="linenos">2369</span></a>                    <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
</span><span id="AnnotateApp-2370"><a href="#AnnotateApp-2370"><span class="linenos">2370</span></a>                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2371"><a href="#AnnotateApp-2371"><span class="linenos">2371</span></a>                    <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2372"><a href="#AnnotateApp-2372"><span class="linenos">2372</span></a>
</span><span id="AnnotateApp-2373"><a href="#AnnotateApp-2373"><span class="linenos">2373</span></a>            <span class="c1"># Apply these settings dynamically using update_settings method</span>
</span><span id="AnnotateApp-2374"><a href="#AnnotateApp-2374"><span class="linenos">2374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
</span><span id="AnnotateApp-2375"><a href="#AnnotateApp-2375"><span class="linenos">2375</span></a>                <span class="s1">&#39;image_type&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;image_type&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2376"><a href="#AnnotateApp-2376"><span class="linenos">2376</span></a>                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channels&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2377"><a href="#AnnotateApp-2377"><span class="linenos">2377</span></a>                <span class="s1">&#39;image_size&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;img_size&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2378"><a href="#AnnotateApp-2378"><span class="linenos">2378</span></a>                <span class="s1">&#39;annotation_column&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;annotation_column&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2379"><a href="#AnnotateApp-2379"><span class="linenos">2379</span></a>                <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalize&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2380"><a href="#AnnotateApp-2380"><span class="linenos">2380</span></a>                <span class="s1">&#39;percentiles&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;percentiles&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2381"><a href="#AnnotateApp-2381"><span class="linenos">2381</span></a>                <span class="s1">&#39;measurement&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;measurement&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2382"><a href="#AnnotateApp-2382"><span class="linenos">2382</span></a>                <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp-2383"><a href="#AnnotateApp-2383"><span class="linenos">2383</span></a>                <span class="s1">&#39;normalize_channels&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2384"><a href="#AnnotateApp-2384"><span class="linenos">2384</span></a>            <span class="p">})</span>
</span><span id="AnnotateApp-2385"><a href="#AnnotateApp-2385"><span class="linenos">2385</span></a>
</span><span id="AnnotateApp-2386"><a href="#AnnotateApp-2386"><span class="linenos">2386</span></a>            <span class="n">settings_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="AnnotateApp-2387"><a href="#AnnotateApp-2387"><span class="linenos">2387</span></a>
</span><span id="AnnotateApp-2388"><a href="#AnnotateApp-2388"><span class="linenos">2388</span></a>        <span class="n">apply_button</span> <span class="o">=</span> <span class="n">spacrButton</span><span class="p">(</span><span class="n">settings_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply Settings&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">apply_new_settings</span><span class="p">,</span><span class="n">show_text</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AnnotateApp-2389"><a href="#AnnotateApp-2389"><span class="linenos">2389</span></a>        <span class="n">apply_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="AnnotateApp-2390"><a href="#AnnotateApp-2390"><span class="linenos">2390</span></a>        
</span><span id="AnnotateApp-2391"><a href="#AnnotateApp-2391"><span class="linenos">2391</span></a>    <span class="k">def</span> <span class="nf">update_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AnnotateApp-2392"><a href="#AnnotateApp-2392"><span class="linenos">2392</span></a>        <span class="n">allowed_attributes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AnnotateApp-2393"><a href="#AnnotateApp-2393"><span class="linenos">2393</span></a>            <span class="s1">&#39;image_type&#39;</span><span class="p">,</span> <span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="s1">&#39;image_size&#39;</span><span class="p">,</span> <span class="s1">&#39;annotation_column&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp-2394"><a href="#AnnotateApp-2394"><span class="linenos">2394</span></a>            <span class="s1">&#39;normalize&#39;</span><span class="p">,</span> <span class="s1">&#39;percentiles&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;normalize_channels&#39;</span>
</span><span id="AnnotateApp-2395"><a href="#AnnotateApp-2395"><span class="linenos">2395</span></a>        <span class="p">}</span>
</span><span id="AnnotateApp-2396"><a href="#AnnotateApp-2396"><span class="linenos">2396</span></a>
</span><span id="AnnotateApp-2397"><a href="#AnnotateApp-2397"><span class="linenos">2397</span></a>        <span class="n">updated</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AnnotateApp-2398"><a href="#AnnotateApp-2398"><span class="linenos">2398</span></a>
</span><span id="AnnotateApp-2399"><a href="#AnnotateApp-2399"><span class="linenos">2399</span></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp-2400"><a href="#AnnotateApp-2400"><span class="linenos">2400</span></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">allowed_attributes</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp-2401"><a href="#AnnotateApp-2401"><span class="linenos">2401</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="AnnotateApp-2402"><a href="#AnnotateApp-2402"><span class="linenos">2402</span></a>                <span class="n">updated</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="AnnotateApp-2403"><a href="#AnnotateApp-2403"><span class="linenos">2403</span></a>
</span><span id="AnnotateApp-2404"><a href="#AnnotateApp-2404"><span class="linenos">2404</span></a>        <span class="k">if</span> <span class="s1">&#39;image_size&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="AnnotateApp-2405"><a href="#AnnotateApp-2405"><span class="linenos">2405</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2406"><a href="#AnnotateApp-2406"><span class="linenos">2406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="AnnotateApp-2407"><a href="#AnnotateApp-2407"><span class="linenos">2407</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AnnotateApp-2408"><a href="#AnnotateApp-2408"><span class="linenos">2408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">)</span>
</span><span id="AnnotateApp-2409"><a href="#AnnotateApp-2409"><span class="linenos">2409</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2410"><a href="#AnnotateApp-2410"><span class="linenos">2410</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid image size&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2411"><a href="#AnnotateApp-2411"><span class="linenos">2411</span></a>
</span><span id="AnnotateApp-2412"><a href="#AnnotateApp-2412"><span class="linenos">2412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_dimensions</span><span class="p">()</span>
</span><span id="AnnotateApp-2413"><a href="#AnnotateApp-2413"><span class="linenos">2413</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recreate_image_grid</span><span class="p">()</span>
</span><span id="AnnotateApp-2414"><a href="#AnnotateApp-2414"><span class="linenos">2414</span></a>
</span><span id="AnnotateApp-2415"><a href="#AnnotateApp-2415"><span class="linenos">2415</span></a>        <span class="k">if</span> <span class="n">updated</span><span class="p">:</span>
</span><span id="AnnotateApp-2416"><a href="#AnnotateApp-2416"><span class="linenos">2416</span></a>            <span class="n">current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># Retain current index</span>
</span><span id="AnnotateApp-2417"><a href="#AnnotateApp-2417"><span class="linenos">2417</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="AnnotateApp-2418"><a href="#AnnotateApp-2418"><span class="linenos">2418</span></a>
</span><span id="AnnotateApp-2419"><a href="#AnnotateApp-2419"><span class="linenos">2419</span></a>            <span class="c1"># Ensure the retained index is still valid (not out of bounds)</span>
</span><span id="AnnotateApp-2420"><a href="#AnnotateApp-2420"><span class="linenos">2420</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="AnnotateApp-2421"><a href="#AnnotateApp-2421"><span class="linenos">2421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_index</span><span class="p">,</span> <span class="n">max_index</span> <span class="o">:=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="mi">0</span><span class="p">))))</span>
</span><span id="AnnotateApp-2422"><a href="#AnnotateApp-2422"><span class="linenos">2422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span><span id="AnnotateApp-2423"><a href="#AnnotateApp-2423"><span class="linenos">2423</span></a>
</span><span id="AnnotateApp-2424"><a href="#AnnotateApp-2424"><span class="linenos">2424</span></a>    <span class="k">def</span> <span class="nf">recreate_image_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2425"><a href="#AnnotateApp-2425"><span class="linenos">2425</span></a>        <span class="c1"># Remove current labels</span>
</span><span id="AnnotateApp-2426"><a href="#AnnotateApp-2426"><span class="linenos">2426</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
</span><span id="AnnotateApp-2427"><a href="#AnnotateApp-2427"><span class="linenos">2427</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="AnnotateApp-2428"><a href="#AnnotateApp-2428"><span class="linenos">2428</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp-2429"><a href="#AnnotateApp-2429"><span class="linenos">2429</span></a>
</span><span id="AnnotateApp-2430"><a href="#AnnotateApp-2430"><span class="linenos">2430</span></a>        <span class="c1"># Recreate the labels grid with updated dimensions</span>
</span><span id="AnnotateApp-2431"><a href="#AnnotateApp-2431"><span class="linenos">2431</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp-2432"><a href="#AnnotateApp-2432"><span class="linenos">2432</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp-2433"><a href="#AnnotateApp-2433"><span class="linenos">2433</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2434"><a href="#AnnotateApp-2434"><span class="linenos">2434</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="AnnotateApp-2435"><a href="#AnnotateApp-2435"><span class="linenos">2435</span></a>
</span><span id="AnnotateApp-2436"><a href="#AnnotateApp-2436"><span class="linenos">2436</span></a>        <span class="c1"># Reconfigure grid weights</span>
</span><span id="AnnotateApp-2437"><a href="#AnnotateApp-2437"><span class="linenos">2437</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">):</span>
</span><span id="AnnotateApp-2438"><a href="#AnnotateApp-2438"><span class="linenos">2438</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2439"><a href="#AnnotateApp-2439"><span class="linenos">2439</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp-2440"><a href="#AnnotateApp-2440"><span class="linenos">2440</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp-2441"><a href="#AnnotateApp-2441"><span class="linenos">2441</span></a>
</span><span id="AnnotateApp-2442"><a href="#AnnotateApp-2442"><span class="linenos">2442</span></a>            
</span><span id="AnnotateApp-2443"><a href="#AnnotateApp-2443"><span class="linenos">2443</span></a>    <span class="k">def</span> <span class="nf">swich_back_annotation_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2444"><a href="#AnnotateApp-2444"><span class="linenos">2444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_annotation_columns</span>
</span><span id="AnnotateApp-2445"><a href="#AnnotateApp-2445"><span class="linenos">2445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="AnnotateApp-2446"><a href="#AnnotateApp-2446"><span class="linenos">2446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span><span id="AnnotateApp-2447"><a href="#AnnotateApp-2447"><span class="linenos">2447</span></a>            
</span><span id="AnnotateApp-2448"><a href="#AnnotateApp-2448"><span class="linenos">2448</span></a>    <span class="k">def</span> <span class="nf">calculate_grid_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2449"><a href="#AnnotateApp-2449"><span class="linenos">2449</span></a>        <span class="n">window_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="AnnotateApp-2450"><a href="#AnnotateApp-2450"><span class="linenos">2450</span></a>        <span class="n">window_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="AnnotateApp-2451"><a href="#AnnotateApp-2451"><span class="linenos">2451</span></a>
</span><span id="AnnotateApp-2452"><a href="#AnnotateApp-2452"><span class="linenos">2452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span> <span class="o">=</span> <span class="n">window_width</span> <span class="o">//</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="AnnotateApp-2453"><a href="#AnnotateApp-2453"><span class="linenos">2453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">window_height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="AnnotateApp-2454"><a href="#AnnotateApp-2454"><span class="linenos">2454</span></a>
</span><span id="AnnotateApp-2455"><a href="#AnnotateApp-2455"><span class="linenos">2455</span></a>        <span class="c1"># Update to make sure grid_rows and grid_cols are at least 1</span>
</span><span id="AnnotateApp-2456"><a href="#AnnotateApp-2456"><span class="linenos">2456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">)</span>
</span><span id="AnnotateApp-2457"><a href="#AnnotateApp-2457"><span class="linenos">2457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">)</span>
</span><span id="AnnotateApp-2458"><a href="#AnnotateApp-2458"><span class="linenos">2458</span></a>
</span><span id="AnnotateApp-2459"><a href="#AnnotateApp-2459"><span class="linenos">2459</span></a>    <span class="k">def</span> <span class="nf">prefilter_paths_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2460"><a href="#AnnotateApp-2460"><span class="linenos">2460</span></a>        <span class="kn">from</span> <span class="nn">.io</span> <span class="kn">import</span> <span class="n">_read_and_join_tables</span><span class="p">,</span> <span class="n">_read_db</span>
</span><span id="AnnotateApp-2461"><a href="#AnnotateApp-2461"><span class="linenos">2461</span></a>        <span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">is_list_of_lists</span>
</span><span id="AnnotateApp-2462"><a href="#AnnotateApp-2462"><span class="linenos">2462</span></a>
</span><span id="AnnotateApp-2463"><a href="#AnnotateApp-2463"><span class="linenos">2463</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp-2464"><a href="#AnnotateApp-2464"><span class="linenos">2464</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">_read_and_join_tables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp-2465"><a href="#AnnotateApp-2465"><span class="linenos">2465</span></a>            <span class="n">png_list_df</span> <span class="o">=</span> <span class="n">_read_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png_list&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp-2466"><a href="#AnnotateApp-2466"><span class="linenos">2466</span></a>            <span class="n">png_list_df</span> <span class="o">=</span> <span class="n">png_list_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;prcfo&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2467"><a href="#AnnotateApp-2467"><span class="linenos">2467</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">png_list_df</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AnnotateApp-2468"><a href="#AnnotateApp-2468"><span class="linenos">2468</span></a>            <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2469"><a href="#AnnotateApp-2469"><span class="linenos">2469</span></a>            <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2470"><a href="#AnnotateApp-2470"><span class="linenos">2470</span></a>
</span><span id="AnnotateApp-2471"><a href="#AnnotateApp-2471"><span class="linenos">2471</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AnnotateApp-2472"><a href="#AnnotateApp-2472"><span class="linenos">2472</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2473"><a href="#AnnotateApp-2473"><span class="linenos">2473</span></a>                    <span class="n">mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp-2474"><a href="#AnnotateApp-2474"><span class="linenos">2474</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="AnnotateApp-2475"><a href="#AnnotateApp-2475"><span class="linenos">2475</span></a>                    <span class="n">mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span>
</span><span id="AnnotateApp-2476"><a href="#AnnotateApp-2476"><span class="linenos">2476</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mes</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="AnnotateApp-2477"><a href="#AnnotateApp-2477"><span class="linenos">2477</span></a>
</span><span id="AnnotateApp-2478"><a href="#AnnotateApp-2478"><span class="linenos">2478</span></a>            <span class="k">if</span> <span class="n">is_list_of_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="AnnotateApp-2479"><a href="#AnnotateApp-2479"><span class="linenos">2479</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_list_of_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
</span><span id="AnnotateApp-2480"><a href="#AnnotateApp-2480"><span class="linenos">2480</span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
</span><span id="AnnotateApp-2481"><a href="#AnnotateApp-2481"><span class="linenos">2481</span></a>                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="AnnotateApp-2482"><a href="#AnnotateApp-2482"><span class="linenos">2482</span></a>                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span>
</span><span id="AnnotateApp-2483"><a href="#AnnotateApp-2483"><span class="linenos">2483</span></a>                        <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2484"><a href="#AnnotateApp-2484"><span class="linenos">2484</span></a>                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
</span><span id="AnnotateApp-2485"><a href="#AnnotateApp-2485"><span class="linenos">2485</span></a>                        <span class="n">th_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AnnotateApp-2486"><a href="#AnnotateApp-2486"><span class="linenos">2486</span></a>                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="AnnotateApp-2487"><a href="#AnnotateApp-2487"><span class="linenos">2487</span></a>                            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AnnotateApp-2488"><a href="#AnnotateApp-2488"><span class="linenos">2488</span></a>                                <span class="n">th_idx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="AnnotateApp-2489"><a href="#AnnotateApp-2489"><span class="linenos">2489</span></a>                                <span class="n">thd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="AnnotateApp-2490"><a href="#AnnotateApp-2490"><span class="linenos">2490</span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thd</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2491"><a href="#AnnotateApp-2491"><span class="linenos">2491</span></a>                                    <span class="n">thd</span> <span class="o">=</span> <span class="n">thd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp-2492"><a href="#AnnotateApp-2492"><span class="linenos">2492</span></a>                                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="AnnotateApp-2493"><a href="#AnnotateApp-2493"><span class="linenos">2493</span></a>                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2494"><a href="#AnnotateApp-2494"><span class="linenos">2494</span></a>                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2495"><a href="#AnnotateApp-2495"><span class="linenos">2495</span></a>                                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thd</span><span class="p">]</span>
</span><span id="AnnotateApp-2496"><a href="#AnnotateApp-2496"><span class="linenos">2496</span></a>                        <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2497"><a href="#AnnotateApp-2497"><span class="linenos">2497</span></a>            
</span><span id="AnnotateApp-2498"><a href="#AnnotateApp-2498"><span class="linenos">2498</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2499"><a href="#AnnotateApp-2499"><span class="linenos">2499</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="AnnotateApp-2500"><a href="#AnnotateApp-2500"><span class="linenos">2500</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2501"><a href="#AnnotateApp-2501"><span class="linenos">2501</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2502"><a href="#AnnotateApp-2502"><span class="linenos">2502</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="AnnotateApp-2503"><a href="#AnnotateApp-2503"><span class="linenos">2503</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2504"><a href="#AnnotateApp-2504"><span class="linenos">2504</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="s1">&#39;threshold_measurement&#39;</span>
</span><span id="AnnotateApp-2505"><a href="#AnnotateApp-2505"><span class="linenos">2505</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2506"><a href="#AnnotateApp-2506"><span class="linenos">2506</span></a>            
</span><span id="AnnotateApp-2507"><a href="#AnnotateApp-2507"><span class="linenos">2507</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2508"><a href="#AnnotateApp-2508"><span class="linenos">2508</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2509"><a href="#AnnotateApp-2509"><span class="linenos">2509</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2510"><a href="#AnnotateApp-2510"><span class="linenos">2510</span></a>                <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2511"><a href="#AnnotateApp-2511"><span class="linenos">2511</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="AnnotateApp-2512"><a href="#AnnotateApp-2512"><span class="linenos">2512</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q1&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2513"><a href="#AnnotateApp-2513"><span class="linenos">2513</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="AnnotateApp-2514"><a href="#AnnotateApp-2514"><span class="linenos">2514</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q2&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2515"><a href="#AnnotateApp-2515"><span class="linenos">2515</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="AnnotateApp-2516"><a href="#AnnotateApp-2516"><span class="linenos">2516</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q3&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2517"><a href="#AnnotateApp-2517"><span class="linenos">2517</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="AnnotateApp-2518"><a href="#AnnotateApp-2518"><span class="linenos">2518</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q4&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2519"><a href="#AnnotateApp-2519"><span class="linenos">2519</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="AnnotateApp-2520"><a href="#AnnotateApp-2520"><span class="linenos">2520</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q5&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2521"><a href="#AnnotateApp-2521"><span class="linenos">2521</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="AnnotateApp-2522"><a href="#AnnotateApp-2522"><span class="linenos">2522</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q6&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2523"><a href="#AnnotateApp-2523"><span class="linenos">2523</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="AnnotateApp-2524"><a href="#AnnotateApp-2524"><span class="linenos">2524</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q7&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2525"><a href="#AnnotateApp-2525"><span class="linenos">2525</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="AnnotateApp-2526"><a href="#AnnotateApp-2526"><span class="linenos">2526</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q8&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2527"><a href="#AnnotateApp-2527"><span class="linenos">2527</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="AnnotateApp-2528"><a href="#AnnotateApp-2528"><span class="linenos">2528</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q9&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp-2529"><a href="#AnnotateApp-2529"><span class="linenos">2529</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
</span><span id="AnnotateApp-2530"><a href="#AnnotateApp-2530"><span class="linenos">2530</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;threshold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2531"><a href="#AnnotateApp-2531"><span class="linenos">2531</span></a>
</span><span id="AnnotateApp-2532"><a href="#AnnotateApp-2532"><span class="linenos">2532</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="AnnotateApp-2533"><a href="#AnnotateApp-2533"><span class="linenos">2533</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2534"><a href="#AnnotateApp-2534"><span class="linenos">2534</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2535"><a href="#AnnotateApp-2535"><span class="linenos">2535</span></a>
</span><span id="AnnotateApp-2536"><a href="#AnnotateApp-2536"><span class="linenos">2536</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp-2537"><a href="#AnnotateApp-2537"><span class="linenos">2537</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="AnnotateApp-2538"><a href="#AnnotateApp-2538"><span class="linenos">2538</span></a>                <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2539"><a href="#AnnotateApp-2539"><span class="linenos">2539</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp-2540"><a href="#AnnotateApp-2540"><span class="linenos">2540</span></a>                    <span class="k">for</span> <span class="n">tpe</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="AnnotateApp-2541"><a href="#AnnotateApp-2541"><span class="linenos">2541</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">tpe</span><span class="p">)]</span>
</span><span id="AnnotateApp-2542"><a href="#AnnotateApp-2542"><span class="linenos">2542</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2543"><a href="#AnnotateApp-2543"><span class="linenos">2543</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">)]</span>
</span><span id="AnnotateApp-2544"><a href="#AnnotateApp-2544"><span class="linenos">2544</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp-2545"><a href="#AnnotateApp-2545"><span class="linenos">2545</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;image_type: Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2546"><a href="#AnnotateApp-2546"><span class="linenos">2546</span></a>
</span><span id="AnnotateApp-2547"><a href="#AnnotateApp-2547"><span class="linenos">2547</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;png_path&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="AnnotateApp-2548"><a href="#AnnotateApp-2548"><span class="linenos">2548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2549"><a href="#AnnotateApp-2549"><span class="linenos">2549</span></a>            <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp-2550"><a href="#AnnotateApp-2550"><span class="linenos">2550</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp-2551"><a href="#AnnotateApp-2551"><span class="linenos">2551</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="AnnotateApp-2552"><a href="#AnnotateApp-2552"><span class="linenos">2552</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list WHERE png_path LIKE ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,))</span>
</span><span id="AnnotateApp-2553"><a href="#AnnotateApp-2553"><span class="linenos">2553</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2554"><a href="#AnnotateApp-2554"><span class="linenos">2554</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2555"><a href="#AnnotateApp-2555"><span class="linenos">2555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="AnnotateApp-2556"><a href="#AnnotateApp-2556"><span class="linenos">2556</span></a>            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AnnotateApp-2557"><a href="#AnnotateApp-2557"><span class="linenos">2557</span></a>
</span><span id="AnnotateApp-2558"><a href="#AnnotateApp-2558"><span class="linenos">2558</span></a>    <span class="k">def</span> <span class="nf">load_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2559"><a href="#AnnotateApp-2559"><span class="linenos">2559</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
</span><span id="AnnotateApp-2560"><a href="#AnnotateApp-2560"><span class="linenos">2560</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2561"><a href="#AnnotateApp-2561"><span class="linenos">2561</span></a>
</span><span id="AnnotateApp-2562"><a href="#AnnotateApp-2562"><span class="linenos">2562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp-2563"><a href="#AnnotateApp-2563"><span class="linenos">2563</span></a>        <span class="n">paths_annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">]</span>
</span><span id="AnnotateApp-2564"><a href="#AnnotateApp-2564"><span class="linenos">2564</span></a>
</span><span id="AnnotateApp-2565"><a href="#AnnotateApp-2565"><span class="linenos">2565</span></a>        <span class="n">adjusted_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AnnotateApp-2566"><a href="#AnnotateApp-2566"><span class="linenos">2566</span></a>        <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">paths_annotations</span><span class="p">:</span>
</span><span id="AnnotateApp-2567"><a href="#AnnotateApp-2567"><span class="linenos">2567</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">):</span>
</span><span id="AnnotateApp-2568"><a href="#AnnotateApp-2568"><span class="linenos">2568</span></a>                <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/data/&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2569"><a href="#AnnotateApp-2569"><span class="linenos">2569</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AnnotateApp-2570"><a href="#AnnotateApp-2570"><span class="linenos">2570</span></a>                    <span class="n">new_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="AnnotateApp-2571"><a href="#AnnotateApp-2571"><span class="linenos">2571</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span><span class="p">[</span><span class="n">new_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="AnnotateApp-2572"><a href="#AnnotateApp-2572"><span class="linenos">2572</span></a>                    <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">new_path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="AnnotateApp-2573"><a href="#AnnotateApp-2573"><span class="linenos">2573</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2574"><a href="#AnnotateApp-2574"><span class="linenos">2574</span></a>                    <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="AnnotateApp-2575"><a href="#AnnotateApp-2575"><span class="linenos">2575</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2576"><a href="#AnnotateApp-2576"><span class="linenos">2576</span></a>                <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="AnnotateApp-2577"><a href="#AnnotateApp-2577"><span class="linenos">2577</span></a>
</span><span id="AnnotateApp-2578"><a href="#AnnotateApp-2578"><span class="linenos">2578</span></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="AnnotateApp-2579"><a href="#AnnotateApp-2579"><span class="linenos">2579</span></a>            <span class="n">loaded_images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_single_image</span><span class="p">,</span> <span class="n">adjusted_paths</span><span class="p">))</span>
</span><span id="AnnotateApp-2580"><a href="#AnnotateApp-2580"><span class="linenos">2580</span></a>
</span><span id="AnnotateApp-2581"><a href="#AnnotateApp-2581"><span class="linenos">2581</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">annotation</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loaded_images</span><span class="p">):</span>
</span><span id="AnnotateApp-2582"><a href="#AnnotateApp-2582"><span class="linenos">2582</span></a>            <span class="k">if</span> <span class="n">annotation</span><span class="p">:</span>
</span><span id="AnnotateApp-2583"><a href="#AnnotateApp-2583"><span class="linenos">2583</span></a>                <span class="n">border_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="n">annotation</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
</span><span id="AnnotateApp-2584"><a href="#AnnotateApp-2584"><span class="linenos">2584</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_colored_border</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">border_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp-2585"><a href="#AnnotateApp-2585"><span class="linenos">2585</span></a>
</span><span id="AnnotateApp-2586"><a href="#AnnotateApp-2586"><span class="linenos">2586</span></a>            <span class="n">photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="AnnotateApp-2587"><a href="#AnnotateApp-2587"><span class="linenos">2587</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="AnnotateApp-2588"><a href="#AnnotateApp-2588"><span class="linenos">2588</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">photo</span>
</span><span id="AnnotateApp-2589"><a href="#AnnotateApp-2589"><span class="linenos">2589</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">photo</span><span class="p">)</span>
</span><span id="AnnotateApp-2590"><a href="#AnnotateApp-2590"><span class="linenos">2590</span></a>
</span><span id="AnnotateApp-2591"><a href="#AnnotateApp-2591"><span class="linenos">2591</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">adjusted_paths</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp-2592"><a href="#AnnotateApp-2592"><span class="linenos">2592</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Button-1&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_on_image_click</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span>
</span><span id="AnnotateApp-2593"><a href="#AnnotateApp-2593"><span class="linenos">2593</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Button-3&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_on_image_click</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span>
</span><span id="AnnotateApp-2594"><a href="#AnnotateApp-2594"><span class="linenos">2594</span></a>
</span><span id="AnnotateApp-2595"><a href="#AnnotateApp-2595"><span class="linenos">2595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="AnnotateApp-2596"><a href="#AnnotateApp-2596"><span class="linenos">2596</span></a>
</span><span id="AnnotateApp-2597"><a href="#AnnotateApp-2597"><span class="linenos">2597</span></a>    <span class="k">def</span> <span class="nf">load_single_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_annotation_tuple</span><span class="p">):</span>
</span><span id="AnnotateApp-2598"><a href="#AnnotateApp-2598"><span class="linenos">2598</span></a>        <span class="n">path</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="n">path_annotation_tuple</span>
</span><span id="AnnotateApp-2599"><a href="#AnnotateApp-2599"><span class="linenos">2599</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="AnnotateApp-2600"><a href="#AnnotateApp-2600"><span class="linenos">2600</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span>
</span><span id="AnnotateApp-2601"><a href="#AnnotateApp-2601"><span class="linenos">2601</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2602"><a href="#AnnotateApp-2602"><span class="linenos">2602</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_channels</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="AnnotateApp-2603"><a href="#AnnotateApp-2603"><span class="linenos">2603</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">)</span>
</span><span id="AnnotateApp-2604"><a href="#AnnotateApp-2604"><span class="linenos">2604</span></a>        <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">annotation</span>
</span><span id="AnnotateApp-2605"><a href="#AnnotateApp-2605"><span class="linenos">2605</span></a>    
</span><span id="AnnotateApp-2606"><a href="#AnnotateApp-2606"><span class="linenos">2606</span></a>    <span class="nd">@staticmethod</span>
</span><span id="AnnotateApp-2607"><a href="#AnnotateApp-2607"><span class="linenos">2607</span></a>    <span class="k">def</span> <span class="nf">normalize_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span> <span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="AnnotateApp-2608"><a href="#AnnotateApp-2608"><span class="linenos">2608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2609"><a href="#AnnotateApp-2609"><span class="linenos">2609</span></a><span class="sd">        Normalize an image based on specific channels (R, G, B).</span>
</span><span id="AnnotateApp-2610"><a href="#AnnotateApp-2610"><span class="linenos">2610</span></a>
</span><span id="AnnotateApp-2611"><a href="#AnnotateApp-2611"><span class="linenos">2611</span></a><span class="sd">        Args:</span>
</span><span id="AnnotateApp-2612"><a href="#AnnotateApp-2612"><span class="linenos">2612</span></a><span class="sd">            img (PIL.Image or np.array): Input image.</span>
</span><span id="AnnotateApp-2613"><a href="#AnnotateApp-2613"><span class="linenos">2613</span></a><span class="sd">            normalize (bool): Whether to normalize the image or not.</span>
</span><span id="AnnotateApp-2614"><a href="#AnnotateApp-2614"><span class="linenos">2614</span></a><span class="sd">            percentiles (tuple): Percentiles to use for intensity rescaling.</span>
</span><span id="AnnotateApp-2615"><a href="#AnnotateApp-2615"><span class="linenos">2615</span></a><span class="sd">            normalize_channels (list): List of channels to normalize. E.g., [&#39;r&#39;, &#39;g&#39;, &#39;b&#39;], [&#39;r&#39;], [&#39;g&#39;], etc.</span>
</span><span id="AnnotateApp-2616"><a href="#AnnotateApp-2616"><span class="linenos">2616</span></a>
</span><span id="AnnotateApp-2617"><a href="#AnnotateApp-2617"><span class="linenos">2617</span></a><span class="sd">        Returns:</span>
</span><span id="AnnotateApp-2618"><a href="#AnnotateApp-2618"><span class="linenos">2618</span></a><span class="sd">            PIL.Image: Normalized image.</span>
</span><span id="AnnotateApp-2619"><a href="#AnnotateApp-2619"><span class="linenos">2619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2620"><a href="#AnnotateApp-2620"><span class="linenos">2620</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="AnnotateApp-2621"><a href="#AnnotateApp-2621"><span class="linenos">2621</span></a>
</span><span id="AnnotateApp-2622"><a href="#AnnotateApp-2622"><span class="linenos">2622</span></a>        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
</span><span id="AnnotateApp-2623"><a href="#AnnotateApp-2623"><span class="linenos">2623</span></a>            <span class="k">if</span> <span class="n">img_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Grayscale image</span>
</span><span id="AnnotateApp-2624"><a href="#AnnotateApp-2624"><span class="linenos">2624</span></a>                <span class="n">p2</span><span class="p">,</span> <span class="n">p98</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">)</span>
</span><span id="AnnotateApp-2625"><a href="#AnnotateApp-2625"><span class="linenos">2625</span></a>                <span class="n">img_array</span> <span class="o">=</span> <span class="n">rescale_intensity</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">in_range</span><span class="o">=</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p98</span><span class="p">),</span> <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="AnnotateApp-2626"><a href="#AnnotateApp-2626"><span class="linenos">2626</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Color image or multi-channel image</span>
</span><span id="AnnotateApp-2627"><a href="#AnnotateApp-2627"><span class="linenos">2627</span></a>                <span class="c1"># Create a map for the color channels</span>
</span><span id="AnnotateApp-2628"><a href="#AnnotateApp-2628"><span class="linenos">2628</span></a>                <span class="n">channel_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span><span id="AnnotateApp-2629"><a href="#AnnotateApp-2629"><span class="linenos">2629</span></a>                
</span><span id="AnnotateApp-2630"><a href="#AnnotateApp-2630"><span class="linenos">2630</span></a>                <span class="c1"># If normalize_channels is not specified, normalize all channels</span>
</span><span id="AnnotateApp-2631"><a href="#AnnotateApp-2631"><span class="linenos">2631</span></a>                <span class="k">if</span> <span class="n">normalize_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp-2632"><a href="#AnnotateApp-2632"><span class="linenos">2632</span></a>                    <span class="n">normalize_channels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2633"><a href="#AnnotateApp-2633"><span class="linenos">2633</span></a>                
</span><span id="AnnotateApp-2634"><a href="#AnnotateApp-2634"><span class="linenos">2634</span></a>                <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">normalize_channels</span><span class="p">:</span>
</span><span id="AnnotateApp-2635"><a href="#AnnotateApp-2635"><span class="linenos">2635</span></a>                    <span class="k">if</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channel_map</span><span class="p">:</span>
</span><span id="AnnotateApp-2636"><a href="#AnnotateApp-2636"><span class="linenos">2636</span></a>                        <span class="n">channel_idx</span> <span class="o">=</span> <span class="n">channel_map</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
</span><span id="AnnotateApp-2637"><a href="#AnnotateApp-2637"><span class="linenos">2637</span></a>                        <span class="n">p2</span><span class="p">,</span> <span class="n">p98</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">],</span> <span class="n">percentiles</span><span class="p">)</span>
</span><span id="AnnotateApp-2638"><a href="#AnnotateApp-2638"><span class="linenos">2638</span></a>                        <span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rescale_intensity</span><span class="p">(</span><span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">],</span> <span class="n">in_range</span><span class="o">=</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p98</span><span class="p">),</span> <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="AnnotateApp-2639"><a href="#AnnotateApp-2639"><span class="linenos">2639</span></a>
</span><span id="AnnotateApp-2640"><a href="#AnnotateApp-2640"><span class="linenos">2640</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2641"><a href="#AnnotateApp-2641"><span class="linenos">2641</span></a>
</span><span id="AnnotateApp-2642"><a href="#AnnotateApp-2642"><span class="linenos">2642</span></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img_array</span><span class="p">)</span>
</span><span id="AnnotateApp-2643"><a href="#AnnotateApp-2643"><span class="linenos">2643</span></a>
</span><span id="AnnotateApp-2644"><a href="#AnnotateApp-2644"><span class="linenos">2644</span></a>    
</span><span id="AnnotateApp-2645"><a href="#AnnotateApp-2645"><span class="linenos">2645</span></a>    <span class="k">def</span> <span class="nf">add_colored_border</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">border_color</span><span class="p">):</span>
</span><span id="AnnotateApp-2646"><a href="#AnnotateApp-2646"><span class="linenos">2646</span></a>        <span class="n">top_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp-2647"><a href="#AnnotateApp-2647"><span class="linenos">2647</span></a>        <span class="n">bottom_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp-2648"><a href="#AnnotateApp-2648"><span class="linenos">2648</span></a>        <span class="n">left_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp-2649"><a href="#AnnotateApp-2649"><span class="linenos">2649</span></a>        <span class="n">right_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp-2650"><a href="#AnnotateApp-2650"><span class="linenos">2650</span></a>
</span><span id="AnnotateApp-2651"><a href="#AnnotateApp-2651"><span class="linenos">2651</span></a>        <span class="n">bordered_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="AnnotateApp-2652"><a href="#AnnotateApp-2652"><span class="linenos">2652</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">top_border</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="AnnotateApp-2653"><a href="#AnnotateApp-2653"><span class="linenos">2653</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">bottom_border</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp-2654"><a href="#AnnotateApp-2654"><span class="linenos">2654</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">left_border</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp-2655"><a href="#AnnotateApp-2655"><span class="linenos">2655</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">right_border</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp-2656"><a href="#AnnotateApp-2656"><span class="linenos">2656</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp-2657"><a href="#AnnotateApp-2657"><span class="linenos">2657</span></a>
</span><span id="AnnotateApp-2658"><a href="#AnnotateApp-2658"><span class="linenos">2658</span></a>        <span class="k">return</span> <span class="n">bordered_img</span>
</span><span id="AnnotateApp-2659"><a href="#AnnotateApp-2659"><span class="linenos">2659</span></a>    
</span><span id="AnnotateApp-2660"><a href="#AnnotateApp-2660"><span class="linenos">2660</span></a>    <span class="k">def</span> <span class="nf">filter_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
</span><span id="AnnotateApp-2661"><a href="#AnnotateApp-2661"><span class="linenos">2661</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="AnnotateApp-2662"><a href="#AnnotateApp-2662"><span class="linenos">2662</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp-2663"><a href="#AnnotateApp-2663"><span class="linenos">2663</span></a>            <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp-2664"><a href="#AnnotateApp-2664"><span class="linenos">2664</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="AnnotateApp-2665"><a href="#AnnotateApp-2665"><span class="linenos">2665</span></a>            <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp-2666"><a href="#AnnotateApp-2666"><span class="linenos">2666</span></a>                <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="AnnotateApp-2667"><a href="#AnnotateApp-2667"><span class="linenos">2667</span></a>            <span class="k">if</span> <span class="s1">&#39;b&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp-2668"><a href="#AnnotateApp-2668"><span class="linenos">2668</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="AnnotateApp-2669"><a href="#AnnotateApp-2669"><span class="linenos">2669</span></a>
</span><span id="AnnotateApp-2670"><a href="#AnnotateApp-2670"><span class="linenos">2670</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AnnotateApp-2671"><a href="#AnnotateApp-2671"><span class="linenos">2671</span></a>                <span class="n">channel_img</span> <span class="o">=</span> <span class="n">r</span> <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="p">(</span><span class="n">g</span> <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="n">b</span><span class="p">)</span>
</span><span id="AnnotateApp-2672"><a href="#AnnotateApp-2672"><span class="linenos">2672</span></a>                <span class="k">return</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">grayscale</span><span class="p">(</span><span class="n">channel_img</span><span class="p">)</span>
</span><span id="AnnotateApp-2673"><a href="#AnnotateApp-2673"><span class="linenos">2673</span></a>
</span><span id="AnnotateApp-2674"><a href="#AnnotateApp-2674"><span class="linenos">2674</span></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="AnnotateApp-2675"><a href="#AnnotateApp-2675"><span class="linenos">2675</span></a>
</span><span id="AnnotateApp-2676"><a href="#AnnotateApp-2676"><span class="linenos">2676</span></a>    <span class="k">def</span> <span class="nf">get_on_image_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
</span><span id="AnnotateApp-2677"><a href="#AnnotateApp-2677"><span class="linenos">2677</span></a>        <span class="k">def</span> <span class="nf">on_image_click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="AnnotateApp-2678"><a href="#AnnotateApp-2678"><span class="linenos">2678</span></a>            <span class="n">new_annotation</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AnnotateApp-2679"><a href="#AnnotateApp-2679"><span class="linenos">2679</span></a>            
</span><span id="AnnotateApp-2680"><a href="#AnnotateApp-2680"><span class="linenos">2680</span></a>            <span class="n">original_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="AnnotateApp-2681"><a href="#AnnotateApp-2681"><span class="linenos">2681</span></a>            
</span><span id="AnnotateApp-2682"><a href="#AnnotateApp-2682"><span class="linenos">2682</span></a>            <span class="k">if</span> <span class="n">original_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_annotation</span><span class="p">:</span>
</span><span id="AnnotateApp-2683"><a href="#AnnotateApp-2683"><span class="linenos">2683</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2684"><a href="#AnnotateApp-2684"><span class="linenos">2684</span></a>                <span class="n">new_annotation</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp-2685"><a href="#AnnotateApp-2685"><span class="linenos">2685</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2686"><a href="#AnnotateApp-2686"><span class="linenos">2686</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_annotation</span>
</span><span id="AnnotateApp-2687"><a href="#AnnotateApp-2687"><span class="linenos">2687</span></a>            
</span><span id="AnnotateApp-2688"><a href="#AnnotateApp-2688"><span class="linenos">2688</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> annotated: </span><span class="si">{</span><span class="n">new_annotation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2689"><a href="#AnnotateApp-2689"><span class="linenos">2689</span></a>            
</span><span id="AnnotateApp-2690"><a href="#AnnotateApp-2690"><span class="linenos">2690</span></a>            <span class="n">img_</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
</span><span id="AnnotateApp-2691"><a href="#AnnotateApp-2691"><span class="linenos">2691</span></a>            <span class="n">border_fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="n">new_annotation</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">new_annotation</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AnnotateApp-2692"><a href="#AnnotateApp-2692"><span class="linenos">2692</span></a>            <span class="n">img_</span> <span class="o">=</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">img_</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">border_fill</span><span class="p">)</span> <span class="k">if</span> <span class="n">border_fill</span> <span class="k">else</span> <span class="n">img_</span>
</span><span id="AnnotateApp-2693"><a href="#AnnotateApp-2693"><span class="linenos">2693</span></a>
</span><span id="AnnotateApp-2694"><a href="#AnnotateApp-2694"><span class="linenos">2694</span></a>            <span class="n">photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img_</span><span class="p">)</span>
</span><span id="AnnotateApp-2695"><a href="#AnnotateApp-2695"><span class="linenos">2695</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">photo</span>
</span><span id="AnnotateApp-2696"><a href="#AnnotateApp-2696"><span class="linenos">2696</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">photo</span><span class="p">)</span>
</span><span id="AnnotateApp-2697"><a href="#AnnotateApp-2697"><span class="linenos">2697</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="AnnotateApp-2698"><a href="#AnnotateApp-2698"><span class="linenos">2698</span></a>
</span><span id="AnnotateApp-2699"><a href="#AnnotateApp-2699"><span class="linenos">2699</span></a>        <span class="k">return</span> <span class="n">on_image_click</span>
</span><span id="AnnotateApp-2700"><a href="#AnnotateApp-2700"><span class="linenos">2700</span></a>
</span><span id="AnnotateApp-2701"><a href="#AnnotateApp-2701"><span class="linenos">2701</span></a>    <span class="nd">@staticmethod</span>
</span><span id="AnnotateApp-2702"><a href="#AnnotateApp-2702"><span class="linenos">2702</span></a>    <span class="k">def</span> <span class="nf">update_html</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span><span id="AnnotateApp-2703"><a href="#AnnotateApp-2703"><span class="linenos">2703</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2704"><a href="#AnnotateApp-2704"><span class="linenos">2704</span></a><span class="s2">        &lt;script&gt;</span>
</span><span id="AnnotateApp-2705"><a href="#AnnotateApp-2705"><span class="linenos">2705</span></a><span class="s2">        document.getElementById(&#39;unique_id&#39;).innerHTML = &#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;;</span>
</span><span id="AnnotateApp-2706"><a href="#AnnotateApp-2706"><span class="linenos">2706</span></a><span class="s2">        &lt;/script&gt;</span>
</span><span id="AnnotateApp-2707"><a href="#AnnotateApp-2707"><span class="linenos">2707</span></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">))</span>
</span><span id="AnnotateApp-2708"><a href="#AnnotateApp-2708"><span class="linenos">2708</span></a>
</span><span id="AnnotateApp-2709"><a href="#AnnotateApp-2709"><span class="linenos">2709</span></a>    <span class="k">def</span> <span class="nf">update_database_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2710"><a href="#AnnotateApp-2710"><span class="linenos">2710</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp-2711"><a href="#AnnotateApp-2711"><span class="linenos">2711</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp-2712"><a href="#AnnotateApp-2712"><span class="linenos">2712</span></a>
</span><span id="AnnotateApp-2713"><a href="#AnnotateApp-2713"><span class="linenos">2713</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;div id=&#39;unique_id&#39;&gt;Initial Text&lt;/div&gt;&quot;</span><span class="p">))</span>
</span><span id="AnnotateApp-2714"><a href="#AnnotateApp-2714"><span class="linenos">2714</span></a>
</span><span id="AnnotateApp-2715"><a href="#AnnotateApp-2715"><span class="linenos">2715</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="AnnotateApp-2716"><a href="#AnnotateApp-2716"><span class="linenos">2716</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">:</span>
</span><span id="AnnotateApp-2717"><a href="#AnnotateApp-2717"><span class="linenos">2717</span></a>                <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AnnotateApp-2718"><a href="#AnnotateApp-2718"><span class="linenos">2718</span></a>                <span class="k">break</span>
</span><span id="AnnotateApp-2719"><a href="#AnnotateApp-2719"><span class="linenos">2719</span></a>
</span><span id="AnnotateApp-2720"><a href="#AnnotateApp-2720"><span class="linenos">2720</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="AnnotateApp-2721"><a href="#AnnotateApp-2721"><span class="linenos">2721</span></a>                <span class="n">AnnotateApp</span><span class="o">.</span><span class="n">update_html</span><span class="p">(</span><span class="s2">&quot;Do not exit, Updating database...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2722"><a href="#AnnotateApp-2722"><span class="linenos">2722</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Do not exit, Updating database...&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2723"><a href="#AnnotateApp-2723"><span class="linenos">2723</span></a>
</span><span id="AnnotateApp-2724"><a href="#AnnotateApp-2724"><span class="linenos">2724</span></a>                <span class="n">pending_updates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="AnnotateApp-2725"><a href="#AnnotateApp-2725"><span class="linenos">2725</span></a>                <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">new_annotation</span> <span class="ow">in</span> <span class="n">pending_updates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp-2726"><a href="#AnnotateApp-2726"><span class="linenos">2726</span></a>                    <span class="k">if</span> <span class="n">new_annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp-2727"><a href="#AnnotateApp-2727"><span class="linenos">2727</span></a>                        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UPDATE png_list SET </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s1"> = NULL WHERE png_path = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">path</span><span class="p">,))</span>
</span><span id="AnnotateApp-2728"><a href="#AnnotateApp-2728"><span class="linenos">2728</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2729"><a href="#AnnotateApp-2729"><span class="linenos">2729</span></a>                        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UPDATE png_list SET </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s1"> = ? WHERE png_path = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">new_annotation</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="AnnotateApp-2730"><a href="#AnnotateApp-2730"><span class="linenos">2730</span></a>                <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="AnnotateApp-2731"><a href="#AnnotateApp-2731"><span class="linenos">2731</span></a>
</span><span id="AnnotateApp-2732"><a href="#AnnotateApp-2732"><span class="linenos">2732</span></a>                <span class="n">AnnotateApp</span><span class="o">.</span><span class="n">update_html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2733"><a href="#AnnotateApp-2733"><span class="linenos">2733</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2734"><a href="#AnnotateApp-2734"><span class="linenos">2734</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="AnnotateApp-2735"><a href="#AnnotateApp-2735"><span class="linenos">2735</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="AnnotateApp-2736"><a href="#AnnotateApp-2736"><span class="linenos">2736</span></a>
</span><span id="AnnotateApp-2737"><a href="#AnnotateApp-2737"><span class="linenos">2737</span></a>    <span class="k">def</span> <span class="nf">update_gui_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="AnnotateApp-2738"><a href="#AnnotateApp-2738"><span class="linenos">2738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="AnnotateApp-2739"><a href="#AnnotateApp-2739"><span class="linenos">2739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="AnnotateApp-2740"><a href="#AnnotateApp-2740"><span class="linenos">2740</span></a>
</span><span id="AnnotateApp-2741"><a href="#AnnotateApp-2741"><span class="linenos">2741</span></a>    <span class="k">def</span> <span class="nf">next_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2742"><a href="#AnnotateApp-2742"><span class="linenos">2742</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="AnnotateApp-2743"><a href="#AnnotateApp-2743"><span class="linenos">2743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="AnnotateApp-2744"><a href="#AnnotateApp-2744"><span class="linenos">2744</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp-2745"><a href="#AnnotateApp-2745"><span class="linenos">2745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span>
</span><span id="AnnotateApp-2746"><a href="#AnnotateApp-2746"><span class="linenos">2746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>  <span class="c1"># Re-fetch annotations from the database</span>
</span><span id="AnnotateApp-2747"><a href="#AnnotateApp-2747"><span class="linenos">2747</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span><span id="AnnotateApp-2748"><a href="#AnnotateApp-2748"><span class="linenos">2748</span></a>
</span><span id="AnnotateApp-2749"><a href="#AnnotateApp-2749"><span class="linenos">2749</span></a>    <span class="k">def</span> <span class="nf">previous_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2750"><a href="#AnnotateApp-2750"><span class="linenos">2750</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="AnnotateApp-2751"><a href="#AnnotateApp-2751"><span class="linenos">2751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="AnnotateApp-2752"><a href="#AnnotateApp-2752"><span class="linenos">2752</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp-2753"><a href="#AnnotateApp-2753"><span class="linenos">2753</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span>
</span><span id="AnnotateApp-2754"><a href="#AnnotateApp-2754"><span class="linenos">2754</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AnnotateApp-2755"><a href="#AnnotateApp-2755"><span class="linenos">2755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AnnotateApp-2756"><a href="#AnnotateApp-2756"><span class="linenos">2756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>  <span class="c1"># Re-fetch annotations from the database</span>
</span><span id="AnnotateApp-2757"><a href="#AnnotateApp-2757"><span class="linenos">2757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span><span id="AnnotateApp-2758"><a href="#AnnotateApp-2758"><span class="linenos">2758</span></a>
</span><span id="AnnotateApp-2759"><a href="#AnnotateApp-2759"><span class="linenos">2759</span></a>    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2760"><a href="#AnnotateApp-2760"><span class="linenos">2760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="AnnotateApp-2761"><a href="#AnnotateApp-2761"><span class="linenos">2761</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="AnnotateApp-2762"><a href="#AnnotateApp-2762"><span class="linenos">2762</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="AnnotateApp-2763"><a href="#AnnotateApp-2763"><span class="linenos">2763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp-2764"><a href="#AnnotateApp-2764"><span class="linenos">2764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="AnnotateApp-2765"><a href="#AnnotateApp-2765"><span class="linenos">2765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span><span id="AnnotateApp-2766"><a href="#AnnotateApp-2766"><span class="linenos">2766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="AnnotateApp-2767"><a href="#AnnotateApp-2767"><span class="linenos">2767</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Quit application&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2768"><a href="#AnnotateApp-2768"><span class="linenos">2768</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2769"><a href="#AnnotateApp-2769"><span class="linenos">2769</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting for pending updates to finish before quitting&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2770"><a href="#AnnotateApp-2770"><span class="linenos">2770</span></a>            
</span><span id="AnnotateApp-2771"><a href="#AnnotateApp-2771"><span class="linenos">2771</span></a>    <span class="k">def</span> <span class="nf">train_and_classify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp-2772"><a href="#AnnotateApp-2772"><span class="linenos">2772</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2773"><a href="#AnnotateApp-2773"><span class="linenos">2773</span></a><span class="sd">        1) Merge data from the relevant DB tables (including png_list).</span>
</span><span id="AnnotateApp-2774"><a href="#AnnotateApp-2774"><span class="linenos">2774</span></a><span class="sd">        2) Collect manual annotations from png_list.&lt;annotation_column&gt; =&gt; &#39;manual_annotation&#39;.</span>
</span><span id="AnnotateApp-2775"><a href="#AnnotateApp-2775"><span class="linenos">2775</span></a><span class="sd">           - 1 =&gt; class=1, 2 =&gt; class=0 (for training).</span>
</span><span id="AnnotateApp-2776"><a href="#AnnotateApp-2776"><span class="linenos">2776</span></a><span class="sd">        3) If only one class is present, randomly sample unannotated images as the other class.</span>
</span><span id="AnnotateApp-2777"><a href="#AnnotateApp-2777"><span class="linenos">2777</span></a><span class="sd">        4) Train an XGBoost model.</span>
</span><span id="AnnotateApp-2778"><a href="#AnnotateApp-2778"><span class="linenos">2778</span></a><span class="sd">        5) Classify *all* rows -&gt; fill XGboost_score (prob of class=1) &amp; XGboost_annotation (1 or 2 if high confidence).</span>
</span><span id="AnnotateApp-2779"><a href="#AnnotateApp-2779"><span class="linenos">2779</span></a><span class="sd">        6) Write those columns back to sqlite, so every row in png_list has a score (and possibly an annotation).</span>
</span><span id="AnnotateApp-2780"><a href="#AnnotateApp-2780"><span class="linenos">2780</span></a><span class="sd">        7) Refresh the UI (prefilter_paths_annotations + load_images).</span>
</span><span id="AnnotateApp-2781"><a href="#AnnotateApp-2781"><span class="linenos">2781</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2782"><a href="#AnnotateApp-2782"><span class="linenos">2782</span></a>
</span><span id="AnnotateApp-2783"><a href="#AnnotateApp-2783"><span class="linenos">2783</span></a>        <span class="c1"># Optionally, update your GUI status label</span>
</span><span id="AnnotateApp-2784"><a href="#AnnotateApp-2784"><span class="linenos">2784</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Merging data...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2785"><a href="#AnnotateApp-2785"><span class="linenos">2785</span></a>
</span><span id="AnnotateApp-2786"><a href="#AnnotateApp-2786"><span class="linenos">2786</span></a>        <span class="kn">from</span> <span class="nn">spacr.io</span> <span class="kn">import</span> <span class="n">_read_and_merge_data</span>  <span class="c1"># Adapt to your actual import</span>
</span><span id="AnnotateApp-2787"><a href="#AnnotateApp-2787"><span class="linenos">2787</span></a>
</span><span id="AnnotateApp-2788"><a href="#AnnotateApp-2788"><span class="linenos">2788</span></a>        <span class="c1"># (1) Merge data</span>
</span><span id="AnnotateApp-2789"><a href="#AnnotateApp-2789"><span class="linenos">2789</span></a>        <span class="n">merged_df</span><span class="p">,</span> <span class="n">obj_df_ls</span> <span class="o">=</span> <span class="n">_read_and_merge_data</span><span class="p">(</span>
</span><span id="AnnotateApp-2790"><a href="#AnnotateApp-2790"><span class="linenos">2790</span></a>            <span class="n">locs</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">],</span>
</span><span id="AnnotateApp-2791"><a href="#AnnotateApp-2791"><span class="linenos">2791</span></a>            <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;cytoplasm&#39;</span><span class="p">,</span> <span class="s1">&#39;nucleus&#39;</span><span class="p">,</span> <span class="s1">&#39;pathogen&#39;</span><span class="p">,</span> <span class="s1">&#39;png_list&#39;</span><span class="p">],</span>
</span><span id="AnnotateApp-2792"><a href="#AnnotateApp-2792"><span class="linenos">2792</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
</span><span id="AnnotateApp-2793"><a href="#AnnotateApp-2793"><span class="linenos">2793</span></a>        <span class="p">)</span>
</span><span id="AnnotateApp-2794"><a href="#AnnotateApp-2794"><span class="linenos">2794</span></a>
</span><span id="AnnotateApp-2795"><a href="#AnnotateApp-2795"><span class="linenos">2795</span></a>        <span class="c1"># (2) Load manual annotations from the DB</span>
</span><span id="AnnotateApp-2796"><a href="#AnnotateApp-2796"><span class="linenos">2796</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp-2797"><a href="#AnnotateApp-2797"><span class="linenos">2797</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp-2798"><a href="#AnnotateApp-2798"><span class="linenos">2798</span></a>        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list WHERE </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> IS NOT NULL&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2799"><a href="#AnnotateApp-2799"><span class="linenos">2799</span></a>        <span class="n">annotated_rows</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  <span class="c1"># e.g. [(png_path, 1 or 2), ...]</span>
</span><span id="AnnotateApp-2800"><a href="#AnnotateApp-2800"><span class="linenos">2800</span></a>        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AnnotateApp-2801"><a href="#AnnotateApp-2801"><span class="linenos">2801</span></a>
</span><span id="AnnotateApp-2802"><a href="#AnnotateApp-2802"><span class="linenos">2802</span></a>        <span class="c1"># dict {png_path -&gt; 1 or 2}</span>
</span><span id="AnnotateApp-2803"><a href="#AnnotateApp-2803"><span class="linenos">2803</span></a>        <span class="n">annot_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">annotated_rows</span><span class="p">)</span>
</span><span id="AnnotateApp-2804"><a href="#AnnotateApp-2804"><span class="linenos">2804</span></a>
</span><span id="AnnotateApp-2805"><a href="#AnnotateApp-2805"><span class="linenos">2805</span></a>        <span class="c1"># Add &#39;manual_annotation&#39; to merged_df</span>
</span><span id="AnnotateApp-2806"><a href="#AnnotateApp-2806"><span class="linenos">2806</span></a>        <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">annot_dict</span><span class="p">)</span>
</span><span id="AnnotateApp-2807"><a href="#AnnotateApp-2807"><span class="linenos">2807</span></a>
</span><span id="AnnotateApp-2808"><a href="#AnnotateApp-2808"><span class="linenos">2808</span></a>        <span class="c1"># Subset with manual labels</span>
</span><span id="AnnotateApp-2809"><a href="#AnnotateApp-2809"><span class="linenos">2809</span></a>        <span class="n">annotated_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp-2810"><a href="#AnnotateApp-2810"><span class="linenos">2810</span></a>        <span class="c1"># Convert &quot;2&quot; =&gt; &quot;0&quot; for binary classification</span>
</span><span id="AnnotateApp-2811"><a href="#AnnotateApp-2811"><span class="linenos">2811</span></a>        <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="AnnotateApp-2812"><a href="#AnnotateApp-2812"><span class="linenos">2812</span></a>
</span><span id="AnnotateApp-2813"><a href="#AnnotateApp-2813"><span class="linenos">2813</span></a>        <span class="c1"># (3) Handle single-class scenario</span>
</span><span id="AnnotateApp-2814"><a href="#AnnotateApp-2814"><span class="linenos">2814</span></a>        <span class="n">class_counts</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span><span id="AnnotateApp-2815"><a href="#AnnotateApp-2815"><span class="linenos">2815</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AnnotateApp-2816"><a href="#AnnotateApp-2816"><span class="linenos">2816</span></a>            <span class="n">single_class</span> <span class="o">=</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 0 or 1</span>
</span><span id="AnnotateApp-2817"><a href="#AnnotateApp-2817"><span class="linenos">2817</span></a>            <span class="n">needed</span> <span class="o">=</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp-2818"><a href="#AnnotateApp-2818"><span class="linenos">2818</span></a>            <span class="n">other_class</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">single_class</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="AnnotateApp-2819"><a href="#AnnotateApp-2819"><span class="linenos">2819</span></a>
</span><span id="AnnotateApp-2820"><a href="#AnnotateApp-2820"><span class="linenos">2820</span></a>            <span class="n">unannotated_df_all</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp-2821"><a href="#AnnotateApp-2821"><span class="linenos">2821</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unannotated_df_all</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AnnotateApp-2822"><a href="#AnnotateApp-2822"><span class="linenos">2822</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No unannotated rows to sample for the other class. Cannot proceed.&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2823"><a href="#AnnotateApp-2823"><span class="linenos">2823</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Not enough data to train (no second class).&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2824"><a href="#AnnotateApp-2824"><span class="linenos">2824</span></a>                <span class="k">return</span>
</span><span id="AnnotateApp-2825"><a href="#AnnotateApp-2825"><span class="linenos">2825</span></a>
</span><span id="AnnotateApp-2826"><a href="#AnnotateApp-2826"><span class="linenos">2826</span></a>            <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">needed</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unannotated_df_all</span><span class="p">))</span>
</span><span id="AnnotateApp-2827"><a href="#AnnotateApp-2827"><span class="linenos">2827</span></a>            <span class="n">artificially_labeled</span> <span class="o">=</span> <span class="n">unannotated_df_all</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp-2828"><a href="#AnnotateApp-2828"><span class="linenos">2828</span></a>            <span class="n">artificially_labeled</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_class</span>
</span><span id="AnnotateApp-2829"><a href="#AnnotateApp-2829"><span class="linenos">2829</span></a>
</span><span id="AnnotateApp-2830"><a href="#AnnotateApp-2830"><span class="linenos">2830</span></a>            <span class="n">annotated_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">annotated_df</span><span class="p">,</span> <span class="n">artificially_labeled</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AnnotateApp-2831"><a href="#AnnotateApp-2831"><span class="linenos">2831</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only one class was present =&gt; randomly labeled </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2"> unannotated rows as </span><span class="si">{</span><span class="n">other_class</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2832"><a href="#AnnotateApp-2832"><span class="linenos">2832</span></a>
</span><span id="AnnotateApp-2833"><a href="#AnnotateApp-2833"><span class="linenos">2833</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotated_df</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="AnnotateApp-2834"><a href="#AnnotateApp-2834"><span class="linenos">2834</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not enough annotated data to train (need at least 2).&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2835"><a href="#AnnotateApp-2835"><span class="linenos">2835</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Not enough data to train.&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2836"><a href="#AnnotateApp-2836"><span class="linenos">2836</span></a>            <span class="k">return</span>
</span><span id="AnnotateApp-2837"><a href="#AnnotateApp-2837"><span class="linenos">2837</span></a>
</span><span id="AnnotateApp-2838"><a href="#AnnotateApp-2838"><span class="linenos">2838</span></a>        <span class="c1"># (4) Train XGBoost</span>
</span><span id="AnnotateApp-2839"><a href="#AnnotateApp-2839"><span class="linenos">2839</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Training XGBoost model...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2840"><a href="#AnnotateApp-2840"><span class="linenos">2840</span></a>
</span><span id="AnnotateApp-2841"><a href="#AnnotateApp-2841"><span class="linenos">2841</span></a>        <span class="c1"># Identify numeric columns</span>
</span><span id="AnnotateApp-2842"><a href="#AnnotateApp-2842"><span class="linenos">2842</span></a>        <span class="n">ignore_cols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;png_path&#39;</span><span class="p">,</span> <span class="s1">&#39;manual_annotation&#39;</span><span class="p">}</span>
</span><span id="AnnotateApp-2843"><a href="#AnnotateApp-2843"><span class="linenos">2843</span></a>        <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AnnotateApp-2844"><a href="#AnnotateApp-2844"><span class="linenos">2844</span></a>            <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">annotated_df</span><span class="o">.</span><span class="n">columns</span>
</span><span id="AnnotateApp-2845"><a href="#AnnotateApp-2845"><span class="linenos">2845</span></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore_cols</span>
</span><span id="AnnotateApp-2846"><a href="#AnnotateApp-2846"><span class="linenos">2846</span></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">annotated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span> <span class="ow">or</span> <span class="n">annotated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="AnnotateApp-2847"><a href="#AnnotateApp-2847"><span class="linenos">2847</span></a>        <span class="p">]</span>
</span><span id="AnnotateApp-2848"><a href="#AnnotateApp-2848"><span class="linenos">2848</span></a>
</span><span id="AnnotateApp-2849"><a href="#AnnotateApp-2849"><span class="linenos">2849</span></a>        <span class="n">X_data</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="AnnotateApp-2850"><a href="#AnnotateApp-2850"><span class="linenos">2850</span></a>        <span class="n">y_data</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="AnnotateApp-2851"><a href="#AnnotateApp-2851"><span class="linenos">2851</span></a>
</span><span id="AnnotateApp-2852"><a href="#AnnotateApp-2852"><span class="linenos">2852</span></a>        <span class="c1"># standard train/test</span>
</span><span id="AnnotateApp-2853"><a href="#AnnotateApp-2853"><span class="linenos">2853</span></a>        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="AnnotateApp-2854"><a href="#AnnotateApp-2854"><span class="linenos">2854</span></a>            <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
</span><span id="AnnotateApp-2855"><a href="#AnnotateApp-2855"><span class="linenos">2855</span></a>        <span class="p">)</span>
</span><span id="AnnotateApp-2856"><a href="#AnnotateApp-2856"><span class="linenos">2856</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp-2857"><a href="#AnnotateApp-2857"><span class="linenos">2857</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="AnnotateApp-2858"><a href="#AnnotateApp-2858"><span class="linenos">2858</span></a>
</span><span id="AnnotateApp-2859"><a href="#AnnotateApp-2859"><span class="linenos">2859</span></a>        <span class="c1"># Evaluate</span>
</span><span id="AnnotateApp-2860"><a href="#AnnotateApp-2860"><span class="linenos">2860</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="AnnotateApp-2861"><a href="#AnnotateApp-2861"><span class="linenos">2861</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Classification Report ===&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2862"><a href="#AnnotateApp-2862"><span class="linenos">2862</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
</span><span id="AnnotateApp-2863"><a href="#AnnotateApp-2863"><span class="linenos">2863</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Confusion Matrix ===&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2864"><a href="#AnnotateApp-2864"><span class="linenos">2864</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
</span><span id="AnnotateApp-2865"><a href="#AnnotateApp-2865"><span class="linenos">2865</span></a>
</span><span id="AnnotateApp-2866"><a href="#AnnotateApp-2866"><span class="linenos">2866</span></a>        <span class="c1"># (5) Classify ALL rows</span>
</span><span id="AnnotateApp-2867"><a href="#AnnotateApp-2867"><span class="linenos">2867</span></a>        <span class="n">all_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp-2868"><a href="#AnnotateApp-2868"><span class="linenos">2868</span></a>        <span class="n">X_all</span> <span class="o">=</span> <span class="n">all_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="AnnotateApp-2869"><a href="#AnnotateApp-2869"><span class="linenos">2869</span></a>        <span class="n">probs_all</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_all</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="AnnotateApp-2870"><a href="#AnnotateApp-2870"><span class="linenos">2870</span></a>        <span class="c1"># Probability =&gt; XGboost_score</span>
</span><span id="AnnotateApp-2871"><a href="#AnnotateApp-2871"><span class="linenos">2871</span></a>        <span class="n">all_df</span><span class="p">[</span><span class="s1">&#39;XGboost_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs_all</span>
</span><span id="AnnotateApp-2872"><a href="#AnnotateApp-2872"><span class="linenos">2872</span></a>
</span><span id="AnnotateApp-2873"><a href="#AnnotateApp-2873"><span class="linenos">2873</span></a>        <span class="c1"># Decide XGboost_annotation</span>
</span><span id="AnnotateApp-2874"><a href="#AnnotateApp-2874"><span class="linenos">2874</span></a>        <span class="k">def</span> <span class="nf">get_annotation_from_prob</span><span class="p">(</span><span class="n">prob</span><span class="p">):</span>
</span><span id="AnnotateApp-2875"><a href="#AnnotateApp-2875"><span class="linenos">2875</span></a>            <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
</span><span id="AnnotateApp-2876"><a href="#AnnotateApp-2876"><span class="linenos">2876</span></a>                <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># class=1</span>
</span><span id="AnnotateApp-2877"><a href="#AnnotateApp-2877"><span class="linenos">2877</span></a>            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
</span><span id="AnnotateApp-2878"><a href="#AnnotateApp-2878"><span class="linenos">2878</span></a>                <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># class=0</span>
</span><span id="AnnotateApp-2879"><a href="#AnnotateApp-2879"><span class="linenos">2879</span></a>            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># uncertain</span>
</span><span id="AnnotateApp-2880"><a href="#AnnotateApp-2880"><span class="linenos">2880</span></a>
</span><span id="AnnotateApp-2881"><a href="#AnnotateApp-2881"><span class="linenos">2881</span></a>        <span class="n">xgb_anno_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_annotation_from_prob</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probs_all</span><span class="p">]</span>
</span><span id="AnnotateApp-2882"><a href="#AnnotateApp-2882"><span class="linenos">2882</span></a>        <span class="c1"># Convert 0 =&gt; 2 if your DB uses &quot;2&quot; for the negative class</span>
</span><span id="AnnotateApp-2883"><a href="#AnnotateApp-2883"><span class="linenos">2883</span></a>        <span class="n">xgb_anno_col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xgb_anno_col</span><span class="p">]</span>
</span><span id="AnnotateApp-2884"><a href="#AnnotateApp-2884"><span class="linenos">2884</span></a>
</span><span id="AnnotateApp-2885"><a href="#AnnotateApp-2885"><span class="linenos">2885</span></a>        <span class="n">all_df</span><span class="p">[</span><span class="s1">&#39;XGboost_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xgb_anno_col</span>
</span><span id="AnnotateApp-2886"><a href="#AnnotateApp-2886"><span class="linenos">2886</span></a>
</span><span id="AnnotateApp-2887"><a href="#AnnotateApp-2887"><span class="linenos">2887</span></a>        <span class="c1"># (6) Write results back to png_list</span>
</span><span id="AnnotateApp-2888"><a href="#AnnotateApp-2888"><span class="linenos">2888</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Updating the database with XGBoost predictions...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2889"><a href="#AnnotateApp-2889"><span class="linenos">2889</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp-2890"><a href="#AnnotateApp-2890"><span class="linenos">2890</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp-2891"><a href="#AnnotateApp-2891"><span class="linenos">2891</span></a>        <span class="c1"># Ensure columns exist</span>
</span><span id="AnnotateApp-2892"><a href="#AnnotateApp-2892"><span class="linenos">2892</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AnnotateApp-2893"><a href="#AnnotateApp-2893"><span class="linenos">2893</span></a>            <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE png_list ADD COLUMN XGboost_annotation INTEGER&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2894"><a href="#AnnotateApp-2894"><span class="linenos">2894</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
</span><span id="AnnotateApp-2895"><a href="#AnnotateApp-2895"><span class="linenos">2895</span></a>            <span class="k">pass</span>
</span><span id="AnnotateApp-2896"><a href="#AnnotateApp-2896"><span class="linenos">2896</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AnnotateApp-2897"><a href="#AnnotateApp-2897"><span class="linenos">2897</span></a>            <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE png_list ADD COLUMN XGboost_score FLOAT&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp-2898"><a href="#AnnotateApp-2898"><span class="linenos">2898</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
</span><span id="AnnotateApp-2899"><a href="#AnnotateApp-2899"><span class="linenos">2899</span></a>            <span class="k">pass</span>
</span><span id="AnnotateApp-2900"><a href="#AnnotateApp-2900"><span class="linenos">2900</span></a>
</span><span id="AnnotateApp-2901"><a href="#AnnotateApp-2901"><span class="linenos">2901</span></a>        <span class="c1"># Update each row</span>
</span><span id="AnnotateApp-2902"><a href="#AnnotateApp-2902"><span class="linenos">2902</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">all_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="AnnotateApp-2903"><a href="#AnnotateApp-2903"><span class="linenos">2903</span></a>            <span class="n">score_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;XGboost_score&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp-2904"><a href="#AnnotateApp-2904"><span class="linenos">2904</span></a>            <span class="n">anno_val</span>  <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;XGboost_annotation&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2905"><a href="#AnnotateApp-2905"><span class="linenos">2905</span></a>            <span class="n">the_path</span>  <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp-2906"><a href="#AnnotateApp-2906"><span class="linenos">2906</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">the_path</span><span class="p">):</span>
</span><span id="AnnotateApp-2907"><a href="#AnnotateApp-2907"><span class="linenos">2907</span></a>                <span class="k">continue</span>  <span class="c1"># skip if no path</span>
</span><span id="AnnotateApp-2908"><a href="#AnnotateApp-2908"><span class="linenos">2908</span></a>
</span><span id="AnnotateApp-2909"><a href="#AnnotateApp-2909"><span class="linenos">2909</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">anno_val</span><span class="p">):</span>
</span><span id="AnnotateApp-2910"><a href="#AnnotateApp-2910"><span class="linenos">2910</span></a>                <span class="c1"># We set annotation=NULL but do set the score</span>
</span><span id="AnnotateApp-2911"><a href="#AnnotateApp-2911"><span class="linenos">2911</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2912"><a href="#AnnotateApp-2912"><span class="linenos">2912</span></a><span class="s2">                    UPDATE png_list</span>
</span><span id="AnnotateApp-2913"><a href="#AnnotateApp-2913"><span class="linenos">2913</span></a><span class="s2">                       SET XGboost_annotation = NULL,</span>
</span><span id="AnnotateApp-2914"><a href="#AnnotateApp-2914"><span class="linenos">2914</span></a><span class="s2">                           XGboost_score       = ?</span>
</span><span id="AnnotateApp-2915"><a href="#AnnotateApp-2915"><span class="linenos">2915</span></a><span class="s2">                     WHERE png_path = ?</span>
</span><span id="AnnotateApp-2916"><a href="#AnnotateApp-2916"><span class="linenos">2916</span></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">score_val</span><span class="p">,</span> <span class="n">the_path</span><span class="p">))</span>
</span><span id="AnnotateApp-2917"><a href="#AnnotateApp-2917"><span class="linenos">2917</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp-2918"><a href="#AnnotateApp-2918"><span class="linenos">2918</span></a>                <span class="c1"># numeric annotation + numeric score</span>
</span><span id="AnnotateApp-2919"><a href="#AnnotateApp-2919"><span class="linenos">2919</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp-2920"><a href="#AnnotateApp-2920"><span class="linenos">2920</span></a><span class="s2">                    UPDATE png_list</span>
</span><span id="AnnotateApp-2921"><a href="#AnnotateApp-2921"><span class="linenos">2921</span></a><span class="s2">                       SET XGboost_annotation = ?,</span>
</span><span id="AnnotateApp-2922"><a href="#AnnotateApp-2922"><span class="linenos">2922</span></a><span class="s2">                           XGboost_score       = ?</span>
</span><span id="AnnotateApp-2923"><a href="#AnnotateApp-2923"><span class="linenos">2923</span></a><span class="s2">                     WHERE png_path = ?</span>
</span><span id="AnnotateApp-2924"><a href="#AnnotateApp-2924"><span class="linenos">2924</span></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">anno_val</span><span class="p">),</span> <span class="n">score_val</span><span class="p">,</span> <span class="n">the_path</span><span class="p">))</span>
</span><span id="AnnotateApp-2925"><a href="#AnnotateApp-2925"><span class="linenos">2925</span></a>                
</span><span id="AnnotateApp-2926"><a href="#AnnotateApp-2926"><span class="linenos">2926</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="s1">&#39;XGboost_annotation&#39;</span>
</span></pre></div>


    

                            <div id="AnnotateApp.__init__" class="classattr">
                                        <input id="AnnotateApp.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AnnotateApp</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">root</span>,</span><span class="param">	<span class="n">db_path</span>,</span><span class="param">	<span class="n">src</span>,</span><span class="param">	<span class="n">image_type</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">channels</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">image_size</span><span class="o">=</span><span class="mi">200</span>,</span><span class="param">	<span class="n">annotation_column</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span>,</span><span class="param">	<span class="n">normalize</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>,</span><span class="param">	<span class="n">measurement</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="AnnotateApp.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.__init__-2213"><a href="#AnnotateApp.__init__-2213"><span class="linenos">2213</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">db_path</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">image_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">annotation_column</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="AnnotateApp.__init__-2214"><a href="#AnnotateApp.__init__-2214"><span class="linenos">2214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
</span><span id="AnnotateApp.__init__-2215"><a href="#AnnotateApp.__init__-2215"><span class="linenos">2215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>
</span><span id="AnnotateApp.__init__-2216"><a href="#AnnotateApp.__init__-2216"><span class="linenos">2216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span>
</span><span id="AnnotateApp.__init__-2217"><a href="#AnnotateApp.__init__-2217"><span class="linenos">2217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AnnotateApp.__init__-2218"><a href="#AnnotateApp.__init__-2218"><span class="linenos">2218</span></a>
</span><span id="AnnotateApp.__init__-2219"><a href="#AnnotateApp.__init__-2219"><span class="linenos">2219</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.__init__-2220"><a href="#AnnotateApp.__init__-2220"><span class="linenos">2220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="AnnotateApp.__init__-2221"><a href="#AnnotateApp.__init__-2221"><span class="linenos">2221</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AnnotateApp.__init__-2222"><a href="#AnnotateApp.__init__-2222"><span class="linenos">2222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2223"><a href="#AnnotateApp.__init__-2223"><span class="linenos">2223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.__init__-2224"><a href="#AnnotateApp.__init__-2224"><span class="linenos">2224</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid image size&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2225"><a href="#AnnotateApp.__init__-2225"><span class="linenos">2225</span></a>        
</span><span id="AnnotateApp.__init__-2226"><a href="#AnnotateApp.__init__-2226"><span class="linenos">2226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_annotation_columns</span> <span class="o">=</span> <span class="n">annotation_column</span>
</span><span id="AnnotateApp.__init__-2227"><a href="#AnnotateApp.__init__-2227"><span class="linenos">2227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="n">annotation_column</span>
</span><span id="AnnotateApp.__init__-2228"><a href="#AnnotateApp.__init__-2228"><span class="linenos">2228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span> <span class="o">=</span> <span class="n">image_type</span>
</span><span id="AnnotateApp.__init__-2229"><a href="#AnnotateApp.__init__-2229"><span class="linenos">2229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">channels</span>
</span><span id="AnnotateApp.__init__-2230"><a href="#AnnotateApp.__init__-2230"><span class="linenos">2230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="AnnotateApp.__init__-2231"><a href="#AnnotateApp.__init__-2231"><span class="linenos">2231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span> <span class="o">=</span> <span class="n">percentiles</span>
</span><span id="AnnotateApp.__init__-2232"><a href="#AnnotateApp.__init__-2232"><span class="linenos">2232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp.__init__-2233"><a href="#AnnotateApp.__init__-2233"><span class="linenos">2233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp.__init__-2234"><a href="#AnnotateApp.__init__-2234"><span class="linenos">2234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AnnotateApp.__init__-2235"><a href="#AnnotateApp.__init__-2235"><span class="linenos">2235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp.__init__-2236"><a href="#AnnotateApp.__init__-2236"><span class="linenos">2236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AnnotateApp.__init__-2237"><a href="#AnnotateApp.__init__-2237"><span class="linenos">2237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
</span><span id="AnnotateApp.__init__-2238"><a href="#AnnotateApp.__init__-2238"><span class="linenos">2238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="n">measurement</span>
</span><span id="AnnotateApp.__init__-2239"><a href="#AnnotateApp.__init__-2239"><span class="linenos">2239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="AnnotateApp.__init__-2240"><a href="#AnnotateApp.__init__-2240"><span class="linenos">2240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span> <span class="o">=</span> <span class="n">normalize_channels</span>
</span><span id="AnnotateApp.__init__-2241"><a href="#AnnotateApp.__init__-2241"><span class="linenos">2241</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.normalize_channels&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2242"><a href="#AnnotateApp.__init__-2242"><span class="linenos">2242</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="AnnotateApp.__init__-2243"><a href="#AnnotateApp.__init__-2243"><span class="linenos">2243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.__init__-2244"><a href="#AnnotateApp.__init__-2244"><span class="linenos">2244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.__init__-2245"><a href="#AnnotateApp.__init__-2245"><span class="linenos">2245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.__init__-2246"><a href="#AnnotateApp.__init__-2246"><span class="linenos">2246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.__init__-2247"><a href="#AnnotateApp.__init__-2247"><span class="linenos">2247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;active_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.__init__-2248"><a href="#AnnotateApp.__init__-2248"><span class="linenos">2248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inactive_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.__init__-2249"><a href="#AnnotateApp.__init__-2249"><span class="linenos">2249</span></a>
</span><span id="AnnotateApp.__init__-2250"><a href="#AnnotateApp.__init__-2250"><span class="linenos">2250</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="p">:</span>
</span><span id="AnnotateApp.__init__-2251"><a href="#AnnotateApp.__init__-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_loader</span><span class="o">.</span><span class="n">get_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2252"><a href="#AnnotateApp.__init__-2252"><span class="linenos">2252</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.__init__-2253"><a href="#AnnotateApp.__init__-2253"><span class="linenos">2253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2254"><a href="#AnnotateApp.__init__-2254"><span class="linenos">2254</span></a>        
</span><span id="AnnotateApp.__init__-2255"><a href="#AnnotateApp.__init__-2255"><span class="linenos">2255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;inactive_color&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp.__init__-2256"><a href="#AnnotateApp.__init__-2256"><span class="linenos">2256</span></a>
</span><span id="AnnotateApp.__init__-2257"><a href="#AnnotateApp.__init__-2257"><span class="linenos">2257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AnnotateApp.__init__-2258"><a href="#AnnotateApp.__init__-2258"><span class="linenos">2258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="AnnotateApp.__init__-2259"><a href="#AnnotateApp.__init__-2259"><span class="linenos">2259</span></a>
</span><span id="AnnotateApp.__init__-2260"><a href="#AnnotateApp.__init__-2260"><span class="linenos">2260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">update_database_worker</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2261"><a href="#AnnotateApp.__init__-2261"><span class="linenos">2261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="AnnotateApp.__init__-2262"><a href="#AnnotateApp.__init__-2262"><span class="linenos">2262</span></a>
</span><span id="AnnotateApp.__init__-2263"><a href="#AnnotateApp.__init__-2263"><span class="linenos">2263</span></a>        <span class="c1"># Set the initial window size and make it fit the screen size</span>
</span><span id="AnnotateApp.__init__-2264"><a href="#AnnotateApp.__init__-2264"><span class="linenos">2264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2265"><a href="#AnnotateApp.__init__-2265"><span class="linenos">2265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
</span><span id="AnnotateApp.__init__-2266"><a href="#AnnotateApp.__init__-2266"><span class="linenos">2266</span></a>
</span><span id="AnnotateApp.__init__-2267"><a href="#AnnotateApp.__init__-2267"><span class="linenos">2267</span></a>        <span class="c1"># Create the status label</span>
</span><span id="AnnotateApp.__init__-2268"><a href="#AnnotateApp.__init__-2268"><span class="linenos">2268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp.__init__-2269"><a href="#AnnotateApp.__init__-2269"><span class="linenos">2269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2270"><a href="#AnnotateApp.__init__-2270"><span class="linenos">2270</span></a>
</span><span id="AnnotateApp.__init__-2271"><a href="#AnnotateApp.__init__-2271"><span class="linenos">2271</span></a>        <span class="c1"># Place the buttons at the bottom right</span>
</span><span id="AnnotateApp.__init__-2272"><a href="#AnnotateApp.__init__-2272"><span class="linenos">2272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp.__init__-2273"><a href="#AnnotateApp.__init__-2273"><span class="linenos">2273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;se&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2274"><a href="#AnnotateApp.__init__-2274"><span class="linenos">2274</span></a>
</span><span id="AnnotateApp.__init__-2275"><a href="#AnnotateApp.__init__-2275"><span class="linenos">2275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_page</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2276"><a href="#AnnotateApp.__init__-2276"><span class="linenos">2276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2277"><a href="#AnnotateApp.__init__-2277"><span class="linenos">2277</span></a>
</span><span id="AnnotateApp.__init__-2278"><a href="#AnnotateApp.__init__-2278"><span class="linenos">2278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_page</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2279"><a href="#AnnotateApp.__init__-2279"><span class="linenos">2279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2280"><a href="#AnnotateApp.__init__-2280"><span class="linenos">2280</span></a>
</span><span id="AnnotateApp.__init__-2281"><a href="#AnnotateApp.__init__-2281"><span class="linenos">2281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2282"><a href="#AnnotateApp.__init__-2282"><span class="linenos">2282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2283"><a href="#AnnotateApp.__init__-2283"><span class="linenos">2283</span></a>        
</span><span id="AnnotateApp.__init__-2284"><a href="#AnnotateApp.__init__-2284"><span class="linenos">2284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Train &amp; Classify (beta)&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_and_classify</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span><span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2285"><a href="#AnnotateApp.__init__-2285"><span class="linenos">2285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2286"><a href="#AnnotateApp.__init__-2286"><span class="linenos">2286</span></a>        
</span><span id="AnnotateApp.__init__-2287"><a href="#AnnotateApp.__init__-2287"><span class="linenos">2287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;orig.&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">swich_back_annotation_column</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span><span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2288"><a href="#AnnotateApp.__init__-2288"><span class="linenos">2288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2289"><a href="#AnnotateApp.__init__-2289"><span class="linenos">2289</span></a>        
</span><span id="AnnotateApp.__init__-2290"><a href="#AnnotateApp.__init__-2290"><span class="linenos">2290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_settings_window</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span> <span class="n">highlightbackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">,</span><span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2291"><a href="#AnnotateApp.__init__-2291"><span class="linenos">2291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2292"><a href="#AnnotateApp.__init__-2292"><span class="linenos">2292</span></a>
</span><span id="AnnotateApp.__init__-2293"><a href="#AnnotateApp.__init__-2293"><span class="linenos">2293</span></a>        <span class="c1"># Calculate grid rows and columns based on the root window size and image size</span>
</span><span id="AnnotateApp.__init__-2294"><a href="#AnnotateApp.__init__-2294"><span class="linenos">2294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_dimensions</span><span class="p">()</span>
</span><span id="AnnotateApp.__init__-2295"><a href="#AnnotateApp.__init__-2295"><span class="linenos">2295</span></a>
</span><span id="AnnotateApp.__init__-2296"><a href="#AnnotateApp.__init__-2296"><span class="linenos">2296</span></a>        <span class="c1"># Create a frame to hold the image grid</span>
</span><span id="AnnotateApp.__init__-2297"><a href="#AnnotateApp.__init__-2297"><span class="linenos">2297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp.__init__-2298"><a href="#AnnotateApp.__init__-2298"><span class="linenos">2298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2299"><a href="#AnnotateApp.__init__-2299"><span class="linenos">2299</span></a>
</span><span id="AnnotateApp.__init__-2300"><a href="#AnnotateApp.__init__-2300"><span class="linenos">2300</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp.__init__-2301"><a href="#AnnotateApp.__init__-2301"><span class="linenos">2301</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp.__init__-2302"><a href="#AnnotateApp.__init__-2302"><span class="linenos">2302</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2303"><a href="#AnnotateApp.__init__-2303"><span class="linenos">2303</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2304"><a href="#AnnotateApp.__init__-2304"><span class="linenos">2304</span></a>
</span><span id="AnnotateApp.__init__-2305"><a href="#AnnotateApp.__init__-2305"><span class="linenos">2305</span></a>        <span class="c1"># Make the grid frame resize with the window</span>
</span><span id="AnnotateApp.__init__-2306"><a href="#AnnotateApp.__init__-2306"><span class="linenos">2306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2307"><a href="#AnnotateApp.__init__-2307"><span class="linenos">2307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2308"><a href="#AnnotateApp.__init__-2308"><span class="linenos">2308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2309"><a href="#AnnotateApp.__init__-2309"><span class="linenos">2309</span></a>
</span><span id="AnnotateApp.__init__-2310"><a href="#AnnotateApp.__init__-2310"><span class="linenos">2310</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">):</span>
</span><span id="AnnotateApp.__init__-2311"><a href="#AnnotateApp.__init__-2311"><span class="linenos">2311</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.__init__-2312"><a href="#AnnotateApp.__init__-2312"><span class="linenos">2312</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp.__init__-2313"><a href="#AnnotateApp.__init__-2313"><span class="linenos">2313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.root" class="classattr">
                                <div class="attr variable">
            <span class="name">root</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.root"></a>
    
    

                            </div>
                            <div id="AnnotateApp.db_path" class="classattr">
                                <div class="attr variable">
            <span class="name">db_path</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.db_path"></a>
    
    

                            </div>
                            <div id="AnnotateApp.src" class="classattr">
                                <div class="attr variable">
            <span class="name">src</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.src"></a>
    
    

                            </div>
                            <div id="AnnotateApp.index" class="classattr">
                                <div class="attr variable">
            <span class="name">index</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.index"></a>
    
    

                            </div>
                            <div id="AnnotateApp.orig_annotation_columns" class="classattr">
                                <div class="attr variable">
            <span class="name">orig_annotation_columns</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.orig_annotation_columns"></a>
    
    

                            </div>
                            <div id="AnnotateApp.annotation_column" class="classattr">
                                <div class="attr variable">
            <span class="name">annotation_column</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.annotation_column"></a>
    
    

                            </div>
                            <div id="AnnotateApp.image_type" class="classattr">
                                <div class="attr variable">
            <span class="name">image_type</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.image_type"></a>
    
    

                            </div>
                            <div id="AnnotateApp.channels" class="classattr">
                                <div class="attr variable">
            <span class="name">channels</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.channels"></a>
    
    

                            </div>
                            <div id="AnnotateApp.normalize" class="classattr">
                                <div class="attr variable">
            <span class="name">normalize</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.normalize"></a>
    
    

                            </div>
                            <div id="AnnotateApp.percentiles" class="classattr">
                                <div class="attr variable">
            <span class="name">percentiles</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.percentiles"></a>
    
    

                            </div>
                            <div id="AnnotateApp.images" class="classattr">
                                <div class="attr variable">
            <span class="name">images</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.images"></a>
    
    

                            </div>
                            <div id="AnnotateApp.pending_updates" class="classattr">
                                <div class="attr variable">
            <span class="name">pending_updates</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.pending_updates"></a>
    
    

                            </div>
                            <div id="AnnotateApp.labels" class="classattr">
                                <div class="attr variable">
            <span class="name">labels</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.labels"></a>
    
    

                            </div>
                            <div id="AnnotateApp.adjusted_to_original_paths" class="classattr">
                                <div class="attr variable">
            <span class="name">adjusted_to_original_paths</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.adjusted_to_original_paths"></a>
    
    

                            </div>
                            <div id="AnnotateApp.terminate" class="classattr">
                                <div class="attr variable">
            <span class="name">terminate</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.terminate"></a>
    
    

                            </div>
                            <div id="AnnotateApp.update_queue" class="classattr">
                                <div class="attr variable">
            <span class="name">update_queue</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.update_queue"></a>
    
    

                            </div>
                            <div id="AnnotateApp.measurement" class="classattr">
                                <div class="attr variable">
            <span class="name">measurement</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.measurement"></a>
    
    

                            </div>
                            <div id="AnnotateApp.threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">threshold</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.threshold"></a>
    
    

                            </div>
                            <div id="AnnotateApp.normalize_channels" class="classattr">
                                <div class="attr variable">
            <span class="name">normalize_channels</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.normalize_channels"></a>
    
    

                            </div>
                            <div id="AnnotateApp.font_loader" class="classattr">
                                <div class="attr variable">
            <span class="name">font_loader</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.font_loader"></a>
    
    

                            </div>
                            <div id="AnnotateApp.font_size" class="classattr">
                                <div class="attr variable">
            <span class="name">font_size</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.font_size"></a>
    
    

                            </div>
                            <div id="AnnotateApp.bg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">bg_color</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.bg_color"></a>
    
    

                            </div>
                            <div id="AnnotateApp.fg_color" class="classattr">
                                <div class="attr variable">
            <span class="name">fg_color</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.fg_color"></a>
    
    

                            </div>
                            <div id="AnnotateApp.active_color" class="classattr">
                                <div class="attr variable">
            <span class="name">active_color</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.active_color"></a>
    
    

                            </div>
                            <div id="AnnotateApp.inactive_color" class="classattr">
                                <div class="attr variable">
            <span class="name">inactive_color</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.inactive_color"></a>
    
    

                            </div>
                            <div id="AnnotateApp.filtered_paths_annotations" class="classattr">
                                <div class="attr variable">
            <span class="name">filtered_paths_annotations</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.filtered_paths_annotations"></a>
    
    

                            </div>
                            <div id="AnnotateApp.db_update_thread" class="classattr">
                                <div class="attr variable">
            <span class="name">db_update_thread</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.db_update_thread"></a>
    
    

                            </div>
                            <div id="AnnotateApp.status_label" class="classattr">
                                <div class="attr variable">
            <span class="name">status_label</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.status_label"></a>
    
    

                            </div>
                            <div id="AnnotateApp.button_frame" class="classattr">
                                <div class="attr variable">
            <span class="name">button_frame</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.button_frame"></a>
    
    

                            </div>
                            <div id="AnnotateApp.next_button" class="classattr">
                                <div class="attr variable">
            <span class="name">next_button</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.next_button"></a>
    
    

                            </div>
                            <div id="AnnotateApp.previous_button" class="classattr">
                                <div class="attr variable">
            <span class="name">previous_button</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.previous_button"></a>
    
    

                            </div>
                            <div id="AnnotateApp.exit_button" class="classattr">
                                <div class="attr variable">
            <span class="name">exit_button</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.exit_button"></a>
    
    

                            </div>
                            <div id="AnnotateApp.train_button" class="classattr">
                                <div class="attr variable">
            <span class="name">train_button</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.train_button"></a>
    
    

                            </div>
                            <div id="AnnotateApp.settings_button" class="classattr">
                                <div class="attr variable">
            <span class="name">settings_button</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.settings_button"></a>
    
    

                            </div>
                            <div id="AnnotateApp.grid_frame" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_frame</span>

        
    </div>
    <a class="headerlink" href="#AnnotateApp.grid_frame"></a>
    
    

                            </div>
                            <div id="AnnotateApp.open_settings_window" class="classattr">
                                        <input id="AnnotateApp.open_settings_window-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_settings_window</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.open_settings_window-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.open_settings_window"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.open_settings_window-2315"><a href="#AnnotateApp.open_settings_window-2315"><span class="linenos">2315</span></a>    <span class="k">def</span> <span class="nf">open_settings_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.open_settings_window-2316"><a href="#AnnotateApp.open_settings_window-2316"><span class="linenos">2316</span></a>        <span class="kn">from</span> <span class="nn">.gui_utils</span> <span class="kn">import</span> <span class="n">generate_annotate_fields</span><span class="p">,</span> <span class="n">convert_to_number</span>
</span><span id="AnnotateApp.open_settings_window-2317"><a href="#AnnotateApp.open_settings_window-2317"><span class="linenos">2317</span></a>
</span><span id="AnnotateApp.open_settings_window-2318"><a href="#AnnotateApp.open_settings_window-2318"><span class="linenos">2318</span></a>        <span class="c1"># Create settings window</span>
</span><span id="AnnotateApp.open_settings_window-2319"><a href="#AnnotateApp.open_settings_window-2319"><span class="linenos">2319</span></a>        <span class="n">settings_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2320"><a href="#AnnotateApp.open_settings_window-2320"><span class="linenos">2320</span></a>        <span class="n">settings_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Modify Annotation Settings&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2321"><a href="#AnnotateApp.open_settings_window-2321"><span class="linenos">2321</span></a>
</span><span id="AnnotateApp.open_settings_window-2322"><a href="#AnnotateApp.open_settings_window-2322"><span class="linenos">2322</span></a>        <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="AnnotateApp.open_settings_window-2323"><a href="#AnnotateApp.open_settings_window-2323"><span class="linenos">2323</span></a>        <span class="n">settings_window</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp.open_settings_window-2324"><a href="#AnnotateApp.open_settings_window-2324"><span class="linenos">2324</span></a>        
</span><span id="AnnotateApp.open_settings_window-2325"><a href="#AnnotateApp.open_settings_window-2325"><span class="linenos">2325</span></a>        <span class="n">settings_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">settings_window</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp.open_settings_window-2326"><a href="#AnnotateApp.open_settings_window-2326"><span class="linenos">2326</span></a>        <span class="n">settings_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2327"><a href="#AnnotateApp.open_settings_window-2327"><span class="linenos">2327</span></a>
</span><span id="AnnotateApp.open_settings_window-2328"><a href="#AnnotateApp.open_settings_window-2328"><span class="linenos">2328</span></a>        <span class="c1"># Generate fields with current settings pre-filled</span>
</span><span id="AnnotateApp.open_settings_window-2329"><a href="#AnnotateApp.open_settings_window-2329"><span class="linenos">2329</span></a>        <span class="n">vars_dict</span> <span class="o">=</span> <span class="n">generate_annotate_fields</span><span class="p">(</span><span class="n">settings_frame</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2330"><a href="#AnnotateApp.open_settings_window-2330"><span class="linenos">2330</span></a>
</span><span id="AnnotateApp.open_settings_window-2331"><a href="#AnnotateApp.open_settings_window-2331"><span class="linenos">2331</span></a>        <span class="c1"># Pre-fill the current settings into vars_dict</span>
</span><span id="AnnotateApp.open_settings_window-2332"><a href="#AnnotateApp.open_settings_window-2332"><span class="linenos">2332</span></a>        <span class="n">current_settings</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AnnotateApp.open_settings_window-2333"><a href="#AnnotateApp.open_settings_window-2333"><span class="linenos">2333</span></a>            <span class="s1">&#39;image_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp.open_settings_window-2334"><a href="#AnnotateApp.open_settings_window-2334"><span class="linenos">2334</span></a>            <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp.open_settings_window-2335"><a href="#AnnotateApp.open_settings_window-2335"><span class="linenos">2335</span></a>            <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AnnotateApp.open_settings_window-2336"><a href="#AnnotateApp.open_settings_window-2336"><span class="linenos">2336</span></a>            <span class="s1">&#39;annotation_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp.open_settings_window-2337"><a href="#AnnotateApp.open_settings_window-2337"><span class="linenos">2337</span></a>            <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2338"><a href="#AnnotateApp.open_settings_window-2338"><span class="linenos">2338</span></a>            <span class="s1">&#39;percentiles&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span><span class="p">)),</span>
</span><span id="AnnotateApp.open_settings_window-2339"><a href="#AnnotateApp.open_settings_window-2339"><span class="linenos">2339</span></a>            <span class="s1">&#39;measurement&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp.open_settings_window-2340"><a href="#AnnotateApp.open_settings_window-2340"><span class="linenos">2340</span></a>            <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp.open_settings_window-2341"><a href="#AnnotateApp.open_settings_window-2341"><span class="linenos">2341</span></a>            <span class="s1">&#39;normalize_channels&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
</span><span id="AnnotateApp.open_settings_window-2342"><a href="#AnnotateApp.open_settings_window-2342"><span class="linenos">2342</span></a>        <span class="p">}</span>
</span><span id="AnnotateApp.open_settings_window-2343"><a href="#AnnotateApp.open_settings_window-2343"><span class="linenos">2343</span></a>
</span><span id="AnnotateApp.open_settings_window-2344"><a href="#AnnotateApp.open_settings_window-2344"><span class="linenos">2344</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">vars_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp.open_settings_window-2345"><a href="#AnnotateApp.open_settings_window-2345"><span class="linenos">2345</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">current_settings</span><span class="p">:</span>
</span><span id="AnnotateApp.open_settings_window-2346"><a href="#AnnotateApp.open_settings_window-2346"><span class="linenos">2346</span></a>                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2347"><a href="#AnnotateApp.open_settings_window-2347"><span class="linenos">2347</span></a>                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">current_settings</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="AnnotateApp.open_settings_window-2348"><a href="#AnnotateApp.open_settings_window-2348"><span class="linenos">2348</span></a>
</span><span id="AnnotateApp.open_settings_window-2349"><a href="#AnnotateApp.open_settings_window-2349"><span class="linenos">2349</span></a>        <span class="k">def</span> <span class="nf">apply_new_settings</span><span class="p">():</span>
</span><span id="AnnotateApp.open_settings_window-2350"><a href="#AnnotateApp.open_settings_window-2350"><span class="linenos">2350</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">vars_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="AnnotateApp.open_settings_window-2351"><a href="#AnnotateApp.open_settings_window-2351"><span class="linenos">2351</span></a>            
</span><span id="AnnotateApp.open_settings_window-2352"><a href="#AnnotateApp.open_settings_window-2352"><span class="linenos">2352</span></a>            <span class="c1"># Process settings exactly as your original initiation function does</span>
</span><span id="AnnotateApp.open_settings_window-2353"><a href="#AnnotateApp.open_settings_window-2353"><span class="linenos">2353</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AnnotateApp.open_settings_window-2354"><a href="#AnnotateApp.open_settings_window-2354"><span class="linenos">2354</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span>
</span><span id="AnnotateApp.open_settings_window-2355"><a href="#AnnotateApp.open_settings_window-2355"><span class="linenos">2355</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">convert_to_number</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;percentiles&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
</span><span id="AnnotateApp.open_settings_window-2356"><a href="#AnnotateApp.open_settings_window-2356"><span class="linenos">2356</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span>
</span><span id="AnnotateApp.open_settings_window-2357"><a href="#AnnotateApp.open_settings_window-2357"><span class="linenos">2357</span></a>            <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AnnotateApp.open_settings_window-2358"><a href="#AnnotateApp.open_settings_window-2358"><span class="linenos">2358</span></a>
</span><span id="AnnotateApp.open_settings_window-2359"><a href="#AnnotateApp.open_settings_window-2359"><span class="linenos">2359</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="AnnotateApp.open_settings_window-2360"><a href="#AnnotateApp.open_settings_window-2360"><span class="linenos">2360</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AnnotateApp.open_settings_window-2361"><a href="#AnnotateApp.open_settings_window-2361"><span class="linenos">2361</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp.open_settings_window-2362"><a href="#AnnotateApp.open_settings_window-2362"><span class="linenos">2362</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="AnnotateApp.open_settings_window-2363"><a href="#AnnotateApp.open_settings_window-2363"><span class="linenos">2363</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp.open_settings_window-2364"><a href="#AnnotateApp.open_settings_window-2364"><span class="linenos">2364</span></a>                <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp.open_settings_window-2365"><a href="#AnnotateApp.open_settings_window-2365"><span class="linenos">2365</span></a>
</span><span id="AnnotateApp.open_settings_window-2366"><a href="#AnnotateApp.open_settings_window-2366"><span class="linenos">2366</span></a>            <span class="c1"># Convert empty strings to None</span>
</span><span id="AnnotateApp.open_settings_window-2367"><a href="#AnnotateApp.open_settings_window-2367"><span class="linenos">2367</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp.open_settings_window-2368"><a href="#AnnotateApp.open_settings_window-2368"><span class="linenos">2368</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.open_settings_window-2369"><a href="#AnnotateApp.open_settings_window-2369"><span class="linenos">2369</span></a>                    <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
</span><span id="AnnotateApp.open_settings_window-2370"><a href="#AnnotateApp.open_settings_window-2370"><span class="linenos">2370</span></a>                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.open_settings_window-2371"><a href="#AnnotateApp.open_settings_window-2371"><span class="linenos">2371</span></a>                    <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp.open_settings_window-2372"><a href="#AnnotateApp.open_settings_window-2372"><span class="linenos">2372</span></a>
</span><span id="AnnotateApp.open_settings_window-2373"><a href="#AnnotateApp.open_settings_window-2373"><span class="linenos">2373</span></a>            <span class="c1"># Apply these settings dynamically using update_settings method</span>
</span><span id="AnnotateApp.open_settings_window-2374"><a href="#AnnotateApp.open_settings_window-2374"><span class="linenos">2374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
</span><span id="AnnotateApp.open_settings_window-2375"><a href="#AnnotateApp.open_settings_window-2375"><span class="linenos">2375</span></a>                <span class="s1">&#39;image_type&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;image_type&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2376"><a href="#AnnotateApp.open_settings_window-2376"><span class="linenos">2376</span></a>                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channels&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2377"><a href="#AnnotateApp.open_settings_window-2377"><span class="linenos">2377</span></a>                <span class="s1">&#39;image_size&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;img_size&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2378"><a href="#AnnotateApp.open_settings_window-2378"><span class="linenos">2378</span></a>                <span class="s1">&#39;annotation_column&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;annotation_column&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2379"><a href="#AnnotateApp.open_settings_window-2379"><span class="linenos">2379</span></a>                <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalize&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2380"><a href="#AnnotateApp.open_settings_window-2380"><span class="linenos">2380</span></a>                <span class="s1">&#39;percentiles&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;percentiles&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2381"><a href="#AnnotateApp.open_settings_window-2381"><span class="linenos">2381</span></a>                <span class="s1">&#39;measurement&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;measurement&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2382"><a href="#AnnotateApp.open_settings_window-2382"><span class="linenos">2382</span></a>                <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">),</span>
</span><span id="AnnotateApp.open_settings_window-2383"><a href="#AnnotateApp.open_settings_window-2383"><span class="linenos">2383</span></a>                <span class="s1">&#39;normalize_channels&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalize_channels&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2384"><a href="#AnnotateApp.open_settings_window-2384"><span class="linenos">2384</span></a>            <span class="p">})</span>
</span><span id="AnnotateApp.open_settings_window-2385"><a href="#AnnotateApp.open_settings_window-2385"><span class="linenos">2385</span></a>
</span><span id="AnnotateApp.open_settings_window-2386"><a href="#AnnotateApp.open_settings_window-2386"><span class="linenos">2386</span></a>            <span class="n">settings_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="AnnotateApp.open_settings_window-2387"><a href="#AnnotateApp.open_settings_window-2387"><span class="linenos">2387</span></a>
</span><span id="AnnotateApp.open_settings_window-2388"><a href="#AnnotateApp.open_settings_window-2388"><span class="linenos">2388</span></a>        <span class="n">apply_button</span> <span class="o">=</span> <span class="n">spacrButton</span><span class="p">(</span><span class="n">settings_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply Settings&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">apply_new_settings</span><span class="p">,</span><span class="n">show_text</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AnnotateApp.open_settings_window-2389"><a href="#AnnotateApp.open_settings_window-2389"><span class="linenos">2389</span></a>        <span class="n">apply_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.update_settings" class="classattr">
                                        <input id="AnnotateApp.update_settings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_settings</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.update_settings-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.update_settings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.update_settings-2391"><a href="#AnnotateApp.update_settings-2391"><span class="linenos">2391</span></a>    <span class="k">def</span> <span class="nf">update_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AnnotateApp.update_settings-2392"><a href="#AnnotateApp.update_settings-2392"><span class="linenos">2392</span></a>        <span class="n">allowed_attributes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AnnotateApp.update_settings-2393"><a href="#AnnotateApp.update_settings-2393"><span class="linenos">2393</span></a>            <span class="s1">&#39;image_type&#39;</span><span class="p">,</span> <span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="s1">&#39;image_size&#39;</span><span class="p">,</span> <span class="s1">&#39;annotation_column&#39;</span><span class="p">,</span>
</span><span id="AnnotateApp.update_settings-2394"><a href="#AnnotateApp.update_settings-2394"><span class="linenos">2394</span></a>            <span class="s1">&#39;normalize&#39;</span><span class="p">,</span> <span class="s1">&#39;percentiles&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;normalize_channels&#39;</span>
</span><span id="AnnotateApp.update_settings-2395"><a href="#AnnotateApp.update_settings-2395"><span class="linenos">2395</span></a>        <span class="p">}</span>
</span><span id="AnnotateApp.update_settings-2396"><a href="#AnnotateApp.update_settings-2396"><span class="linenos">2396</span></a>
</span><span id="AnnotateApp.update_settings-2397"><a href="#AnnotateApp.update_settings-2397"><span class="linenos">2397</span></a>        <span class="n">updated</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AnnotateApp.update_settings-2398"><a href="#AnnotateApp.update_settings-2398"><span class="linenos">2398</span></a>
</span><span id="AnnotateApp.update_settings-2399"><a href="#AnnotateApp.update_settings-2399"><span class="linenos">2399</span></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp.update_settings-2400"><a href="#AnnotateApp.update_settings-2400"><span class="linenos">2400</span></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">allowed_attributes</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp.update_settings-2401"><a href="#AnnotateApp.update_settings-2401"><span class="linenos">2401</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="AnnotateApp.update_settings-2402"><a href="#AnnotateApp.update_settings-2402"><span class="linenos">2402</span></a>                <span class="n">updated</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="AnnotateApp.update_settings-2403"><a href="#AnnotateApp.update_settings-2403"><span class="linenos">2403</span></a>
</span><span id="AnnotateApp.update_settings-2404"><a href="#AnnotateApp.update_settings-2404"><span class="linenos">2404</span></a>        <span class="k">if</span> <span class="s1">&#39;image_size&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="AnnotateApp.update_settings-2405"><a href="#AnnotateApp.update_settings-2405"><span class="linenos">2405</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.update_settings-2406"><a href="#AnnotateApp.update_settings-2406"><span class="linenos">2406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="AnnotateApp.update_settings-2407"><a href="#AnnotateApp.update_settings-2407"><span class="linenos">2407</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AnnotateApp.update_settings-2408"><a href="#AnnotateApp.update_settings-2408"><span class="linenos">2408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">)</span>
</span><span id="AnnotateApp.update_settings-2409"><a href="#AnnotateApp.update_settings-2409"><span class="linenos">2409</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.update_settings-2410"><a href="#AnnotateApp.update_settings-2410"><span class="linenos">2410</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid image size&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.update_settings-2411"><a href="#AnnotateApp.update_settings-2411"><span class="linenos">2411</span></a>
</span><span id="AnnotateApp.update_settings-2412"><a href="#AnnotateApp.update_settings-2412"><span class="linenos">2412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_dimensions</span><span class="p">()</span>
</span><span id="AnnotateApp.update_settings-2413"><a href="#AnnotateApp.update_settings-2413"><span class="linenos">2413</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recreate_image_grid</span><span class="p">()</span>
</span><span id="AnnotateApp.update_settings-2414"><a href="#AnnotateApp.update_settings-2414"><span class="linenos">2414</span></a>
</span><span id="AnnotateApp.update_settings-2415"><a href="#AnnotateApp.update_settings-2415"><span class="linenos">2415</span></a>        <span class="k">if</span> <span class="n">updated</span><span class="p">:</span>
</span><span id="AnnotateApp.update_settings-2416"><a href="#AnnotateApp.update_settings-2416"><span class="linenos">2416</span></a>            <span class="n">current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># Retain current index</span>
</span><span id="AnnotateApp.update_settings-2417"><a href="#AnnotateApp.update_settings-2417"><span class="linenos">2417</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="AnnotateApp.update_settings-2418"><a href="#AnnotateApp.update_settings-2418"><span class="linenos">2418</span></a>
</span><span id="AnnotateApp.update_settings-2419"><a href="#AnnotateApp.update_settings-2419"><span class="linenos">2419</span></a>            <span class="c1"># Ensure the retained index is still valid (not out of bounds)</span>
</span><span id="AnnotateApp.update_settings-2420"><a href="#AnnotateApp.update_settings-2420"><span class="linenos">2420</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="AnnotateApp.update_settings-2421"><a href="#AnnotateApp.update_settings-2421"><span class="linenos">2421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_index</span><span class="p">,</span> <span class="n">max_index</span> <span class="o">:=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="mi">0</span><span class="p">))))</span>
</span><span id="AnnotateApp.update_settings-2422"><a href="#AnnotateApp.update_settings-2422"><span class="linenos">2422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.recreate_image_grid" class="classattr">
                                        <input id="AnnotateApp.recreate_image_grid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">recreate_image_grid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.recreate_image_grid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.recreate_image_grid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.recreate_image_grid-2424"><a href="#AnnotateApp.recreate_image_grid-2424"><span class="linenos">2424</span></a>    <span class="k">def</span> <span class="nf">recreate_image_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.recreate_image_grid-2425"><a href="#AnnotateApp.recreate_image_grid-2425"><span class="linenos">2425</span></a>        <span class="c1"># Remove current labels</span>
</span><span id="AnnotateApp.recreate_image_grid-2426"><a href="#AnnotateApp.recreate_image_grid-2426"><span class="linenos">2426</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
</span><span id="AnnotateApp.recreate_image_grid-2427"><a href="#AnnotateApp.recreate_image_grid-2427"><span class="linenos">2427</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="AnnotateApp.recreate_image_grid-2428"><a href="#AnnotateApp.recreate_image_grid-2428"><span class="linenos">2428</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp.recreate_image_grid-2429"><a href="#AnnotateApp.recreate_image_grid-2429"><span class="linenos">2429</span></a>
</span><span id="AnnotateApp.recreate_image_grid-2430"><a href="#AnnotateApp.recreate_image_grid-2430"><span class="linenos">2430</span></a>        <span class="c1"># Recreate the labels grid with updated dimensions</span>
</span><span id="AnnotateApp.recreate_image_grid-2431"><a href="#AnnotateApp.recreate_image_grid-2431"><span class="linenos">2431</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp.recreate_image_grid-2432"><a href="#AnnotateApp.recreate_image_grid-2432"><span class="linenos">2432</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">))</span>
</span><span id="AnnotateApp.recreate_image_grid-2433"><a href="#AnnotateApp.recreate_image_grid-2433"><span class="linenos">2433</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.recreate_image_grid-2434"><a href="#AnnotateApp.recreate_image_grid-2434"><span class="linenos">2434</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="AnnotateApp.recreate_image_grid-2435"><a href="#AnnotateApp.recreate_image_grid-2435"><span class="linenos">2435</span></a>
</span><span id="AnnotateApp.recreate_image_grid-2436"><a href="#AnnotateApp.recreate_image_grid-2436"><span class="linenos">2436</span></a>        <span class="c1"># Reconfigure grid weights</span>
</span><span id="AnnotateApp.recreate_image_grid-2437"><a href="#AnnotateApp.recreate_image_grid-2437"><span class="linenos">2437</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">):</span>
</span><span id="AnnotateApp.recreate_image_grid-2438"><a href="#AnnotateApp.recreate_image_grid-2438"><span class="linenos">2438</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AnnotateApp.recreate_image_grid-2439"><a href="#AnnotateApp.recreate_image_grid-2439"><span class="linenos">2439</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">):</span>
</span><span id="AnnotateApp.recreate_image_grid-2440"><a href="#AnnotateApp.recreate_image_grid-2440"><span class="linenos">2440</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grid_frame</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.swich_back_annotation_column" class="classattr">
                                        <input id="AnnotateApp.swich_back_annotation_column-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">swich_back_annotation_column</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.swich_back_annotation_column-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.swich_back_annotation_column"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.swich_back_annotation_column-2443"><a href="#AnnotateApp.swich_back_annotation_column-2443"><span class="linenos">2443</span></a>    <span class="k">def</span> <span class="nf">swich_back_annotation_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.swich_back_annotation_column-2444"><a href="#AnnotateApp.swich_back_annotation_column-2444"><span class="linenos">2444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_annotation_columns</span>
</span><span id="AnnotateApp.swich_back_annotation_column-2445"><a href="#AnnotateApp.swich_back_annotation_column-2445"><span class="linenos">2445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>
</span><span id="AnnotateApp.swich_back_annotation_column-2446"><a href="#AnnotateApp.swich_back_annotation_column-2446"><span class="linenos">2446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_display</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.calculate_grid_dimensions" class="classattr">
                                        <input id="AnnotateApp.calculate_grid_dimensions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_grid_dimensions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.calculate_grid_dimensions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.calculate_grid_dimensions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.calculate_grid_dimensions-2448"><a href="#AnnotateApp.calculate_grid_dimensions-2448"><span class="linenos">2448</span></a>    <span class="k">def</span> <span class="nf">calculate_grid_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2449"><a href="#AnnotateApp.calculate_grid_dimensions-2449"><span class="linenos">2449</span></a>        <span class="n">window_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2450"><a href="#AnnotateApp.calculate_grid_dimensions-2450"><span class="linenos">2450</span></a>        <span class="n">window_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2451"><a href="#AnnotateApp.calculate_grid_dimensions-2451"><span class="linenos">2451</span></a>
</span><span id="AnnotateApp.calculate_grid_dimensions-2452"><a href="#AnnotateApp.calculate_grid_dimensions-2452"><span class="linenos">2452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span> <span class="o">=</span> <span class="n">window_width</span> <span class="o">//</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2453"><a href="#AnnotateApp.calculate_grid_dimensions-2453"><span class="linenos">2453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">window_height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2454"><a href="#AnnotateApp.calculate_grid_dimensions-2454"><span class="linenos">2454</span></a>
</span><span id="AnnotateApp.calculate_grid_dimensions-2455"><a href="#AnnotateApp.calculate_grid_dimensions-2455"><span class="linenos">2455</span></a>        <span class="c1"># Update to make sure grid_rows and grid_cols are at least 1</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2456"><a href="#AnnotateApp.calculate_grid_dimensions-2456"><span class="linenos">2456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">)</span>
</span><span id="AnnotateApp.calculate_grid_dimensions-2457"><a href="#AnnotateApp.calculate_grid_dimensions-2457"><span class="linenos">2457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.prefilter_paths_annotations" class="classattr">
                                        <input id="AnnotateApp.prefilter_paths_annotations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prefilter_paths_annotations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.prefilter_paths_annotations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.prefilter_paths_annotations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.prefilter_paths_annotations-2459"><a href="#AnnotateApp.prefilter_paths_annotations-2459"><span class="linenos">2459</span></a>    <span class="k">def</span> <span class="nf">prefilter_paths_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2460"><a href="#AnnotateApp.prefilter_paths_annotations-2460"><span class="linenos">2460</span></a>        <span class="kn">from</span> <span class="nn">.io</span> <span class="kn">import</span> <span class="n">_read_and_join_tables</span><span class="p">,</span> <span class="n">_read_db</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2461"><a href="#AnnotateApp.prefilter_paths_annotations-2461"><span class="linenos">2461</span></a>        <span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">is_list_of_lists</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2462"><a href="#AnnotateApp.prefilter_paths_annotations-2462"><span class="linenos">2462</span></a>
</span><span id="AnnotateApp.prefilter_paths_annotations-2463"><a href="#AnnotateApp.prefilter_paths_annotations-2463"><span class="linenos">2463</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2464"><a href="#AnnotateApp.prefilter_paths_annotations-2464"><span class="linenos">2464</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">_read_and_join_tables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2465"><a href="#AnnotateApp.prefilter_paths_annotations-2465"><span class="linenos">2465</span></a>            <span class="n">png_list_df</span> <span class="o">=</span> <span class="n">_read_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png_list&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2466"><a href="#AnnotateApp.prefilter_paths_annotations-2466"><span class="linenos">2466</span></a>            <span class="n">png_list_df</span> <span class="o">=</span> <span class="n">png_list_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;prcfo&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2467"><a href="#AnnotateApp.prefilter_paths_annotations-2467"><span class="linenos">2467</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">png_list_df</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2468"><a href="#AnnotateApp.prefilter_paths_annotations-2468"><span class="linenos">2468</span></a>            <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2469"><a href="#AnnotateApp.prefilter_paths_annotations-2469"><span class="linenos">2469</span></a>            <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2470"><a href="#AnnotateApp.prefilter_paths_annotations-2470"><span class="linenos">2470</span></a>
</span><span id="AnnotateApp.prefilter_paths_annotations-2471"><a href="#AnnotateApp.prefilter_paths_annotations-2471"><span class="linenos">2471</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2472"><a href="#AnnotateApp.prefilter_paths_annotations-2472"><span class="linenos">2472</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2473"><a href="#AnnotateApp.prefilter_paths_annotations-2473"><span class="linenos">2473</span></a>                    <span class="n">mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2474"><a href="#AnnotateApp.prefilter_paths_annotations-2474"><span class="linenos">2474</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2475"><a href="#AnnotateApp.prefilter_paths_annotations-2475"><span class="linenos">2475</span></a>                    <span class="n">mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2476"><a href="#AnnotateApp.prefilter_paths_annotations-2476"><span class="linenos">2476</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mes</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2477"><a href="#AnnotateApp.prefilter_paths_annotations-2477"><span class="linenos">2477</span></a>
</span><span id="AnnotateApp.prefilter_paths_annotations-2478"><a href="#AnnotateApp.prefilter_paths_annotations-2478"><span class="linenos">2478</span></a>            <span class="k">if</span> <span class="n">is_list_of_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2479"><a href="#AnnotateApp.prefilter_paths_annotations-2479"><span class="linenos">2479</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_list_of_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2480"><a href="#AnnotateApp.prefilter_paths_annotations-2480"><span class="linenos">2480</span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2481"><a href="#AnnotateApp.prefilter_paths_annotations-2481"><span class="linenos">2481</span></a>                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2482"><a href="#AnnotateApp.prefilter_paths_annotations-2482"><span class="linenos">2482</span></a>                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2483"><a href="#AnnotateApp.prefilter_paths_annotations-2483"><span class="linenos">2483</span></a>                        <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2484"><a href="#AnnotateApp.prefilter_paths_annotations-2484"><span class="linenos">2484</span></a>                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2485"><a href="#AnnotateApp.prefilter_paths_annotations-2485"><span class="linenos">2485</span></a>                        <span class="n">th_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2486"><a href="#AnnotateApp.prefilter_paths_annotations-2486"><span class="linenos">2486</span></a>                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2487"><a href="#AnnotateApp.prefilter_paths_annotations-2487"><span class="linenos">2487</span></a>                            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2488"><a href="#AnnotateApp.prefilter_paths_annotations-2488"><span class="linenos">2488</span></a>                                <span class="n">th_idx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2489"><a href="#AnnotateApp.prefilter_paths_annotations-2489"><span class="linenos">2489</span></a>                                <span class="n">thd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2490"><a href="#AnnotateApp.prefilter_paths_annotations-2490"><span class="linenos">2490</span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thd</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2491"><a href="#AnnotateApp.prefilter_paths_annotations-2491"><span class="linenos">2491</span></a>                                    <span class="n">thd</span> <span class="o">=</span> <span class="n">thd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2492"><a href="#AnnotateApp.prefilter_paths_annotations-2492"><span class="linenos">2492</span></a>                                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2493"><a href="#AnnotateApp.prefilter_paths_annotations-2493"><span class="linenos">2493</span></a>                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2494"><a href="#AnnotateApp.prefilter_paths_annotations-2494"><span class="linenos">2494</span></a>                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2495"><a href="#AnnotateApp.prefilter_paths_annotations-2495"><span class="linenos">2495</span></a>                                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;threshold_measurement_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thd</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2496"><a href="#AnnotateApp.prefilter_paths_annotations-2496"><span class="linenos">2496</span></a>                        <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2497"><a href="#AnnotateApp.prefilter_paths_annotations-2497"><span class="linenos">2497</span></a>            
</span><span id="AnnotateApp.prefilter_paths_annotations-2498"><a href="#AnnotateApp.prefilter_paths_annotations-2498"><span class="linenos">2498</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2499"><a href="#AnnotateApp.prefilter_paths_annotations-2499"><span class="linenos">2499</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2500"><a href="#AnnotateApp.prefilter_paths_annotations-2500"><span class="linenos">2500</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2501"><a href="#AnnotateApp.prefilter_paths_annotations-2501"><span class="linenos">2501</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2502"><a href="#AnnotateApp.prefilter_paths_annotations-2502"><span class="linenos">2502</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threshold_measurement&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2503"><a href="#AnnotateApp.prefilter_paths_annotations-2503"><span class="linenos">2503</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2504"><a href="#AnnotateApp.prefilter_paths_annotations-2504"><span class="linenos">2504</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="s1">&#39;threshold_measurement&#39;</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2505"><a href="#AnnotateApp.prefilter_paths_annotations-2505"><span class="linenos">2505</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2506"><a href="#AnnotateApp.prefilter_paths_annotations-2506"><span class="linenos">2506</span></a>            
</span><span id="AnnotateApp.prefilter_paths_annotations-2507"><a href="#AnnotateApp.prefilter_paths_annotations-2507"><span class="linenos">2507</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2508"><a href="#AnnotateApp.prefilter_paths_annotations-2508"><span class="linenos">2508</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2509"><a href="#AnnotateApp.prefilter_paths_annotations-2509"><span class="linenos">2509</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median threshold measurement: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2510"><a href="#AnnotateApp.prefilter_paths_annotations-2510"><span class="linenos">2510</span></a>                <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2511"><a href="#AnnotateApp.prefilter_paths_annotations-2511"><span class="linenos">2511</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2512"><a href="#AnnotateApp.prefilter_paths_annotations-2512"><span class="linenos">2512</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q1&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2513"><a href="#AnnotateApp.prefilter_paths_annotations-2513"><span class="linenos">2513</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2514"><a href="#AnnotateApp.prefilter_paths_annotations-2514"><span class="linenos">2514</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q2&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2515"><a href="#AnnotateApp.prefilter_paths_annotations-2515"><span class="linenos">2515</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2516"><a href="#AnnotateApp.prefilter_paths_annotations-2516"><span class="linenos">2516</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q3&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2517"><a href="#AnnotateApp.prefilter_paths_annotations-2517"><span class="linenos">2517</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2518"><a href="#AnnotateApp.prefilter_paths_annotations-2518"><span class="linenos">2518</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q4&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2519"><a href="#AnnotateApp.prefilter_paths_annotations-2519"><span class="linenos">2519</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2520"><a href="#AnnotateApp.prefilter_paths_annotations-2520"><span class="linenos">2520</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q5&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2521"><a href="#AnnotateApp.prefilter_paths_annotations-2521"><span class="linenos">2521</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2522"><a href="#AnnotateApp.prefilter_paths_annotations-2522"><span class="linenos">2522</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q6&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2523"><a href="#AnnotateApp.prefilter_paths_annotations-2523"><span class="linenos">2523</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2524"><a href="#AnnotateApp.prefilter_paths_annotations-2524"><span class="linenos">2524</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q7&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2525"><a href="#AnnotateApp.prefilter_paths_annotations-2525"><span class="linenos">2525</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2526"><a href="#AnnotateApp.prefilter_paths_annotations-2526"><span class="linenos">2526</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q8&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2527"><a href="#AnnotateApp.prefilter_paths_annotations-2527"><span class="linenos">2527</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2528"><a href="#AnnotateApp.prefilter_paths_annotations-2528"><span class="linenos">2528</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="s1">&#39;q9&#39;</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2529"><a href="#AnnotateApp.prefilter_paths_annotations-2529"><span class="linenos">2529</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2530"><a href="#AnnotateApp.prefilter_paths_annotations-2530"><span class="linenos">2530</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;threshold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2531"><a href="#AnnotateApp.prefilter_paths_annotations-2531"><span class="linenos">2531</span></a>
</span><span id="AnnotateApp.prefilter_paths_annotations-2532"><a href="#AnnotateApp.prefilter_paths_annotations-2532"><span class="linenos">2532</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2533"><a href="#AnnotateApp.prefilter_paths_annotations-2533"><span class="linenos">2533</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2534"><a href="#AnnotateApp.prefilter_paths_annotations-2534"><span class="linenos">2534</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2535"><a href="#AnnotateApp.prefilter_paths_annotations-2535"><span class="linenos">2535</span></a>
</span><span id="AnnotateApp.prefilter_paths_annotations-2536"><a href="#AnnotateApp.prefilter_paths_annotations-2536"><span class="linenos">2536</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2537"><a href="#AnnotateApp.prefilter_paths_annotations-2537"><span class="linenos">2537</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2538"><a href="#AnnotateApp.prefilter_paths_annotations-2538"><span class="linenos">2538</span></a>                <span class="n">before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2539"><a href="#AnnotateApp.prefilter_paths_annotations-2539"><span class="linenos">2539</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2540"><a href="#AnnotateApp.prefilter_paths_annotations-2540"><span class="linenos">2540</span></a>                    <span class="k">for</span> <span class="n">tpe</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2541"><a href="#AnnotateApp.prefilter_paths_annotations-2541"><span class="linenos">2541</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">tpe</span><span class="p">)]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2542"><a href="#AnnotateApp.prefilter_paths_annotations-2542"><span class="linenos">2542</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2543"><a href="#AnnotateApp.prefilter_paths_annotations-2543"><span class="linenos">2543</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">)]</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2544"><a href="#AnnotateApp.prefilter_paths_annotations-2544"><span class="linenos">2544</span></a>                <span class="n">after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2545"><a href="#AnnotateApp.prefilter_paths_annotations-2545"><span class="linenos">2545</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;image_type: Removed: </span><span class="si">{</span><span class="n">before</span><span class="o">-</span><span class="n">after</span><span class="si">}</span><span class="s1"> rows, retained </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2546"><a href="#AnnotateApp.prefilter_paths_annotations-2546"><span class="linenos">2546</span></a>
</span><span id="AnnotateApp.prefilter_paths_annotations-2547"><a href="#AnnotateApp.prefilter_paths_annotations-2547"><span class="linenos">2547</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;png_path&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2548"><a href="#AnnotateApp.prefilter_paths_annotations-2548"><span class="linenos">2548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2549"><a href="#AnnotateApp.prefilter_paths_annotations-2549"><span class="linenos">2549</span></a>            <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2550"><a href="#AnnotateApp.prefilter_paths_annotations-2550"><span class="linenos">2550</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2551"><a href="#AnnotateApp.prefilter_paths_annotations-2551"><span class="linenos">2551</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2552"><a href="#AnnotateApp.prefilter_paths_annotations-2552"><span class="linenos">2552</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list WHERE png_path LIKE ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">image_type</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,))</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2553"><a href="#AnnotateApp.prefilter_paths_annotations-2553"><span class="linenos">2553</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2554"><a href="#AnnotateApp.prefilter_paths_annotations-2554"><span class="linenos">2554</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2555"><a href="#AnnotateApp.prefilter_paths_annotations-2555"><span class="linenos">2555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="AnnotateApp.prefilter_paths_annotations-2556"><a href="#AnnotateApp.prefilter_paths_annotations-2556"><span class="linenos">2556</span></a>            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.load_images" class="classattr">
                                        <input id="AnnotateApp.load_images-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_images</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.load_images-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.load_images"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.load_images-2558"><a href="#AnnotateApp.load_images-2558"><span class="linenos">2558</span></a>    <span class="k">def</span> <span class="nf">load_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.load_images-2559"><a href="#AnnotateApp.load_images-2559"><span class="linenos">2559</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2560"><a href="#AnnotateApp.load_images-2560"><span class="linenos">2560</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.load_images-2561"><a href="#AnnotateApp.load_images-2561"><span class="linenos">2561</span></a>
</span><span id="AnnotateApp.load_images-2562"><a href="#AnnotateApp.load_images-2562"><span class="linenos">2562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AnnotateApp.load_images-2563"><a href="#AnnotateApp.load_images-2563"><span class="linenos">2563</span></a>        <span class="n">paths_annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_paths_annotations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span><span class="p">]</span>
</span><span id="AnnotateApp.load_images-2564"><a href="#AnnotateApp.load_images-2564"><span class="linenos">2564</span></a>
</span><span id="AnnotateApp.load_images-2565"><a href="#AnnotateApp.load_images-2565"><span class="linenos">2565</span></a>        <span class="n">adjusted_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AnnotateApp.load_images-2566"><a href="#AnnotateApp.load_images-2566"><span class="linenos">2566</span></a>        <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">paths_annotations</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2567"><a href="#AnnotateApp.load_images-2567"><span class="linenos">2567</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">):</span>
</span><span id="AnnotateApp.load_images-2568"><a href="#AnnotateApp.load_images-2568"><span class="linenos">2568</span></a>                <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/data/&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.load_images-2569"><a href="#AnnotateApp.load_images-2569"><span class="linenos">2569</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2570"><a href="#AnnotateApp.load_images-2570"><span class="linenos">2570</span></a>                    <span class="n">new_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="AnnotateApp.load_images-2571"><a href="#AnnotateApp.load_images-2571"><span class="linenos">2571</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span><span class="p">[</span><span class="n">new_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="AnnotateApp.load_images-2572"><a href="#AnnotateApp.load_images-2572"><span class="linenos">2572</span></a>                    <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">new_path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="AnnotateApp.load_images-2573"><a href="#AnnotateApp.load_images-2573"><span class="linenos">2573</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2574"><a href="#AnnotateApp.load_images-2574"><span class="linenos">2574</span></a>                    <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="AnnotateApp.load_images-2575"><a href="#AnnotateApp.load_images-2575"><span class="linenos">2575</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2576"><a href="#AnnotateApp.load_images-2576"><span class="linenos">2576</span></a>                <span class="n">adjusted_paths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">annotation</span><span class="p">))</span>
</span><span id="AnnotateApp.load_images-2577"><a href="#AnnotateApp.load_images-2577"><span class="linenos">2577</span></a>
</span><span id="AnnotateApp.load_images-2578"><a href="#AnnotateApp.load_images-2578"><span class="linenos">2578</span></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2579"><a href="#AnnotateApp.load_images-2579"><span class="linenos">2579</span></a>            <span class="n">loaded_images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_single_image</span><span class="p">,</span> <span class="n">adjusted_paths</span><span class="p">))</span>
</span><span id="AnnotateApp.load_images-2580"><a href="#AnnotateApp.load_images-2580"><span class="linenos">2580</span></a>
</span><span id="AnnotateApp.load_images-2581"><a href="#AnnotateApp.load_images-2581"><span class="linenos">2581</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">annotation</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loaded_images</span><span class="p">):</span>
</span><span id="AnnotateApp.load_images-2582"><a href="#AnnotateApp.load_images-2582"><span class="linenos">2582</span></a>            <span class="k">if</span> <span class="n">annotation</span><span class="p">:</span>
</span><span id="AnnotateApp.load_images-2583"><a href="#AnnotateApp.load_images-2583"><span class="linenos">2583</span></a>                <span class="n">border_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="n">annotation</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
</span><span id="AnnotateApp.load_images-2584"><a href="#AnnotateApp.load_images-2584"><span class="linenos">2584</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_colored_border</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">border_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp.load_images-2585"><a href="#AnnotateApp.load_images-2585"><span class="linenos">2585</span></a>
</span><span id="AnnotateApp.load_images-2586"><a href="#AnnotateApp.load_images-2586"><span class="linenos">2586</span></a>            <span class="n">photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="AnnotateApp.load_images-2587"><a href="#AnnotateApp.load_images-2587"><span class="linenos">2587</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="AnnotateApp.load_images-2588"><a href="#AnnotateApp.load_images-2588"><span class="linenos">2588</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">photo</span>
</span><span id="AnnotateApp.load_images-2589"><a href="#AnnotateApp.load_images-2589"><span class="linenos">2589</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">photo</span><span class="p">)</span>
</span><span id="AnnotateApp.load_images-2590"><a href="#AnnotateApp.load_images-2590"><span class="linenos">2590</span></a>
</span><span id="AnnotateApp.load_images-2591"><a href="#AnnotateApp.load_images-2591"><span class="linenos">2591</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">adjusted_paths</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp.load_images-2592"><a href="#AnnotateApp.load_images-2592"><span class="linenos">2592</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Button-1&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_on_image_click</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span>
</span><span id="AnnotateApp.load_images-2593"><a href="#AnnotateApp.load_images-2593"><span class="linenos">2593</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Button-3&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_on_image_click</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span>
</span><span id="AnnotateApp.load_images-2594"><a href="#AnnotateApp.load_images-2594"><span class="linenos">2594</span></a>
</span><span id="AnnotateApp.load_images-2595"><a href="#AnnotateApp.load_images-2595"><span class="linenos">2595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.load_single_image" class="classattr">
                                        <input id="AnnotateApp.load_single_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_single_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path_annotation_tuple</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.load_single_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.load_single_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.load_single_image-2597"><a href="#AnnotateApp.load_single_image-2597"><span class="linenos">2597</span></a>    <span class="k">def</span> <span class="nf">load_single_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_annotation_tuple</span><span class="p">):</span>
</span><span id="AnnotateApp.load_single_image-2598"><a href="#AnnotateApp.load_single_image-2598"><span class="linenos">2598</span></a>        <span class="n">path</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="n">path_annotation_tuple</span>
</span><span id="AnnotateApp.load_single_image-2599"><a href="#AnnotateApp.load_single_image-2599"><span class="linenos">2599</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="AnnotateApp.load_single_image-2600"><a href="#AnnotateApp.load_single_image-2600"><span class="linenos">2600</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentiles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_channels</span><span class="p">)</span>
</span><span id="AnnotateApp.load_single_image-2601"><a href="#AnnotateApp.load_single_image-2601"><span class="linenos">2601</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.load_single_image-2602"><a href="#AnnotateApp.load_single_image-2602"><span class="linenos">2602</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_channels</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="AnnotateApp.load_single_image-2603"><a href="#AnnotateApp.load_single_image-2603"><span class="linenos">2603</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">)</span>
</span><span id="AnnotateApp.load_single_image-2604"><a href="#AnnotateApp.load_single_image-2604"><span class="linenos">2604</span></a>        <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">annotation</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.normalize_image" class="classattr">
                                        <input id="AnnotateApp.normalize_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">normalize_image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">img</span>, </span><span class="param"><span class="n">normalize</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>, </span><span class="param"><span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.normalize_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.normalize_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.normalize_image-2606"><a href="#AnnotateApp.normalize_image-2606"><span class="linenos">2606</span></a>    <span class="nd">@staticmethod</span>
</span><span id="AnnotateApp.normalize_image-2607"><a href="#AnnotateApp.normalize_image-2607"><span class="linenos">2607</span></a>    <span class="k">def</span> <span class="nf">normalize_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span> <span class="n">normalize_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="AnnotateApp.normalize_image-2608"><a href="#AnnotateApp.normalize_image-2608"><span class="linenos">2608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp.normalize_image-2609"><a href="#AnnotateApp.normalize_image-2609"><span class="linenos">2609</span></a><span class="sd">        Normalize an image based on specific channels (R, G, B).</span>
</span><span id="AnnotateApp.normalize_image-2610"><a href="#AnnotateApp.normalize_image-2610"><span class="linenos">2610</span></a>
</span><span id="AnnotateApp.normalize_image-2611"><a href="#AnnotateApp.normalize_image-2611"><span class="linenos">2611</span></a><span class="sd">        Args:</span>
</span><span id="AnnotateApp.normalize_image-2612"><a href="#AnnotateApp.normalize_image-2612"><span class="linenos">2612</span></a><span class="sd">            img (PIL.Image or np.array): Input image.</span>
</span><span id="AnnotateApp.normalize_image-2613"><a href="#AnnotateApp.normalize_image-2613"><span class="linenos">2613</span></a><span class="sd">            normalize (bool): Whether to normalize the image or not.</span>
</span><span id="AnnotateApp.normalize_image-2614"><a href="#AnnotateApp.normalize_image-2614"><span class="linenos">2614</span></a><span class="sd">            percentiles (tuple): Percentiles to use for intensity rescaling.</span>
</span><span id="AnnotateApp.normalize_image-2615"><a href="#AnnotateApp.normalize_image-2615"><span class="linenos">2615</span></a><span class="sd">            normalize_channels (list): List of channels to normalize. E.g., [&#39;r&#39;, &#39;g&#39;, &#39;b&#39;], [&#39;r&#39;], [&#39;g&#39;], etc.</span>
</span><span id="AnnotateApp.normalize_image-2616"><a href="#AnnotateApp.normalize_image-2616"><span class="linenos">2616</span></a>
</span><span id="AnnotateApp.normalize_image-2617"><a href="#AnnotateApp.normalize_image-2617"><span class="linenos">2617</span></a><span class="sd">        Returns:</span>
</span><span id="AnnotateApp.normalize_image-2618"><a href="#AnnotateApp.normalize_image-2618"><span class="linenos">2618</span></a><span class="sd">            PIL.Image: Normalized image.</span>
</span><span id="AnnotateApp.normalize_image-2619"><a href="#AnnotateApp.normalize_image-2619"><span class="linenos">2619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AnnotateApp.normalize_image-2620"><a href="#AnnotateApp.normalize_image-2620"><span class="linenos">2620</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="AnnotateApp.normalize_image-2621"><a href="#AnnotateApp.normalize_image-2621"><span class="linenos">2621</span></a>
</span><span id="AnnotateApp.normalize_image-2622"><a href="#AnnotateApp.normalize_image-2622"><span class="linenos">2622</span></a>        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
</span><span id="AnnotateApp.normalize_image-2623"><a href="#AnnotateApp.normalize_image-2623"><span class="linenos">2623</span></a>            <span class="k">if</span> <span class="n">img_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Grayscale image</span>
</span><span id="AnnotateApp.normalize_image-2624"><a href="#AnnotateApp.normalize_image-2624"><span class="linenos">2624</span></a>                <span class="n">p2</span><span class="p">,</span> <span class="n">p98</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">)</span>
</span><span id="AnnotateApp.normalize_image-2625"><a href="#AnnotateApp.normalize_image-2625"><span class="linenos">2625</span></a>                <span class="n">img_array</span> <span class="o">=</span> <span class="n">rescale_intensity</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">in_range</span><span class="o">=</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p98</span><span class="p">),</span> <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="AnnotateApp.normalize_image-2626"><a href="#AnnotateApp.normalize_image-2626"><span class="linenos">2626</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Color image or multi-channel image</span>
</span><span id="AnnotateApp.normalize_image-2627"><a href="#AnnotateApp.normalize_image-2627"><span class="linenos">2627</span></a>                <span class="c1"># Create a map for the color channels</span>
</span><span id="AnnotateApp.normalize_image-2628"><a href="#AnnotateApp.normalize_image-2628"><span class="linenos">2628</span></a>                <span class="n">channel_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span><span id="AnnotateApp.normalize_image-2629"><a href="#AnnotateApp.normalize_image-2629"><span class="linenos">2629</span></a>                
</span><span id="AnnotateApp.normalize_image-2630"><a href="#AnnotateApp.normalize_image-2630"><span class="linenos">2630</span></a>                <span class="c1"># If normalize_channels is not specified, normalize all channels</span>
</span><span id="AnnotateApp.normalize_image-2631"><a href="#AnnotateApp.normalize_image-2631"><span class="linenos">2631</span></a>                <span class="k">if</span> <span class="n">normalize_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp.normalize_image-2632"><a href="#AnnotateApp.normalize_image-2632"><span class="linenos">2632</span></a>                    <span class="n">normalize_channels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.normalize_image-2633"><a href="#AnnotateApp.normalize_image-2633"><span class="linenos">2633</span></a>                
</span><span id="AnnotateApp.normalize_image-2634"><a href="#AnnotateApp.normalize_image-2634"><span class="linenos">2634</span></a>                <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">normalize_channels</span><span class="p">:</span>
</span><span id="AnnotateApp.normalize_image-2635"><a href="#AnnotateApp.normalize_image-2635"><span class="linenos">2635</span></a>                    <span class="k">if</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channel_map</span><span class="p">:</span>
</span><span id="AnnotateApp.normalize_image-2636"><a href="#AnnotateApp.normalize_image-2636"><span class="linenos">2636</span></a>                        <span class="n">channel_idx</span> <span class="o">=</span> <span class="n">channel_map</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
</span><span id="AnnotateApp.normalize_image-2637"><a href="#AnnotateApp.normalize_image-2637"><span class="linenos">2637</span></a>                        <span class="n">p2</span><span class="p">,</span> <span class="n">p98</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">],</span> <span class="n">percentiles</span><span class="p">)</span>
</span><span id="AnnotateApp.normalize_image-2638"><a href="#AnnotateApp.normalize_image-2638"><span class="linenos">2638</span></a>                        <span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rescale_intensity</span><span class="p">(</span><span class="n">img_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">channel_idx</span><span class="p">],</span> <span class="n">in_range</span><span class="o">=</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p98</span><span class="p">),</span> <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="AnnotateApp.normalize_image-2639"><a href="#AnnotateApp.normalize_image-2639"><span class="linenos">2639</span></a>
</span><span id="AnnotateApp.normalize_image-2640"><a href="#AnnotateApp.normalize_image-2640"><span class="linenos">2640</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.normalize_image-2641"><a href="#AnnotateApp.normalize_image-2641"><span class="linenos">2641</span></a>
</span><span id="AnnotateApp.normalize_image-2642"><a href="#AnnotateApp.normalize_image-2642"><span class="linenos">2642</span></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img_array</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Normalize an image based on specific channels (R, G, B).</p>

<p>Args:
    img (PIL.Image or np.array): Input image.
    normalize (bool): Whether to normalize the image or not.
    percentiles (tuple): Percentiles to use for intensity rescaling.
    normalize_channels (list): List of channels to normalize. E.g., ['r', 'g', 'b'], ['r'], ['g'], etc.</p>

<p>Returns:
    PIL.Image: Normalized image.</p>
</div>


                            </div>
                            <div id="AnnotateApp.add_colored_border" class="classattr">
                                        <input id="AnnotateApp.add_colored_border-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_colored_border</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">img</span>, </span><span class="param"><span class="n">border_width</span>, </span><span class="param"><span class="n">border_color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.add_colored_border-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.add_colored_border"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.add_colored_border-2645"><a href="#AnnotateApp.add_colored_border-2645"><span class="linenos">2645</span></a>    <span class="k">def</span> <span class="nf">add_colored_border</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">border_color</span><span class="p">):</span>
</span><span id="AnnotateApp.add_colored_border-2646"><a href="#AnnotateApp.add_colored_border-2646"><span class="linenos">2646</span></a>        <span class="n">top_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp.add_colored_border-2647"><a href="#AnnotateApp.add_colored_border-2647"><span class="linenos">2647</span></a>        <span class="n">bottom_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp.add_colored_border-2648"><a href="#AnnotateApp.add_colored_border-2648"><span class="linenos">2648</span></a>        <span class="n">left_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp.add_colored_border-2649"><a href="#AnnotateApp.add_colored_border-2649"><span class="linenos">2649</span></a>        <span class="n">right_border</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
</span><span id="AnnotateApp.add_colored_border-2650"><a href="#AnnotateApp.add_colored_border-2650"><span class="linenos">2650</span></a>
</span><span id="AnnotateApp.add_colored_border-2651"><a href="#AnnotateApp.add_colored_border-2651"><span class="linenos">2651</span></a>        <span class="n">bordered_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">border_width</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="AnnotateApp.add_colored_border-2652"><a href="#AnnotateApp.add_colored_border-2652"><span class="linenos">2652</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">top_border</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="AnnotateApp.add_colored_border-2653"><a href="#AnnotateApp.add_colored_border-2653"><span class="linenos">2653</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">bottom_border</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp.add_colored_border-2654"><a href="#AnnotateApp.add_colored_border-2654"><span class="linenos">2654</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">left_border</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp.add_colored_border-2655"><a href="#AnnotateApp.add_colored_border-2655"><span class="linenos">2655</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">right_border</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">border_width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp.add_colored_border-2656"><a href="#AnnotateApp.add_colored_border-2656"><span class="linenos">2656</span></a>        <span class="n">bordered_img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">border_width</span><span class="p">,</span> <span class="n">border_width</span><span class="p">))</span>
</span><span id="AnnotateApp.add_colored_border-2657"><a href="#AnnotateApp.add_colored_border-2657"><span class="linenos">2657</span></a>
</span><span id="AnnotateApp.add_colored_border-2658"><a href="#AnnotateApp.add_colored_border-2658"><span class="linenos">2658</span></a>        <span class="k">return</span> <span class="n">bordered_img</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.filter_channels" class="classattr">
                                        <input id="AnnotateApp.filter_channels-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_channels</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">img</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.filter_channels-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.filter_channels"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.filter_channels-2660"><a href="#AnnotateApp.filter_channels-2660"><span class="linenos">2660</span></a>    <span class="k">def</span> <span class="nf">filter_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
</span><span id="AnnotateApp.filter_channels-2661"><a href="#AnnotateApp.filter_channels-2661"><span class="linenos">2661</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="AnnotateApp.filter_channels-2662"><a href="#AnnotateApp.filter_channels-2662"><span class="linenos">2662</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp.filter_channels-2663"><a href="#AnnotateApp.filter_channels-2663"><span class="linenos">2663</span></a>            <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp.filter_channels-2664"><a href="#AnnotateApp.filter_channels-2664"><span class="linenos">2664</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="AnnotateApp.filter_channels-2665"><a href="#AnnotateApp.filter_channels-2665"><span class="linenos">2665</span></a>            <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp.filter_channels-2666"><a href="#AnnotateApp.filter_channels-2666"><span class="linenos">2666</span></a>                <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="AnnotateApp.filter_channels-2667"><a href="#AnnotateApp.filter_channels-2667"><span class="linenos">2667</span></a>            <span class="k">if</span> <span class="s1">&#39;b&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
</span><span id="AnnotateApp.filter_channels-2668"><a href="#AnnotateApp.filter_channels-2668"><span class="linenos">2668</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="AnnotateApp.filter_channels-2669"><a href="#AnnotateApp.filter_channels-2669"><span class="linenos">2669</span></a>
</span><span id="AnnotateApp.filter_channels-2670"><a href="#AnnotateApp.filter_channels-2670"><span class="linenos">2670</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AnnotateApp.filter_channels-2671"><a href="#AnnotateApp.filter_channels-2671"><span class="linenos">2671</span></a>                <span class="n">channel_img</span> <span class="o">=</span> <span class="n">r</span> <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="p">(</span><span class="n">g</span> <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="k">else</span> <span class="n">b</span><span class="p">)</span>
</span><span id="AnnotateApp.filter_channels-2672"><a href="#AnnotateApp.filter_channels-2672"><span class="linenos">2672</span></a>                <span class="k">return</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">grayscale</span><span class="p">(</span><span class="n">channel_img</span><span class="p">)</span>
</span><span id="AnnotateApp.filter_channels-2673"><a href="#AnnotateApp.filter_channels-2673"><span class="linenos">2673</span></a>
</span><span id="AnnotateApp.filter_channels-2674"><a href="#AnnotateApp.filter_channels-2674"><span class="linenos">2674</span></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.get_on_image_click" class="classattr">
                                        <input id="AnnotateApp.get_on_image_click-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_on_image_click</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span>, </span><span class="param"><span class="n">label</span>, </span><span class="param"><span class="n">img</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.get_on_image_click-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.get_on_image_click"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.get_on_image_click-2676"><a href="#AnnotateApp.get_on_image_click-2676"><span class="linenos">2676</span></a>    <span class="k">def</span> <span class="nf">get_on_image_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
</span><span id="AnnotateApp.get_on_image_click-2677"><a href="#AnnotateApp.get_on_image_click-2677"><span class="linenos">2677</span></a>        <span class="k">def</span> <span class="nf">on_image_click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="AnnotateApp.get_on_image_click-2678"><a href="#AnnotateApp.get_on_image_click-2678"><span class="linenos">2678</span></a>            <span class="n">new_annotation</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AnnotateApp.get_on_image_click-2679"><a href="#AnnotateApp.get_on_image_click-2679"><span class="linenos">2679</span></a>            
</span><span id="AnnotateApp.get_on_image_click-2680"><a href="#AnnotateApp.get_on_image_click-2680"><span class="linenos">2680</span></a>            <span class="n">original_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_to_original_paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="AnnotateApp.get_on_image_click-2681"><a href="#AnnotateApp.get_on_image_click-2681"><span class="linenos">2681</span></a>            
</span><span id="AnnotateApp.get_on_image_click-2682"><a href="#AnnotateApp.get_on_image_click-2682"><span class="linenos">2682</span></a>            <span class="k">if</span> <span class="n">original_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_annotation</span><span class="p">:</span>
</span><span id="AnnotateApp.get_on_image_click-2683"><a href="#AnnotateApp.get_on_image_click-2683"><span class="linenos">2683</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp.get_on_image_click-2684"><a href="#AnnotateApp.get_on_image_click-2684"><span class="linenos">2684</span></a>                <span class="n">new_annotation</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AnnotateApp.get_on_image_click-2685"><a href="#AnnotateApp.get_on_image_click-2685"><span class="linenos">2685</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.get_on_image_click-2686"><a href="#AnnotateApp.get_on_image_click-2686"><span class="linenos">2686</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">[</span><span class="n">original_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_annotation</span>
</span><span id="AnnotateApp.get_on_image_click-2687"><a href="#AnnotateApp.get_on_image_click-2687"><span class="linenos">2687</span></a>            
</span><span id="AnnotateApp.get_on_image_click-2688"><a href="#AnnotateApp.get_on_image_click-2688"><span class="linenos">2688</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> annotated: </span><span class="si">{</span><span class="n">new_annotation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.get_on_image_click-2689"><a href="#AnnotateApp.get_on_image_click-2689"><span class="linenos">2689</span></a>            
</span><span id="AnnotateApp.get_on_image_click-2690"><a href="#AnnotateApp.get_on_image_click-2690"><span class="linenos">2690</span></a>            <span class="n">img_</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
</span><span id="AnnotateApp.get_on_image_click-2691"><a href="#AnnotateApp.get_on_image_click-2691"><span class="linenos">2691</span></a>            <span class="n">border_fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_color</span> <span class="k">if</span> <span class="n">new_annotation</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">new_annotation</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AnnotateApp.get_on_image_click-2692"><a href="#AnnotateApp.get_on_image_click-2692"><span class="linenos">2692</span></a>            <span class="n">img_</span> <span class="o">=</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">img_</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">border_fill</span><span class="p">)</span> <span class="k">if</span> <span class="n">border_fill</span> <span class="k">else</span> <span class="n">img_</span>
</span><span id="AnnotateApp.get_on_image_click-2693"><a href="#AnnotateApp.get_on_image_click-2693"><span class="linenos">2693</span></a>
</span><span id="AnnotateApp.get_on_image_click-2694"><a href="#AnnotateApp.get_on_image_click-2694"><span class="linenos">2694</span></a>            <span class="n">photo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img_</span><span class="p">)</span>
</span><span id="AnnotateApp.get_on_image_click-2695"><a href="#AnnotateApp.get_on_image_click-2695"><span class="linenos">2695</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">photo</span>
</span><span id="AnnotateApp.get_on_image_click-2696"><a href="#AnnotateApp.get_on_image_click-2696"><span class="linenos">2696</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">photo</span><span class="p">)</span>
</span><span id="AnnotateApp.get_on_image_click-2697"><a href="#AnnotateApp.get_on_image_click-2697"><span class="linenos">2697</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="AnnotateApp.get_on_image_click-2698"><a href="#AnnotateApp.get_on_image_click-2698"><span class="linenos">2698</span></a>
</span><span id="AnnotateApp.get_on_image_click-2699"><a href="#AnnotateApp.get_on_image_click-2699"><span class="linenos">2699</span></a>        <span class="k">return</span> <span class="n">on_image_click</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.update_html" class="classattr">
                                        <input id="AnnotateApp.update_html-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">update_html</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">text</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.update_html-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.update_html"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.update_html-2701"><a href="#AnnotateApp.update_html-2701"><span class="linenos">2701</span></a>    <span class="nd">@staticmethod</span>
</span><span id="AnnotateApp.update_html-2702"><a href="#AnnotateApp.update_html-2702"><span class="linenos">2702</span></a>    <span class="k">def</span> <span class="nf">update_html</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span><span id="AnnotateApp.update_html-2703"><a href="#AnnotateApp.update_html-2703"><span class="linenos">2703</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp.update_html-2704"><a href="#AnnotateApp.update_html-2704"><span class="linenos">2704</span></a><span class="s2">        &lt;script&gt;</span>
</span><span id="AnnotateApp.update_html-2705"><a href="#AnnotateApp.update_html-2705"><span class="linenos">2705</span></a><span class="s2">        document.getElementById(&#39;unique_id&#39;).innerHTML = &#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;;</span>
</span><span id="AnnotateApp.update_html-2706"><a href="#AnnotateApp.update_html-2706"><span class="linenos">2706</span></a><span class="s2">        &lt;/script&gt;</span>
</span><span id="AnnotateApp.update_html-2707"><a href="#AnnotateApp.update_html-2707"><span class="linenos">2707</span></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.update_database_worker" class="classattr">
                                        <input id="AnnotateApp.update_database_worker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_database_worker</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.update_database_worker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.update_database_worker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.update_database_worker-2709"><a href="#AnnotateApp.update_database_worker-2709"><span class="linenos">2709</span></a>    <span class="k">def</span> <span class="nf">update_database_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.update_database_worker-2710"><a href="#AnnotateApp.update_database_worker-2710"><span class="linenos">2710</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp.update_database_worker-2711"><a href="#AnnotateApp.update_database_worker-2711"><span class="linenos">2711</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp.update_database_worker-2712"><a href="#AnnotateApp.update_database_worker-2712"><span class="linenos">2712</span></a>
</span><span id="AnnotateApp.update_database_worker-2713"><a href="#AnnotateApp.update_database_worker-2713"><span class="linenos">2713</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;div id=&#39;unique_id&#39;&gt;Initial Text&lt;/div&gt;&quot;</span><span class="p">))</span>
</span><span id="AnnotateApp.update_database_worker-2714"><a href="#AnnotateApp.update_database_worker-2714"><span class="linenos">2714</span></a>
</span><span id="AnnotateApp.update_database_worker-2715"><a href="#AnnotateApp.update_database_worker-2715"><span class="linenos">2715</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="AnnotateApp.update_database_worker-2716"><a href="#AnnotateApp.update_database_worker-2716"><span class="linenos">2716</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">:</span>
</span><span id="AnnotateApp.update_database_worker-2717"><a href="#AnnotateApp.update_database_worker-2717"><span class="linenos">2717</span></a>                <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AnnotateApp.update_database_worker-2718"><a href="#AnnotateApp.update_database_worker-2718"><span class="linenos">2718</span></a>                <span class="k">break</span>
</span><span id="AnnotateApp.update_database_worker-2719"><a href="#AnnotateApp.update_database_worker-2719"><span class="linenos">2719</span></a>
</span><span id="AnnotateApp.update_database_worker-2720"><a href="#AnnotateApp.update_database_worker-2720"><span class="linenos">2720</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="AnnotateApp.update_database_worker-2721"><a href="#AnnotateApp.update_database_worker-2721"><span class="linenos">2721</span></a>                <span class="n">AnnotateApp</span><span class="o">.</span><span class="n">update_html</span><span class="p">(</span><span class="s2">&quot;Do not exit, Updating database...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.update_database_worker-2722"><a href="#AnnotateApp.update_database_worker-2722"><span class="linenos">2722</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Do not exit, Updating database...&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.update_database_worker-2723"><a href="#AnnotateApp.update_database_worker-2723"><span class="linenos">2723</span></a>
</span><span id="AnnotateApp.update_database_worker-2724"><a href="#AnnotateApp.update_database_worker-2724"><span class="linenos">2724</span></a>                <span class="n">pending_updates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="AnnotateApp.update_database_worker-2725"><a href="#AnnotateApp.update_database_worker-2725"><span class="linenos">2725</span></a>                <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">new_annotation</span> <span class="ow">in</span> <span class="n">pending_updates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AnnotateApp.update_database_worker-2726"><a href="#AnnotateApp.update_database_worker-2726"><span class="linenos">2726</span></a>                    <span class="k">if</span> <span class="n">new_annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AnnotateApp.update_database_worker-2727"><a href="#AnnotateApp.update_database_worker-2727"><span class="linenos">2727</span></a>                        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UPDATE png_list SET </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s1"> = NULL WHERE png_path = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">path</span><span class="p">,))</span>
</span><span id="AnnotateApp.update_database_worker-2728"><a href="#AnnotateApp.update_database_worker-2728"><span class="linenos">2728</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.update_database_worker-2729"><a href="#AnnotateApp.update_database_worker-2729"><span class="linenos">2729</span></a>                        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UPDATE png_list SET </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s1"> = ? WHERE png_path = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">new_annotation</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="AnnotateApp.update_database_worker-2730"><a href="#AnnotateApp.update_database_worker-2730"><span class="linenos">2730</span></a>                <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="AnnotateApp.update_database_worker-2731"><a href="#AnnotateApp.update_database_worker-2731"><span class="linenos">2731</span></a>
</span><span id="AnnotateApp.update_database_worker-2732"><a href="#AnnotateApp.update_database_worker-2732"><span class="linenos">2732</span></a>                <span class="n">AnnotateApp</span><span class="o">.</span><span class="n">update_html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.update_database_worker-2733"><a href="#AnnotateApp.update_database_worker-2733"><span class="linenos">2733</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.update_database_worker-2734"><a href="#AnnotateApp.update_database_worker-2734"><span class="linenos">2734</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="AnnotateApp.update_database_worker-2735"><a href="#AnnotateApp.update_database_worker-2735"><span class="linenos">2735</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.update_gui_text" class="classattr">
                                        <input id="AnnotateApp.update_gui_text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_gui_text</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">text</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.update_gui_text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.update_gui_text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.update_gui_text-2737"><a href="#AnnotateApp.update_gui_text-2737"><span class="linenos">2737</span></a>    <span class="k">def</span> <span class="nf">update_gui_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span><span id="AnnotateApp.update_gui_text-2738"><a href="#AnnotateApp.update_gui_text-2738"><span class="linenos">2738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span><span id="AnnotateApp.update_gui_text-2739"><a href="#AnnotateApp.update_gui_text-2739"><span class="linenos">2739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.next_page" class="classattr">
                                        <input id="AnnotateApp.next_page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.next_page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.next_page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.next_page-2741"><a href="#AnnotateApp.next_page-2741"><span class="linenos">2741</span></a>    <span class="k">def</span> <span class="nf">next_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.next_page-2742"><a href="#AnnotateApp.next_page-2742"><span class="linenos">2742</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="AnnotateApp.next_page-2743"><a href="#AnnotateApp.next_page-2743"><span class="linenos">2743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="AnnotateApp.next_page-2744"><a href="#AnnotateApp.next_page-2744"><span class="linenos">2744</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp.next_page-2745"><a href="#AnnotateApp.next_page-2745"><span class="linenos">2745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span>
</span><span id="AnnotateApp.next_page-2746"><a href="#AnnotateApp.next_page-2746"><span class="linenos">2746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>  <span class="c1"># Re-fetch annotations from the database</span>
</span><span id="AnnotateApp.next_page-2747"><a href="#AnnotateApp.next_page-2747"><span class="linenos">2747</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.previous_page" class="classattr">
                                        <input id="AnnotateApp.previous_page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">previous_page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.previous_page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.previous_page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.previous_page-2749"><a href="#AnnotateApp.previous_page-2749"><span class="linenos">2749</span></a>    <span class="k">def</span> <span class="nf">previous_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.previous_page-2750"><a href="#AnnotateApp.previous_page-2750"><span class="linenos">2750</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="AnnotateApp.previous_page-2751"><a href="#AnnotateApp.previous_page-2751"><span class="linenos">2751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="AnnotateApp.previous_page-2752"><a href="#AnnotateApp.previous_page-2752"><span class="linenos">2752</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp.previous_page-2753"><a href="#AnnotateApp.previous_page-2753"><span class="linenos">2753</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_cols</span>
</span><span id="AnnotateApp.previous_page-2754"><a href="#AnnotateApp.previous_page-2754"><span class="linenos">2754</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AnnotateApp.previous_page-2755"><a href="#AnnotateApp.previous_page-2755"><span class="linenos">2755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AnnotateApp.previous_page-2756"><a href="#AnnotateApp.previous_page-2756"><span class="linenos">2756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prefilter_paths_annotations</span><span class="p">()</span>  <span class="c1"># Re-fetch annotations from the database</span>
</span><span id="AnnotateApp.previous_page-2757"><a href="#AnnotateApp.previous_page-2757"><span class="linenos">2757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.shutdown" class="classattr">
                                        <input id="AnnotateApp.shutdown-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">shutdown</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.shutdown-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.shutdown"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.shutdown-2759"><a href="#AnnotateApp.shutdown-2759"><span class="linenos">2759</span></a>    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.shutdown-2760"><a href="#AnnotateApp.shutdown-2760"><span class="linenos">2760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="AnnotateApp.shutdown-2761"><a href="#AnnotateApp.shutdown-2761"><span class="linenos">2761</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="AnnotateApp.shutdown-2762"><a href="#AnnotateApp.shutdown-2762"><span class="linenos">2762</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="p">:</span>
</span><span id="AnnotateApp.shutdown-2763"><a href="#AnnotateApp.shutdown-2763"><span class="linenos">2763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pending_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="AnnotateApp.shutdown-2764"><a href="#AnnotateApp.shutdown-2764"><span class="linenos">2764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db_update_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="AnnotateApp.shutdown-2765"><a href="#AnnotateApp.shutdown-2765"><span class="linenos">2765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span><span id="AnnotateApp.shutdown-2766"><a href="#AnnotateApp.shutdown-2766"><span class="linenos">2766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</span><span id="AnnotateApp.shutdown-2767"><a href="#AnnotateApp.shutdown-2767"><span class="linenos">2767</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Quit application&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.shutdown-2768"><a href="#AnnotateApp.shutdown-2768"><span class="linenos">2768</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.shutdown-2769"><a href="#AnnotateApp.shutdown-2769"><span class="linenos">2769</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting for pending updates to finish before quitting&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AnnotateApp.train_and_classify" class="classattr">
                                        <input id="AnnotateApp.train_and_classify-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">train_and_classify</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AnnotateApp.train_and_classify-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AnnotateApp.train_and_classify"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AnnotateApp.train_and_classify-2771"><a href="#AnnotateApp.train_and_classify-2771"><span class="linenos">2771</span></a>    <span class="k">def</span> <span class="nf">train_and_classify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AnnotateApp.train_and_classify-2772"><a href="#AnnotateApp.train_and_classify-2772"><span class="linenos">2772</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp.train_and_classify-2773"><a href="#AnnotateApp.train_and_classify-2773"><span class="linenos">2773</span></a><span class="sd">        1) Merge data from the relevant DB tables (including png_list).</span>
</span><span id="AnnotateApp.train_and_classify-2774"><a href="#AnnotateApp.train_and_classify-2774"><span class="linenos">2774</span></a><span class="sd">        2) Collect manual annotations from png_list.&lt;annotation_column&gt; =&gt; &#39;manual_annotation&#39;.</span>
</span><span id="AnnotateApp.train_and_classify-2775"><a href="#AnnotateApp.train_and_classify-2775"><span class="linenos">2775</span></a><span class="sd">           - 1 =&gt; class=1, 2 =&gt; class=0 (for training).</span>
</span><span id="AnnotateApp.train_and_classify-2776"><a href="#AnnotateApp.train_and_classify-2776"><span class="linenos">2776</span></a><span class="sd">        3) If only one class is present, randomly sample unannotated images as the other class.</span>
</span><span id="AnnotateApp.train_and_classify-2777"><a href="#AnnotateApp.train_and_classify-2777"><span class="linenos">2777</span></a><span class="sd">        4) Train an XGBoost model.</span>
</span><span id="AnnotateApp.train_and_classify-2778"><a href="#AnnotateApp.train_and_classify-2778"><span class="linenos">2778</span></a><span class="sd">        5) Classify *all* rows -&gt; fill XGboost_score (prob of class=1) &amp; XGboost_annotation (1 or 2 if high confidence).</span>
</span><span id="AnnotateApp.train_and_classify-2779"><a href="#AnnotateApp.train_and_classify-2779"><span class="linenos">2779</span></a><span class="sd">        6) Write those columns back to sqlite, so every row in png_list has a score (and possibly an annotation).</span>
</span><span id="AnnotateApp.train_and_classify-2780"><a href="#AnnotateApp.train_and_classify-2780"><span class="linenos">2780</span></a><span class="sd">        7) Refresh the UI (prefilter_paths_annotations + load_images).</span>
</span><span id="AnnotateApp.train_and_classify-2781"><a href="#AnnotateApp.train_and_classify-2781"><span class="linenos">2781</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AnnotateApp.train_and_classify-2782"><a href="#AnnotateApp.train_and_classify-2782"><span class="linenos">2782</span></a>
</span><span id="AnnotateApp.train_and_classify-2783"><a href="#AnnotateApp.train_and_classify-2783"><span class="linenos">2783</span></a>        <span class="c1"># Optionally, update your GUI status label</span>
</span><span id="AnnotateApp.train_and_classify-2784"><a href="#AnnotateApp.train_and_classify-2784"><span class="linenos">2784</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Merging data...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2785"><a href="#AnnotateApp.train_and_classify-2785"><span class="linenos">2785</span></a>
</span><span id="AnnotateApp.train_and_classify-2786"><a href="#AnnotateApp.train_and_classify-2786"><span class="linenos">2786</span></a>        <span class="kn">from</span> <span class="nn">spacr.io</span> <span class="kn">import</span> <span class="n">_read_and_merge_data</span>  <span class="c1"># Adapt to your actual import</span>
</span><span id="AnnotateApp.train_and_classify-2787"><a href="#AnnotateApp.train_and_classify-2787"><span class="linenos">2787</span></a>
</span><span id="AnnotateApp.train_and_classify-2788"><a href="#AnnotateApp.train_and_classify-2788"><span class="linenos">2788</span></a>        <span class="c1"># (1) Merge data</span>
</span><span id="AnnotateApp.train_and_classify-2789"><a href="#AnnotateApp.train_and_classify-2789"><span class="linenos">2789</span></a>        <span class="n">merged_df</span><span class="p">,</span> <span class="n">obj_df_ls</span> <span class="o">=</span> <span class="n">_read_and_merge_data</span><span class="p">(</span>
</span><span id="AnnotateApp.train_and_classify-2790"><a href="#AnnotateApp.train_and_classify-2790"><span class="linenos">2790</span></a>            <span class="n">locs</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">],</span>
</span><span id="AnnotateApp.train_and_classify-2791"><a href="#AnnotateApp.train_and_classify-2791"><span class="linenos">2791</span></a>            <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;cytoplasm&#39;</span><span class="p">,</span> <span class="s1">&#39;nucleus&#39;</span><span class="p">,</span> <span class="s1">&#39;pathogen&#39;</span><span class="p">,</span> <span class="s1">&#39;png_list&#39;</span><span class="p">],</span>
</span><span id="AnnotateApp.train_and_classify-2792"><a href="#AnnotateApp.train_and_classify-2792"><span class="linenos">2792</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
</span><span id="AnnotateApp.train_and_classify-2793"><a href="#AnnotateApp.train_and_classify-2793"><span class="linenos">2793</span></a>        <span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2794"><a href="#AnnotateApp.train_and_classify-2794"><span class="linenos">2794</span></a>
</span><span id="AnnotateApp.train_and_classify-2795"><a href="#AnnotateApp.train_and_classify-2795"><span class="linenos">2795</span></a>        <span class="c1"># (2) Load manual annotations from the DB</span>
</span><span id="AnnotateApp.train_and_classify-2796"><a href="#AnnotateApp.train_and_classify-2796"><span class="linenos">2796</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2797"><a href="#AnnotateApp.train_and_classify-2797"><span class="linenos">2797</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2798"><a href="#AnnotateApp.train_and_classify-2798"><span class="linenos">2798</span></a>        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT png_path, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> FROM png_list WHERE </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span><span class="si">}</span><span class="s2"> IS NOT NULL&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2799"><a href="#AnnotateApp.train_and_classify-2799"><span class="linenos">2799</span></a>        <span class="n">annotated_rows</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  <span class="c1"># e.g. [(png_path, 1 or 2), ...]</span>
</span><span id="AnnotateApp.train_and_classify-2800"><a href="#AnnotateApp.train_and_classify-2800"><span class="linenos">2800</span></a>        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2801"><a href="#AnnotateApp.train_and_classify-2801"><span class="linenos">2801</span></a>
</span><span id="AnnotateApp.train_and_classify-2802"><a href="#AnnotateApp.train_and_classify-2802"><span class="linenos">2802</span></a>        <span class="c1"># dict {png_path -&gt; 1 or 2}</span>
</span><span id="AnnotateApp.train_and_classify-2803"><a href="#AnnotateApp.train_and_classify-2803"><span class="linenos">2803</span></a>        <span class="n">annot_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">annotated_rows</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2804"><a href="#AnnotateApp.train_and_classify-2804"><span class="linenos">2804</span></a>
</span><span id="AnnotateApp.train_and_classify-2805"><a href="#AnnotateApp.train_and_classify-2805"><span class="linenos">2805</span></a>        <span class="c1"># Add &#39;manual_annotation&#39; to merged_df</span>
</span><span id="AnnotateApp.train_and_classify-2806"><a href="#AnnotateApp.train_and_classify-2806"><span class="linenos">2806</span></a>        <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">annot_dict</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2807"><a href="#AnnotateApp.train_and_classify-2807"><span class="linenos">2807</span></a>
</span><span id="AnnotateApp.train_and_classify-2808"><a href="#AnnotateApp.train_and_classify-2808"><span class="linenos">2808</span></a>        <span class="c1"># Subset with manual labels</span>
</span><span id="AnnotateApp.train_and_classify-2809"><a href="#AnnotateApp.train_and_classify-2809"><span class="linenos">2809</span></a>        <span class="n">annotated_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2810"><a href="#AnnotateApp.train_and_classify-2810"><span class="linenos">2810</span></a>        <span class="c1"># Convert &quot;2&quot; =&gt; &quot;0&quot; for binary classification</span>
</span><span id="AnnotateApp.train_and_classify-2811"><a href="#AnnotateApp.train_and_classify-2811"><span class="linenos">2811</span></a>        <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2812"><a href="#AnnotateApp.train_and_classify-2812"><span class="linenos">2812</span></a>
</span><span id="AnnotateApp.train_and_classify-2813"><a href="#AnnotateApp.train_and_classify-2813"><span class="linenos">2813</span></a>        <span class="c1"># (3) Handle single-class scenario</span>
</span><span id="AnnotateApp.train_and_classify-2814"><a href="#AnnotateApp.train_and_classify-2814"><span class="linenos">2814</span></a>        <span class="n">class_counts</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2815"><a href="#AnnotateApp.train_and_classify-2815"><span class="linenos">2815</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2816"><a href="#AnnotateApp.train_and_classify-2816"><span class="linenos">2816</span></a>            <span class="n">single_class</span> <span class="o">=</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 0 or 1</span>
</span><span id="AnnotateApp.train_and_classify-2817"><a href="#AnnotateApp.train_and_classify-2817"><span class="linenos">2817</span></a>            <span class="n">needed</span> <span class="o">=</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2818"><a href="#AnnotateApp.train_and_classify-2818"><span class="linenos">2818</span></a>            <span class="n">other_class</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">single_class</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="AnnotateApp.train_and_classify-2819"><a href="#AnnotateApp.train_and_classify-2819"><span class="linenos">2819</span></a>
</span><span id="AnnotateApp.train_and_classify-2820"><a href="#AnnotateApp.train_and_classify-2820"><span class="linenos">2820</span></a>            <span class="n">unannotated_df_all</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2821"><a href="#AnnotateApp.train_and_classify-2821"><span class="linenos">2821</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unannotated_df_all</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2822"><a href="#AnnotateApp.train_and_classify-2822"><span class="linenos">2822</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No unannotated rows to sample for the other class. Cannot proceed.&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2823"><a href="#AnnotateApp.train_and_classify-2823"><span class="linenos">2823</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Not enough data to train (no second class).&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2824"><a href="#AnnotateApp.train_and_classify-2824"><span class="linenos">2824</span></a>                <span class="k">return</span>
</span><span id="AnnotateApp.train_and_classify-2825"><a href="#AnnotateApp.train_and_classify-2825"><span class="linenos">2825</span></a>
</span><span id="AnnotateApp.train_and_classify-2826"><a href="#AnnotateApp.train_and_classify-2826"><span class="linenos">2826</span></a>            <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">needed</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unannotated_df_all</span><span class="p">))</span>
</span><span id="AnnotateApp.train_and_classify-2827"><a href="#AnnotateApp.train_and_classify-2827"><span class="linenos">2827</span></a>            <span class="n">artificially_labeled</span> <span class="o">=</span> <span class="n">unannotated_df_all</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2828"><a href="#AnnotateApp.train_and_classify-2828"><span class="linenos">2828</span></a>            <span class="n">artificially_labeled</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_class</span>
</span><span id="AnnotateApp.train_and_classify-2829"><a href="#AnnotateApp.train_and_classify-2829"><span class="linenos">2829</span></a>
</span><span id="AnnotateApp.train_and_classify-2830"><a href="#AnnotateApp.train_and_classify-2830"><span class="linenos">2830</span></a>            <span class="n">annotated_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">annotated_df</span><span class="p">,</span> <span class="n">artificially_labeled</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2831"><a href="#AnnotateApp.train_and_classify-2831"><span class="linenos">2831</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only one class was present =&gt; randomly labeled </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2"> unannotated rows as </span><span class="si">{</span><span class="n">other_class</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2832"><a href="#AnnotateApp.train_and_classify-2832"><span class="linenos">2832</span></a>
</span><span id="AnnotateApp.train_and_classify-2833"><a href="#AnnotateApp.train_and_classify-2833"><span class="linenos">2833</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotated_df</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2834"><a href="#AnnotateApp.train_and_classify-2834"><span class="linenos">2834</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not enough annotated data to train (need at least 2).&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2835"><a href="#AnnotateApp.train_and_classify-2835"><span class="linenos">2835</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Not enough data to train.&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2836"><a href="#AnnotateApp.train_and_classify-2836"><span class="linenos">2836</span></a>            <span class="k">return</span>
</span><span id="AnnotateApp.train_and_classify-2837"><a href="#AnnotateApp.train_and_classify-2837"><span class="linenos">2837</span></a>
</span><span id="AnnotateApp.train_and_classify-2838"><a href="#AnnotateApp.train_and_classify-2838"><span class="linenos">2838</span></a>        <span class="c1"># (4) Train XGBoost</span>
</span><span id="AnnotateApp.train_and_classify-2839"><a href="#AnnotateApp.train_and_classify-2839"><span class="linenos">2839</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Training XGBoost model...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2840"><a href="#AnnotateApp.train_and_classify-2840"><span class="linenos">2840</span></a>
</span><span id="AnnotateApp.train_and_classify-2841"><a href="#AnnotateApp.train_and_classify-2841"><span class="linenos">2841</span></a>        <span class="c1"># Identify numeric columns</span>
</span><span id="AnnotateApp.train_and_classify-2842"><a href="#AnnotateApp.train_and_classify-2842"><span class="linenos">2842</span></a>        <span class="n">ignore_cols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;png_path&#39;</span><span class="p">,</span> <span class="s1">&#39;manual_annotation&#39;</span><span class="p">}</span>
</span><span id="AnnotateApp.train_and_classify-2843"><a href="#AnnotateApp.train_and_classify-2843"><span class="linenos">2843</span></a>        <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AnnotateApp.train_and_classify-2844"><a href="#AnnotateApp.train_and_classify-2844"><span class="linenos">2844</span></a>            <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">annotated_df</span><span class="o">.</span><span class="n">columns</span>
</span><span id="AnnotateApp.train_and_classify-2845"><a href="#AnnotateApp.train_and_classify-2845"><span class="linenos">2845</span></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore_cols</span>
</span><span id="AnnotateApp.train_and_classify-2846"><a href="#AnnotateApp.train_and_classify-2846"><span class="linenos">2846</span></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">annotated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span> <span class="ow">or</span> <span class="n">annotated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2847"><a href="#AnnotateApp.train_and_classify-2847"><span class="linenos">2847</span></a>        <span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2848"><a href="#AnnotateApp.train_and_classify-2848"><span class="linenos">2848</span></a>
</span><span id="AnnotateApp.train_and_classify-2849"><a href="#AnnotateApp.train_and_classify-2849"><span class="linenos">2849</span></a>        <span class="n">X_data</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="AnnotateApp.train_and_classify-2850"><a href="#AnnotateApp.train_and_classify-2850"><span class="linenos">2850</span></a>        <span class="n">y_data</span> <span class="o">=</span> <span class="n">annotated_df</span><span class="p">[</span><span class="s1">&#39;manual_annotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="AnnotateApp.train_and_classify-2851"><a href="#AnnotateApp.train_and_classify-2851"><span class="linenos">2851</span></a>
</span><span id="AnnotateApp.train_and_classify-2852"><a href="#AnnotateApp.train_and_classify-2852"><span class="linenos">2852</span></a>        <span class="c1"># standard train/test</span>
</span><span id="AnnotateApp.train_and_classify-2853"><a href="#AnnotateApp.train_and_classify-2853"><span class="linenos">2853</span></a>        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="AnnotateApp.train_and_classify-2854"><a href="#AnnotateApp.train_and_classify-2854"><span class="linenos">2854</span></a>            <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
</span><span id="AnnotateApp.train_and_classify-2855"><a href="#AnnotateApp.train_and_classify-2855"><span class="linenos">2855</span></a>        <span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2856"><a href="#AnnotateApp.train_and_classify-2856"><span class="linenos">2856</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2857"><a href="#AnnotateApp.train_and_classify-2857"><span class="linenos">2857</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2858"><a href="#AnnotateApp.train_and_classify-2858"><span class="linenos">2858</span></a>
</span><span id="AnnotateApp.train_and_classify-2859"><a href="#AnnotateApp.train_and_classify-2859"><span class="linenos">2859</span></a>        <span class="c1"># Evaluate</span>
</span><span id="AnnotateApp.train_and_classify-2860"><a href="#AnnotateApp.train_and_classify-2860"><span class="linenos">2860</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2861"><a href="#AnnotateApp.train_and_classify-2861"><span class="linenos">2861</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Classification Report ===&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2862"><a href="#AnnotateApp.train_and_classify-2862"><span class="linenos">2862</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
</span><span id="AnnotateApp.train_and_classify-2863"><a href="#AnnotateApp.train_and_classify-2863"><span class="linenos">2863</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Confusion Matrix ===&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2864"><a href="#AnnotateApp.train_and_classify-2864"><span class="linenos">2864</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
</span><span id="AnnotateApp.train_and_classify-2865"><a href="#AnnotateApp.train_and_classify-2865"><span class="linenos">2865</span></a>
</span><span id="AnnotateApp.train_and_classify-2866"><a href="#AnnotateApp.train_and_classify-2866"><span class="linenos">2866</span></a>        <span class="c1"># (5) Classify ALL rows</span>
</span><span id="AnnotateApp.train_and_classify-2867"><a href="#AnnotateApp.train_and_classify-2867"><span class="linenos">2867</span></a>        <span class="n">all_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2868"><a href="#AnnotateApp.train_and_classify-2868"><span class="linenos">2868</span></a>        <span class="n">X_all</span> <span class="o">=</span> <span class="n">all_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="AnnotateApp.train_and_classify-2869"><a href="#AnnotateApp.train_and_classify-2869"><span class="linenos">2869</span></a>        <span class="n">probs_all</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_all</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2870"><a href="#AnnotateApp.train_and_classify-2870"><span class="linenos">2870</span></a>        <span class="c1"># Probability =&gt; XGboost_score</span>
</span><span id="AnnotateApp.train_and_classify-2871"><a href="#AnnotateApp.train_and_classify-2871"><span class="linenos">2871</span></a>        <span class="n">all_df</span><span class="p">[</span><span class="s1">&#39;XGboost_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs_all</span>
</span><span id="AnnotateApp.train_and_classify-2872"><a href="#AnnotateApp.train_and_classify-2872"><span class="linenos">2872</span></a>
</span><span id="AnnotateApp.train_and_classify-2873"><a href="#AnnotateApp.train_and_classify-2873"><span class="linenos">2873</span></a>        <span class="c1"># Decide XGboost_annotation</span>
</span><span id="AnnotateApp.train_and_classify-2874"><a href="#AnnotateApp.train_and_classify-2874"><span class="linenos">2874</span></a>        <span class="k">def</span> <span class="nf">get_annotation_from_prob</span><span class="p">(</span><span class="n">prob</span><span class="p">):</span>
</span><span id="AnnotateApp.train_and_classify-2875"><a href="#AnnotateApp.train_and_classify-2875"><span class="linenos">2875</span></a>            <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2876"><a href="#AnnotateApp.train_and_classify-2876"><span class="linenos">2876</span></a>                <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># class=1</span>
</span><span id="AnnotateApp.train_and_classify-2877"><a href="#AnnotateApp.train_and_classify-2877"><span class="linenos">2877</span></a>            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2878"><a href="#AnnotateApp.train_and_classify-2878"><span class="linenos">2878</span></a>                <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># class=0</span>
</span><span id="AnnotateApp.train_and_classify-2879"><a href="#AnnotateApp.train_and_classify-2879"><span class="linenos">2879</span></a>            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># uncertain</span>
</span><span id="AnnotateApp.train_and_classify-2880"><a href="#AnnotateApp.train_and_classify-2880"><span class="linenos">2880</span></a>
</span><span id="AnnotateApp.train_and_classify-2881"><a href="#AnnotateApp.train_and_classify-2881"><span class="linenos">2881</span></a>        <span class="n">xgb_anno_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_annotation_from_prob</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probs_all</span><span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2882"><a href="#AnnotateApp.train_and_classify-2882"><span class="linenos">2882</span></a>        <span class="c1"># Convert 0 =&gt; 2 if your DB uses &quot;2&quot; for the negative class</span>
</span><span id="AnnotateApp.train_and_classify-2883"><a href="#AnnotateApp.train_and_classify-2883"><span class="linenos">2883</span></a>        <span class="n">xgb_anno_col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xgb_anno_col</span><span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2884"><a href="#AnnotateApp.train_and_classify-2884"><span class="linenos">2884</span></a>
</span><span id="AnnotateApp.train_and_classify-2885"><a href="#AnnotateApp.train_and_classify-2885"><span class="linenos">2885</span></a>        <span class="n">all_df</span><span class="p">[</span><span class="s1">&#39;XGboost_annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xgb_anno_col</span>
</span><span id="AnnotateApp.train_and_classify-2886"><a href="#AnnotateApp.train_and_classify-2886"><span class="linenos">2886</span></a>
</span><span id="AnnotateApp.train_and_classify-2887"><a href="#AnnotateApp.train_and_classify-2887"><span class="linenos">2887</span></a>        <span class="c1"># (6) Write results back to png_list</span>
</span><span id="AnnotateApp.train_and_classify-2888"><a href="#AnnotateApp.train_and_classify-2888"><span class="linenos">2888</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_text</span><span class="p">(</span><span class="s2">&quot;Updating the database with XGBoost predictions...&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2889"><a href="#AnnotateApp.train_and_classify-2889"><span class="linenos">2889</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2890"><a href="#AnnotateApp.train_and_classify-2890"><span class="linenos">2890</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="AnnotateApp.train_and_classify-2891"><a href="#AnnotateApp.train_and_classify-2891"><span class="linenos">2891</span></a>        <span class="c1"># Ensure columns exist</span>
</span><span id="AnnotateApp.train_and_classify-2892"><a href="#AnnotateApp.train_and_classify-2892"><span class="linenos">2892</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2893"><a href="#AnnotateApp.train_and_classify-2893"><span class="linenos">2893</span></a>            <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE png_list ADD COLUMN XGboost_annotation INTEGER&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2894"><a href="#AnnotateApp.train_and_classify-2894"><span class="linenos">2894</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2895"><a href="#AnnotateApp.train_and_classify-2895"><span class="linenos">2895</span></a>            <span class="k">pass</span>
</span><span id="AnnotateApp.train_and_classify-2896"><a href="#AnnotateApp.train_and_classify-2896"><span class="linenos">2896</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2897"><a href="#AnnotateApp.train_and_classify-2897"><span class="linenos">2897</span></a>            <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE png_list ADD COLUMN XGboost_score FLOAT&quot;</span><span class="p">)</span>
</span><span id="AnnotateApp.train_and_classify-2898"><a href="#AnnotateApp.train_and_classify-2898"><span class="linenos">2898</span></a>        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2899"><a href="#AnnotateApp.train_and_classify-2899"><span class="linenos">2899</span></a>            <span class="k">pass</span>
</span><span id="AnnotateApp.train_and_classify-2900"><a href="#AnnotateApp.train_and_classify-2900"><span class="linenos">2900</span></a>
</span><span id="AnnotateApp.train_and_classify-2901"><a href="#AnnotateApp.train_and_classify-2901"><span class="linenos">2901</span></a>        <span class="c1"># Update each row</span>
</span><span id="AnnotateApp.train_and_classify-2902"><a href="#AnnotateApp.train_and_classify-2902"><span class="linenos">2902</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">all_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="AnnotateApp.train_and_classify-2903"><a href="#AnnotateApp.train_and_classify-2903"><span class="linenos">2903</span></a>            <span class="n">score_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;XGboost_score&#39;</span><span class="p">])</span>
</span><span id="AnnotateApp.train_and_classify-2904"><a href="#AnnotateApp.train_and_classify-2904"><span class="linenos">2904</span></a>            <span class="n">anno_val</span>  <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;XGboost_annotation&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2905"><a href="#AnnotateApp.train_and_classify-2905"><span class="linenos">2905</span></a>            <span class="n">the_path</span>  <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;png_path&#39;</span><span class="p">]</span>
</span><span id="AnnotateApp.train_and_classify-2906"><a href="#AnnotateApp.train_and_classify-2906"><span class="linenos">2906</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">the_path</span><span class="p">):</span>
</span><span id="AnnotateApp.train_and_classify-2907"><a href="#AnnotateApp.train_and_classify-2907"><span class="linenos">2907</span></a>                <span class="k">continue</span>  <span class="c1"># skip if no path</span>
</span><span id="AnnotateApp.train_and_classify-2908"><a href="#AnnotateApp.train_and_classify-2908"><span class="linenos">2908</span></a>
</span><span id="AnnotateApp.train_and_classify-2909"><a href="#AnnotateApp.train_and_classify-2909"><span class="linenos">2909</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">anno_val</span><span class="p">):</span>
</span><span id="AnnotateApp.train_and_classify-2910"><a href="#AnnotateApp.train_and_classify-2910"><span class="linenos">2910</span></a>                <span class="c1"># We set annotation=NULL but do set the score</span>
</span><span id="AnnotateApp.train_and_classify-2911"><a href="#AnnotateApp.train_and_classify-2911"><span class="linenos">2911</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp.train_and_classify-2912"><a href="#AnnotateApp.train_and_classify-2912"><span class="linenos">2912</span></a><span class="s2">                    UPDATE png_list</span>
</span><span id="AnnotateApp.train_and_classify-2913"><a href="#AnnotateApp.train_and_classify-2913"><span class="linenos">2913</span></a><span class="s2">                       SET XGboost_annotation = NULL,</span>
</span><span id="AnnotateApp.train_and_classify-2914"><a href="#AnnotateApp.train_and_classify-2914"><span class="linenos">2914</span></a><span class="s2">                           XGboost_score       = ?</span>
</span><span id="AnnotateApp.train_and_classify-2915"><a href="#AnnotateApp.train_and_classify-2915"><span class="linenos">2915</span></a><span class="s2">                     WHERE png_path = ?</span>
</span><span id="AnnotateApp.train_and_classify-2916"><a href="#AnnotateApp.train_and_classify-2916"><span class="linenos">2916</span></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">score_val</span><span class="p">,</span> <span class="n">the_path</span><span class="p">))</span>
</span><span id="AnnotateApp.train_and_classify-2917"><a href="#AnnotateApp.train_and_classify-2917"><span class="linenos">2917</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AnnotateApp.train_and_classify-2918"><a href="#AnnotateApp.train_and_classify-2918"><span class="linenos">2918</span></a>                <span class="c1"># numeric annotation + numeric score</span>
</span><span id="AnnotateApp.train_and_classify-2919"><a href="#AnnotateApp.train_and_classify-2919"><span class="linenos">2919</span></a>                <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="AnnotateApp.train_and_classify-2920"><a href="#AnnotateApp.train_and_classify-2920"><span class="linenos">2920</span></a><span class="s2">                    UPDATE png_list</span>
</span><span id="AnnotateApp.train_and_classify-2921"><a href="#AnnotateApp.train_and_classify-2921"><span class="linenos">2921</span></a><span class="s2">                       SET XGboost_annotation = ?,</span>
</span><span id="AnnotateApp.train_and_classify-2922"><a href="#AnnotateApp.train_and_classify-2922"><span class="linenos">2922</span></a><span class="s2">                           XGboost_score       = ?</span>
</span><span id="AnnotateApp.train_and_classify-2923"><a href="#AnnotateApp.train_and_classify-2923"><span class="linenos">2923</span></a><span class="s2">                     WHERE png_path = ?</span>
</span><span id="AnnotateApp.train_and_classify-2924"><a href="#AnnotateApp.train_and_classify-2924"><span class="linenos">2924</span></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">anno_val</span><span class="p">),</span> <span class="n">score_val</span><span class="p">,</span> <span class="n">the_path</span><span class="p">))</span>
</span><span id="AnnotateApp.train_and_classify-2925"><a href="#AnnotateApp.train_and_classify-2925"><span class="linenos">2925</span></a>                
</span><span id="AnnotateApp.train_and_classify-2926"><a href="#AnnotateApp.train_and_classify-2926"><span class="linenos">2926</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">annotation_column</span> <span class="o">=</span> <span class="s1">&#39;XGboost_annotation&#39;</span>
</span></pre></div>


            <div class="docstring"><p>1) Merge data from the relevant DB tables (including png_list).
2) Collect manual annotations from png_list.<annotation_column> =&gt; 'manual_annotation'.</p>

<ul>
<li>1 =&gt; class=1, 2 =&gt; class=0 (for training).
3) If only one class is present, randomly sample unannotated images as the other class.
4) Train an XGBoost model.
5) Classify <em>all</em> rows -> fill XGboost_score (prob of class=1) &amp; XGboost_annotation (1 or 2 if high confidence).
6) Write those columns back to sqlite, so every row in png_list has a score (and possibly an annotation).
7) Refresh the UI (prefilter_paths_annotations + load_images).</li>
</ul>
</div>


                            </div>
                </section>
                <section id="standardize_figure">
                            <input id="standardize_figure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">standardize_figure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fig</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="standardize_figure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#standardize_figure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="standardize_figure-2928"><a href="#standardize_figure-2928"><span class="linenos">2928</span></a><span class="k">def</span> <span class="nf">standardize_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="standardize_figure-2929"><a href="#standardize_figure-2929"><span class="linenos">2929</span></a>    <span class="kn">from</span> <span class="nn">.gui_elements</span> <span class="kn">import</span> <span class="n">set_dark_style</span>
</span><span id="standardize_figure-2930"><a href="#standardize_figure-2930"><span class="linenos">2930</span></a>    <span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
</span><span id="standardize_figure-2931"><a href="#standardize_figure-2931"><span class="linenos">2931</span></a>
</span><span id="standardize_figure-2932"><a href="#standardize_figure-2932"><span class="linenos">2932</span></a>    <span class="n">style_out</span> <span class="o">=</span> <span class="n">set_dark_style</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">())</span>
</span><span id="standardize_figure-2933"><a href="#standardize_figure-2933"><span class="linenos">2933</span></a>    <span class="n">bg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;bg_color&#39;</span><span class="p">]</span>
</span><span id="standardize_figure-2934"><a href="#standardize_figure-2934"><span class="linenos">2934</span></a>    <span class="n">fg_color</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;fg_color&#39;</span><span class="p">]</span>
</span><span id="standardize_figure-2935"><a href="#standardize_figure-2935"><span class="linenos">2935</span></a>    <span class="n">font_size</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span>
</span><span id="standardize_figure-2936"><a href="#standardize_figure-2936"><span class="linenos">2936</span></a>    <span class="n">font_loader</span> <span class="o">=</span> <span class="n">style_out</span><span class="p">[</span><span class="s1">&#39;font_loader&#39;</span><span class="p">]</span>
</span><span id="standardize_figure-2937"><a href="#standardize_figure-2937"><span class="linenos">2937</span></a>
</span><span id="standardize_figure-2938"><a href="#standardize_figure-2938"><span class="linenos">2938</span></a>    <span class="c1"># Get the custom font path from the font loader</span>
</span><span id="standardize_figure-2939"><a href="#standardize_figure-2939"><span class="linenos">2939</span></a>    <span class="n">font_path</span> <span class="o">=</span> <span class="n">font_loader</span><span class="o">.</span><span class="n">font_path</span>
</span><span id="standardize_figure-2940"><a href="#standardize_figure-2940"><span class="linenos">2940</span></a>    <span class="n">font_prop</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">font_path</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="standardize_figure-2941"><a href="#standardize_figure-2941"><span class="linenos">2941</span></a>
</span><span id="standardize_figure-2942"><a href="#standardize_figure-2942"><span class="linenos">2942</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="standardize_figure-2943"><a href="#standardize_figure-2943"><span class="linenos">2943</span></a><span class="sd">    Standardizes the appearance of the figure:</span>
</span><span id="standardize_figure-2944"><a href="#standardize_figure-2944"><span class="linenos">2944</span></a><span class="sd">    - Font size: from style</span>
</span><span id="standardize_figure-2945"><a href="#standardize_figure-2945"><span class="linenos">2945</span></a><span class="sd">    - Font color: from style</span>
</span><span id="standardize_figure-2946"><a href="#standardize_figure-2946"><span class="linenos">2946</span></a><span class="sd">    - Font family: custom OpenSans from font_loader</span>
</span><span id="standardize_figure-2947"><a href="#standardize_figure-2947"><span class="linenos">2947</span></a><span class="sd">    - Removes top and right spines</span>
</span><span id="standardize_figure-2948"><a href="#standardize_figure-2948"><span class="linenos">2948</span></a><span class="sd">    - Figure and subplot background: from style</span>
</span><span id="standardize_figure-2949"><a href="#standardize_figure-2949"><span class="linenos">2949</span></a><span class="sd">    - Line width: 1</span>
</span><span id="standardize_figure-2950"><a href="#standardize_figure-2950"><span class="linenos">2950</span></a><span class="sd">    - Line color: from style</span>
</span><span id="standardize_figure-2951"><a href="#standardize_figure-2951"><span class="linenos">2951</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="standardize_figure-2952"><a href="#standardize_figure-2952"><span class="linenos">2952</span></a>    
</span><span id="standardize_figure-2953"><a href="#standardize_figure-2953"><span class="linenos">2953</span></a>
</span><span id="standardize_figure-2954"><a href="#standardize_figure-2954"><span class="linenos">2954</span></a>    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="standardize_figure-2955"><a href="#standardize_figure-2955"><span class="linenos">2955</span></a>        <span class="c1"># Set font properties for title and labels</span>
</span><span id="standardize_figure-2956"><a href="#standardize_figure-2956"><span class="linenos">2956</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="standardize_figure-2957"><a href="#standardize_figure-2957"><span class="linenos">2957</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2958"><a href="#standardize_figure-2958"><span class="linenos">2958</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="standardize_figure-2959"><a href="#standardize_figure-2959"><span class="linenos">2959</span></a>
</span><span id="standardize_figure-2960"><a href="#standardize_figure-2960"><span class="linenos">2960</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="standardize_figure-2961"><a href="#standardize_figure-2961"><span class="linenos">2961</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2962"><a href="#standardize_figure-2962"><span class="linenos">2962</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="standardize_figure-2963"><a href="#standardize_figure-2963"><span class="linenos">2963</span></a>
</span><span id="standardize_figure-2964"><a href="#standardize_figure-2964"><span class="linenos">2964</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="standardize_figure-2965"><a href="#standardize_figure-2965"><span class="linenos">2965</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2966"><a href="#standardize_figure-2966"><span class="linenos">2966</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="standardize_figure-2967"><a href="#standardize_figure-2967"><span class="linenos">2967</span></a>
</span><span id="standardize_figure-2968"><a href="#standardize_figure-2968"><span class="linenos">2968</span></a>        <span class="c1"># Set font properties for tick labels</span>
</span><span id="standardize_figure-2969"><a href="#standardize_figure-2969"><span class="linenos">2969</span></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
</span><span id="standardize_figure-2970"><a href="#standardize_figure-2970"><span class="linenos">2970</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="standardize_figure-2971"><a href="#standardize_figure-2971"><span class="linenos">2971</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2972"><a href="#standardize_figure-2972"><span class="linenos">2972</span></a>            <span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">font_prop</span><span class="p">)</span>
</span><span id="standardize_figure-2973"><a href="#standardize_figure-2973"><span class="linenos">2973</span></a>
</span><span id="standardize_figure-2974"><a href="#standardize_figure-2974"><span class="linenos">2974</span></a>        <span class="c1"># Remove top and right spines</span>
</span><span id="standardize_figure-2975"><a href="#standardize_figure-2975"><span class="linenos">2975</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="standardize_figure-2976"><a href="#standardize_figure-2976"><span class="linenos">2976</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="standardize_figure-2977"><a href="#standardize_figure-2977"><span class="linenos">2977</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="standardize_figure-2978"><a href="#standardize_figure-2978"><span class="linenos">2978</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="standardize_figure-2979"><a href="#standardize_figure-2979"><span class="linenos">2979</span></a>
</span><span id="standardize_figure-2980"><a href="#standardize_figure-2980"><span class="linenos">2980</span></a>        <span class="c1"># Set spine line width and color</span>
</span><span id="standardize_figure-2981"><a href="#standardize_figure-2981"><span class="linenos">2981</span></a>        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="standardize_figure-2982"><a href="#standardize_figure-2982"><span class="linenos">2982</span></a>            <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="standardize_figure-2983"><a href="#standardize_figure-2983"><span class="linenos">2983</span></a>            <span class="n">spine</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2984"><a href="#standardize_figure-2984"><span class="linenos">2984</span></a>
</span><span id="standardize_figure-2985"><a href="#standardize_figure-2985"><span class="linenos">2985</span></a>        <span class="c1"># Set line width and color</span>
</span><span id="standardize_figure-2986"><a href="#standardize_figure-2986"><span class="linenos">2986</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">():</span>
</span><span id="standardize_figure-2987"><a href="#standardize_figure-2987"><span class="linenos">2987</span></a>            <span class="n">line</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="standardize_figure-2988"><a href="#standardize_figure-2988"><span class="linenos">2988</span></a>            <span class="n">line</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">fg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2989"><a href="#standardize_figure-2989"><span class="linenos">2989</span></a>
</span><span id="standardize_figure-2990"><a href="#standardize_figure-2990"><span class="linenos">2990</span></a>        <span class="c1"># Set subplot background color</span>
</span><span id="standardize_figure-2991"><a href="#standardize_figure-2991"><span class="linenos">2991</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2992"><a href="#standardize_figure-2992"><span class="linenos">2992</span></a>
</span><span id="standardize_figure-2993"><a href="#standardize_figure-2993"><span class="linenos">2993</span></a>        <span class="c1"># Adjust the grid if needed</span>
</span><span id="standardize_figure-2994"><a href="#standardize_figure-2994"><span class="linenos">2994</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="standardize_figure-2995"><a href="#standardize_figure-2995"><span class="linenos">2995</span></a>
</span><span id="standardize_figure-2996"><a href="#standardize_figure-2996"><span class="linenos">2996</span></a>    <span class="c1"># Set figure background color</span>
</span><span id="standardize_figure-2997"><a href="#standardize_figure-2997"><span class="linenos">2997</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="standardize_figure-2998"><a href="#standardize_figure-2998"><span class="linenos">2998</span></a>
</span><span id="standardize_figure-2999"><a href="#standardize_figure-2999"><span class="linenos">2999</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span><span id="standardize_figure-3000"><a href="#standardize_figure-3000"><span class="linenos">3000</span></a>
</span><span id="standardize_figure-3001"><a href="#standardize_figure-3001"><span class="linenos">3001</span></a>    <span class="k">return</span> <span class="n">fig</span>
</span></pre></div>


    

                </section>
                <section id="modify_figure_properties">
                            <input id="modify_figure_properties-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">modify_figure_properties</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fig</span>,</span><span class="param">	<span class="n">scale_x</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">scale_y</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">line_width</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">font_size</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">x_lim</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">y_lim</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">grid</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">legend</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">x_label_rotation</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">remove_axes</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">bg_color</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">text_color</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">line_color</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="modify_figure_properties-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#modify_figure_properties"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="modify_figure_properties-3003"><a href="#modify_figure_properties-3003"><span class="linenos">3003</span></a><span class="k">def</span> <span class="nf">modify_figure_properties</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">scale_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label_rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="modify_figure_properties-3004"><a href="#modify_figure_properties-3004"><span class="linenos">3004</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="modify_figure_properties-3005"><a href="#modify_figure_properties-3005"><span class="linenos">3005</span></a><span class="sd">    Modifies the properties of the figure, including scaling, line widths, font sizes, axis limits, x-axis label rotation, background color, text color, line color, and other common options.</span>
</span><span id="modify_figure_properties-3006"><a href="#modify_figure_properties-3006"><span class="linenos">3006</span></a>
</span><span id="modify_figure_properties-3007"><a href="#modify_figure_properties-3007"><span class="linenos">3007</span></a><span class="sd">    Parameters:</span>
</span><span id="modify_figure_properties-3008"><a href="#modify_figure_properties-3008"><span class="linenos">3008</span></a><span class="sd">    - fig: The Matplotlib figure object to modify.</span>
</span><span id="modify_figure_properties-3009"><a href="#modify_figure_properties-3009"><span class="linenos">3009</span></a><span class="sd">    - scale_x: Scaling factor for the width of subplots (optional).</span>
</span><span id="modify_figure_properties-3010"><a href="#modify_figure_properties-3010"><span class="linenos">3010</span></a><span class="sd">    - scale_y: Scaling factor for the height of subplots (optional).</span>
</span><span id="modify_figure_properties-3011"><a href="#modify_figure_properties-3011"><span class="linenos">3011</span></a><span class="sd">    - line_width: Desired line width for all lines (optional).</span>
</span><span id="modify_figure_properties-3012"><a href="#modify_figure_properties-3012"><span class="linenos">3012</span></a><span class="sd">    - font_size: Desired font size for all text (optional).</span>
</span><span id="modify_figure_properties-3013"><a href="#modify_figure_properties-3013"><span class="linenos">3013</span></a><span class="sd">    - x_lim: Tuple specifying the x-axis limits (min, max) (optional).</span>
</span><span id="modify_figure_properties-3014"><a href="#modify_figure_properties-3014"><span class="linenos">3014</span></a><span class="sd">    - y_lim: Tuple specifying the y-axis limits (min, max) (optional).</span>
</span><span id="modify_figure_properties-3015"><a href="#modify_figure_properties-3015"><span class="linenos">3015</span></a><span class="sd">    - grid: Boolean to add grid lines to the plot (optional).</span>
</span><span id="modify_figure_properties-3016"><a href="#modify_figure_properties-3016"><span class="linenos">3016</span></a><span class="sd">    - legend: Boolean to show/hide the legend (optional).</span>
</span><span id="modify_figure_properties-3017"><a href="#modify_figure_properties-3017"><span class="linenos">3017</span></a><span class="sd">    - title: String to set as the title of the plot (optional).</span>
</span><span id="modify_figure_properties-3018"><a href="#modify_figure_properties-3018"><span class="linenos">3018</span></a><span class="sd">    - x_label_rotation: Angle to rotate the x-axis labels (optional).</span>
</span><span id="modify_figure_properties-3019"><a href="#modify_figure_properties-3019"><span class="linenos">3019</span></a><span class="sd">    - remove_axes: Boolean to remove or show the axes labels (optional).</span>
</span><span id="modify_figure_properties-3020"><a href="#modify_figure_properties-3020"><span class="linenos">3020</span></a><span class="sd">    - bg_color: Color for the figure and subplot background (optional).</span>
</span><span id="modify_figure_properties-3021"><a href="#modify_figure_properties-3021"><span class="linenos">3021</span></a><span class="sd">    - text_color: Color for all text in the figure (optional).</span>
</span><span id="modify_figure_properties-3022"><a href="#modify_figure_properties-3022"><span class="linenos">3022</span></a><span class="sd">    - line_color: Color for all lines in the figure (optional).</span>
</span><span id="modify_figure_properties-3023"><a href="#modify_figure_properties-3023"><span class="linenos">3023</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="modify_figure_properties-3024"><a href="#modify_figure_properties-3024"><span class="linenos">3024</span></a>    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3025"><a href="#modify_figure_properties-3025"><span class="linenos">3025</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: The figure provided is None.&quot;</span><span class="p">)</span>
</span><span id="modify_figure_properties-3026"><a href="#modify_figure_properties-3026"><span class="linenos">3026</span></a>        <span class="k">return</span>
</span><span id="modify_figure_properties-3027"><a href="#modify_figure_properties-3027"><span class="linenos">3027</span></a>
</span><span id="modify_figure_properties-3028"><a href="#modify_figure_properties-3028"><span class="linenos">3028</span></a>    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="modify_figure_properties-3029"><a href="#modify_figure_properties-3029"><span class="linenos">3029</span></a>        <span class="c1"># Rescale subplots if scaling factors are provided</span>
</span><span id="modify_figure_properties-3030"><a href="#modify_figure_properties-3030"><span class="linenos">3030</span></a>        <span class="k">if</span> <span class="n">scale_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scale_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3031"><a href="#modify_figure_properties-3031"><span class="linenos">3031</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
</span><span id="modify_figure_properties-3032"><a href="#modify_figure_properties-3032"><span class="linenos">3032</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="n">scale_x</span> <span class="k">if</span> <span class="n">scale_x</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="modify_figure_properties-3033"><a href="#modify_figure_properties-3033"><span class="linenos">3033</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="p">(</span><span class="n">scale_y</span> <span class="k">if</span> <span class="n">scale_y</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="modify_figure_properties-3034"><a href="#modify_figure_properties-3034"><span class="linenos">3034</span></a>            <span class="n">new_bbox</span> <span class="o">=</span> <span class="p">[</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">]</span>
</span><span id="modify_figure_properties-3035"><a href="#modify_figure_properties-3035"><span class="linenos">3035</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">new_bbox</span><span class="p">)</span>
</span><span id="modify_figure_properties-3036"><a href="#modify_figure_properties-3036"><span class="linenos">3036</span></a>
</span><span id="modify_figure_properties-3037"><a href="#modify_figure_properties-3037"><span class="linenos">3037</span></a>        <span class="c1"># Set axis limits if provided</span>
</span><span id="modify_figure_properties-3038"><a href="#modify_figure_properties-3038"><span class="linenos">3038</span></a>        <span class="k">if</span> <span class="n">x_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3039"><a href="#modify_figure_properties-3039"><span class="linenos">3039</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lim</span><span class="p">)</span>
</span><span id="modify_figure_properties-3040"><a href="#modify_figure_properties-3040"><span class="linenos">3040</span></a>        <span class="k">if</span> <span class="n">y_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3041"><a href="#modify_figure_properties-3041"><span class="linenos">3041</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
</span><span id="modify_figure_properties-3042"><a href="#modify_figure_properties-3042"><span class="linenos">3042</span></a>
</span><span id="modify_figure_properties-3043"><a href="#modify_figure_properties-3043"><span class="linenos">3043</span></a>        <span class="c1"># Set grid visibility only</span>
</span><span id="modify_figure_properties-3044"><a href="#modify_figure_properties-3044"><span class="linenos">3044</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</span><span id="modify_figure_properties-3045"><a href="#modify_figure_properties-3045"><span class="linenos">3045</span></a>
</span><span id="modify_figure_properties-3046"><a href="#modify_figure_properties-3046"><span class="linenos">3046</span></a>        <span class="c1"># Adjust line width and color if specified</span>
</span><span id="modify_figure_properties-3047"><a href="#modify_figure_properties-3047"><span class="linenos">3047</span></a>        <span class="k">if</span> <span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3048"><a href="#modify_figure_properties-3048"><span class="linenos">3048</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">():</span>
</span><span id="modify_figure_properties-3049"><a href="#modify_figure_properties-3049"><span class="linenos">3049</span></a>                <span class="k">if</span> <span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3050"><a href="#modify_figure_properties-3050"><span class="linenos">3050</span></a>                    <span class="n">line</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">line_width</span><span class="p">)</span>
</span><span id="modify_figure_properties-3051"><a href="#modify_figure_properties-3051"><span class="linenos">3051</span></a>                <span class="k">if</span> <span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3052"><a href="#modify_figure_properties-3052"><span class="linenos">3052</span></a>                    <span class="n">line</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">line_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3053"><a href="#modify_figure_properties-3053"><span class="linenos">3053</span></a>            <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>  <span class="c1"># Modify width and color of spines (e.g., scale bars)</span>
</span><span id="modify_figure_properties-3054"><a href="#modify_figure_properties-3054"><span class="linenos">3054</span></a>                <span class="k">if</span> <span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3055"><a href="#modify_figure_properties-3055"><span class="linenos">3055</span></a>                    <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">line_width</span><span class="p">)</span>
</span><span id="modify_figure_properties-3056"><a href="#modify_figure_properties-3056"><span class="linenos">3056</span></a>                <span class="k">if</span> <span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3057"><a href="#modify_figure_properties-3057"><span class="linenos">3057</span></a>                    <span class="n">spine</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">line_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3058"><a href="#modify_figure_properties-3058"><span class="linenos">3058</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">text_color</span> <span class="k">if</span> <span class="n">text_color</span> <span class="k">else</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="modify_figure_properties-3059"><a href="#modify_figure_properties-3059"><span class="linenos">3059</span></a>
</span><span id="modify_figure_properties-3060"><a href="#modify_figure_properties-3060"><span class="linenos">3060</span></a>        <span class="c1"># Adjust font size if specified</span>
</span><span id="modify_figure_properties-3061"><a href="#modify_figure_properties-3061"><span class="linenos">3061</span></a>        <span class="k">if</span> <span class="n">font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3062"><a href="#modify_figure_properties-3062"><span class="linenos">3062</span></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
</span><span id="modify_figure_properties-3063"><a href="#modify_figure_properties-3063"><span class="linenos">3063</span></a>                <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="modify_figure_properties-3064"><a href="#modify_figure_properties-3064"><span class="linenos">3064</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="modify_figure_properties-3065"><a href="#modify_figure_properties-3065"><span class="linenos">3065</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="modify_figure_properties-3066"><a href="#modify_figure_properties-3066"><span class="linenos">3066</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="modify_figure_properties-3067"><a href="#modify_figure_properties-3067"><span class="linenos">3067</span></a>            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
</span><span id="modify_figure_properties-3068"><a href="#modify_figure_properties-3068"><span class="linenos">3068</span></a>                <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">get_texts</span><span class="p">():</span>
</span><span id="modify_figure_properties-3069"><a href="#modify_figure_properties-3069"><span class="linenos">3069</span></a>                    <span class="n">text</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
</span><span id="modify_figure_properties-3070"><a href="#modify_figure_properties-3070"><span class="linenos">3070</span></a>
</span><span id="modify_figure_properties-3071"><a href="#modify_figure_properties-3071"><span class="linenos">3071</span></a>        <span class="c1"># Rotate x-axis labels if rotation is specified</span>
</span><span id="modify_figure_properties-3072"><a href="#modify_figure_properties-3072"><span class="linenos">3072</span></a>        <span class="k">if</span> <span class="n">x_label_rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="modify_figure_properties-3073"><a href="#modify_figure_properties-3073"><span class="linenos">3073</span></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
</span><span id="modify_figure_properties-3074"><a href="#modify_figure_properties-3074"><span class="linenos">3074</span></a>                <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">x_label_rotation</span><span class="p">)</span>
</span><span id="modify_figure_properties-3075"><a href="#modify_figure_properties-3075"><span class="linenos">3075</span></a>                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x_label_rotation</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="modify_figure_properties-3076"><a href="#modify_figure_properties-3076"><span class="linenos">3076</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">set_ha</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="modify_figure_properties-3077"><a href="#modify_figure_properties-3077"><span class="linenos">3077</span></a>
</span><span id="modify_figure_properties-3078"><a href="#modify_figure_properties-3078"><span class="linenos">3078</span></a>        <span class="c1"># Toggle axes labels visibility without affecting the grid or spines</span>
</span><span id="modify_figure_properties-3079"><a href="#modify_figure_properties-3079"><span class="linenos">3079</span></a>        <span class="k">if</span> <span class="n">remove_axes</span><span class="p">:</span>
</span><span id="modify_figure_properties-3080"><a href="#modify_figure_properties-3080"><span class="linenos">3080</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="modify_figure_properties-3081"><a href="#modify_figure_properties-3081"><span class="linenos">3081</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="modify_figure_properties-3082"><a href="#modify_figure_properties-3082"><span class="linenos">3082</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="modify_figure_properties-3083"><a href="#modify_figure_properties-3083"><span class="linenos">3083</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="modify_figure_properties-3084"><a href="#modify_figure_properties-3084"><span class="linenos">3084</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="modify_figure_properties-3085"><a href="#modify_figure_properties-3085"><span class="linenos">3085</span></a>
</span><span id="modify_figure_properties-3086"><a href="#modify_figure_properties-3086"><span class="linenos">3086</span></a>        <span class="c1"># Set text color if specified</span>
</span><span id="modify_figure_properties-3087"><a href="#modify_figure_properties-3087"><span class="linenos">3087</span></a>        <span class="k">if</span> <span class="n">text_color</span><span class="p">:</span>
</span><span id="modify_figure_properties-3088"><a href="#modify_figure_properties-3088"><span class="linenos">3088</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3089"><a href="#modify_figure_properties-3089"><span class="linenos">3089</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3090"><a href="#modify_figure_properties-3090"><span class="linenos">3090</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3091"><a href="#modify_figure_properties-3091"><span class="linenos">3091</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3092"><a href="#modify_figure_properties-3092"><span class="linenos">3092</span></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
</span><span id="modify_figure_properties-3093"><a href="#modify_figure_properties-3093"><span class="linenos">3093</span></a>                <span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3094"><a href="#modify_figure_properties-3094"><span class="linenos">3094</span></a>
</span><span id="modify_figure_properties-3095"><a href="#modify_figure_properties-3095"><span class="linenos">3095</span></a>        <span class="c1"># Set background color for subplots if specified</span>
</span><span id="modify_figure_properties-3096"><a href="#modify_figure_properties-3096"><span class="linenos">3096</span></a>        <span class="k">if</span> <span class="n">bg_color</span><span class="p">:</span>
</span><span id="modify_figure_properties-3097"><a href="#modify_figure_properties-3097"><span class="linenos">3097</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3098"><a href="#modify_figure_properties-3098"><span class="linenos">3098</span></a>
</span><span id="modify_figure_properties-3099"><a href="#modify_figure_properties-3099"><span class="linenos">3099</span></a>    <span class="c1"># Set figure background color if specified</span>
</span><span id="modify_figure_properties-3100"><a href="#modify_figure_properties-3100"><span class="linenos">3100</span></a>    <span class="k">if</span> <span class="n">bg_color</span><span class="p">:</span>
</span><span id="modify_figure_properties-3101"><a href="#modify_figure_properties-3101"><span class="linenos">3101</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bg_color</span><span class="p">)</span>
</span><span id="modify_figure_properties-3102"><a href="#modify_figure_properties-3102"><span class="linenos">3102</span></a>
</span><span id="modify_figure_properties-3103"><a href="#modify_figure_properties-3103"><span class="linenos">3103</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Modifies the properties of the figure, including scaling, line widths, font sizes, axis limits, x-axis label rotation, background color, text color, line color, and other common options.</p>

<p>Parameters:</p>

<ul>
<li>fig: The Matplotlib figure object to modify.</li>
<li>scale_x: Scaling factor for the width of subplots (optional).</li>
<li>scale_y: Scaling factor for the height of subplots (optional).</li>
<li>line_width: Desired line width for all lines (optional).</li>
<li>font_size: Desired font size for all text (optional).</li>
<li>x_lim: Tuple specifying the x-axis limits (min, max) (optional).</li>
<li>y_lim: Tuple specifying the y-axis limits (min, max) (optional).</li>
<li>grid: Boolean to add grid lines to the plot (optional).</li>
<li>legend: Boolean to show/hide the legend (optional).</li>
<li>title: String to set as the title of the plot (optional).</li>
<li>x_label_rotation: Angle to rotate the x-axis labels (optional).</li>
<li>remove_axes: Boolean to remove or show the axes labels (optional).</li>
<li>bg_color: Color for the figure and subplot background (optional).</li>
<li>text_color: Color for all text in the figure (optional).</li>
<li>line_color: Color for all lines in the figure (optional).</li>
</ul>
</div>


                </section>
                <section id="save_figure_as_format">
                            <input id="save_figure_as_format-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_figure_as_format</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fig</span>, </span><span class="param"><span class="n">file_format</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="save_figure_as_format-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_figure_as_format"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="save_figure_as_format-3105"><a href="#save_figure_as_format-3105"><span class="linenos">3105</span></a><span class="k">def</span> <span class="nf">save_figure_as_format</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">file_format</span><span class="p">):</span>
</span><span id="save_figure_as_format-3106"><a href="#save_figure_as_format-3106"><span class="linenos">3106</span></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="n">defaultextension</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*&quot;</span><span class="p">)])</span>
</span><span id="save_figure_as_format-3107"><a href="#save_figure_as_format-3107"><span class="linenos">3107</span></a>    <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="save_figure_as_format-3108"><a href="#save_figure_as_format-3108"><span class="linenos">3108</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="save_figure_as_format-3109"><a href="#save_figure_as_format-3109"><span class="linenos">3109</span></a>            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">file_format</span><span class="p">)</span>
</span><span id="save_figure_as_format-3110"><a href="#save_figure_as_format-3110"><span class="linenos">3110</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure saved as </span><span class="si">{</span><span class="n">file_format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="save_figure_as_format-3111"><a href="#save_figure_as_format-3111"><span class="linenos">3111</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="save_figure_as_format-3112"><a href="#save_figure_as_format-3112"><span class="linenos">3112</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error saving figure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="modify_figure">
                            <input id="modify_figure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">modify_figure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fig</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="modify_figure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#modify_figure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="modify_figure-3114"><a href="#modify_figure-3114"><span class="linenos">3114</span></a><span class="k">def</span> <span class="nf">modify_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="modify_figure-3115"><a href="#modify_figure-3115"><span class="linenos">3115</span></a>    <span class="kn">from</span> <span class="nn">.gui_core</span> <span class="kn">import</span> <span class="n">display_figure</span>
</span><span id="modify_figure-3116"><a href="#modify_figure-3116"><span class="linenos">3116</span></a>    <span class="k">def</span> <span class="nf">apply_modifications</span><span class="p">():</span>
</span><span id="modify_figure-3117"><a href="#modify_figure-3117"><span class="linenos">3117</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="modify_figure-3118"><a href="#modify_figure-3118"><span class="linenos">3118</span></a>            <span class="c1"># Only apply changes if the fields are filled</span>
</span><span id="modify_figure-3119"><a href="#modify_figure-3119"><span class="linenos">3119</span></a>            <span class="n">scale_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_x_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">scale_x_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3120"><a href="#modify_figure-3120"><span class="linenos">3120</span></a>            <span class="n">scale_y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_y_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">scale_y_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3121"><a href="#modify_figure-3121"><span class="linenos">3121</span></a>            <span class="n">line_width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_width_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">line_width_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3122"><a href="#modify_figure-3122"><span class="linenos">3122</span></a>            <span class="n">font_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">font_size_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">font_size_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3123"><a href="#modify_figure-3123"><span class="linenos">3123</span></a>            <span class="n">x_lim</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">x_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3124"><a href="#modify_figure-3124"><span class="linenos">3124</span></a>            <span class="n">y_lim</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">y_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">y_lim_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3125"><a href="#modify_figure-3125"><span class="linenos">3125</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="n">title_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">title_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3126"><a href="#modify_figure-3126"><span class="linenos">3126</span></a>            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">bg_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">bg_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3127"><a href="#modify_figure-3127"><span class="linenos">3127</span></a>            <span class="n">text_color</span> <span class="o">=</span> <span class="n">text_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">text_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3128"><a href="#modify_figure-3128"><span class="linenos">3128</span></a>            <span class="n">line_color</span> <span class="o">=</span> <span class="n">line_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">line_color_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3129"><a href="#modify_figure-3129"><span class="linenos">3129</span></a>            <span class="n">x_label_rotation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_label_rotation_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="k">if</span> <span class="n">x_label_rotation_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="modify_figure-3130"><a href="#modify_figure-3130"><span class="linenos">3130</span></a>
</span><span id="modify_figure-3131"><a href="#modify_figure-3131"><span class="linenos">3131</span></a>            <span class="n">modify_figure_properties</span><span class="p">(</span>
</span><span id="modify_figure-3132"><a href="#modify_figure-3132"><span class="linenos">3132</span></a>                <span class="n">fig</span><span class="p">,</span>
</span><span id="modify_figure-3133"><a href="#modify_figure-3133"><span class="linenos">3133</span></a>                <span class="n">scale_x</span><span class="o">=</span><span class="n">scale_x</span><span class="p">,</span>
</span><span id="modify_figure-3134"><a href="#modify_figure-3134"><span class="linenos">3134</span></a>                <span class="n">scale_y</span><span class="o">=</span><span class="n">scale_y</span><span class="p">,</span>
</span><span id="modify_figure-3135"><a href="#modify_figure-3135"><span class="linenos">3135</span></a>                <span class="n">line_width</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span>
</span><span id="modify_figure-3136"><a href="#modify_figure-3136"><span class="linenos">3136</span></a>                <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
</span><span id="modify_figure-3137"><a href="#modify_figure-3137"><span class="linenos">3137</span></a>                <span class="n">x_lim</span><span class="o">=</span><span class="n">x_lim</span><span class="p">,</span>
</span><span id="modify_figure-3138"><a href="#modify_figure-3138"><span class="linenos">3138</span></a>                <span class="n">y_lim</span><span class="o">=</span><span class="n">y_lim</span><span class="p">,</span>
</span><span id="modify_figure-3139"><a href="#modify_figure-3139"><span class="linenos">3139</span></a>                <span class="n">grid</span><span class="o">=</span><span class="n">grid_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
</span><span id="modify_figure-3140"><a href="#modify_figure-3140"><span class="linenos">3140</span></a>                <span class="n">legend</span><span class="o">=</span><span class="n">legend_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
</span><span id="modify_figure-3141"><a href="#modify_figure-3141"><span class="linenos">3141</span></a>                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
</span><span id="modify_figure-3142"><a href="#modify_figure-3142"><span class="linenos">3142</span></a>                <span class="n">x_label_rotation</span><span class="o">=</span><span class="n">x_label_rotation</span><span class="p">,</span>
</span><span id="modify_figure-3143"><a href="#modify_figure-3143"><span class="linenos">3143</span></a>                <span class="n">remove_axes</span><span class="o">=</span><span class="n">remove_axes_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
</span><span id="modify_figure-3144"><a href="#modify_figure-3144"><span class="linenos">3144</span></a>                <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span>
</span><span id="modify_figure-3145"><a href="#modify_figure-3145"><span class="linenos">3145</span></a>                <span class="n">text_color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
</span><span id="modify_figure-3146"><a href="#modify_figure-3146"><span class="linenos">3146</span></a>                <span class="n">line_color</span><span class="o">=</span><span class="n">line_color</span>
</span><span id="modify_figure-3147"><a href="#modify_figure-3147"><span class="linenos">3147</span></a>            <span class="p">)</span>
</span><span id="modify_figure-3148"><a href="#modify_figure-3148"><span class="linenos">3148</span></a>            <span class="n">display_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="modify_figure-3149"><a href="#modify_figure-3149"><span class="linenos">3149</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="modify_figure-3150"><a href="#modify_figure-3150"><span class="linenos">3150</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input; please enter numeric values.&quot;</span><span class="p">)</span>
</span><span id="modify_figure-3151"><a href="#modify_figure-3151"><span class="linenos">3151</span></a>
</span><span id="modify_figure-3152"><a href="#modify_figure-3152"><span class="linenos">3152</span></a>    <span class="k">def</span> <span class="nf">toggle_spleens</span><span class="p">():</span>
</span><span id="modify_figure-3153"><a href="#modify_figure-3153"><span class="linenos">3153</span></a>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="modify_figure-3154"><a href="#modify_figure-3154"><span class="linenos">3154</span></a>            <span class="k">if</span> <span class="n">spleens_var</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="modify_figure-3155"><a href="#modify_figure-3155"><span class="linenos">3155</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="modify_figure-3156"><a href="#modify_figure-3156"><span class="linenos">3156</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="modify_figure-3157"><a href="#modify_figure-3157"><span class="linenos">3157</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="modify_figure-3158"><a href="#modify_figure-3158"><span class="linenos">3158</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="modify_figure-3159"><a href="#modify_figure-3159"><span class="linenos">3159</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="modify_figure-3160"><a href="#modify_figure-3160"><span class="linenos">3160</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="modify_figure-3161"><a href="#modify_figure-3161"><span class="linenos">3161</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="modify_figure-3162"><a href="#modify_figure-3162"><span class="linenos">3162</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="modify_figure-3163"><a href="#modify_figure-3163"><span class="linenos">3163</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="modify_figure-3164"><a href="#modify_figure-3164"><span class="linenos">3164</span></a>            <span class="n">display_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="modify_figure-3165"><a href="#modify_figure-3165"><span class="linenos">3165</span></a>
</span><span id="modify_figure-3166"><a href="#modify_figure-3166"><span class="linenos">3166</span></a>    <span class="c1"># Create a new window for user input</span>
</span><span id="modify_figure-3167"><a href="#modify_figure-3167"><span class="linenos">3167</span></a>    <span class="n">modify_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">()</span>
</span><span id="modify_figure-3168"><a href="#modify_figure-3168"><span class="linenos">3168</span></a>    <span class="n">modify_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Modify Figure Properties&quot;</span><span class="p">)</span>
</span><span id="modify_figure-3169"><a href="#modify_figure-3169"><span class="linenos">3169</span></a>
</span><span id="modify_figure-3170"><a href="#modify_figure-3170"><span class="linenos">3170</span></a>    <span class="c1"># Apply dark style to the popup window</span>
</span><span id="modify_figure-3171"><a href="#modify_figure-3171"><span class="linenos">3171</span></a>    <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
</span><span id="modify_figure-3172"><a href="#modify_figure-3172"><span class="linenos">3172</span></a>    <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TCheckbutton&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">selectcolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</span><span id="modify_figure-3173"><a href="#modify_figure-3173"><span class="linenos">3173</span></a>
</span><span id="modify_figure-3174"><a href="#modify_figure-3174"><span class="linenos">3174</span></a>    <span class="n">modify_window</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">)</span>
</span><span id="modify_figure-3175"><a href="#modify_figure-3175"><span class="linenos">3175</span></a>
</span><span id="modify_figure-3176"><a href="#modify_figure-3176"><span class="linenos">3176</span></a>    <span class="c1"># Create and style the input fields</span>
</span><span id="modify_figure-3177"><a href="#modify_figure-3177"><span class="linenos">3177</span></a>    <span class="n">scale_x_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3178"><a href="#modify_figure-3178"><span class="linenos">3178</span></a>    <span class="n">scale_y_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3179"><a href="#modify_figure-3179"><span class="linenos">3179</span></a>    <span class="n">line_width_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3180"><a href="#modify_figure-3180"><span class="linenos">3180</span></a>    <span class="n">font_size_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3181"><a href="#modify_figure-3181"><span class="linenos">3181</span></a>    <span class="n">x_lim_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3182"><a href="#modify_figure-3182"><span class="linenos">3182</span></a>    <span class="n">y_lim_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3183"><a href="#modify_figure-3183"><span class="linenos">3183</span></a>    <span class="n">title_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3184"><a href="#modify_figure-3184"><span class="linenos">3184</span></a>    <span class="n">bg_color_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3185"><a href="#modify_figure-3185"><span class="linenos">3185</span></a>    <span class="n">text_color_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3186"><a href="#modify_figure-3186"><span class="linenos">3186</span></a>    <span class="n">line_color_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3187"><a href="#modify_figure-3187"><span class="linenos">3187</span></a>    <span class="n">x_label_rotation_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
</span><span id="modify_figure-3188"><a href="#modify_figure-3188"><span class="linenos">3188</span></a>    <span class="n">remove_axes_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="modify_figure-3189"><a href="#modify_figure-3189"><span class="linenos">3189</span></a>    <span class="n">grid_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="modify_figure-3190"><a href="#modify_figure-3190"><span class="linenos">3190</span></a>    <span class="n">legend_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="modify_figure-3191"><a href="#modify_figure-3191"><span class="linenos">3191</span></a>    <span class="n">spleens_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
</span><span id="modify_figure-3192"><a href="#modify_figure-3192"><span class="linenos">3192</span></a>
</span><span id="modify_figure-3193"><a href="#modify_figure-3193"><span class="linenos">3193</span></a>    <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="modify_figure-3194"><a href="#modify_figure-3194"><span class="linenos">3194</span></a>        <span class="p">(</span><span class="s2">&quot;Rescale X:&quot;</span><span class="p">,</span> <span class="n">scale_x_var</span><span class="p">),</span>
</span><span id="modify_figure-3195"><a href="#modify_figure-3195"><span class="linenos">3195</span></a>        <span class="p">(</span><span class="s2">&quot;Rescale Y:&quot;</span><span class="p">,</span> <span class="n">scale_y_var</span><span class="p">),</span>
</span><span id="modify_figure-3196"><a href="#modify_figure-3196"><span class="linenos">3196</span></a>        <span class="p">(</span><span class="s2">&quot;Line Width:&quot;</span><span class="p">,</span> <span class="n">line_width_var</span><span class="p">),</span>
</span><span id="modify_figure-3197"><a href="#modify_figure-3197"><span class="linenos">3197</span></a>        <span class="p">(</span><span class="s2">&quot;Font Size:&quot;</span><span class="p">,</span> <span class="n">font_size_var</span><span class="p">),</span>
</span><span id="modify_figure-3198"><a href="#modify_figure-3198"><span class="linenos">3198</span></a>        <span class="p">(</span><span class="s2">&quot;X Axis Limits (tuple):&quot;</span><span class="p">,</span> <span class="n">x_lim_var</span><span class="p">),</span>
</span><span id="modify_figure-3199"><a href="#modify_figure-3199"><span class="linenos">3199</span></a>        <span class="p">(</span><span class="s2">&quot;Y Axis Limits (tuple):&quot;</span><span class="p">,</span> <span class="n">y_lim_var</span><span class="p">),</span>
</span><span id="modify_figure-3200"><a href="#modify_figure-3200"><span class="linenos">3200</span></a>        <span class="p">(</span><span class="s2">&quot;Title:&quot;</span><span class="p">,</span> <span class="n">title_var</span><span class="p">),</span>
</span><span id="modify_figure-3201"><a href="#modify_figure-3201"><span class="linenos">3201</span></a>        <span class="p">(</span><span class="s2">&quot;X Label Rotation (degrees):&quot;</span><span class="p">,</span> <span class="n">x_label_rotation_var</span><span class="p">),</span>
</span><span id="modify_figure-3202"><a href="#modify_figure-3202"><span class="linenos">3202</span></a>        <span class="p">(</span><span class="s2">&quot;Background Color:&quot;</span><span class="p">,</span> <span class="n">bg_color_var</span><span class="p">),</span>
</span><span id="modify_figure-3203"><a href="#modify_figure-3203"><span class="linenos">3203</span></a>        <span class="p">(</span><span class="s2">&quot;Text Color:&quot;</span><span class="p">,</span> <span class="n">text_color_var</span><span class="p">),</span>
</span><span id="modify_figure-3204"><a href="#modify_figure-3204"><span class="linenos">3204</span></a>        <span class="p">(</span><span class="s2">&quot;Line Color:&quot;</span><span class="p">,</span> <span class="n">line_color_var</span><span class="p">)</span>
</span><span id="modify_figure-3205"><a href="#modify_figure-3205"><span class="linenos">3205</span></a>    <span class="p">]</span>
</span><span id="modify_figure-3206"><a href="#modify_figure-3206"><span class="linenos">3206</span></a>
</span><span id="modify_figure-3207"><a href="#modify_figure-3207"><span class="linenos">3207</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label_text</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
</span><span id="modify_figure-3208"><a href="#modify_figure-3208"><span class="linenos">3208</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="modify_figure-3209"><a href="#modify_figure-3209"><span class="linenos">3209</span></a>        <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="modify_figure-3210"><a href="#modify_figure-3210"><span class="linenos">3210</span></a>
</span><span id="modify_figure-3211"><a href="#modify_figure-3211"><span class="linenos">3211</span></a>    <span class="n">checkboxes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="modify_figure-3212"><a href="#modify_figure-3212"><span class="linenos">3212</span></a>        <span class="p">(</span><span class="s2">&quot;Grid&quot;</span><span class="p">,</span> <span class="n">grid_var</span><span class="p">),</span>
</span><span id="modify_figure-3213"><a href="#modify_figure-3213"><span class="linenos">3213</span></a>        <span class="p">(</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="n">legend_var</span><span class="p">),</span>
</span><span id="modify_figure-3214"><a href="#modify_figure-3214"><span class="linenos">3214</span></a>        <span class="p">(</span><span class="s2">&quot;Spleens&quot;</span><span class="p">,</span> <span class="n">spleens_var</span><span class="p">),</span>
</span><span id="modify_figure-3215"><a href="#modify_figure-3215"><span class="linenos">3215</span></a>        <span class="p">(</span><span class="s2">&quot;Remove Axes&quot;</span><span class="p">,</span> <span class="n">remove_axes_var</span><span class="p">)</span>
</span><span id="modify_figure-3216"><a href="#modify_figure-3216"><span class="linenos">3216</span></a>    <span class="p">]</span>
</span><span id="modify_figure-3217"><a href="#modify_figure-3217"><span class="linenos">3217</span></a>
</span><span id="modify_figure-3218"><a href="#modify_figure-3218"><span class="linenos">3218</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label_text</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">checkboxes</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)):</span>
</span><span id="modify_figure-3219"><a href="#modify_figure-3219"><span class="linenos">3219</span></a>        <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">label_text</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;TCheckbutton&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="modify_figure-3220"><a href="#modify_figure-3220"><span class="linenos">3220</span></a>
</span><span id="modify_figure-3221"><a href="#modify_figure-3221"><span class="linenos">3221</span></a>    <span class="n">spleens_var</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">toggle_spleens</span><span class="p">())</span>
</span><span id="modify_figure-3222"><a href="#modify_figure-3222"><span class="linenos">3222</span></a>
</span><span id="modify_figure-3223"><a href="#modify_figure-3223"><span class="linenos">3223</span></a>    <span class="c1"># Apply button</span>
</span><span id="modify_figure-3224"><a href="#modify_figure-3224"><span class="linenos">3224</span></a>    <span class="n">apply_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">modify_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">apply_modifications</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="modify_figure-3225"><a href="#modify_figure-3225"><span class="linenos">3225</span></a>    <span class="n">apply_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkboxes</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="generate_dna_matrix">
                            <input id="generate_dna_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_dna_matrix</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;dna_matrix.gif&#39;</span>,</span><span class="param">	<span class="n">canvas_width</span><span class="o">=</span><span class="mi">1500</span>,</span><span class="param">	<span class="n">canvas_height</span><span class="o">=</span><span class="mi">1000</span>,</span><span class="param">	<span class="n">duration</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">fps</span><span class="o">=</span><span class="mi">20</span>,</span><span class="param">	<span class="n">base_size</span><span class="o">=</span><span class="mi">20</span>,</span><span class="param">	<span class="n">transition_frames</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span>,</span><span class="param">	<span class="n">enhance</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>,</span><span class="param">	<span class="n">lowercase_prob</span><span class="o">=</span><span class="mf">0.3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="generate_dna_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_dna_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_dna_matrix-3227"><a href="#generate_dna_matrix-3227"><span class="linenos">3227</span></a><span class="k">def</span> <span class="nf">generate_dna_matrix</span><span class="p">(</span><span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;dna_matrix.gif&#39;</span><span class="p">,</span> <span class="n">canvas_width</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">canvas_height</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">base_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">transition_frames</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">enhance</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">lowercase_prob</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
</span><span id="generate_dna_matrix-3228"><a href="#generate_dna_matrix-3228"><span class="linenos">3228</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="generate_dna_matrix-3229"><a href="#generate_dna_matrix-3229"><span class="linenos">3229</span></a><span class="sd">    Generate a DNA matrix animation and save it as GIF, MP4, or AVI using OpenCV for videos.</span>
</span><span id="generate_dna_matrix-3230"><a href="#generate_dna_matrix-3230"><span class="linenos">3230</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_dna_matrix-3231"><a href="#generate_dna_matrix-3231"><span class="linenos">3231</span></a>
</span><span id="generate_dna_matrix-3232"><a href="#generate_dna_matrix-3232"><span class="linenos">3232</span></a>    <span class="k">def</span> <span class="nf">save_output</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="n">output_format</span><span class="p">):</span>
</span><span id="generate_dna_matrix-3233"><a href="#generate_dna_matrix-3233"><span class="linenos">3233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the animation based on output format.&quot;&quot;&quot;</span>
</span><span id="generate_dna_matrix-3234"><a href="#generate_dna_matrix-3234"><span class="linenos">3234</span></a>        <span class="k">if</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="s1">&#39;.avi&#39;</span><span class="p">]:</span>
</span><span id="generate_dna_matrix-3235"><a href="#generate_dna_matrix-3235"><span class="linenos">3235</span></a>            <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">frames</span><span class="p">]</span>
</span><span id="generate_dna_matrix-3236"><a href="#generate_dna_matrix-3236"><span class="linenos">3236</span></a>            <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="s1">&#39;mp4v&#39;</span> <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;.mp4&#39;</span> <span class="k">else</span> <span class="s1">&#39;XVID&#39;</span><span class="p">))</span>
</span><span id="generate_dna_matrix-3237"><a href="#generate_dna_matrix-3237"><span class="linenos">3237</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">))</span>
</span><span id="generate_dna_matrix-3238"><a href="#generate_dna_matrix-3238"><span class="linenos">3238</span></a>            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3239"><a href="#generate_dna_matrix-3239"><span class="linenos">3239</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">))</span>
</span><span id="generate_dna_matrix-3240"><a href="#generate_dna_matrix-3240"><span class="linenos">3240</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="generate_dna_matrix-3241"><a href="#generate_dna_matrix-3241"><span class="linenos">3241</span></a>        <span class="k">elif</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;.gif&#39;</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3242"><a href="#generate_dna_matrix-3242"><span class="linenos">3242</span></a>            <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">duration</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="n">fps</span><span class="p">),</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3243"><a href="#generate_dna_matrix-3243"><span class="linenos">3243</span></a>
</span><span id="generate_dna_matrix-3244"><a href="#generate_dna_matrix-3244"><span class="linenos">3244</span></a>    <span class="k">def</span> <span class="nf">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="generate_dna_matrix-3245"><a href="#generate_dna_matrix-3245"><span class="linenos">3245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws a DNA base at the specified position.&quot;&quot;&quot;</span>
</span><span id="generate_dna_matrix-3246"><a href="#generate_dna_matrix-3246"><span class="linenos">3246</span></a>        <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">col_idx</span> <span class="o">*</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">base_position</span> <span class="o">*</span> <span class="n">base_size</span><span class="p">),</span> <span class="n">base</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="o">*</span><span class="n">fill_color</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3247"><a href="#generate_dna_matrix-3247"><span class="linenos">3247</span></a>
</span><span id="generate_dna_matrix-3248"><a href="#generate_dna_matrix-3248"><span class="linenos">3248</span></a>    <span class="c1"># Setup variables</span>
</span><span id="generate_dna_matrix-3249"><a href="#generate_dna_matrix-3249"><span class="linenos">3249</span></a>    <span class="n">num_frames</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">*</span> <span class="n">fps</span>
</span><span id="generate_dna_matrix-3250"><a href="#generate_dna_matrix-3250"><span class="linenos">3250</span></a>    <span class="n">num_columns</span> <span class="o">=</span> <span class="n">canvas_width</span> <span class="o">//</span> <span class="n">base_size</span>
</span><span id="generate_dna_matrix-3251"><a href="#generate_dna_matrix-3251"><span class="linenos">3251</span></a>    <span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
</span><span id="generate_dna_matrix-3252"><a href="#generate_dna_matrix-3252"><span class="linenos">3252</span></a>    <span class="n">active_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">155</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">155</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3253"><a href="#generate_dna_matrix-3253"><span class="linenos">3253</span></a>    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3254"><a href="#generate_dna_matrix-3254"><span class="linenos">3254</span></a>    <span class="n">base_colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">}</span>
</span><span id="generate_dna_matrix-3255"><a href="#generate_dna_matrix-3255"><span class="linenos">3255</span></a>
</span><span id="generate_dna_matrix-3256"><a href="#generate_dna_matrix-3256"><span class="linenos">3256</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">output_format</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3257"><a href="#generate_dna_matrix-3257"><span class="linenos">3257</span></a>    
</span><span id="generate_dna_matrix-3258"><a href="#generate_dna_matrix-3258"><span class="linenos">3258</span></a>    <span class="c1"># Initialize font</span>
</span><span id="generate_dna_matrix-3259"><a href="#generate_dna_matrix-3259"><span class="linenos">3259</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3260"><a href="#generate_dna_matrix-3260"><span class="linenos">3260</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">font_type</span><span class="p">,</span> <span class="n">base_size</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3261"><a href="#generate_dna_matrix-3261"><span class="linenos">3261</span></a>    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3262"><a href="#generate_dna_matrix-3262"><span class="linenos">3262</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">load_default</span><span class="p">()</span>
</span><span id="generate_dna_matrix-3263"><a href="#generate_dna_matrix-3263"><span class="linenos">3263</span></a>
</span><span id="generate_dna_matrix-3264"><a href="#generate_dna_matrix-3264"><span class="linenos">3264</span></a>    <span class="c1"># DNA string and positions</span>
</span><span id="generate_dna_matrix-3265"><a href="#generate_dna_matrix-3265"><span class="linenos">3265</span></a>    <span class="n">string_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)]</span>
</span><span id="generate_dna_matrix-3266"><a href="#generate_dna_matrix-3266"><span class="linenos">3266</span></a>    <span class="n">visible_bases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_columns</span>
</span><span id="generate_dna_matrix-3267"><a href="#generate_dna_matrix-3267"><span class="linenos">3267</span></a>    <span class="n">base_positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="n">canvas_height</span> <span class="o">//</span> <span class="n">base_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)]</span>
</span><span id="generate_dna_matrix-3268"><a href="#generate_dna_matrix-3268"><span class="linenos">3268</span></a>    <span class="n">column_strings</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)]</span>
</span><span id="generate_dna_matrix-3269"><a href="#generate_dna_matrix-3269"><span class="linenos">3269</span></a>    <span class="n">random_white_sequences</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_columns</span>
</span><span id="generate_dna_matrix-3270"><a href="#generate_dna_matrix-3270"><span class="linenos">3270</span></a>
</span><span id="generate_dna_matrix-3271"><a href="#generate_dna_matrix-3271"><span class="linenos">3271</span></a>    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="generate_dna_matrix-3272"><a href="#generate_dna_matrix-3272"><span class="linenos">3272</span></a>    <span class="n">end_frame_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_frames</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3273"><a href="#generate_dna_matrix-3273"><span class="linenos">3273</span></a>
</span><span id="generate_dna_matrix-3274"><a href="#generate_dna_matrix-3274"><span class="linenos">3274</span></a>    <span class="k">for</span> <span class="n">frame_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_frames</span><span class="p">):</span>
</span><span id="generate_dna_matrix-3275"><a href="#generate_dna_matrix-3275"><span class="linenos">3275</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">canvas_width</span><span class="p">,</span> <span class="n">canvas_height</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
</span><span id="generate_dna_matrix-3276"><a href="#generate_dna_matrix-3276"><span class="linenos">3276</span></a>        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3277"><a href="#generate_dna_matrix-3277"><span class="linenos">3277</span></a>
</span><span id="generate_dna_matrix-3278"><a href="#generate_dna_matrix-3278"><span class="linenos">3278</span></a>        <span class="k">for</span> <span class="n">col_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="p">):</span>
</span><span id="generate_dna_matrix-3279"><a href="#generate_dna_matrix-3279"><span class="linenos">3279</span></a>            <span class="k">if</span> <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">canvas_height</span> <span class="o">//</span> <span class="n">base_size</span> <span class="ow">and</span> <span class="n">frame_idx</span> <span class="o">&lt;</span> <span class="n">end_frame_start</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3280"><a href="#generate_dna_matrix-3280"><span class="linenos">3280</span></a>                <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3281"><a href="#generate_dna_matrix-3281"><span class="linenos">3281</span></a>                <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span>
</span><span id="generate_dna_matrix-3282"><a href="#generate_dna_matrix-3282"><span class="linenos">3282</span></a>                <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="generate_dna_matrix-3283"><a href="#generate_dna_matrix-3283"><span class="linenos">3283</span></a>                <span class="c1"># Randomly choose whether to make each base lowercase</span>
</span><span id="generate_dna_matrix-3284"><a href="#generate_dna_matrix-3284"><span class="linenos">3284</span></a>                <span class="n">column_strings</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="generate_dna_matrix-3285"><a href="#generate_dna_matrix-3285"><span class="linenos">3285</span></a>                    <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="n">base</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">base</span><span class="p">])</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">lowercase_prob</span> <span class="k">else</span> <span class="n">base</span>
</span><span id="generate_dna_matrix-3286"><a href="#generate_dna_matrix-3286"><span class="linenos">3286</span></a>                    <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bases</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">])]</span>
</span><span id="generate_dna_matrix-3287"><a href="#generate_dna_matrix-3287"><span class="linenos">3287</span></a>                <span class="p">]</span>
</span><span id="generate_dna_matrix-3288"><a href="#generate_dna_matrix-3288"><span class="linenos">3288</span></a>                <span class="k">if</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3289"><a href="#generate_dna_matrix-3289"><span class="linenos">3289</span></a>                    <span class="n">random_start</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3290"><a href="#generate_dna_matrix-3290"><span class="linenos">3290</span></a>                    <span class="n">random_white_sequences</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">random_start</span><span class="p">,</span> <span class="n">random_start</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3291"><a href="#generate_dna_matrix-3291"><span class="linenos">3291</span></a>
</span><span id="generate_dna_matrix-3292"><a href="#generate_dna_matrix-3292"><span class="linenos">3292</span></a>            <span class="n">last_10_percent_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">))</span>
</span><span id="generate_dna_matrix-3293"><a href="#generate_dna_matrix-3293"><span class="linenos">3293</span></a>            
</span><span id="generate_dna_matrix-3294"><a href="#generate_dna_matrix-3294"><span class="linenos">3294</span></a>            <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">],</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">])):</span>
</span><span id="generate_dna_matrix-3295"><a href="#generate_dna_matrix-3295"><span class="linenos">3295</span></a>                <span class="n">base_position</span> <span class="o">=</span> <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">row_idx</span>
</span><span id="generate_dna_matrix-3296"><a href="#generate_dna_matrix-3296"><span class="linenos">3296</span></a>                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">base_position</span> <span class="o">*</span> <span class="n">base_size</span> <span class="o">&lt;</span> <span class="n">canvas_height</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3297"><a href="#generate_dna_matrix-3297"><span class="linenos">3297</span></a>                    <span class="n">base</span> <span class="o">=</span> <span class="n">column_strings</span><span class="p">[</span><span class="n">col_idx</span><span class="p">][</span><span class="n">row_idx</span><span class="p">]</span>
</span><span id="generate_dna_matrix-3298"><a href="#generate_dna_matrix-3298"><span class="linenos">3298</span></a>                    <span class="k">if</span> <span class="n">base</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3299"><a href="#generate_dna_matrix-3299"><span class="linenos">3299</span></a>                        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3300"><a href="#generate_dna_matrix-3300"><span class="linenos">3300</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3301"><a href="#generate_dna_matrix-3301"><span class="linenos">3301</span></a>                        <span class="k">elif</span> <span class="n">row_idx</span> <span class="o">&gt;=</span> <span class="n">last_10_percent_start</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3302"><a href="#generate_dna_matrix-3302"><span class="linenos">3302</span></a>                            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(((</span><span class="n">row_idx</span> <span class="o">-</span> <span class="n">last_10_percent_start</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">last_10_percent_start</span><span class="p">))</span> <span class="o">*</span> <span class="mi">127</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3303"><a href="#generate_dna_matrix-3303"><span class="linenos">3303</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">base_colors</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
</span><span id="generate_dna_matrix-3304"><a href="#generate_dna_matrix-3304"><span class="linenos">3304</span></a>                        <span class="k">elif</span> <span class="n">random_white_sequences</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="n">random_white_sequences</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]:</span>
</span><span id="generate_dna_matrix-3305"><a href="#generate_dna_matrix-3305"><span class="linenos">3305</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">active_color</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3306"><a href="#generate_dna_matrix-3306"><span class="linenos">3306</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3307"><a href="#generate_dna_matrix-3307"><span class="linenos">3307</span></a>                            <span class="n">draw_base</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">base_position</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">base_colors</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
</span><span id="generate_dna_matrix-3308"><a href="#generate_dna_matrix-3308"><span class="linenos">3308</span></a>
</span><span id="generate_dna_matrix-3309"><a href="#generate_dna_matrix-3309"><span class="linenos">3309</span></a>            <span class="k">if</span> <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">string_lengths</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]:</span>
</span><span id="generate_dna_matrix-3310"><a href="#generate_dna_matrix-3310"><span class="linenos">3310</span></a>                <span class="n">visible_bases</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="generate_dna_matrix-3311"><a href="#generate_dna_matrix-3311"><span class="linenos">3311</span></a>            <span class="n">base_positions</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="generate_dna_matrix-3312"><a href="#generate_dna_matrix-3312"><span class="linenos">3312</span></a>
</span><span id="generate_dna_matrix-3313"><a href="#generate_dna_matrix-3313"><span class="linenos">3313</span></a>        <span class="c1"># Convert the image to numpy array to check unique pixel values</span>
</span><span id="generate_dna_matrix-3314"><a href="#generate_dna_matrix-3314"><span class="linenos">3314</span></a>        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3315"><a href="#generate_dna_matrix-3315"><span class="linenos">3315</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">img_array</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Only append frames with more than two unique pixel values (avoid black frames)</span>
</span><span id="generate_dna_matrix-3316"><a href="#generate_dna_matrix-3316"><span class="linenos">3316</span></a>            <span class="c1"># Enhance contrast and saturation</span>
</span><span id="generate_dna_matrix-3317"><a href="#generate_dna_matrix-3317"><span class="linenos">3317</span></a>            <span class="k">if</span> <span class="n">enhance</span><span class="p">:</span>
</span><span id="generate_dna_matrix-3318"><a href="#generate_dna_matrix-3318"><span class="linenos">3318</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Brightness</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>   <span class="c1"># Slightly increase brightness</span>
</span><span id="generate_dna_matrix-3319"><a href="#generate_dna_matrix-3319"><span class="linenos">3319</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Sharpness</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>    <span class="c1"># Sharpen the image</span>
</span><span id="generate_dna_matrix-3320"><a href="#generate_dna_matrix-3320"><span class="linenos">3320</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Contrast</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>     <span class="c1"># Enhance contrast</span>
</span><span id="generate_dna_matrix-3321"><a href="#generate_dna_matrix-3321"><span class="linenos">3321</span></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">enhance</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>        <span class="c1"># Boost color saturation </span>
</span><span id="generate_dna_matrix-3322"><a href="#generate_dna_matrix-3322"><span class="linenos">3322</span></a>
</span><span id="generate_dna_matrix-3323"><a href="#generate_dna_matrix-3323"><span class="linenos">3323</span></a>            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3324"><a href="#generate_dna_matrix-3324"><span class="linenos">3324</span></a>
</span><span id="generate_dna_matrix-3325"><a href="#generate_dna_matrix-3325"><span class="linenos">3325</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">transition_frames</span><span class="p">):</span>
</span><span id="generate_dna_matrix-3326"><a href="#generate_dna_matrix-3326"><span class="linenos">3326</span></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">transition_frames</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3327"><a href="#generate_dna_matrix-3327"><span class="linenos">3327</span></a>        <span class="n">transition_frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3328"><a href="#generate_dna_matrix-3328"><span class="linenos">3328</span></a>        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition_frame</span><span class="p">)</span>
</span><span id="generate_dna_matrix-3329"><a href="#generate_dna_matrix-3329"><span class="linenos">3329</span></a>
</span><span id="generate_dna_matrix-3330"><a href="#generate_dna_matrix-3330"><span class="linenos">3330</span></a>    <span class="n">save_output</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a DNA matrix animation and save it as GIF, MP4, or AVI using OpenCV for videos.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>